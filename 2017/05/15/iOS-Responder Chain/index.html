<!DOCTYPE html><html lang="zh-CN"><head><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="description"><title>iOS-Responder Chain (响应链) | JackJin's 博客</title><link rel="stylesheet" type="text/css" href="/css/style.css?v=0.0.0"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/normalize/4.1.1/normalize.min.css"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/pure/0.6.0/pure-min.css"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/pure/0.6.0/grids-responsive-min.css"><link rel="stylesheet" href="//cdn.bootcss.com/font-awesome/4.6.2/css/font-awesome.min.css"><script type="text/javascript" src="//cdn.bootcss.com/jquery/2.2.3/jquery.min.js"></script><link rel="Shortcut Icon" type="image/x-icon" href="/favicon.ico"><link rel="apple-touch-icon" href="/apple-touch-icon.png"><link rel="apple-touch-icon-precomposed" href="/apple-touch-icon.png"><link rel="alternate" type="application/atom+xml" href="/atom.xml"></head><body><div class="body_container"><div id="header"><div class="site-name"><h1 class="hidden">iOS-Responder Chain (响应链)</h1><a id="logo" href="/.">JackJin's 博客</a><p class="description">一位脚踏实地，拥有梦想的90后，想要一直努力追上你！</p></div><div id="nav-menu"><a href="/." class="current"><i class="fa fa-home"> 首页</i></a><a href="/archives/"><i class="fa fa-archive"> 归档</i></a><a href="/about/"><i class="fa fa-user"> 关于</i></a><a href="/atom.xml"><i class="fa fa-rss"> 订阅</i></a></div></div><div id="layout" class="pure-g"><div class="pure-u-1 pure-u-md-3-4"><div class="content_container"><div class="post"><h1 class="post-title">iOS-Responder Chain (响应链)</h1><div class="post-meta">May 15, 2017<span> | </span><span class="category"><a href="/categories/iOS/">iOS</a></span><script src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js" async></script><span id="busuanzi_container_page_pv"> | <span id="busuanzi_value_page_pv"></span><span> Hits</span></span></div><a data-disqus-identifier="2017/05/15/iOS-Responder Chain/" href="/2017/05/15/iOS-Responder Chain/#disqus_thread" class="disqus-comment-count"></a><div class="clear"><div id="toc" class="toc-article"><div class="toc-title">文章目录</div><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#iOS-Responder-Chain-响应链"><span class="toc-number">1.</span> <span class="toc-text">iOS-Responder Chain (响应链)</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#人与计算机交互"><span class="toc-number">1.1.</span> <span class="toc-text">人与计算机交互</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Responder-Chain-响应者链"><span class="toc-number">1.2.</span> <span class="toc-text">Responder Chain (响应者链)</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#NSResponder-h-头文件的源码"><span class="toc-number">1.2.0.0.1.</span> <span class="toc-text">NSResponder.h 头文件的源码</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#UIKit-控件之间的继承关系"><span class="toc-number">1.2.0.0.2.</span> <span class="toc-text">UIKit 控件之间的继承关系</span></a></li></ol></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#响应链的创建"><span class="toc-number">1.3.</span> <span class="toc-text">响应链的创建</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#控制器中的-View-树状结构"><span class="toc-number">1.3.0.0.1.</span> <span class="toc-text">控制器中的 View 树状结构</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#点击相应的测试-amp-打印"><span class="toc-number">1.3.0.0.2.</span> <span class="toc-text">点击相应的测试&打印</span></a></li></ol></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#如何找打第一响应者"><span class="toc-number">1.4.</span> <span class="toc-text">如何找打第一响应者</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#探测器-Hit-Test"><span class="toc-number">1.4.0.0.1.</span> <span class="toc-text">探测器 Hit - Test</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#寻找第一相应的探测猜想"><span class="toc-number">1.4.0.0.2.</span> <span class="toc-text">寻找第一相应的探测猜想</span></a></li></ol></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#利用响应者在应用中的体现"><span class="toc-number">1.5.</span> <span class="toc-text">利用响应者在应用中的体现</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#改变控件的相应范围"><span class="toc-number">1.5.0.0.1.</span> <span class="toc-text">改变控件的相应范围</span></a></li></ol></li></ol></li></ol></li></ol></li></ol></div></div><div class="post-content"><p>工作接近一年，很久没有更新博客。工作中学到很多知识点后面将花时间整理，作为对一年知识学习的总结：</p>
<p>下面是本篇博客的写作思路：</p>
<p><img src="http://upload-images.jianshu.io/upload_images/1877765-56a34538a5ab0e6b.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="iOS-Responder Chain.png"></p>
<h1 id="iOS-Responder-Chain-响应链"><a href="#iOS-Responder-Chain-响应链" class="headerlink" title="iOS-Responder Chain (响应链)"></a>iOS-Responder Chain (响应链)</h1><h2 id="人与计算机交互"><a href="#人与计算机交互" class="headerlink" title="人与计算机交互"></a>人与计算机交互</h2><p>目前计算机在我们生活中扮演很重要的角色，我们与计算机之间的交互也很普遍。多数情况使用最多的是 PC 和 移动端，而两种交互方式有很大的不同</p>
<ul>
<li>PC 与人的交互</li>
<li>移动端与人的交互</li>
</ul>
<p>a)  在 PC 端我们通过键盘、鼠标等来对界面的内容进行操作和完成相关的任务</p>
<p>b）在移动端我们可以通过手指对界面内容进行点击控件和实现相应的操作</p>
<blockquote>
<p>这里提出一个疑问，PC 端我们通过点击可以实现控件的相关操作。但是移动端我们手指点击控件是怎么被检测点击的位置、传递信息和做出相应的操作呢？</p>
</blockquote>
<p>这里引入一个概念：Responder Chain (响应者链)</p>
<h2 id="Responder-Chain-响应者链"><a href="#Responder-Chain-响应者链" class="headerlink" title="Responder Chain (响应者链)"></a>Responder Chain (响应者链)</h2><ul>
<li>NSResponder.h 头文件的源码</li>
<li>UIKit 控件之间的继承关系</li>
</ul>
<h5 id="NSResponder-h-头文件的源码"><a href="#NSResponder-h-头文件的源码" class="headerlink" title="NSResponder.h 头文件的源码"></a>NSResponder.h 头文件的源码</h5><p>在我们点击手机屏幕的一个控件时，与 Responder Chain (响应者链)之间联系紧密。下面是小编在 <code>UIKit</code> 框架中找到相应相关的代码，如下：<br><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">@interface</span> <span class="title">UIResponder</span> : <span class="title">NSObject</span> &lt;<span class="title">UIResponderStandardEditActions</span>&gt;</span></span><br><span class="line"><span class="keyword">@property</span>(<span class="keyword">nonatomic</span>, <span class="keyword">readonly</span>, nullable) <span class="built_in">UIResponder</span> *nextResponder;</span><br><span class="line">- (nullable <span class="built_in">UIResponder</span>*)nextResponder;</span><br><span class="line"></span><br><span class="line"><span class="keyword">@property</span>(<span class="keyword">nonatomic</span>, <span class="keyword">readonly</span>) <span class="built_in">BOOL</span> canBecomeFirstResponder;    <span class="comment">// default is NO</span></span><br><span class="line">- (<span class="built_in">BOOL</span>)canBecomeFirstResponder;    <span class="comment">// default is NO</span></span><br><span class="line">- (<span class="built_in">BOOL</span>)becomeFirstResponder;</span><br><span class="line"></span><br><span class="line"><span class="keyword">@property</span>(<span class="keyword">nonatomic</span>, <span class="keyword">readonly</span>) <span class="built_in">BOOL</span> canResignFirstResponder;   </span><br><span class="line">- (<span class="built_in">BOOL</span>)canResignFirstResponder;    <span class="comment">// default is YES</span></span><br><span class="line">- (<span class="built_in">BOOL</span>)resignFirstResponder;</span><br><span class="line"></span><br><span class="line"><span class="keyword">@property</span>(<span class="keyword">nonatomic</span>, <span class="keyword">readonly</span>) <span class="built_in">BOOL</span> isFirstResponder;</span><br><span class="line">- (<span class="built_in">BOOL</span>)isFirstResponder;</span><br><span class="line"></span><br><span class="line">- (<span class="keyword">void</span>)touchesBegan:(<span class="built_in">NSSet</span>&lt;<span class="built_in">UITouch</span> *&gt; *)touches withEvent:(nullable <span class="built_in">UIEvent</span> *)event;</span><br><span class="line">- (<span class="keyword">void</span>)touchesMoved:(<span class="built_in">NSSet</span>&lt;<span class="built_in">UITouch</span> *&gt; *)touches withEvent:(nullable <span class="built_in">UIEvent</span> *)event;</span><br><span class="line">- (<span class="keyword">void</span>)touchesEnded:(<span class="built_in">NSSet</span>&lt;<span class="built_in">UITouch</span> *&gt; *)touches withEvent:(nullable <span class="built_in">UIEvent</span> *)event;</span><br><span class="line">- (<span class="keyword">void</span>)touchesCancelled:(<span class="built_in">NSSet</span>&lt;<span class="built_in">UITouch</span> *&gt; *)touches withEvent:(nullable <span class="built_in">UIEvent</span> *)event;</span><br><span class="line">- (<span class="keyword">void</span>)touchesEstimatedPropertiesUpdated:(<span class="built_in">NSSet</span>&lt;<span class="built_in">UITouch</span> *&gt; *)touches <span class="built_in">NS_AVAILABLE_IOS</span>(<span class="number">9</span>_1);</span><br><span class="line"></span><br><span class="line">- (<span class="keyword">void</span>)pressesBegan:(<span class="built_in">NSSet</span>&lt;<span class="built_in">UIPress</span> *&gt; *)presses withEvent:(nullable <span class="built_in">UIPressesEvent</span> *)event <span class="built_in">NS_AVAILABLE_IOS</span>(<span class="number">9</span>_0);</span><br><span class="line">- (<span class="keyword">void</span>)pressesChanged:(<span class="built_in">NSSet</span>&lt;<span class="built_in">UIPress</span> *&gt; *)presses withEvent:(nullable <span class="built_in">UIPressesEvent</span> *)event <span class="built_in">NS_AVAILABLE_IOS</span>(<span class="number">9</span>_0);</span><br><span class="line">- (<span class="keyword">void</span>)pressesEnded:(<span class="built_in">NSSet</span>&lt;<span class="built_in">UIPress</span> *&gt; *)presses withEvent:(nullable <span class="built_in">UIPressesEvent</span> *)event <span class="built_in">NS_AVAILABLE_IOS</span>(<span class="number">9</span>_0);</span><br><span class="line">- (<span class="keyword">void</span>)pressesCancelled:(<span class="built_in">NSSet</span>&lt;<span class="built_in">UIPress</span> *&gt; *)presses withEvent:(nullable <span class="built_in">UIPressesEvent</span> *)event <span class="built_in">NS_AVAILABLE_IOS</span>(<span class="number">9</span>_0);</span><br></pre></td></tr></table></figure></p>
<p>在上面 <code>&lt;UIKit/UIResponder.h&gt;</code> 的文件中我们可以看出 <code>UIResponder</code> 的类可以实现 <code>Touch</code> 和 <code>Press</code> 相关操作的做出监听</p>
<h5 id="UIKit-控件之间的继承关系"><a href="#UIKit-控件之间的继承关系" class="headerlink" title="UIKit 控件之间的继承关系"></a>UIKit 控件之间的继承关系</h5><p>下面是小编对 <code>UIKit</code> 框架中点击相应控件有关 <code>Class</code> (类)继承关系整理，如下图：</p>
<p><img src="http://upload-images.jianshu.io/upload_images/1877765-faaebfb7fe3a7067.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="iOS-Responder Chain-UIKit.png"></p>
<blockquote>
<p>由上面我们可以看出，在界面上我们平时使用控件时通过继承 <code>UIResponder</code> 来实现对界面 <code>Touch</code> 和 <code>Press</code> 相关操作的做出监听</p>
</blockquote>
<h2 id="响应链的创建"><a href="#响应链的创建" class="headerlink" title="响应链的创建"></a>响应链的创建</h2><ul>
<li>控制器中的 <code>View</code> 树状结构</li>
<li>点击相应的测试&amp;打印</li>
</ul>
<h5 id="控制器中的-View-树状结构"><a href="#控制器中的-View-树状结构" class="headerlink" title="控制器中的 View 树状结构"></a>控制器中的 <code>View</code> 树状结构</h5><p>在手机的 GUI 中我们多数情况下使用 <code>UIViewController</code> 和 <code>UINavigationViewController</code> 控制器来实现界面控件的管理，其中以控制器的 <code>View</code> 为界面显示创建和添加控件，最后形成 <code>View</code> 的控件树状结构</p>
<p>GUI 手机界面中，我们知道 <code>UIView</code> 中用 <code>property</code> (属性) <code>superView</code> 可以用来添加新的 <code>UIView</code> 到当前的 <code>View</code> 中，添加的子类 <code>View</code> 中 <code>property</code> (属性) <code>nextResponder</code> 可以指向父类 <code>View</code> 的 <code>property</code> (属性) <code>superView</code></p>
<p>每一个  <code>ViewController</code> 中有 <code>property</code>(属性) <code>view</code> -&gt; 既<code>self.view</code> 来进行添加子类 <code>View</code>，同样：<code>view</code> 的 <code>property</code> (属性) 通过   <code>property</code> (属性) <code>nextResponder</code> 来指向   <code>ViewController</code> </p>
<p>下图是 <code>View</code> 初始化布局：</p>
<p><img src="http://upload-images.jianshu.io/upload_images/1877765-ff79d6261a13c062.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="iOS-Responder Chain-View-Front.png"><br><img src="http://upload-images.jianshu.io/upload_images/1877765-bbfe167edcd04fed.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="iOS-Responder Chain-View-Hierarchy.png"></p>
<h5 id="点击相应的测试-amp-打印"><a href="#点击相应的测试-amp-打印" class="headerlink" title="点击相应的测试&amp;打印"></a>点击相应的测试&amp;打印</h5><p>在定义的 ViewA1 中重写<code>touch</code>方法：<br><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">- (<span class="keyword">void</span>)touchesBegan:(<span class="built_in">NSSet</span>&lt;<span class="built_in">UITouch</span> *&gt; *)touches withEvent:(<span class="built_in">UIEvent</span> *)event &#123;</span><br><span class="line">    <span class="built_in">UIResponder</span> *next = [<span class="keyword">self</span> nextResponder];</span><br><span class="line">    <span class="built_in">NSMutableString</span> *prefix  = <span class="string">@""</span>.mutableCopy;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">while</span> (<span class="literal">nil</span> != next) &#123;</span><br><span class="line">        <span class="built_in">NSLog</span>(<span class="string">@"%@%@"</span>, prefix, [next class]);</span><br><span class="line">        [prefix appendString:<span class="string">@"--"</span>];</span><br><span class="line">        next = [next nextResponder];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>点击 <code>ViewA1</code> 得到的打印结果：<br><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">2017</span><span class="number">-05</span><span class="number">-08</span> <span class="number">23</span>:<span class="number">55</span>:<span class="number">12.278</span> DesignPattern-Create[<span class="number">19441</span>:<span class="number">727956</span>] ViewA0</span><br><span class="line"><span class="number">2017</span><span class="number">-05</span><span class="number">-08</span> <span class="number">23</span>:<span class="number">55</span>:<span class="number">12.278</span> DesignPattern-Create[<span class="number">19441</span>:<span class="number">727956</span>] --ViewA</span><br><span class="line"><span class="number">2017</span><span class="number">-05</span><span class="number">-08</span> <span class="number">23</span>:<span class="number">55</span>:<span class="number">12.278</span> DesignPattern-Create[<span class="number">19441</span>:<span class="number">727956</span>] ----<span class="built_in">UIView</span></span><br><span class="line"><span class="number">2017</span><span class="number">-05</span><span class="number">-08</span> <span class="number">23</span>:<span class="number">55</span>:<span class="number">12.279</span> DesignPattern-Create[<span class="number">19441</span>:<span class="number">727956</span>] ------ViewController</span><br><span class="line"><span class="number">2017</span><span class="number">-05</span><span class="number">-08</span> <span class="number">23</span>:<span class="number">55</span>:<span class="number">12.279</span> DesignPattern-Create[<span class="number">19441</span>:<span class="number">727956</span>] --------<span class="built_in">UIWindow</span></span><br><span class="line"><span class="number">2017</span><span class="number">-05</span><span class="number">-08</span> <span class="number">23</span>:<span class="number">55</span>:<span class="number">12.279</span> DesignPattern-Create[<span class="number">19441</span>:<span class="number">727956</span>] ----------<span class="built_in">UIApplication</span></span><br><span class="line"><span class="number">2017</span><span class="number">-05</span><span class="number">-08</span> <span class="number">23</span>:<span class="number">55</span>:<span class="number">12.280</span> DesignPattern-Create[<span class="number">19441</span>:<span class="number">727956</span>] ------------AppDelegate</span><br></pre></td></tr></table></figure></p>
<blockquote>
<p>基于上面：小编从上面代码打印的结果可以验证，子 View 的 property(属性) <code>nextResponder</code> 指向父 View，父类的 View 的property(属性) <code>nextResponder</code> 最后指向 ViewController </p>
</blockquote>
<h2 id="如何找打第一响应者"><a href="#如何找打第一响应者" class="headerlink" title="如何找打第一响应者"></a>如何找打第一响应者</h2><ul>
<li>探测器 <code>Hit - Test</code></li>
<li>寻找第一相应的探测猜想</li>
</ul>
<h5 id="探测器-Hit-Test"><a href="#探测器-Hit-Test" class="headerlink" title="探测器 Hit - Test"></a>探测器 <code>Hit - Test</code></h5><p>在响应链查找过程中，有两个函数起到很重要的作用<br><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">- (<span class="built_in">UIView</span> *)hitTest:(<span class="built_in">CGPoint</span>)point withEvent:(<span class="built_in">UIEvent</span> *)event;</span><br><span class="line">- (<span class="built_in">BOOL</span>)pointInside:(<span class="built_in">CGPoint</span>)point withEvent:(<span class="built_in">UIEvent</span> *)event;</span><br></pre></td></tr></table></figure></p>
<p>在响应链创建的情况下，我们在把寻找响应者的过程称为：<code>Hit - Testing View</code> 在寻找相应 View 的过程称为：<code>Hit - Test</code><br>我们把 <code>Hit - Test</code> 可以比作一个探测器，通过这个探测器来检测手指点击在哪个 <code>UIView</code> 上面 </p>
<p>通过上面的继承关系和点击后打印出的结果可以看到，当我们点击界面 <code>UIApplication</code> 就会调用 <code>hitTest: withEvent</code> 查看点击是否在 <code>UIWindow</code> 中如果不在就返回 <code>nil</code> , 如果在 <code>UIWindow</code> 也会调用 <code>hitTest: withEvent</code> 对<code>UIWindow</code> 中 <code>subViews</code> 进行探测</p>
<blockquote>
<p><code>hitTest: withEvent</code> 在探测过程中采用我们比较常见 递归的方式来查找点击 <code>UIView</code>， 通过我们在初始化过程中最后被初始化的放在最上面</p>
</blockquote>
<p>在点击 <code>ViewA1</code> 来进行验证下一个 <code>nextResponder</code> 过程中在每一个 <code>View</code>重写 <code>hitTest</code> 如下：<br><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">- (<span class="built_in">UIView</span> *)hitTest:(<span class="built_in">CGPoint</span>)point withEvent:(<span class="built_in">UIEvent</span> *)event &#123;</span><br><span class="line">    <span class="keyword">if</span> (!<span class="keyword">self</span>.isUserInteractionEnabled || <span class="keyword">self</span>.hidden || <span class="keyword">self</span>.alpha &lt;= <span class="number">0.01</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">nil</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">NSLog</span>(<span class="string">@"ResponderChain : %@"</span>, [<span class="keyword">self</span> class]);</span><br><span class="line">    <span class="keyword">if</span> ([<span class="keyword">self</span> pointInside:point withEvent:event]) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="built_in">UIView</span> *subView <span class="keyword">in</span> [<span class="keyword">self</span>.subviews reverseObjectEnumerator]) &#123;</span><br><span class="line">            <span class="built_in">CGPoint</span> converPoin = [subView convertPoint:point fromView:<span class="keyword">self</span>];</span><br><span class="line">            <span class="built_in">UIView</span> *hitTestView = [subView hitTest:converPoin withEvent:event];</span><br><span class="line">            <span class="keyword">if</span> (hitTestView) &#123;</span><br><span class="line">                <span class="built_in">NSLog</span>(<span class="string">@"ViewA : hitTestView -&gt; %@"</span>, [hitTestView class]);</span><br><span class="line">                <span class="keyword">return</span> hitTestView;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">self</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">nil</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>点击 <code>ViewA1</code> 得到打印的结果如下：<br><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">2017</span><span class="number">-05</span><span class="number">-09</span> <span class="number">07</span>:<span class="number">42</span>:<span class="number">05.968</span> DesignPattern-Create[<span class="number">1197</span>:<span class="number">22554</span>] ResponderChain : ViewB</span><br><span class="line"><span class="number">2017</span><span class="number">-05</span><span class="number">-09</span> <span class="number">07</span>:<span class="number">42</span>:<span class="number">05.969</span> DesignPattern-Create[<span class="number">1197</span>:<span class="number">22554</span>] ResponderChain : ViewA</span><br><span class="line"><span class="number">2017</span><span class="number">-05</span><span class="number">-09</span> <span class="number">07</span>:<span class="number">42</span>:<span class="number">05.969</span> DesignPattern-Create[<span class="number">1197</span>:<span class="number">22554</span>] ResponderChain : ViewA0</span><br><span class="line"><span class="number">2017</span><span class="number">-05</span><span class="number">-09</span> <span class="number">07</span>:<span class="number">42</span>:<span class="number">05.969</span> DesignPattern-Create[<span class="number">1197</span>:<span class="number">22554</span>] ResponderChain : ViewA1</span><br></pre></td></tr></table></figure></p>
<h5 id="寻找第一相应的探测猜想"><a href="#寻找第一相应的探测猜想" class="headerlink" title="寻找第一相应的探测猜想"></a>寻找第一相应的探测猜想</h5><p>根据打印的结果，我们可以验证点击具体查找的流程如下图所示：（实例是点击 viewA1）<br>UIApplication —&gt; UIWindow  —&gt; viewB —&gt; viewA —&gt; viewA0 —&gt; viewA1</p>
<p><img src="http://upload-images.jianshu.io/upload_images/1877765-4b1f59d1c65500ba.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="iOS-Responder Chain-Hit-Testing-View.png"></p>
<h2 id="利用响应者在应用中的体现"><a href="#利用响应者在应用中的体现" class="headerlink" title="利用响应者在应用中的体现"></a>利用响应者在应用中的体现</h2><ul>
<li>改变控件的相应范围</li>
</ul>
<h5 id="改变控件的相应范围"><a href="#改变控件的相应范围" class="headerlink" title="改变控件的相应范围"></a>改变控件的相应范围</h5><p>我们可以利用 <code>hitTest</code> 根据 <code>point</code> 方式来重新设置 <code>ponit</code> 的点击相应的范围大小<br>在 ViewB1 中实现点击相应范围在布局显示基础上下左右拓展 10 px，实现代码如下：</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">- (<span class="built_in">UIView</span> *)hitTest:(<span class="built_in">CGPoint</span>)point withEvent:(<span class="built_in">UIEvent</span> *)event &#123;</span><br><span class="line">    <span class="keyword">if</span> (!<span class="keyword">self</span>.isUserInteractionEnabled || <span class="keyword">self</span>.isHidden || <span class="keyword">self</span>.alpha &lt;= <span class="number">0.01</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">nil</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">NSLog</span>(<span class="string">@"ResponderChain : %@"</span>, [<span class="keyword">self</span> class]);</span><br><span class="line">    <span class="built_in">CGRect</span> touchRect = <span class="built_in">CGRectInset</span>(<span class="keyword">self</span>.bounds, <span class="number">-10</span>, <span class="number">-10</span>);</span><br><span class="line">    <span class="keyword">if</span> (<span class="built_in">CGRectContainsPoint</span>(touchRect, point)) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="built_in">UIView</span> *subView <span class="keyword">in</span> [<span class="keyword">self</span>.subviews reverseObjectEnumerator]) &#123;</span><br><span class="line">            <span class="built_in">CGPoint</span> converPoint = [subView convertPoint:point fromView:<span class="keyword">self</span>];</span><br><span class="line">            <span class="built_in">UIView</span> *hitTestView = [subView hitTest:converPoint withEvent:event];</span><br><span class="line">            <span class="keyword">if</span> (hitTestView) &#123;</span><br><span class="line">                <span class="built_in">NSLog</span>(<span class="string">@"ViewB1 : hitTestView -&gt; %@"</span>, [hitTestView class]);</span><br><span class="line">                <span class="keyword">return</span> hitTestView;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">self</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">nil</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><code>ViewB1</code> 界面中实际范围，和点击相应的 <code>viewB1</code> 外的虚框的范围也会做出相应的相应。如下图：</p>
<p><img src="http://upload-images.jianshu.io/upload_images/1877765-f4e683de8d0ab2cb.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="iOS-Responder Chain-Apply.png"></p>
<p>打印的结果：<br><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">2017</span><span class="number">-05</span><span class="number">-09</span> <span class="number">10</span>:<span class="number">34</span>:<span class="number">00.437</span> DesignPattern-Create[<span class="number">1197</span>:<span class="number">22554</span>] ResponderChain : ViewB</span><br><span class="line"><span class="number">2017</span><span class="number">-05</span><span class="number">-09</span> <span class="number">10</span>:<span class="number">34</span>:<span class="number">00.437</span> DesignPattern-Create[<span class="number">1197</span>:<span class="number">22554</span>] ResponderChain : ViewB1</span><br><span class="line"><span class="number">2017</span><span class="number">-05</span><span class="number">-09</span> <span class="number">10</span>:<span class="number">34</span>:<span class="number">00.437</span> DesignPattern-Create[<span class="number">1197</span>:<span class="number">22554</span>] ViewB : hitTestView -&gt; ViewB1</span><br></pre></td></tr></table></figure></p>
<p>相关的测试的<a href="https://github.com/boilWater/DesignPattern-Create.git" target="_blank" rel="external">Dome</a>下载地址</p>
<p>时间：2017/5/8 23:58:44 (后面会继承写作)<br>修改时间： 2017/5/9 22:30:45</p>
</div><script type="text/javascript" src="/js/share.js?v=0.0.0" async></script><a data-url="http://yoursite.com/2017/05/15/iOS-Responder Chain/" data-id="cj3d60lpd001aoxfyl4luny1d" class="article-share-link">分享到</a><div class="tags"><a href="/tags/iOS/">iOS</a></div><div class="post-nav"><a href="/2017/05/31/NSError(错误信息)/" class="pre">iOS-开发过程中的错误处理</a><a href="/2017/01/16/16总结-17展望/" class="next">2016年末~2017年初</a></div><div id="disqus_thread"><script>var disqus_shortname = 'JackJin## Your disqus_shortname, e.g. username';
var disqus_identifier = '2017/05/15/iOS-Responder Chain/';
var disqus_title = 'iOS-Responder Chain (响应链)';
var disqus_url = 'http://yoursite.com/2017/05/15/iOS-Responder Chain/';
(function() {
  var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
  dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
  (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
})();</script><script id="dsq-count-scr" src="//JackJin## Your disqus_shortname, e.g. username.disqus.com/count.js" async></script></div></div></div></div><div class="pure-u-1-4"><div id="sidebar"><div class="widget"><form action="//www.baidu.com/baidu" method="get" accept-charset="utf-8" target="_blank" class="search-form"><input type="search" name="word" maxlength="20" placeholder="Search"/><input type="hidden" name="si" value="http://yoursite.com"/><input name="tn" type="hidden" value="bds"/><input name="cl" type="hidden" value="3"/><input name="ct" type="hidden" value="2097152"/><input name="s" type="hidden" value="on"/></form></div><div class="widget"><div class="widget-title"><i class="fa fa-folder-o"> 分类</i></div><ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/IOS/">IOS</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/iOS/">iOS</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/第三方框架/">第三方框架</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/视图-图层-动画/">视图&图层&动画</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/随笔/">随笔</a></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-star-o"> 标签</i></div><div class="tagcloud"><a href="/tags/随笔/" style="font-size: 15px;">随笔</a> <a href="/tags/IOS/" style="font-size: 15px;">IOS</a> <a href="/tags/IOS基础知识/" style="font-size: 15px;">IOS基础知识</a> <a href="/tags/iOS/" style="font-size: 15px;">iOS</a> <a href="/tags/三方框架解析/" style="font-size: 15px;">三方框架解析</a> <a href="/tags/图片视频/" style="font-size: 15px;">图片视频</a> <a href="/tags/视频心得/" style="font-size: 15px;">视频心得</a> <a href="/tags/博客之初/" style="font-size: 15px;">博客之初</a></div></div><div class="widget"><div class="widget-title"><i class="fa fa-file-o"> 最新文章</i></div><ul class="post-list"><li class="post-list-item"><a class="post-list-link" href="/2017/05/31/NSError(错误信息)/">iOS-开发过程中的错误处理</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/05/15/iOS-Responder Chain/">iOS-Responder Chain (响应链)</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/01/16/16总结-17展望/">2016年末~2017年初</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/01/13/APP控件在屏幕上显示/">APP控件在屏幕上显示</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/09/09/IOS响应者链/">IOS整体框架</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/07/16/两周感悟~广州/">广州~两周感悟</a></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-comment-o"> 最新评论</i></div><script type="text/javascript" src="//JackJin## Your disqus_shortname, e.g. username.disqus.com/recent_comments_widget.js?num_items=5&amp;hide_avatars=1&amp;avatar_size=32&amp;excerpt_length=20&amp;hide_mods=1"></script></div><div class="widget"><div class="widget-title"><i class="fa fa-external-link"> 链接</i></div><ul></ul><a href="https://github.com/boilWater" title="Github" target="_blank">Github</a><ul></ul><a href="http://weibo.com/u/2815612403?is_all=1" title="微博" target="_blank">微博</a><ul></ul><a href="http://www.jianshu.com/users/c48ed5ae3925/latest_articles" title="简书" target="_blank">简书</a></div></div></div><div class="pure-u-1 pure-u-md-3-4"><div id="footer">© <a href="/." rel="nofollow">JackJin's 博客.</a> Powered by<a rel="nofollow" target="_blank" href="https://hexo.io"> Hexo.</a><a rel="nofollow" target="_blank" href="https://github.com/tufu9441/maupassant-hexo"> Theme</a> by<a rel="nofollow" target="_blank" href="https://github.com/pagecho"> Cho.</a></div></div></div><a id="rocket" href="#top" class="show"></a><script type="text/javascript" src="/js/totop.js?v=0.0.0" async></script><script type="text/javascript" src="//cdn.bootcss.com/fancybox/2.1.5/jquery.fancybox.pack.js" async></script><script type="text/javascript" src="/js/fancybox.js?v=0.0.0" async></script><link rel="stylesheet" type="text/css" href="/css/jquery.fancybox.css?v=0.0.0"><script type="text/javascript" src="/js/codeblock-resizer.js?v=0.0.0"></script><script type="text/javascript" src="/js/smartresize.js?v=0.0.0"></script></div></body></html>