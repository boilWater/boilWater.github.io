<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <meta name="renderer" content="webkit">
  <meta http-equiv="X-UA-Compatible" content="IE=edge" >
  <link rel="dns-prefetch" href="http://yoursite.com">
  <title>JackJin&#39;s åšå®¢</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description">
<meta property="og:type" content="website">
<meta property="og:title" content="JackJin's åšå®¢">
<meta property="og:url" content="http://yoursite.com/index.html">
<meta property="og:site_name" content="JackJin's åšå®¢">
<meta property="og:description">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="JackJin's åšå®¢">
<meta name="twitter:description">
  
    <link rel="alternative" href="/atom.xml" title="JackJin&#39;s åšå®¢" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  <link rel="stylesheet" type="text/css" href="/./main.b3331d.css">
  <style type="text/css">
  
    #container.show {
      background: linear-gradient(200deg,#a0cfe4,#e8c37e);
    }
  </style>
  

  

</head>

<body>
  <div id="container" q-class="show:isCtnShow">
    <canvas id="anm-canvas" class="anm-canvas"></canvas>
    <div class="left-col" q-class="show:isShow">
      
<div class="overlay" style="background: #4d4d4d"></div>
<div class="intrude-less">
	<header id="header" class="inner">
		<a href="/" class="profilepic">
			<img src="null" class="js-avatar">
		</a>
		<hgroup>
		  <h1 class="header-author"><a href="/">JackJin</a></h1>
		</hgroup>
		
		<p class="header-subtitle">ä¸€ä½è„šè¸å®åœ°ï¼Œæ‹¥æœ‰æ¢¦æƒ³çš„90åï¼Œæƒ³è¦ä¸€ç›´åŠªåŠ›è¿½ä¸Šä½ ï¼</p>
		

		<nav class="header-menu">
			<ul>
			
				<li><a href="/">ä¸»é¡µ</a></li>
	        
				<li><a href="/tags/éšç¬”/">éšç¬”</a></li>
	        
			</ul>
		</nav>
		<nav class="header-smart-menu">
    		
    			
    			<a q-on="click: openSlider(e, 'innerArchive')" href="javascript:void(0)">æ‰€æœ‰æ–‡ç« </a>
    			
            
    			
    			<a q-on="click: openSlider(e, 'friends')" href="javascript:void(0)">å‹é“¾</a>
    			
            
    			
    			<a q-on="click: openSlider(e, 'aboutme')" href="javascript:void(0)">å…³äºæˆ‘</a>
    			
            
		</nav>
		<nav class="header-nav">
			<div class="social">
				
					<a class="github" target="_blank" href="#" title="github"><i class="icon-github"></i></a>
		        
					<a class="weibo" target="_blank" href="#" title="weibo"><i class="icon-weibo"></i></a>
		        
					<a class="rss" target="_blank" href="#" title="rss"><i class="icon-rss"></i></a>
		        
					<a class="zhihu" target="_blank" href="#" title="zhihu"><i class="icon-zhihu"></i></a>
		        
			</div>
		</nav>
	</header>		
</div>

    </div>
    <div class="mid-col" q-class="show:isShow,hide:isShow|isFalse">
      
<nav id="mobile-nav">
  	<div class="overlay js-overlay" style="background: #4d4d4d"></div>
	<div class="btnctn js-mobile-btnctn">
  		<div class="slider-trigger list" q-on="click: openSlider(e)"><i class="icon icon-sort"></i></div>
	</div>
	<div class="intrude-less">
		<header id="header" class="inner">
			<div class="profilepic">
				<img src="null" class="js-avatar">
			</div>
			<hgroup>
			  <h1 class="header-author js-header-author">JackJin</h1>
			</hgroup>
			
			<p class="header-subtitle"><i class="icon icon-quo-left"></i>ä¸€ä½è„šè¸å®åœ°ï¼Œæ‹¥æœ‰æ¢¦æƒ³çš„90åï¼Œæƒ³è¦ä¸€ç›´åŠªåŠ›è¿½ä¸Šä½ ï¼<i class="icon icon-quo-right"></i></p>
			
			
			
				
			
				
			
			
			
			<nav class="header-nav">
				<div class="social">
					
						<a class="github" target="_blank" href="#" title="github"><i class="icon-github"></i></a>
			        
						<a class="weibo" target="_blank" href="#" title="weibo"><i class="icon-weibo"></i></a>
			        
						<a class="rss" target="_blank" href="#" title="rss"><i class="icon-rss"></i></a>
			        
						<a class="zhihu" target="_blank" href="#" title="zhihu"><i class="icon-zhihu"></i></a>
			        
				</div>
			</nav>

			<nav class="header-menu js-header-menu">
				<ul style="width: 50%">
				
				
					<li style="width: 50%"><a href="/">ä¸»é¡µ</a></li>
		        
					<li style="width: 50%"><a href="/tags/éšç¬”/">éšç¬”</a></li>
		        
				</ul>
			</nav>
		</header>				
	</div>
	<div class="mobile-mask" style="display:none" q-show="isShow"></div>
</nav>

      <div id="wrapper" class="body-wrap">
        <div class="menu-l">
          <div class="canvas-wrap">
            <canvas data-colors="#eaeaea" data-sectionHeight="100" data-contentId="js-content" id="myCanvas1" class="anm-canvas"></canvas>
          </div>
          <div id="js-content" class="content-ll">
            
  
    <article id="post-NSError(é”™è¯¯ä¿¡æ¯)" class="article article-type-post  article-index" itemscope itemprop="blogPost">
  <div class="article-inner">
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/05/31/NSError(é”™è¯¯ä¿¡æ¯)/">iOS-å¼€å‘è¿‡ç¨‹ä¸­çš„é”™è¯¯å¤„ç†</a>
    </h1>
  

        
        <a href="/2017/05/31/NSError(é”™è¯¯ä¿¡æ¯)/" class="archive-article-date">
  	<time datetime="2017-05-31T06:35:13.000Z" itemprop="datePublished"><i class="icon-calendar icon"></i>2017-05-31</time>
</a>
        
      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>å¼€å‘è¿‡è¿‡ç¨‹ä¸­æˆ‘ä»¬ç»å¸¸ä¼šé‡åˆ°å¼‚å¸¸é—®é¢˜</p>
<p><img src="http://upload-images.jianshu.io/upload_images/1877765-ebec37c09e21ba91.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="iOSå¼‚å¸¸.png"></p>
<h1 id="iOS-å¼€å‘è¿‡ç¨‹ä¸­çš„é”™è¯¯å¤„ç†"><a href="#iOS-å¼€å‘è¿‡ç¨‹ä¸­çš„é”™è¯¯å¤„ç†" class="headerlink" title="iOS-å¼€å‘è¿‡ç¨‹ä¸­çš„é”™è¯¯å¤„ç†"></a>iOS-å¼€å‘è¿‡ç¨‹ä¸­çš„é”™è¯¯å¤„ç†</h1><p>æˆ‘ä»¬åœ¨ç¨‹åºå¼€å‘è¿‡ç¨‹ä¸­ç»å¸¸ä¼šé‡åˆ°å¼‚å¸¸ï¼Œå¯¹å¼‚å¸¸çš„å¤„ç†ä¸€èˆ¬é‡‡ç”¨æ‰“å°æˆ–è€…ç›´æ¥æŠ›å‡ºã€‚è¿™æ ·ä¹Ÿå¯ä»¥å¾ˆæ–¹ä¾¿æˆ‘ä»¬è°ƒè¯•è¿‡ç¨‹æœ‰æ‰€å‚è€ƒï¼Œè€Œä¸”æ–¹ä¾¿æˆ‘ä»¬æŸ¥çœ‹å¼‚å¸¸äº§ç”Ÿçš„ä½ç½®ä¿¡æ¯</p>
<h3 id="NSError-é”™è¯¯ä¿¡æ¯"><a href="#NSError-é”™è¯¯ä¿¡æ¯" class="headerlink" title="NSError(é”™è¯¯ä¿¡æ¯)"></a>NSError(é”™è¯¯ä¿¡æ¯)</h3><h4 id="é‡‡ç”¨NSErrorçš„æƒ…å†µ"><a href="#é‡‡ç”¨NSErrorçš„æƒ…å†µ" class="headerlink" title="é‡‡ç”¨NSErrorçš„æƒ…å†µ"></a>é‡‡ç”¨NSErrorçš„æƒ…å†µ</h4><p>  ä½¿ç”¨ <code>NSError</code> çš„å½¢å¼å¯ä»¥æŠŠç¨‹åºä¸­å¯¼è‡´é”™è¯¯åŸå› å›æŠ¥ç»™è°ƒç”¨è€…ï¼Œè€Œä¸”ä½¿ç¨‹åºæ­£å¸¸è¿è¡Œä¸ä¼šé€ æˆå¥”æºƒçš„åæœ</p>
<h4 id="NSErroråŒ…å«çš„å†…å®¹"><a href="#NSErroråŒ…å«çš„å†…å®¹" class="headerlink" title="NSErroråŒ…å«çš„å†…å®¹"></a>NSErroråŒ…å«çš„å†…å®¹</h4><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">@interface</span> <span class="title">NSError</span> : <span class="title">NSObject</span> &lt;<span class="title">NSCopying</span>, <span class="title">NSSecureCoding</span>&gt; </span>&#123;</span><br><span class="line">    <span class="keyword">@private</span></span><br><span class="line">    <span class="keyword">void</span> *_reserved;</span><br><span class="line">    <span class="built_in">NSInteger</span> _code;</span><br><span class="line">    <span class="built_in">NSString</span> *_domain;</span><br><span class="line">    <span class="built_in">NSDictionary</span> *_userInfo;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li><code>NSError _code</code>ï¼ˆé”™è¯¯ç ï¼Œ ç±»å‹ <code>NSInteger</code>)  ï¼š ç‹¬æœ‰çš„é”™è¯¯ä»£ç ï¼ŒæŒ‡æ˜åœ¨æŸä¸ªèŒƒå›´å†…å…·ä½“å‘ç”Ÿçš„é”™è¯¯ã€‚å¯èƒ½æ˜¯ä¸€ç³»åˆ—çš„é”™è¯¯çš„é›†åˆï¼Œæ‰€ä»¥å¯ä»¥ä½¿ç”¨ Enum æ¥å®šä¹‰ã€‚</li>
<li><code>NSError *_domain</code> (é”™è¯¯èŒƒå›´ï¼Œç±»å‹ <code>NSString</code>) ï¼šé”™è¯¯å‘ç”ŸèŒƒå›´ï¼Œé€šå¸¸ä½¿ç”¨ä¸€ä¸ªç‰¹æœ‰çš„å…¨å±€å˜é‡æ¥å®šä¹‰ã€‚</li>
<li><code>NSError *_userInfo</code> (ç”¨æˆ·ä¿¡æ¯ï¼Œç±»å‹ <code>NSDictionary</code>) ï¼šæœ‰å…³é”™è¯¯çš„é¢å¤–ä¿¡æ¯ï¼Œå…¶ä¸­åŒ…å«ä¸€æ®µâ€œæœ¬åœ°åŒ–çš„æè¿°â€ï¼Œè¿˜å¯èƒ½åŒ…å«å¯¼è‡´æ­¤é”™è¯¯å‘ç”Ÿçš„å¦ä¸€ä¸ªé”™è¯¯ã€‚userInfo å¯ä»¥æè¿°ä¸ºä¸€æ¡é”™è¯¯çš„é“¾æ¡</li>
</ul>
<h4 id="NSErrorä½¿ç”¨çš„ä¸¤ç§æƒ…å†µ"><a href="#NSErrorä½¿ç”¨çš„ä¸¤ç§æƒ…å†µ" class="headerlink" title="NSErrorä½¿ç”¨çš„ä¸¤ç§æƒ…å†µ"></a>NSErrorä½¿ç”¨çš„ä¸¤ç§æƒ…å†µ</h4><p>   åœ¨æ–¹æ³•å®ç°æˆ–è€…æ˜¯ API è®¾è®¡æ—¶ï¼Œæˆ‘ä»¬å¯¹ <code>NSError</code> çš„ä½¿ç”¨æƒ…å½¢æœ‰ä¸¤ç§ï¼šåœ¨åè®®ä¸­ä¼ é€’å’Œâ€œè¾“å‡ºå‚æ•°â€è¿”å›ç»™è°ƒç”¨è€…</p>
<ol>
<li>é€šè¿‡å§”æ‰˜åè®®æ¥ä¼ é€’é”™è¯¯</li>
</ol>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">- (<span class="keyword">void</span>)connection:(<span class="built_in">NSURLConnection</span> *)connection withError:(<span class="built_in">NSError</span> *)error;</span><br></pre></td></tr></table></figure>
<p>é€šè¿‡ä»£ç†åè®®çš„æ–¹å¼å¯ä»¥æŠŠé”™è¯¯æŠ¥å‘Šä¿¡æ¯ä¼ é€’</p>
<p>  2.â€œè¾“å‡ºå‚æ•°â€è¿”å›ç»™è°ƒç”¨è€…</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">- (<span class="built_in">BOOL</span>)doSomething:(<span class="built_in">NSError</span> **)error;</span><br></pre></td></tr></table></figure>
<p>é”™è¯¯çš„ä¿¡æ¯ä½œä¸ºä¸€ä¸ªæŒ‡å‘æŒ‡é’ˆçš„æŒ‡é’ˆï¼ˆä¹Ÿå°±æ˜¯è¯´ä¸€ä¸ªæŒ‡é’ˆæŒ‡å‘é”™è¯¯çš„å¯¹è±¡ï¼‰</p>
<h3 id="throw-NSException-å¼‚å¸¸æŠ›å‡º"><a href="#throw-NSException-å¼‚å¸¸æŠ›å‡º" class="headerlink" title="@throw NSException (å¼‚å¸¸æŠ›å‡º)"></a>@throw NSException (å¼‚å¸¸æŠ›å‡º)</h3><h4 id="é‡‡ç”¨-throw-æƒ…å†µ"><a href="#é‡‡ç”¨-throw-æƒ…å†µ" class="headerlink" title="é‡‡ç”¨ @throw æƒ…å†µ"></a>é‡‡ç”¨ @throw æƒ…å†µ</h4><p>åœ¨ APP è¿è¡ŒæœŸé—´é‡åˆ°é—®é¢˜ï¼Œéœ€è¦å¯¹é—®é¢˜è¿›è¡Œæ“ä½œç»ˆæ­¢ç¨‹åºæŠ›å‡ºå¼‚å¸¸ï¼Œå¯ä»¥ä½¿ç”¨ <code>@throw</code> æ¥è¿›è¡Œ</p>
<h4 id="é‡‡ç”¨-throw-å¯èƒ½äº§ç”Ÿé—®é¢˜"><a href="#é‡‡ç”¨-throw-å¯èƒ½äº§ç”Ÿé—®é¢˜" class="headerlink" title="é‡‡ç”¨ @throw å¯èƒ½äº§ç”Ÿé—®é¢˜"></a>é‡‡ç”¨ @throw å¯èƒ½äº§ç”Ÿé—®é¢˜</h4><p>åœ¨å¼‚å¸¸æŠ›å‡ºå®ä¾‹ä¸­ï¼Œå¦‚æœæŠ›å‡ºå¼‚å¸¸ã€‚åœ¨å®ç°æŠ›å‡ºå¼‚å¸¸çš„ä»£ç åé¢çš„æ‰§è¡Œé‡Šæ”¾èµ„æºå°±ä¸ä¼šæ‰§è¡Œï¼Œè¿™æ ·æœ«å°¾çš„å¯¹è±¡å°±ä¸ä¼šè¢«é‡Šæ”¾ã€‚å¦‚æœæƒ³è¦ç”Ÿæˆâ€œå¼‚å¸¸å®‰å…¨â€çš„ä»£ç ï¼Œå¯ä»¥è®¾ç½®ç¼–è¯‘å™¨çš„æ ‡å¿— <code>-fobjc-arc-exceptions</code> æ¥è¿›è¡Œå®ç°ã€‚ä¸è¿‡å°†è¦ä¸€å¦‚åŠ ä¸€äº›é¢å¤–çš„ä»£ç ï¼Œåœ¨ä¸æŠ›å‡ºå¼‚å¸¸æ—¶ä¹Ÿä¼šæ‰§è¡Œä»£ç ã€‚<br>åœ¨ä¸ä½¿ç”¨ ARC æ—¶ä¹Ÿå¾ˆéš¾å®ç°å¼‚å¸¸æŠ›å‡ºæƒ…å†µä¸‹å¯¹å†…å­˜è¿›è¡Œé‡Šæ”¾ã€‚</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">NSError</span> * error = <span class="literal">nil</span>;</span><br><span class="line"><span class="built_in">BOOL</span> success = [<span class="keyword">self</span> doSomething:&amp;error];</span><br><span class="line"><span class="keyword">if</span>(error &amp;&amp; success) &#123;</span><br><span class="line">     <span class="keyword">@throw</span>[<span class="built_in">NSException</span> â€¦];</span><br><span class="line">&#125;</span><br><span class="line">[success release];</span><br></pre></td></tr></table></figure>
<p>æŒ‰ç…§ä¸Šé¢ğŸ‘†å®ç°å½“åœ¨å¼‚å¸¸æŠ›å‡ºçš„è¿‡ç¨‹æ—¶ï¼Œsuccess è¿˜æ¥ä¸åŠé‡Šæ”¾ã€‚æ‰€ä»¥è¦è§£å†³ä¸Šé¢çš„é—®é¢˜å¯ä»¥åœ¨å¼‚å¸¸æŠ›å‡ºä¹‹å‰å¯¹ success è¿›è¡Œé‡Šæ”¾ï¼Œä½†æ˜¯å½“éœ€è¦é‡Šæ”¾çš„èµ„æºæœ‰å¾ˆå¤šçš„æƒ…å†µä¸‹ï¼Œè¿™æ ·æ“ä½œèµ·æ¥å°±æ¯”è¾ƒå¤æ‚ã€‚</p>
<p>åœ¨å¼€å‘è¿‡ç¨‹ä¸­å¼‚å¸¸æŠ›å‡ºå¯ä»¥ä½¿ç”¨åœ¨ æŠ½è±¡çš„åŸºç±» å®ä¾‹æ–¹æ³•ä¸­è¿›è¡Œè°ƒç”¨ã€‚å¦‚æœåŸºç±»ä¸­çš„æ–¹æ³•ä¸è¢« <code>override</code> å°±è®¾ç½®æŠ›å‡ºå¼‚å¸¸ï¼Œè¿™æ ·å¯ä»¥ä¿è¯å®ä¾‹æ–¹æ³•è¢«é‡å†™ã€‚</p>
<h3 id="try-catch-finally-å¼‚å¸¸æ•æ‰"><a href="#try-catch-finally-å¼‚å¸¸æ•æ‰" class="headerlink" title="@try @catch @finally (å¼‚å¸¸æ•æ‰)"></a>@try @catch @finally (å¼‚å¸¸æ•æ‰)</h3><h4 id="é‡‡ç”¨-try-catch-finally-æƒ…å†µ"><a href="#é‡‡ç”¨-try-catch-finally-æƒ…å†µ" class="headerlink" title="é‡‡ç”¨ @try @catch @finally æƒ…å†µ"></a>é‡‡ç”¨ @try @catch @finally æƒ…å†µ</h4><p>ä¸ªäººæ„Ÿè§‰ @try @catch @finally æ˜¯ @throw NSException çš„åŠ å¼ºç‰ˆã€‚å‰è€…å¯ä»¥å®ç°å¯¹å¼‚å¸¸çš„æ•æ‰ï¼Œç›¸å…³å¼‚å¸¸çš„è¾“å‡ºï¼Œå’Œå¼‚å¸¸è¾“å‡ºåæ‰§è¡Œçš„ @finally ç›¸å…³çš„å…·ä½“æ“ä½œã€‚åè€…æ˜¯å¯¹å…·ä½“æ•´ç† NSExpection æŠ›å‡ºï¼Œå¹¶æ²¡æœ‰å‰è€…æ¯”è¾ƒå®Œå–„çš„æµç¨‹åŒ–æ“ä½œæ­¥éª¤ã€‚</p>
<p>å¦‚æœåœ¨åŸºç±»ä¸­å®ç° @throw è¿›è¡Œè®¾ç½® å¿…é¡» override åŸºç±»ä¸­çš„å®ä¾‹æ–¹æ³•ï¼Œé‚£ä¹ˆæ•è·å¼‚å¸¸çš„æ–¹æ³•ä¸­ä½¿ç”¨ @try @catch @finallyã€‚ä¾‹å¦‚ï¼šNSArrayï¼ŒNSDictionary åˆå§‹å˜é‡ä½¿ç”¨å­—é¢é‡æ¥è·å–å€¼æ—¶ï¼Œéœ€è¦åˆ¤æ–­è¿”å›æ•°æ®æ˜¯å¦ä¸º nil æ¥é˜²æ­¢ APP Crashã€‚ </p>
<h4 id="äº§ç”Ÿé—®é¢˜å’Œè§£å†³æ–¹å¼"><a href="#äº§ç”Ÿé—®é¢˜å’Œè§£å†³æ–¹å¼" class="headerlink" title="äº§ç”Ÿé—®é¢˜å’Œè§£å†³æ–¹å¼"></a>äº§ç”Ÿé—®é¢˜å’Œè§£å†³æ–¹å¼</h4><p>å½“ä½¿ç”¨ <code>@try @catch @finally</code> æ—¶ï¼Œæœ‰ä¸¤ç§æƒ…å†µ <code>MRC</code> å’Œ <code>ARC</code>ã€‚</p>
<p><code>MRC</code>ï¼ˆiOS 5 ä¹‹å‰ï¼‰ çš„ç¯å¢ƒä¸­ï¼Œä¸Šé¢çš„ä»£ç å¯ä»¥å±•ç¤ºä¸ºï¼š</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">SomeClass *someClass = <span class="literal">nil</span>;</span><br><span class="line"><span class="keyword">@try</span> &#123;</span><br><span class="line">       someClass = [[SomeClass alloc] init];</span><br><span class="line">       [someClass doSomeThingsThatMayThrow];</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">@catch</span>() &#123;</span><br><span class="line">     <span class="built_in">NSLog</span>(â€¦ â€¦);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">@finally</span> &#123;</span><br><span class="line">     [someClass release];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>åœ¨ ARC çš„ç¯å¢ƒä¸­ï¼Œä¸Šé¢çš„ä»£ç å±•ç¤ºä¸ºï¼š</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">SomeClass *someClass = <span class="literal">nil</span>;</span><br><span class="line"><span class="keyword">@try</span> &#123;</span><br><span class="line">       someClass = [[SomeClass alloc] init];</span><br><span class="line">       [someClass doSomeThingsThatMayThrow];</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">@catch</span>( â€¦ ) &#123;</span><br><span class="line">     <span class="built_in">NSLog</span>(â€¦ â€¦);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">@finally</span> &#123;</span><br><span class="line">    </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>å¯ä»¥çœ‹å‡ºåœ¨ MRC çš„æƒ…å½¢ä¸‹å¯ä»¥å®ç°å¯¹äºå†…å­˜çš„é‡Šæ”¾ï¼Œåœ¨ ARC çš„æƒ…å½¢ä¸‹ä¼šç³»ç»Ÿä¼šå®ç°å¯¹å†…å­˜çš„é‡Šæ”¾? è¿™æ ·å‘æ­£ç¡®å—ï¼Ÿ</p>
</blockquote>
<p>ç­”æ¡ˆæ˜¯ï¼šARC ä¸ä¼šè‡ªåŠ¨å¤„ç†ï¼Œå› ä¸ºå¦‚æœè¦å®ç°è‡ªåŠ¨å¤„ç†å¯èƒ½è¦åŠ å…¥å¤§é‡çš„ä»£ç ï¼Œæ‰å¯ä»¥æ¸…æ¥šå¯¹è±¡å®ç°æŠ›å‡ºå¼‚å¸¸æ—¶å°†å…¶æ¸…ç†ã€‚ä½†æ˜¯å¦‚æœåŠ å…¥ä»£ç å°±ä¼šå½±å“è¿è¡Œæ—¶çš„æ€§èƒ½ï¼Œåœ¨æ­£å¸¸è¿è¡Œæ—¶ä¹Ÿä¼šå¦‚æ­¤ã€‚<br>å¦‚æœåœ¨å½“å‰å®ç°ä¸­å¼€å¯ <code>-fobjc-arc-exception</code> çš„æ¨¡å¼å¯ä»¥å®ç°åœ¨ <code>@try @catch @finally</code> åœ¨å¼‚å¸¸æƒ…å†µä¸‹å®ç°å¯¹æœªé‡Šæ”¾çš„å¯¹è±¡è¿›è¡Œå†…å­˜çš„é‡Šæ”¾ç®¡ç†</p>
<h4 id="try-catch-finally-çš„-C-æºç "><a href="#try-catch-finally-çš„-C-æºç " class="headerlink" title="@try@catch@finally çš„ C++ æºç "></a>@try@catch@finally çš„ C++ æºç </h4><p>æŸ¥çœ‹å¼‚å¸¸æŠ›å‡ºçš„æºç ï¼š<br>å»ºç«‹é¡¹ç›®åœ¨ <code>main.m</code> æ–‡ä»¶ä¸­å®ç°ä¸‹é¢ä»£ç ï¼š</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> main(<span class="keyword">int</span> argc, <span class="keyword">char</span> * argv[]) &#123;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">@try</span> &#123;</span><br><span class="line">        </span><br><span class="line">    &#125; <span class="keyword">@catch</span> (<span class="built_in">NSException</span> *exception) &#123;</span><br><span class="line">        </span><br><span class="line">    &#125; <span class="keyword">@finally</span> &#123;</span><br><span class="line">        </span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>æ‰“å¼€ç»ˆç«¯åœ¨ <code>main.m</code> ç»ˆç«¯çš„æ–‡ä»¶å¤¹è·¯å¾„æ‰§è¡Œä¸‹é¢çš„è¯­å¥</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">clang -x objective-c -rewrite-objc -isysroot /Applications/Xcode.app/Contents/Developer/Platforms/iPhoneSimulator.platform/Developer/SDKs/iPhoneSimulator.sdk main.m</span><br></pre></td></tr></table></figure>
<p>ä¼šç”Ÿæˆæ–‡ä»¶ <code>main.cpp</code> çš„æ–‡ä»¶ï¼Œå¯ä»¥æ‰“å¼€æŸ¥çœ‹æ–‡ <code>@try @catch @fianlly</code></p>
<h5 id="NSExpection-å±æ€§å†…å®¹"><a href="#NSExpection-å±æ€§å†…å®¹" class="headerlink" title="NSExpection å±æ€§å†…å®¹"></a>NSExpection å±æ€§å†…å®¹</h5><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">__attribute__((__objc_exception__))</span><br><span class="line"></span><br><span class="line"><span class="meta">#ifndef _REWRITER_typedef_NSException</span></span><br><span class="line"><span class="meta">#define _REWRITER_typedef_NSException</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">struct</span> objc_object <span class="built_in">NSException</span>;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">struct</span> &#123;&#125; _objc_exc_NSException;</span><br><span class="line"><span class="meta">#endif</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="built_in">NSException_IMPL</span> &#123;</span><br><span class="line">	<span class="keyword">struct</span> <span class="built_in">NSObject_IMPL</span> <span class="built_in">NSObject_IVARS</span>; <span class="comment">//å®ä¾‹å˜é‡</span></span><br><span class="line">	<span class="built_in">NSString</span> *name;                      <span class="comment">//exception çš„åå­—</span></span><br><span class="line">	<span class="built_in">NSString</span> *reason;                    <span class="comment">//exception äº§ç”Ÿçš„åŸå› </span></span><br><span class="line">	<span class="built_in">NSDictionary</span> *userInfo;              <span class="comment">//exception å±•ç¤ºä½¿ç”¨è¯¦ç»†çš„ä¿¡æ¯</span></span><br><span class="line">	<span class="keyword">id</span> reserved;                         <span class="comment">//</span></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h5 id="NSError-å±æ€§å†…å®¹"><a href="#NSError-å±æ€§å†…å®¹" class="headerlink" title="NSError å±æ€§å†…å®¹"></a>NSError å±æ€§å†…å®¹</h5><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#ifndef _REWRITER_typedef_NSError</span></span><br><span class="line"><span class="meta">#define _REWRITER_typedef_NSError</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">struct</span> objc_object <span class="built_in">NSError</span>;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">struct</span> &#123;&#125; _objc_exc_NSError;</span><br><span class="line"><span class="meta">#endif</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="built_in">NSError_IMPL</span> &#123;</span><br><span class="line">	<span class="keyword">struct</span> <span class="built_in">NSObject_IMPL</span> <span class="built_in">NSObject_IVARS</span>; <span class="comment">//å®ä¾‹å˜é‡</span></span><br><span class="line">	<span class="keyword">void</span> *_reserved;                     <span class="comment">//å®ä¾‹è°ƒç”¨çš„æ–¹æ³•</span></span><br><span class="line">	<span class="built_in">NSInteger</span> _code;                     <span class="comment">//error é”™è¯¯ç </span></span><br><span class="line">	<span class="built_in">NSString</span> *_domain;                   <span class="comment">//error é”™è¯¯å‘ç”ŸèŒƒå›´</span></span><br><span class="line">	<span class="built_in">NSDictionary</span> *_userInfo;             <span class="comment">//error é”™è¯¯æè¿°çš„å…·ä½“ä¿¡æ¯</span></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p>ä¸‹é¢åœ¨ <code>main.m</code> ä¸­ä½¿ç”¨ <code>Clang</code> è§£æ <code>@try @catch @finally</code> åœ¨ C++ ç¯å¢ƒä¸­è§£æ</p>
<ul><br><li>æ²¡æœ‰å‚æ•°<br></li><br><br><li>æœ‰å‚æ•°<br></li><br></ul>

<h5 id="æ²¡æœ‰å‚æ•°"><a href="#æ²¡æœ‰å‚æ•°" class="headerlink" title="æ²¡æœ‰å‚æ•°"></a>æ²¡æœ‰å‚æ•°</h5><p>åœ¨æ²¡æœ‰å‚æ•°çš„æƒ…å†µä¸‹</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> main() &#123;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">@try</span> &#123;</span><br><span class="line">        </span><br><span class="line">    &#125; <span class="keyword">@catch</span> (<span class="built_in">NSException</span> *exception) &#123;</span><br><span class="line">        </span><br><span class="line">    &#125; <span class="keyword">@finally</span> &#123;</span><br><span class="line">        </span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ç»è¿‡ Clang è§£æåæºç å¦‚ä¸‹ï¼š</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> main() &#123;</span><br><span class="line"></span><br><span class="line">&#123; <span class="keyword">id</span> <span class="keyword">volatile</span> _rethrow = <span class="number">0</span>;</span><br><span class="line">	try &#123;</span><br><span class="line">		try &#123;</span><br><span class="line">		         <span class="comment">//å¼‚å¸¸æ•è·</span></span><br><span class="line">		    &#125; catch (_objc_exc_NSException *_exception) &#123;</span><br><span class="line">		         <span class="built_in">NSException</span> *exception = (<span class="built_in">NSException</span>*)_exception; </span><br><span class="line">		         <span class="comment">//æ•è·å¼‚å¸¸ï¼Œå¹¶è¿›è¡ŒæŠ›å‡º</span></span><br><span class="line">		    &#125; </span><br><span class="line">	    &#125;</span><br><span class="line">	catch (<span class="keyword">id</span> e) &#123;</span><br><span class="line">	     _rethrow = e;</span><br><span class="line">	    &#125;</span><br><span class="line">	&#123;  </span><br><span class="line">	  <span class="keyword">struct</span> _FIN &#123; _FIN(<span class="keyword">id</span> reth) : rethrow(reth) &#123;&#125;</span><br><span class="line">		~_FIN() &#123; <span class="keyword">if</span> (rethrow) objc_exception_throw(rethrow); &#125;</span><br><span class="line">		<span class="keyword">id</span> rethrow;</span><br><span class="line">		&#125; _fin_force_rethow(_rethrow);</span><br><span class="line">		   <span class="comment">//å¼‚å¸¸æŠ›å‡ºåæ‰§è¡Œçš„ finally çš„å†…å®¹</span></span><br><span class="line">	    &#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">static</span> <span class="keyword">struct</span> IMAGE_INFO &#123; <span class="keyword">unsigned</span> version; <span class="keyword">unsigned</span> flag; &#125; _OBJC_IMAGE_INFO = &#123; <span class="number">0</span>, <span class="number">2</span> &#125;;</span><br></pre></td></tr></table></figure>
<h5 id="æœ‰å‚æ•°"><a href="#æœ‰å‚æ•°" class="headerlink" title="æœ‰å‚æ•°"></a>æœ‰å‚æ•°</h5><p>åœ¨æœ‰å‚æ•°çš„æƒ…å†µä¸‹</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> main() &#123;</span><br><span class="line">    </span><br><span class="line">    <span class="built_in">NSDictionary</span> *dic = @&#123;<span class="string">@"name"</span>:<span class="string">@"liang"</span>,</span><br><span class="line">                          <span class="string">@"last name"</span>:<span class="string">@"bai"</span>,</span><br><span class="line">                          <span class="string">@"dream"</span>:<span class="string">@"to be a bussinessman"</span>,</span><br><span class="line">                          <span class="string">@"work"</span>:<span class="string">@"IT"</span>&#125;;</span><br><span class="line">    </span><br><span class="line">    <span class="built_in">NSString</span> *salaryLiterals = <span class="literal">nil</span>;</span><br><span class="line">    <span class="built_in">NSString</span> *salaryAtIndex = <span class="literal">nil</span>;</span><br><span class="line">    <span class="keyword">@try</span> &#123;</span><br><span class="line">        </span><br><span class="line">        salaryAtIndex = [dic objectForKey:<span class="string">@"salary"</span>];</span><br><span class="line">        salaryLiterals = dic[<span class="string">@"salary"</span>];</span><br><span class="line">        </span><br><span class="line">    &#125; <span class="keyword">@catch</span> (<span class="built_in">NSException</span> *exception) &#123;</span><br><span class="line">        <span class="built_in">NSLog</span>(<span class="string">@"error name is %@, reason : %@, userInfo : %@"</span>, exception.name, exception.reason, exception.userInfo);</span><br><span class="line">    &#125; <span class="keyword">@finally</span> &#123;</span><br><span class="line">        </span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ç»è¿‡ Clang è§£æåæºç å¦‚ä¸‹ï¼š</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> main() &#123;</span><br><span class="line">    <span class="built_in">NSDictionary</span> *dic = ((<span class="built_in">NSDictionary</span> *(*)(Class, SEL, <span class="keyword">const</span> ObjectType *, <span class="keyword">const</span> <span class="keyword">id</span> *, <span class="built_in">NSUInteger</span>))(<span class="keyword">void</span> *)objc_msgSend)(objc_getClass(<span class="string">"NSDictionary"</span>), </span><br><span class="line">sel_registerName(<span class="string">"dictionaryWithObjects:forKeys:count:"</span>), </span><br><span class="line">(<span class="keyword">const</span> <span class="keyword">id</span> *)__NSContainer_literal(<span class="number">4</span>U, (<span class="built_in">NSString</span> *)&amp;__NSConstantStringImpl__var_folders_tv_4c43vcqx24vcxx6d51n4ntc00000gn_T_main_753a25_mi_1,</span><br><span class="line">(<span class="built_in">NSString</span> *)&amp;__NSConstantStringImpl__var_folders_tv_4c43vcqx24vcxx6d51n4ntc00000gn_T_main_753a25_mi_3, </span><br><span class="line">(<span class="built_in">NSString</span> *)&amp;__NSConstantStringImpl__var_folders_tv_4c43vcqx24vcxx6d51n4ntc00000gn_T_main_753a25_mi_5, </span><br><span class="line">(<span class="built_in">NSString</span> *)&amp;__NSConstantStringImpl__var_folders_tv_4c43vcqx24vcxx6d51n4ntc00000gn_T_main_753a25_mi_7).arr,</span><br><span class="line">(<span class="keyword">const</span> <span class="keyword">id</span> *)__NSContainer_literal(<span class="number">4</span>U, (<span class="built_in">NSString</span> *)&amp;__NSConstantStringImpl__var_folders_tv_4c43vcqx24vcxx6d51n4ntc00000gn_T_main_753a25_mi_0, </span><br><span class="line">(<span class="built_in">NSString</span> *)&amp;__NSConstantStringImpl__var_folders_tv_4c43vcqx24vcxx6d51n4ntc00000gn_T_main_753a25_mi_2,</span><br><span class="line">(<span class="built_in">NSString</span> *)&amp;__NSConstantStringImpl__var_folders_tv_4c43vcqx24vcxx6d51n4ntc00000gn_T_main_753a25_mi_4,</span><br><span class="line">(<span class="built_in">NSString</span> *)&amp;__NSConstantStringImpl__var_folders_tv_4c43vcqx24vcxx6d51n4ntc00000gn_T_main_753a25_mi_6).arr, <span class="number">4</span>U);</span><br><span class="line">    <span class="built_in">NSString</span> *salary = __null;</span><br><span class="line">    &#123; <span class="keyword">id</span> <span class="keyword">volatile</span> _rethrow = <span class="number">0</span>; <span class="comment">//ä½¿ç”¨ volatile ä¿®é¥°çš„ _rethrow è®°å½•å¼‚å¸¸çš„å±€éƒ¨å˜é‡ </span></span><br><span class="line">		try &#123;</span><br><span class="line">			try &#123;</span><br><span class="line">			        salary = ((<span class="keyword">id</span>  _Nullable (*)(<span class="keyword">id</span>, SEL, KeyType))(<span class="keyword">void</span> *)objc_msgSend)((<span class="keyword">id</span>)dic, sel_registerName(<span class="string">"objectForKeyedSubscript:"</span>), </span><br><span class="line">			  (<span class="keyword">id</span>)(<span class="built_in">NSString</span> *)&amp;__NSConstantStringImpl__var_folders_tv_4c43vcqx24vcxx6d51n4ntc00000gn_T_main_753a25_mi_8);</span><br><span class="line">			    &#125; </span><br><span class="line">		    catch (_objc_exc_NSException *_exception) &#123;</span><br><span class="line">		     <span class="built_in">NSException</span> *exception = (<span class="built_in">NSException</span>*)_exception; </span><br><span class="line">		     <span class="built_in">NSLog</span>((<span class="built_in">NSString</span> *)&amp;__NSConstantStringImpl__var_folders_tv_4c43vcqx24vcxx6d51n4ntc00000gn_T_main_753a25_mi_9,</span><br><span class="line">		            ((<span class="built_in">NSExceptionName</span> (*)(<span class="keyword">id</span>, SEL))(<span class="keyword">void</span> *)objc_msgSend)((<span class="keyword">id</span>)exception, sel_registerName(<span class="string">"name"</span>)), </span><br><span class="line">		            ((<span class="built_in">NSString</span> * _Nullable (*)(<span class="keyword">id</span>, SEL))(<span class="keyword">void</span> *)objc_msgSend)((<span class="keyword">id</span>)exception, sel_registerName(<span class="string">"reason"</span>)), </span><br><span class="line">		            ((<span class="built_in">NSDictionary</span> * _Nullable (*)(<span class="keyword">id</span>, SEL))(<span class="keyword">void</span> *)objc_msgSend)((<span class="keyword">id</span>)exception, sel_registerName(<span class="string">"userInfo"</span>)));</span><br><span class="line">		    &#125; </span><br><span class="line">		&#125;</span><br><span class="line">		catch (<span class="keyword">id</span> e) &#123;</span><br><span class="line">		    _rethrow = e;</span><br><span class="line">		&#125;</span><br><span class="line">		 &#123; </span><br><span class="line">			 <span class="keyword">struct</span> _FIN &#123; </span><br><span class="line">			    _FIN(<span class="keyword">id</span> reth) : rethrow(reth) &#123;&#125;</span><br><span class="line">				~_FIN() &#123; </span><br><span class="line">				  <span class="keyword">if</span> (rethrow) objc_exception_throw(rethrow); </span><br><span class="line">				&#125;</span><br><span class="line">				<span class="keyword">id</span> rethrow;</span><br><span class="line">			 &#125; </span><br><span class="line">			 _fin_force_rethow(_rethrow);</span><br><span class="line">			    salary = __null;</span><br><span class="line">		 &#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">static</span> <span class="keyword">struct</span> IMAGE_INFO &#123; <span class="keyword">unsigned</span> version; <span class="keyword">unsigned</span> flag; &#125; _OBJC_IMAGE_INFO = &#123; <span class="number">0</span>, <span class="number">2</span> &#125;;</span><br></pre></td></tr></table></figure>
<h3 id="æ€»ç»“ï¼š"><a href="#æ€»ç»“ï¼š" class="headerlink" title="æ€»ç»“ï¼š"></a>æ€»ç»“ï¼š</h3><blockquote>
<p>ï¼ˆ1ï¼‰é‡åˆ°å¥”æºƒé—®é¢˜æˆ–è€…æ˜¯é”™è¯¯é—®é¢˜ï¼Œä¼˜å…ˆä½¿ç”¨ <code>NSError</code> æ¥å¯¹å¥”æºƒå’Œé”™è¯¯è¿›è¡Œå°è£…ï¼Œç„¶åä½¿ç”¨ <code>NSLog</code> å¯¹å…¶è¿›è¡Œæ‰“å°</p>
<p>ï¼ˆ2ï¼‰<code>@try @catch @finally</code> åœ¨ä½¿ç”¨çš„è¿‡ç¨‹ä¸­å¾ˆæ–¹ä¾¿ï¼Œä½†æ˜¯ <code>MRC</code> ä¸­å¦‚æœå˜é‡è¾ƒå¤šå¯èƒ½ä¼šæ¼æ‰å±€éƒ¨å˜é‡å†…å­˜é‡Šæ”¾é—®é¢˜å’Œ <code>ARC</code> ä¸­å¦‚æœæŠ›å‡ºé—®é¢˜ï¼Œä¸ä¼šè‡ªåŠ¨å¯¹å±€éƒ¨å˜é‡é‡Šæ”¾ï¼ˆå¼€å¯ <code>-fobjc-arc-expections</code> æ¨¡å¼ä¼šè¿›è¡Œé‡Šæ”¾ï¼Œä½†æ˜¯å¼•å…¥ä»£ç å¯¹æ€§èƒ½æœ‰æ‰€å½±å“ï¼‰</p>
</blockquote>

      

      
    </div>
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<i class="icon-price-tags icon"></i>
		<ul class="article-tag-list">
			 
        		<li class="article-tag-list-item">
        			<a href="javascript:void(0)" class="js-tag article-tag-list-link color4">iOS</a>
        		</li>
      		
		</ul>
	</div>

      
	<div class="article-category tagcloud">
		<i class="icon-book icon"></i>
		<ul class="article-tag-list">
			 
        		<li class="article-tag-list-item">
        			<a href="/categories/iOS/" class="article-tag-list-link color4">iOS</a>
        		</li>
      		
		</ul>
	</div>


      
        <p class="article-more-link">
          <a class="article-more-a" href="/2017/05/31/NSError(é”™è¯¯ä¿¡æ¯)/">å±•å¼€å…¨æ–‡ >></a>
        </p>
      

      
      <div class="clearfix"></div>
    </div>
  </div>
</article>





  
    <article id="post-iOS-Responder Chain" class="article article-type-post  article-index" itemscope itemprop="blogPost">
  <div class="article-inner">
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/05/15/iOS-Responder Chain/">iOS-Responder Chain (å“åº”é“¾)</a>
    </h1>
  

        
        <a href="/2017/05/15/iOS-Responder Chain/" class="archive-article-date">
  	<time datetime="2017-05-14T16:12:14.000Z" itemprop="datePublished"><i class="icon-calendar icon"></i>2017-05-15</time>
</a>
        
      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>å·¥ä½œæ¥è¿‘ä¸€å¹´ï¼Œå¾ˆä¹…æ²¡æœ‰æ›´æ–°åšå®¢ã€‚å·¥ä½œä¸­å­¦åˆ°å¾ˆå¤šçŸ¥è¯†ç‚¹åé¢å°†èŠ±æ—¶é—´æ•´ç†ï¼Œä½œä¸ºå¯¹ä¸€å¹´çŸ¥è¯†å­¦ä¹ çš„æ€»ç»“ï¼š</p>
<p>ä¸‹é¢æ˜¯æœ¬ç¯‡åšå®¢çš„å†™ä½œæ€è·¯ï¼š</p>
<p><img src="http://upload-images.jianshu.io/upload_images/1877765-56a34538a5ab0e6b.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="iOS-Responder Chain.png"></p>
<h1 id="iOS-Responder-Chain-å“åº”é“¾"><a href="#iOS-Responder-Chain-å“åº”é“¾" class="headerlink" title="iOS-Responder Chain (å“åº”é“¾)"></a>iOS-Responder Chain (å“åº”é“¾)</h1><h2 id="äººä¸è®¡ç®—æœºäº¤äº’"><a href="#äººä¸è®¡ç®—æœºäº¤äº’" class="headerlink" title="äººä¸è®¡ç®—æœºäº¤äº’"></a>äººä¸è®¡ç®—æœºäº¤äº’</h2><p>ç›®å‰è®¡ç®—æœºåœ¨æˆ‘ä»¬ç”Ÿæ´»ä¸­æ‰®æ¼”å¾ˆé‡è¦çš„è§’è‰²ï¼Œæˆ‘ä»¬ä¸è®¡ç®—æœºä¹‹é—´çš„äº¤äº’ä¹Ÿå¾ˆæ™®éã€‚å¤šæ•°æƒ…å†µä½¿ç”¨æœ€å¤šçš„æ˜¯ PC å’Œ ç§»åŠ¨ç«¯ï¼Œè€Œä¸¤ç§äº¤äº’æ–¹å¼æœ‰å¾ˆå¤§çš„ä¸åŒ</p>
<ul>
<li>PC ä¸äººçš„äº¤äº’</li>
<li>ç§»åŠ¨ç«¯ä¸äººçš„äº¤äº’</li>
</ul>
<p>a)  åœ¨ PC ç«¯æˆ‘ä»¬é€šè¿‡é”®ç›˜ã€é¼ æ ‡ç­‰æ¥å¯¹ç•Œé¢çš„å†…å®¹è¿›è¡Œæ“ä½œå’Œå®Œæˆç›¸å…³çš„ä»»åŠ¡</p>
<p>bï¼‰åœ¨ç§»åŠ¨ç«¯æˆ‘ä»¬å¯ä»¥é€šè¿‡æ‰‹æŒ‡å¯¹ç•Œé¢å†…å®¹è¿›è¡Œç‚¹å‡»æ§ä»¶å’Œå®ç°ç›¸åº”çš„æ“ä½œ</p>
<blockquote>
<p>è¿™é‡Œæå‡ºä¸€ä¸ªç–‘é—®ï¼ŒPC ç«¯æˆ‘ä»¬é€šè¿‡ç‚¹å‡»å¯ä»¥å®ç°æ§ä»¶çš„ç›¸å…³æ“ä½œã€‚ä½†æ˜¯ç§»åŠ¨ç«¯æˆ‘ä»¬æ‰‹æŒ‡ç‚¹å‡»æ§ä»¶æ˜¯æ€ä¹ˆè¢«æ£€æµ‹ç‚¹å‡»çš„ä½ç½®ã€ä¼ é€’ä¿¡æ¯å’Œåšå‡ºç›¸åº”çš„æ“ä½œå‘¢ï¼Ÿ</p>
</blockquote>
<p>è¿™é‡Œå¼•å…¥ä¸€ä¸ªæ¦‚å¿µï¼šResponder Chain (å“åº”è€…é“¾)</p>
<h2 id="Responder-Chain-å“åº”è€…é“¾"><a href="#Responder-Chain-å“åº”è€…é“¾" class="headerlink" title="Responder Chain (å“åº”è€…é“¾)"></a>Responder Chain (å“åº”è€…é“¾)</h2><ul>
<li>NSResponder.h å¤´æ–‡ä»¶çš„æºç </li>
<li>UIKit æ§ä»¶ä¹‹é—´çš„ç»§æ‰¿å…³ç³»</li>
</ul>
<h5 id="NSResponder-h-å¤´æ–‡ä»¶çš„æºç "><a href="#NSResponder-h-å¤´æ–‡ä»¶çš„æºç " class="headerlink" title="NSResponder.h å¤´æ–‡ä»¶çš„æºç "></a>NSResponder.h å¤´æ–‡ä»¶çš„æºç </h5><p>åœ¨æˆ‘ä»¬ç‚¹å‡»æ‰‹æœºå±å¹•çš„ä¸€ä¸ªæ§ä»¶æ—¶ï¼Œä¸ Responder Chain (å“åº”è€…é“¾)ä¹‹é—´è”ç³»ç´§å¯†ã€‚ä¸‹é¢æ˜¯å°ç¼–åœ¨ <code>UIKit</code> æ¡†æ¶ä¸­æ‰¾åˆ°ç›¸åº”ç›¸å…³çš„ä»£ç ï¼Œå¦‚ä¸‹ï¼š<br><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">@interface</span> <span class="title">UIResponder</span> : <span class="title">NSObject</span> &lt;<span class="title">UIResponderStandardEditActions</span>&gt;</span></span><br><span class="line"><span class="keyword">@property</span>(<span class="keyword">nonatomic</span>, <span class="keyword">readonly</span>, nullable) <span class="built_in">UIResponder</span> *nextResponder;</span><br><span class="line">- (nullable <span class="built_in">UIResponder</span>*)nextResponder;</span><br><span class="line"></span><br><span class="line"><span class="keyword">@property</span>(<span class="keyword">nonatomic</span>, <span class="keyword">readonly</span>) <span class="built_in">BOOL</span> canBecomeFirstResponder;    <span class="comment">// default is NO</span></span><br><span class="line">- (<span class="built_in">BOOL</span>)canBecomeFirstResponder;    <span class="comment">// default is NO</span></span><br><span class="line">- (<span class="built_in">BOOL</span>)becomeFirstResponder;</span><br><span class="line"></span><br><span class="line"><span class="keyword">@property</span>(<span class="keyword">nonatomic</span>, <span class="keyword">readonly</span>) <span class="built_in">BOOL</span> canResignFirstResponder;   </span><br><span class="line">- (<span class="built_in">BOOL</span>)canResignFirstResponder;    <span class="comment">// default is YES</span></span><br><span class="line">- (<span class="built_in">BOOL</span>)resignFirstResponder;</span><br><span class="line"></span><br><span class="line"><span class="keyword">@property</span>(<span class="keyword">nonatomic</span>, <span class="keyword">readonly</span>) <span class="built_in">BOOL</span> isFirstResponder;</span><br><span class="line">- (<span class="built_in">BOOL</span>)isFirstResponder;</span><br><span class="line"></span><br><span class="line">- (<span class="keyword">void</span>)touchesBegan:(<span class="built_in">NSSet</span>&lt;<span class="built_in">UITouch</span> *&gt; *)touches withEvent:(nullable <span class="built_in">UIEvent</span> *)event;</span><br><span class="line">- (<span class="keyword">void</span>)touchesMoved:(<span class="built_in">NSSet</span>&lt;<span class="built_in">UITouch</span> *&gt; *)touches withEvent:(nullable <span class="built_in">UIEvent</span> *)event;</span><br><span class="line">- (<span class="keyword">void</span>)touchesEnded:(<span class="built_in">NSSet</span>&lt;<span class="built_in">UITouch</span> *&gt; *)touches withEvent:(nullable <span class="built_in">UIEvent</span> *)event;</span><br><span class="line">- (<span class="keyword">void</span>)touchesCancelled:(<span class="built_in">NSSet</span>&lt;<span class="built_in">UITouch</span> *&gt; *)touches withEvent:(nullable <span class="built_in">UIEvent</span> *)event;</span><br><span class="line">- (<span class="keyword">void</span>)touchesEstimatedPropertiesUpdated:(<span class="built_in">NSSet</span>&lt;<span class="built_in">UITouch</span> *&gt; *)touches <span class="built_in">NS_AVAILABLE_IOS</span>(<span class="number">9</span>_1);</span><br><span class="line"></span><br><span class="line">- (<span class="keyword">void</span>)pressesBegan:(<span class="built_in">NSSet</span>&lt;<span class="built_in">UIPress</span> *&gt; *)presses withEvent:(nullable <span class="built_in">UIPressesEvent</span> *)event <span class="built_in">NS_AVAILABLE_IOS</span>(<span class="number">9</span>_0);</span><br><span class="line">- (<span class="keyword">void</span>)pressesChanged:(<span class="built_in">NSSet</span>&lt;<span class="built_in">UIPress</span> *&gt; *)presses withEvent:(nullable <span class="built_in">UIPressesEvent</span> *)event <span class="built_in">NS_AVAILABLE_IOS</span>(<span class="number">9</span>_0);</span><br><span class="line">- (<span class="keyword">void</span>)pressesEnded:(<span class="built_in">NSSet</span>&lt;<span class="built_in">UIPress</span> *&gt; *)presses withEvent:(nullable <span class="built_in">UIPressesEvent</span> *)event <span class="built_in">NS_AVAILABLE_IOS</span>(<span class="number">9</span>_0);</span><br><span class="line">- (<span class="keyword">void</span>)pressesCancelled:(<span class="built_in">NSSet</span>&lt;<span class="built_in">UIPress</span> *&gt; *)presses withEvent:(nullable <span class="built_in">UIPressesEvent</span> *)event <span class="built_in">NS_AVAILABLE_IOS</span>(<span class="number">9</span>_0);</span><br></pre></td></tr></table></figure></p>
<p>åœ¨ä¸Šé¢ <code>&lt;UIKit/UIResponder.h&gt;</code> çš„æ–‡ä»¶ä¸­æˆ‘ä»¬å¯ä»¥çœ‹å‡º <code>UIResponder</code> çš„ç±»å¯ä»¥å®ç° <code>Touch</code> å’Œ <code>Press</code> ç›¸å…³æ“ä½œçš„åšå‡ºç›‘å¬</p>
<h5 id="UIKit-æ§ä»¶ä¹‹é—´çš„ç»§æ‰¿å…³ç³»"><a href="#UIKit-æ§ä»¶ä¹‹é—´çš„ç»§æ‰¿å…³ç³»" class="headerlink" title="UIKit æ§ä»¶ä¹‹é—´çš„ç»§æ‰¿å…³ç³»"></a>UIKit æ§ä»¶ä¹‹é—´çš„ç»§æ‰¿å…³ç³»</h5><p>ä¸‹é¢æ˜¯å°ç¼–å¯¹ <code>UIKit</code> æ¡†æ¶ä¸­ç‚¹å‡»ç›¸åº”æ§ä»¶æœ‰å…³ <code>Class</code> (ç±»)ç»§æ‰¿å…³ç³»æ•´ç†ï¼Œå¦‚ä¸‹å›¾ï¼š</p>
<p><img src="http://upload-images.jianshu.io/upload_images/1877765-faaebfb7fe3a7067.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="iOS-Responder Chain-UIKit.png"></p>
<blockquote>
<p>ç”±ä¸Šé¢æˆ‘ä»¬å¯ä»¥çœ‹å‡ºï¼Œåœ¨ç•Œé¢ä¸Šæˆ‘ä»¬å¹³æ—¶ä½¿ç”¨æ§ä»¶æ—¶é€šè¿‡ç»§æ‰¿ <code>UIResponder</code> æ¥å®ç°å¯¹ç•Œé¢ <code>Touch</code> å’Œ <code>Press</code> ç›¸å…³æ“ä½œçš„åšå‡ºç›‘å¬</p>
</blockquote>
<h2 id="å“åº”é“¾çš„åˆ›å»º"><a href="#å“åº”é“¾çš„åˆ›å»º" class="headerlink" title="å“åº”é“¾çš„åˆ›å»º"></a>å“åº”é“¾çš„åˆ›å»º</h2><ul>
<li>æ§åˆ¶å™¨ä¸­çš„ <code>View</code> æ ‘çŠ¶ç»“æ„</li>
<li>ç‚¹å‡»ç›¸åº”çš„æµ‹è¯•&amp;æ‰“å°</li>
</ul>
<h5 id="æ§åˆ¶å™¨ä¸­çš„-View-æ ‘çŠ¶ç»“æ„"><a href="#æ§åˆ¶å™¨ä¸­çš„-View-æ ‘çŠ¶ç»“æ„" class="headerlink" title="æ§åˆ¶å™¨ä¸­çš„ View æ ‘çŠ¶ç»“æ„"></a>æ§åˆ¶å™¨ä¸­çš„ <code>View</code> æ ‘çŠ¶ç»“æ„</h5><p>åœ¨æ‰‹æœºçš„ GUI ä¸­æˆ‘ä»¬å¤šæ•°æƒ…å†µä¸‹ä½¿ç”¨ <code>UIViewController</code> å’Œ <code>UINavigationViewController</code> æ§åˆ¶å™¨æ¥å®ç°ç•Œé¢æ§ä»¶çš„ç®¡ç†ï¼Œå…¶ä¸­ä»¥æ§åˆ¶å™¨çš„ <code>View</code> ä¸ºç•Œé¢æ˜¾ç¤ºåˆ›å»ºå’Œæ·»åŠ æ§ä»¶ï¼Œæœ€åå½¢æˆ <code>View</code> çš„æ§ä»¶æ ‘çŠ¶ç»“æ„</p>
<p>GUI æ‰‹æœºç•Œé¢ä¸­ï¼Œæˆ‘ä»¬çŸ¥é“ <code>UIView</code> ä¸­ç”¨ <code>property</code> (å±æ€§) <code>superView</code> å¯ä»¥ç”¨æ¥æ·»åŠ æ–°çš„ <code>UIView</code> åˆ°å½“å‰çš„ <code>View</code> ä¸­ï¼Œæ·»åŠ çš„å­ç±» <code>View</code> ä¸­ <code>property</code> (å±æ€§) <code>nextResponder</code> å¯ä»¥æŒ‡å‘çˆ¶ç±» <code>View</code> çš„ <code>property</code> (å±æ€§) <code>superView</code></p>
<p>æ¯ä¸€ä¸ª  <code>ViewController</code> ä¸­æœ‰ <code>property</code>(å±æ€§) <code>view</code> -&gt; æ—¢<code>self.view</code> æ¥è¿›è¡Œæ·»åŠ å­ç±» <code>View</code>ï¼ŒåŒæ ·ï¼š<code>view</code> çš„ <code>property</code> (å±æ€§) é€šè¿‡   <code>property</code> (å±æ€§) <code>nextResponder</code> æ¥æŒ‡å‘   <code>ViewController</code> </p>
<p>ä¸‹å›¾æ˜¯ <code>View</code> åˆå§‹åŒ–å¸ƒå±€ï¼š</p>
<p><img src="http://upload-images.jianshu.io/upload_images/1877765-ff79d6261a13c062.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="iOS-Responder Chain-View-Front.png"><br><img src="http://upload-images.jianshu.io/upload_images/1877765-bbfe167edcd04fed.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="iOS-Responder Chain-View-Hierarchy.png"></p>
<h5 id="ç‚¹å‡»ç›¸åº”çš„æµ‹è¯•-amp-æ‰“å°"><a href="#ç‚¹å‡»ç›¸åº”çš„æµ‹è¯•-amp-æ‰“å°" class="headerlink" title="ç‚¹å‡»ç›¸åº”çš„æµ‹è¯•&amp;æ‰“å°"></a>ç‚¹å‡»ç›¸åº”çš„æµ‹è¯•&amp;æ‰“å°</h5><p>åœ¨å®šä¹‰çš„ ViewA1 ä¸­é‡å†™<code>touch</code>æ–¹æ³•ï¼š<br><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">- (<span class="keyword">void</span>)touchesBegan:(<span class="built_in">NSSet</span>&lt;<span class="built_in">UITouch</span> *&gt; *)touches withEvent:(<span class="built_in">UIEvent</span> *)event &#123;</span><br><span class="line">    <span class="built_in">UIResponder</span> *next = [<span class="keyword">self</span> nextResponder];</span><br><span class="line">    <span class="built_in">NSMutableString</span> *prefix  = <span class="string">@""</span>.mutableCopy;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">while</span> (<span class="literal">nil</span> != next) &#123;</span><br><span class="line">        <span class="built_in">NSLog</span>(<span class="string">@"%@%@"</span>, prefix, [next class]);</span><br><span class="line">        [prefix appendString:<span class="string">@"--"</span>];</span><br><span class="line">        next = [next nextResponder];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>ç‚¹å‡» <code>ViewA1</code> å¾—åˆ°çš„æ‰“å°ç»“æœï¼š<br><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">2017</span><span class="number">-05</span><span class="number">-08</span> <span class="number">23</span>:<span class="number">55</span>:<span class="number">12.278</span> DesignPattern-Create[<span class="number">19441</span>:<span class="number">727956</span>] ViewA0</span><br><span class="line"><span class="number">2017</span><span class="number">-05</span><span class="number">-08</span> <span class="number">23</span>:<span class="number">55</span>:<span class="number">12.278</span> DesignPattern-Create[<span class="number">19441</span>:<span class="number">727956</span>] --ViewA</span><br><span class="line"><span class="number">2017</span><span class="number">-05</span><span class="number">-08</span> <span class="number">23</span>:<span class="number">55</span>:<span class="number">12.278</span> DesignPattern-Create[<span class="number">19441</span>:<span class="number">727956</span>] ----<span class="built_in">UIView</span></span><br><span class="line"><span class="number">2017</span><span class="number">-05</span><span class="number">-08</span> <span class="number">23</span>:<span class="number">55</span>:<span class="number">12.279</span> DesignPattern-Create[<span class="number">19441</span>:<span class="number">727956</span>] ------ViewController</span><br><span class="line"><span class="number">2017</span><span class="number">-05</span><span class="number">-08</span> <span class="number">23</span>:<span class="number">55</span>:<span class="number">12.279</span> DesignPattern-Create[<span class="number">19441</span>:<span class="number">727956</span>] --------<span class="built_in">UIWindow</span></span><br><span class="line"><span class="number">2017</span><span class="number">-05</span><span class="number">-08</span> <span class="number">23</span>:<span class="number">55</span>:<span class="number">12.279</span> DesignPattern-Create[<span class="number">19441</span>:<span class="number">727956</span>] ----------<span class="built_in">UIApplication</span></span><br><span class="line"><span class="number">2017</span><span class="number">-05</span><span class="number">-08</span> <span class="number">23</span>:<span class="number">55</span>:<span class="number">12.280</span> DesignPattern-Create[<span class="number">19441</span>:<span class="number">727956</span>] ------------AppDelegate</span><br></pre></td></tr></table></figure></p>
<blockquote>
<p>åŸºäºä¸Šé¢ï¼šå°ç¼–ä»ä¸Šé¢ä»£ç æ‰“å°çš„ç»“æœå¯ä»¥éªŒè¯ï¼Œå­ View çš„ property(å±æ€§) <code>nextResponder</code> æŒ‡å‘çˆ¶ Viewï¼Œçˆ¶ç±»çš„ View çš„property(å±æ€§) <code>nextResponder</code> æœ€åæŒ‡å‘ ViewController </p>
</blockquote>
<h2 id="å¦‚ä½•æ‰¾æ‰“ç¬¬ä¸€å“åº”è€…"><a href="#å¦‚ä½•æ‰¾æ‰“ç¬¬ä¸€å“åº”è€…" class="headerlink" title="å¦‚ä½•æ‰¾æ‰“ç¬¬ä¸€å“åº”è€…"></a>å¦‚ä½•æ‰¾æ‰“ç¬¬ä¸€å“åº”è€…</h2><ul>
<li>æ¢æµ‹å™¨ <code>Hit - Test</code></li>
<li>å¯»æ‰¾ç¬¬ä¸€ç›¸åº”çš„æ¢æµ‹çŒœæƒ³</li>
</ul>
<h5 id="æ¢æµ‹å™¨-Hit-Test"><a href="#æ¢æµ‹å™¨-Hit-Test" class="headerlink" title="æ¢æµ‹å™¨ Hit - Test"></a>æ¢æµ‹å™¨ <code>Hit - Test</code></h5><p>åœ¨å“åº”é“¾æŸ¥æ‰¾è¿‡ç¨‹ä¸­ï¼Œæœ‰ä¸¤ä¸ªå‡½æ•°èµ·åˆ°å¾ˆé‡è¦çš„ä½œç”¨<br><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">- (<span class="built_in">UIView</span> *)hitTest:(<span class="built_in">CGPoint</span>)point withEvent:(<span class="built_in">UIEvent</span> *)event;</span><br><span class="line">- (<span class="built_in">BOOL</span>)pointInside:(<span class="built_in">CGPoint</span>)point withEvent:(<span class="built_in">UIEvent</span> *)event;</span><br></pre></td></tr></table></figure></p>
<p>åœ¨å“åº”é“¾åˆ›å»ºçš„æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬åœ¨æŠŠå¯»æ‰¾å“åº”è€…çš„è¿‡ç¨‹ç§°ä¸ºï¼š<code>Hit - Testing View</code> åœ¨å¯»æ‰¾ç›¸åº” View çš„è¿‡ç¨‹ç§°ä¸ºï¼š<code>Hit - Test</code><br>æˆ‘ä»¬æŠŠ <code>Hit - Test</code> å¯ä»¥æ¯”ä½œä¸€ä¸ªæ¢æµ‹å™¨ï¼Œé€šè¿‡è¿™ä¸ªæ¢æµ‹å™¨æ¥æ£€æµ‹æ‰‹æŒ‡ç‚¹å‡»åœ¨å“ªä¸ª <code>UIView</code> ä¸Šé¢ </p>
<p>é€šè¿‡ä¸Šé¢çš„ç»§æ‰¿å…³ç³»å’Œç‚¹å‡»åæ‰“å°å‡ºçš„ç»“æœå¯ä»¥çœ‹åˆ°ï¼Œå½“æˆ‘ä»¬ç‚¹å‡»ç•Œé¢ <code>UIApplication</code> å°±ä¼šè°ƒç”¨ <code>hitTest: withEvent</code> æŸ¥çœ‹ç‚¹å‡»æ˜¯å¦åœ¨ <code>UIWindow</code> ä¸­å¦‚æœä¸åœ¨å°±è¿”å› <code>nil</code> , å¦‚æœåœ¨ <code>UIWindow</code> ä¹Ÿä¼šè°ƒç”¨ <code>hitTest: withEvent</code> å¯¹<code>UIWindow</code> ä¸­ <code>subViews</code> è¿›è¡Œæ¢æµ‹</p>
<blockquote>
<p><code>hitTest: withEvent</code> åœ¨æ¢æµ‹è¿‡ç¨‹ä¸­é‡‡ç”¨æˆ‘ä»¬æ¯”è¾ƒå¸¸è§ é€’å½’çš„æ–¹å¼æ¥æŸ¥æ‰¾ç‚¹å‡» <code>UIView</code>ï¼Œ é€šè¿‡æˆ‘ä»¬åœ¨åˆå§‹åŒ–è¿‡ç¨‹ä¸­æœ€åè¢«åˆå§‹åŒ–çš„æ”¾åœ¨æœ€ä¸Šé¢</p>
</blockquote>
<p>åœ¨ç‚¹å‡» <code>ViewA1</code> æ¥è¿›è¡ŒéªŒè¯ä¸‹ä¸€ä¸ª <code>nextResponder</code> è¿‡ç¨‹ä¸­åœ¨æ¯ä¸€ä¸ª <code>View</code>é‡å†™ <code>hitTest</code> å¦‚ä¸‹ï¼š<br><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">- (<span class="built_in">UIView</span> *)hitTest:(<span class="built_in">CGPoint</span>)point withEvent:(<span class="built_in">UIEvent</span> *)event &#123;</span><br><span class="line">    <span class="keyword">if</span> (!<span class="keyword">self</span>.isUserInteractionEnabled || <span class="keyword">self</span>.hidden || <span class="keyword">self</span>.alpha &lt;= <span class="number">0.01</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">nil</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">NSLog</span>(<span class="string">@"ResponderChain : %@"</span>, [<span class="keyword">self</span> class]);</span><br><span class="line">    <span class="keyword">if</span> ([<span class="keyword">self</span> pointInside:point withEvent:event]) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="built_in">UIView</span> *subView <span class="keyword">in</span> [<span class="keyword">self</span>.subviews reverseObjectEnumerator]) &#123;</span><br><span class="line">            <span class="built_in">CGPoint</span> converPoin = [subView convertPoint:point fromView:<span class="keyword">self</span>];</span><br><span class="line">            <span class="built_in">UIView</span> *hitTestView = [subView hitTest:converPoin withEvent:event];</span><br><span class="line">            <span class="keyword">if</span> (hitTestView) &#123;</span><br><span class="line">                <span class="built_in">NSLog</span>(<span class="string">@"ViewA : hitTestView -&gt; %@"</span>, [hitTestView class]);</span><br><span class="line">                <span class="keyword">return</span> hitTestView;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">self</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">nil</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>ç‚¹å‡» <code>ViewA1</code> å¾—åˆ°æ‰“å°çš„ç»“æœå¦‚ä¸‹ï¼š<br><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">2017</span><span class="number">-05</span><span class="number">-09</span> <span class="number">07</span>:<span class="number">42</span>:<span class="number">05.968</span> DesignPattern-Create[<span class="number">1197</span>:<span class="number">22554</span>] ResponderChain : ViewB</span><br><span class="line"><span class="number">2017</span><span class="number">-05</span><span class="number">-09</span> <span class="number">07</span>:<span class="number">42</span>:<span class="number">05.969</span> DesignPattern-Create[<span class="number">1197</span>:<span class="number">22554</span>] ResponderChain : ViewA</span><br><span class="line"><span class="number">2017</span><span class="number">-05</span><span class="number">-09</span> <span class="number">07</span>:<span class="number">42</span>:<span class="number">05.969</span> DesignPattern-Create[<span class="number">1197</span>:<span class="number">22554</span>] ResponderChain : ViewA0</span><br><span class="line"><span class="number">2017</span><span class="number">-05</span><span class="number">-09</span> <span class="number">07</span>:<span class="number">42</span>:<span class="number">05.969</span> DesignPattern-Create[<span class="number">1197</span>:<span class="number">22554</span>] ResponderChain : ViewA1</span><br></pre></td></tr></table></figure></p>
<h5 id="å¯»æ‰¾ç¬¬ä¸€ç›¸åº”çš„æ¢æµ‹çŒœæƒ³"><a href="#å¯»æ‰¾ç¬¬ä¸€ç›¸åº”çš„æ¢æµ‹çŒœæƒ³" class="headerlink" title="å¯»æ‰¾ç¬¬ä¸€ç›¸åº”çš„æ¢æµ‹çŒœæƒ³"></a>å¯»æ‰¾ç¬¬ä¸€ç›¸åº”çš„æ¢æµ‹çŒœæƒ³</h5><p>æ ¹æ®æ‰“å°çš„ç»“æœï¼Œæˆ‘ä»¬å¯ä»¥éªŒè¯ç‚¹å‡»å…·ä½“æŸ¥æ‰¾çš„æµç¨‹å¦‚ä¸‹å›¾æ‰€ç¤ºï¼šï¼ˆå®ä¾‹æ˜¯ç‚¹å‡» viewA1ï¼‰<br>UIApplication â€”&gt; UIWindow  â€”&gt; viewB â€”&gt; viewA â€”&gt; viewA0 â€”&gt; viewA1</p>
<p><img src="http://upload-images.jianshu.io/upload_images/1877765-4b1f59d1c65500ba.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="iOS-Responder Chain-Hit-Testing-View.png"></p>
<h2 id="åˆ©ç”¨å“åº”è€…åœ¨åº”ç”¨ä¸­çš„ä½“ç°"><a href="#åˆ©ç”¨å“åº”è€…åœ¨åº”ç”¨ä¸­çš„ä½“ç°" class="headerlink" title="åˆ©ç”¨å“åº”è€…åœ¨åº”ç”¨ä¸­çš„ä½“ç°"></a>åˆ©ç”¨å“åº”è€…åœ¨åº”ç”¨ä¸­çš„ä½“ç°</h2><ul>
<li>æ”¹å˜æ§ä»¶çš„ç›¸åº”èŒƒå›´</li>
</ul>
<h5 id="æ”¹å˜æ§ä»¶çš„ç›¸åº”èŒƒå›´"><a href="#æ”¹å˜æ§ä»¶çš„ç›¸åº”èŒƒå›´" class="headerlink" title="æ”¹å˜æ§ä»¶çš„ç›¸åº”èŒƒå›´"></a>æ”¹å˜æ§ä»¶çš„ç›¸åº”èŒƒå›´</h5><p>æˆ‘ä»¬å¯ä»¥åˆ©ç”¨ <code>hitTest</code> æ ¹æ® <code>point</code> æ–¹å¼æ¥é‡æ–°è®¾ç½® <code>ponit</code> çš„ç‚¹å‡»ç›¸åº”çš„èŒƒå›´å¤§å°<br>åœ¨ ViewB1 ä¸­å®ç°ç‚¹å‡»ç›¸åº”èŒƒå›´åœ¨å¸ƒå±€æ˜¾ç¤ºåŸºç¡€ä¸Šä¸‹å·¦å³æ‹“å±• 10 pxï¼Œå®ç°ä»£ç å¦‚ä¸‹ï¼š</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">- (<span class="built_in">UIView</span> *)hitTest:(<span class="built_in">CGPoint</span>)point withEvent:(<span class="built_in">UIEvent</span> *)event &#123;</span><br><span class="line">    <span class="keyword">if</span> (!<span class="keyword">self</span>.isUserInteractionEnabled || <span class="keyword">self</span>.isHidden || <span class="keyword">self</span>.alpha &lt;= <span class="number">0.01</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">nil</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">NSLog</span>(<span class="string">@"ResponderChain : %@"</span>, [<span class="keyword">self</span> class]);</span><br><span class="line">    <span class="built_in">CGRect</span> touchRect = <span class="built_in">CGRectInset</span>(<span class="keyword">self</span>.bounds, <span class="number">-10</span>, <span class="number">-10</span>);</span><br><span class="line">    <span class="keyword">if</span> (<span class="built_in">CGRectContainsPoint</span>(touchRect, point)) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="built_in">UIView</span> *subView <span class="keyword">in</span> [<span class="keyword">self</span>.subviews reverseObjectEnumerator]) &#123;</span><br><span class="line">            <span class="built_in">CGPoint</span> converPoint = [subView convertPoint:point fromView:<span class="keyword">self</span>];</span><br><span class="line">            <span class="built_in">UIView</span> *hitTestView = [subView hitTest:converPoint withEvent:event];</span><br><span class="line">            <span class="keyword">if</span> (hitTestView) &#123;</span><br><span class="line">                <span class="built_in">NSLog</span>(<span class="string">@"ViewB1 : hitTestView -&gt; %@"</span>, [hitTestView class]);</span><br><span class="line">                <span class="keyword">return</span> hitTestView;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">self</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">nil</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><code>ViewB1</code> ç•Œé¢ä¸­å®é™…èŒƒå›´ï¼Œå’Œç‚¹å‡»ç›¸åº”çš„ <code>viewB1</code> å¤–çš„è™šæ¡†çš„èŒƒå›´ä¹Ÿä¼šåšå‡ºç›¸åº”çš„ç›¸åº”ã€‚å¦‚ä¸‹å›¾ï¼š</p>
<p><img src="http://upload-images.jianshu.io/upload_images/1877765-f4e683de8d0ab2cb.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="iOS-Responder Chain-Apply.png"></p>
<p>æ‰“å°çš„ç»“æœï¼š<br><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">2017</span><span class="number">-05</span><span class="number">-09</span> <span class="number">10</span>:<span class="number">34</span>:<span class="number">00.437</span> DesignPattern-Create[<span class="number">1197</span>:<span class="number">22554</span>] ResponderChain : ViewB</span><br><span class="line"><span class="number">2017</span><span class="number">-05</span><span class="number">-09</span> <span class="number">10</span>:<span class="number">34</span>:<span class="number">00.437</span> DesignPattern-Create[<span class="number">1197</span>:<span class="number">22554</span>] ResponderChain : ViewB1</span><br><span class="line"><span class="number">2017</span><span class="number">-05</span><span class="number">-09</span> <span class="number">10</span>:<span class="number">34</span>:<span class="number">00.437</span> DesignPattern-Create[<span class="number">1197</span>:<span class="number">22554</span>] ViewB : hitTestView -&gt; ViewB1</span><br></pre></td></tr></table></figure></p>
<p>ç›¸å…³çš„æµ‹è¯•çš„<a href="https://github.com/boilWater/DesignPattern-Create.git" target="_blank" rel="external">Dome</a>ä¸‹è½½åœ°å€</p>
<p>æ—¶é—´ï¼š2017/5/8 23:58:44 (åé¢ä¼šç»§æ‰¿å†™ä½œ)<br>ä¿®æ”¹æ—¶é—´ï¼š 2017/5/9 22:30:45</p>

      

      
    </div>
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<i class="icon-price-tags icon"></i>
		<ul class="article-tag-list">
			 
        		<li class="article-tag-list-item">
        			<a href="javascript:void(0)" class="js-tag article-tag-list-link color4">iOS</a>
        		</li>
      		
		</ul>
	</div>

      
	<div class="article-category tagcloud">
		<i class="icon-book icon"></i>
		<ul class="article-tag-list">
			 
        		<li class="article-tag-list-item">
        			<a href="/categories/iOS/" class="article-tag-list-link color4">iOS</a>
        		</li>
      		
		</ul>
	</div>


      
        <p class="article-more-link">
          <a class="article-more-a" href="/2017/05/15/iOS-Responder Chain/">å±•å¼€å…¨æ–‡ >></a>
        </p>
      

      
      <div class="clearfix"></div>
    </div>
  </div>
</article>





  
    <article id="post-16æ€»ç»“-17å±•æœ›" class="article article-type-post  article-index" itemscope itemprop="blogPost">
  <div class="article-inner">
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/01/16/16æ€»ç»“-17å±•æœ›/">2016å¹´æœ«~2017å¹´åˆ</a>
    </h1>
  

        
        <a href="/2017/01/16/16æ€»ç»“-17å±•æœ›/" class="archive-article-date">
  	<time datetime="2017-01-16T15:56:06.000Z" itemprop="datePublished"><i class="icon-calendar icon"></i>2017-01-16</time>
</a>
        
      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="2016æ€»ç»“"><a href="#2016æ€»ç»“" class="headerlink" title="2016æ€»ç»“"></a>2016æ€»ç»“</h2><p>è¸©ç€16å¹´çš„å°å°¾å·´å†™ä¸‹è¿™è¾¹æ–‡ç« ï¼Œç¦»å›å®¶è¿˜æœ‰8å¤©æ—¶é—´ğŸ‘Š</p>
<p>ä»Šå¹´ä¹Ÿæ˜¯è‡ªå·±ç¬¬ä¸€æ¬¡è¿™ä¹ˆä¹…ç¦»å¼€å®¶ï¼Œå¤§æ¦‚æœ‰è¿‘ 1 å¹´æ—¶é—´</p>
<p>æ—©ä¸Šè€å¦¹å‘æ¥è¯­éŸ³è¯´ï¼Œæ”¾å‡å›å®¶çš„ï¼ˆæœ¬æ¥è¯´å¥½è¦QQå’Œè€å¦¹èŠå¤©ï¼ŒåŠ ç­åˆ°9ï¼š30å°±å¿˜è®°å•¦ğŸ˜›ï¼‰</p>
<p>16å¹´7æœˆ1å·ç¦»å¼€æ±•å¤´ï¼ˆå¤´å¤§ï¼‰æˆªæ­¢åˆ°ä»Šå¤©å·®ä¸å¤šåŠå¹´æ—¶é—´</p>
<p>ä¸€å¹´æ¥ä»å­¦ç”Ÿæˆé•¿ä¸ºç¤¾ä¼šå·¥ä½œçš„ 90 åï¼Œå…¬å¸ä¸åƒå­¦æ ¡å¯ä»¥è‡ªç”±çš„çŠ¯é”™</p>
<p>åœ¨è¿™é‡Œå‘†çš„ä¹…å•¦ï¼Œæ„Ÿè§‰å­¦æ ¡é‡ŒåŸæ¥å¾ˆéš¾åšåˆ°çš„äº‹æƒ…è¶Šæ¥åªè¦å’¬ç‰™åšæŒå°±å¯ä»¥å®Œæˆ</p>
<h3 id="16è§‚å¿µ"><a href="#16è§‚å¿µ" class="headerlink" title="16è§‚å¿µ"></a>16è§‚å¿µ</h3><blockquote>
<ul>
<li><p>ä»¥å‰çš„ 8 åƒç±³å¯¹æˆ‘æ¥è¯´å¾ˆéš¾ï¼Œç°åœ¨ 20 åƒç±³ä¹Ÿæ˜¯å¯ä»¥å®Œæˆçš„</p>
</li>
<li><p>ä»¥å‰çš„è‡ªå·±ä¸»å¼ è¯»ä¹¦æ— ç”¨è®ºï¼Œç°åœ¨è‡ªå·±ä¼šä¸»åŠ¨ä¹°ä¹¦ğŸ“šæ¥çœ‹</p>
</li>
<li><p>ä»¥å‰çš„è‡ªå·±åªçŸ¥é“å¾€å‰èµ°ï¼Œç°åœ¨è‡ªå·±ä¼šæ¯å¤©å¤ç›˜ä¸€å¤©ä¸­äº‹æƒ…æŸ¥æ‰¾ä¸è¶³</p>
</li>
<li><p>ä»¥å‰çš„è‡ªå·±ä¸ä¼šå¦¥åï¼Œç°åœ¨è‡ªå·±çŸ¥é“åªè¦å¤§æ–¹å‘ä¸å˜å¯ä»¥ä¸´æ—¶åšå‡ºæ”¹å˜</p>
</li>
<li><p>ä»¥å‰çš„è‡ªå·±çŸ¥é“è¯´æœåˆ«äººï¼Œç°åœ¨è‡ªå·±çŸ¥é“æ²Ÿé€šéœ€è¦å¬ğŸ‘‚å¯¹æ–¹æ‰€è®²</p>
</li>
<li><p>ä»¥å‰è‡ªå·±åªçŸ¥é“å–œæ¬¢ä¸€ä¸ªäººå°±æƒ³æ—¶åˆ»çŸ¥é“è¿‘å†µï¼Œç°åœ¨è‡ªå·±çœ‹åˆ°å¥¹çš„å¼€å¿ƒå°±æ„Ÿåˆ°æ¬£å–œ</p>
</li>
<li><p>ä»¥å‰è‡ªå·±æ‹¥æœ‰æ¢¦æƒ³ä½†æ‰€åšå¾ˆå°‘ï¼Œç°åœ¨è‡ªå·±è„šè¸å®åœ°å¹¶å­¦ä¼šä¸ä»–äººåˆ†äº«æ¢¦æƒ³</p>
</li>
</ul>
</blockquote>
<h3 id="16æ‰€åš"><a href="#16æ‰€åš" class="headerlink" title="16æ‰€åš"></a>16æ‰€åš</h3><blockquote>
<ul>
<li><p>E å‡ºè¡Œç›®å‰è¿˜åœ¨æ±•å¤§ä¸ºæ±•å¤§å­¦å­æœåŠ¡</p>
</li>
<li><p>åä¸€èƒŒèµ·è¡Œå›Šåˆ°è¾¾å¤§å­¦æœŸé—´æœ€æƒ³å»çš„åœ°æ–¹~æ‹‰è¨ï¼Œè·¯ç¨‹ä¸­é‡è§ä¸€ä½åœ¨æ­å·çš„åšITè€ä¹¡å“¥ä»¬ï¼Œç¢°åˆ°ä¸€ä½æ­å·ç”Ÿæ„äºº;é€›è¿‡æ‹‰è¨çš„å¯ºåº™ï¼Œæ²¡æœ‰ç•™ä¸‹ä¸€å¼ ç…§ç‰‡</p>
</li>
<li><p>å¤©æ²³å…¬å›­ç‹¬è‡ªä¸€ä¸ªäººè¿ç»­è·‘è¿‘ 5 ä¸ªå°æ—¶ï¼Œç¬¬ä¸€æ¬¡å®Œæˆ 20 å¤šå…¬é‡Œ</p>
</li>
<li><p>åšè¿‡ç›®å‰æœ€åæ‚”çš„äº‹ï¼Œè®©ä¸€ä½å¤§ç¾å¥³ç‹‚æ€’ğŸ˜‚</p>
</li>
<li><p>åšè¿‡æœ€è ¢çš„äº‹ï¼ŒæŠŠæ¥¼ä¸Šå¤§ç¾å¥³åˆ é™¤ï¼ˆ16å¹´è ¢äº‹çš„é›†åˆéƒ½æ²¡æœ‰è¿™ä¸ªé—®é¢˜å¤§ï¼‰</p>
</li>
</ul>
</blockquote>
<h2 id="17å¹´å±•æœ›"><a href="#17å¹´å±•æœ›" class="headerlink" title="17å¹´å±•æœ›"></a>17å¹´å±•æœ›</h2><h3 id="17å››ä»¶äº‹"><a href="#17å››ä»¶äº‹" class="headerlink" title="17å››ä»¶äº‹"></a>17å››ä»¶äº‹</h3><blockquote>
<ul>
<li><p>(1)æƒ³åŠæ³•è®©æ¥¼ä¸Šå¤§ç¾å¥³åŸè°…æˆ‘ï¼Œå¯ä»¥æ­£å¸¸é¢å¯¹æˆ‘</p>
</li>
<li><p>(2)å®Œæˆè‡ªå·±è€ƒé›…æ€è®¡åˆ’</p>
</li>
<li><p>(3)å‚åŠ è‡³å°‘ 3 æ¬¡é©¬æ‹‰æ¾èµ›äº‹</p>
</li>
<li><p>(4)è¿›è¡Œé—´éš”å°é—­å¼ç¼–ç¨‹è®­ç»ƒï¼Œå¹´åº•æˆ–åå¹´æš‘å‡è¿›å…¥ä¸€çº¿äº’è”ç½‘å…¬å¸</p>
</li>
</ul>
</blockquote>
<h3 id="17å·¥ä½œ"><a href="#17å·¥ä½œ" class="headerlink" title="17å·¥ä½œ"></a>17å·¥ä½œ</h3><blockquote>
<ul>
<li><p>åŠªåŠ›å·¥ä½œ</p>
</li>
<li><p>åé¢åŠ ç­å°†æˆä¸ºå¸¸æ€</p>
</li>
<li><p>æŠŠè‡ªå·±æƒ³å­¦ä¹ çš„ä¸œè¥¿ä¸€ä¸€å®ç°</p>
</li>
</ul>
</blockquote>
<h4 id="åè®°"><a href="#åè®°" class="headerlink" title="åè®°"></a>åè®°</h4><p>ğŸ™ˆåé¢å°†ä¼šæ…¢æ…¢æ·»åŠ å’Œä¿®æ”¹ï¼Œä½† 17 å¹´å››ä»¶äº‹ä¸å˜ğŸ™ˆ</p>

      

      
    </div>
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<i class="icon-price-tags icon"></i>
		<ul class="article-tag-list">
			 
        		<li class="article-tag-list-item">
        			<a href="javascript:void(0)" class="js-tag article-tag-list-link color3">éšç¬”</a>
        		</li>
      		
		</ul>
	</div>

      
	<div class="article-category tagcloud">
		<i class="icon-book icon"></i>
		<ul class="article-tag-list">
			 
        		<li class="article-tag-list-item">
        			<a href="/categories/éšç¬”/" class="article-tag-list-link color3">éšç¬”</a>
        		</li>
      		
		</ul>
	</div>


      
        <p class="article-more-link">
          <a class="article-more-a" href="/2017/01/16/16æ€»ç»“-17å±•æœ›/">å±•å¼€å…¨æ–‡ >></a>
        </p>
      

      
      <div class="clearfix"></div>
    </div>
  </div>
</article>





  
    <article id="post-APPæ§ä»¶åœ¨å±å¹•ä¸Šæ˜¾ç¤º" class="article article-type-post  article-index" itemscope itemprop="blogPost">
  <div class="article-inner">
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/01/13/APPæ§ä»¶åœ¨å±å¹•ä¸Šæ˜¾ç¤º/">APPæ§ä»¶åœ¨å±å¹•ä¸Šæ˜¾ç¤º</a>
    </h1>
  

        
        <a href="/2017/01/13/APPæ§ä»¶åœ¨å±å¹•ä¸Šæ˜¾ç¤º/" class="archive-article-date">
  	<time datetime="2017-01-13T13:57:36.000Z" itemprop="datePublished"><i class="icon-calendar icon"></i>2017-01-13</time>
</a>
        
      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="APPæ§ä»¶åœ¨å±å¹•ä¸Šæ˜¾ç¤º"><a href="#APPæ§ä»¶åœ¨å±å¹•ä¸Šæ˜¾ç¤º" class="headerlink" title="APPæ§ä»¶åœ¨å±å¹•ä¸Šæ˜¾ç¤º"></a>APPæ§ä»¶åœ¨å±å¹•ä¸Šæ˜¾ç¤º</h1><p>åœ¨æ¯ä¸ª APP ä¸­å¦‚æœæƒ³è¦å®ç°ç•Œé¢çš„ç²¾ç¾ï¼Œå¤šæ•°æƒ…å†µä¸‹æˆ‘ä»¬éœ€è¦å¯¹ç›¸å…³æ§ä»¶è¿›è¡Œåˆ†è£…ï¼Œé‡‡ç”¨CocoaPodsè¿›è¡Œæ’ä»¶åŒ–ç®¡ç†ã€‚<br>ä½†æ˜¯æˆ‘ä»¬åœ¨ç¨‹åºé‡Œçš„ç©ºé—´æ˜¯æ€ä¹ˆæ˜¾ç¤ºåœ¨å±å¹•ä¸Šçš„ï¼Œä¸‹é¢å°†åˆç•¥çš„è®²è¿°å±å¹•ä¸Šæ˜¾ç¤ºæ§ä»¶çš„è¿‡ç¨‹ã€‚</p>
<h1 id="æ–‡ç« çŸ¥è¯†ç‚¹è®²è¿°çš„æ€è·¯"><a href="#æ–‡ç« çŸ¥è¯†ç‚¹è®²è¿°çš„æ€è·¯" class="headerlink" title="æ–‡ç« çŸ¥è¯†ç‚¹è®²è¿°çš„æ€è·¯"></a>æ–‡ç« çŸ¥è¯†ç‚¹è®²è¿°çš„æ€è·¯</h1><p>ä½¿ç”¨ Xmind æ¥å±•ç¤ºåšå®¢è®²è¿° APP æ§ä»¶åœ¨å±å¹•ä¸Šæ˜¾ç¤ºçš„æ€è·¯å’Œç›¸å…³çŸ¥è¯†ç‚¹çš„æ•´ç†æ€è·¯ï¼Œå…·ä½“æ€è·¯çœ‹ä¸‹å›¾ï¼š</p>
<p><img src="/images/APPæ§ä»¶åœ¨å±å¹•ä¸Šæ˜¾ç¤º.png" alt="APP æ§ä»¶åœ¨å±å¹•ä¸Šæ˜¾ç¤º"></p>
<h2 id="å±å¹•æ˜¾ç¤ºå›¾åƒçš„åŸç†"><a href="#å±å¹•æ˜¾ç¤ºå›¾åƒçš„åŸç†" class="headerlink" title="å±å¹•æ˜¾ç¤ºå›¾åƒçš„åŸç†"></a>å±å¹•æ˜¾ç¤ºå›¾åƒçš„åŸç†</h2><p>è®°å¾—ç¬¬ä¸€å°ç”µè§†æœºæ˜¯æœ€è€å¼çš„é»‘ç™½ç”µè§†æœºï¼Œä¸Šé¢å…·å¤‡å¤©çº¿ã€éœ€è¦æ‰‹åŠ¨è½¬åŠ¨æ—‹è½¬è°ƒå°é‚£ç§ï¼Œç›®å‰è¿™ç§ç”µè§†ğŸ“ºå¾ˆå°‘å‡ºç°é¢ã€‚<br>ä¸Šé¢é‚£ç§è€å¼çš„ç”µè§†æœºç”»é¢çš„æ˜¾ç¤ºå°±æ˜¯é‡‡ç”¨ CRT æ˜¾ç¤ºï¼Œæ˜¾ç¤ºçš„åŸç†å¦‚ä¸‹å›¾ï¼š</p>
<p><img src="/images/CRT.png" alt="CRT æ‰«æè¿‡ç¨‹æ¨¡æ‹Ÿ"></p>
<p>å…¶åŸç†ï¼šCRT æŒ‰ç…§ä¸Šé¢å›¾ç‰‡å±•ç¤ºçš„é‚£æ ·ï¼Œä»ä¸Šåˆ°ä¸‹è¿›è¡Œé€è¡Œæ‰«æï¼Œå½“æ‰«æå®Œæˆå°±ä¼šæ˜¾ç¤ºä¸€æ•´å¼ å›¾åƒï¼Œéšåç”µå­æªå›åˆ°åŸæ¥çš„ä½ç½®ä»å¤´å¼€å§‹è¿›è¡Œå›¾åƒç´ æçš„æ‰«æã€‚å…·ä½“çš„è¿‡ç¨‹å½“æ˜¾ç¤ºå™¨æ‰«å®Œä¸€è¡Œæ¢åˆ°æ–°çš„ä¸€è¡Œï¼Œæ˜¾ç¤ºå™¨å°±ä¼šå‘å‡ºä¸€ä¸ªæ°´å¹³ä¿¡å·ï¼š<strong>HSync</strong>ï¼Œå½“æ˜¾ç¤ºå™¨æ‰«å®Œæ•´å¼ çš„å›¾ç‰‡åç”µå­è¿›è¡Œå¤ä½ï¼Œå¼€å§‹ä¸‹ä¸€æ¬¡çš„é‡æ–°æ‰«æï¼Œæ˜¾ç¤ºå™¨ä¹Ÿä¼šå‘å‡ºä¸€ä¸ªæ–°çš„å‚ç›´ä¿¡å·ï¼š<strong>VSync</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">æˆ‘ä»¬ APP åœ¨å±å¹•ä¸Šçš„åˆ·æ–°çš„é¢‘ç‡å°±æ˜¯ VSync ä¿¡å·äº§ç”Ÿçš„é¢‘ç‡ï¼Œæ‰€ä»¥æˆ‘ä»¬åœ¨è§£å†³ç•Œé¢å¡é¡¿çš„è¿‡ç¨‹å°±è¦æ ¹æ® VSync çš„åŸºç¡€ä¸Šè¿›è¡Œç›¸å…³çš„å®Œå–„å’Œä¼˜åŒ–</span><br></pre></td></tr></table></figure>
<p>ğŸ‘ˆğŸ‘ˆğŸ‘ˆğŸ‘ˆğŸ‘ˆğŸ‘ˆç›®å‰æˆ‘ä»¬ä¸€èˆ¬æ˜¯é‡‡å–åŒç¼“å†²çš„æœºåˆ¶ï¼Œ GPUä¼šé¢„å…ˆç¼“å†²å¥½ä¸€å¸§å­˜æ”¾åœ¨ç¼“å†²ä¸­ï¼Œè®©è§†é¢‘æ§åˆ¶å™¨è¯»å–ï¼Œå½“ä¸‹ä¸€é˜µæ¸²æŸ“å¥½ï¼Œå°±ç›´æ¥æŠŠè§†é¢‘æ§åˆ¶å™¨çš„æŒ‡é’ˆæŒ‡å‘ç¬¬äºŒä¸ªç¼“å†²å™¨ ï¼š è¿™æ ·åšçš„å¥½å¤„å°±æ˜¯å¯ä»¥å¤§å¤§æé«˜ç¼“å†²çš„æ•ˆç‡é—®é¢˜ğŸ‘‰ğŸ¿ğŸ‘‰ğŸ¿ğŸ‘‰ğŸ¿ğŸ‘‰ğŸ¿ğŸ‘‰ğŸ¿ğŸ‘‰ğŸ¿</p>
<p>é‡‡ç”¨åŒç¼“å­˜å¯èƒ½ä¼šå¼•å…¥ä¸€ä¸ªé—®é¢˜å°±æ˜¯å±å¹•å†…å®¹æ˜¾ç¤ºä¸€åŠï¼Œ GPU å°†æ–°çš„å†…å®¹æäº¤åˆ°ç¼“å­˜åŒºå¯¹å…¶è¿›è¡Œäº¤æ¢ï¼Œè§†é¢‘æ§åˆ¶å™¨æŠŠæ–°çš„ä¸‹åŠæ®µçš„æ˜¾ç¤ºåœ¨å±å¹•ä¸Š<br>å¯èƒ½å½¢æˆç”»é¢æ’•è£‚ï¼Œ<br>è§£å†³æ–¹å¼ï¼šGPU å¼•å…¥å‚ç›´åŒæ­¥ï¼ˆV-Syncï¼‰å½“å¼€å¯å‚ç›´åŒæ­¥åï¼Œ GPUä¼šç­‰å¾… VSync ä¿¡å·å‘å‡ºï¼Œæ‰ä¼šå¯¹ç¼“å­˜çš„å†…å®¹è¿›è¡Œæ›´æ–°ï¼Œè¿™æ ·å°±å¯ä»¥æ˜¯ç”»é¢æ›´åŠ æµç•…ï¼Œå‡å°‘å»¶è¿Ÿ</p>
<p>ğŸ˜€ğŸ˜†ğŸ˜†ğŸ˜†ğŸ˜†ğŸ˜†ğŸ˜†ğŸ˜†ğŸ˜†ğŸ˜†ğŸ˜†ğŸ˜†ğŸ˜†ğŸ˜†ğŸ˜†ğŸ˜†ğŸ˜†ğŸ˜†ğŸ˜†ğŸ˜†ğŸ˜†ğŸ˜†</p>
<p>iOS è®¾å¤‡é‡‡ç”¨åŒç¼“å­˜ + å‚ç›´åŒæ­¥ï¼› Androidé‡‡ç”¨çš„ä¸‰ç¼“å­˜ + å‚ç›´åŒæ­¥</p>
<p>ğŸ˜†ğŸ˜†ğŸ˜†ğŸ˜†ğŸ˜†ğŸ˜†ğŸ˜†ğŸ˜†ğŸ˜†ğŸ˜†ğŸ˜†ğŸ˜†ğŸ˜†ğŸ˜†ğŸ˜†ğŸ˜†ğŸ˜†ğŸ˜†ğŸ˜†ğŸ˜†ğŸ˜†ğŸ˜</p>
<p>åœ¨ä¸€äº›æ¸¸æˆä¸­æˆ‘ä»¬ç»å¸¸ä¼šè§åˆ°ä¸€äº›åœºæ™¯å¦‚ä¸‹ï¼š</p>
<p><img src="/images/å±å¹•é”™ä½.png" alt="å±å¹•é”™ä½"></p>
<h2 id="CPUå’ŒGPUçš„å·¥ä½œåŸç†"><a href="#CPUå’ŒGPUçš„å·¥ä½œåŸç†" class="headerlink" title="CPUå’ŒGPUçš„å·¥ä½œåŸç†"></a>CPUå’ŒGPUçš„å·¥ä½œåŸç†</h2><h3 id="CPUå·¥ä½œåŸç†"><a href="#CPUå·¥ä½œåŸç†" class="headerlink" title="CPUå·¥ä½œåŸç†"></a>CPUå·¥ä½œåŸç†</h3><p>CPUï¼ˆä¸­å¤®å¤„ç†å™¨ï¼ŒCentral Processing Unitï¼‰ä¸»è¦æ˜¯è§£é‡Šè®¡ç®—æœºä¸­çš„æŒ‡ä»¤ï¼Œå¤„ç†è®¡ç®—æœºè½¯ä»¶ä¸­çš„æ•°æ®ã€‚CPUã€å†…éƒ¨å­˜å‚¨å™¨å’Œè¾“å…¥/è¾“å‡ºè®¾å¤‡æ˜¯è®¡ç®—æœºçš„ä¸‰å¤§æ ¸å¿ƒç»„ä»¶ã€‚</p>
<p>CPUç›®å‰å¾ˆå¤§ä¸€éƒ¨åˆ†æ˜¯é‡‡ç”¨ å†¯Â·è¯ºä¾æ›¼ç»“æ„ï¼Œåœ¨å·¥ä½œçš„è¿‡ç¨‹ä¹‹ä¸­å…¶è¿‡ç¨‹ä¸€èˆ¬å¯ä»¥åˆ†ä¸ºå››ä¸ªé˜¶æ®µï¼šæå–ã€è§£ç ã€æ‰§è¡Œå’Œè°ƒå›</p>
<p>æå–ï¼š<br>è§£ç ï¼š<br>æ‰§è¡Œï¼š<br>è°ƒå›ï¼š</p>
<p><img src="/images/CPU.png" alt="CPU AMD Opteronå…­æ ¸å¿ƒå¤„ç†å™¨"></p>
<h3 id="GPUå·¥ä½œåŸç†"><a href="#GPUå·¥ä½œåŸç†" class="headerlink" title="GPUå·¥ä½œåŸç†"></a>GPUå·¥ä½œåŸç†</h3><p>GPUï¼ˆå›¾å½¢å¤„ç†å™¨ï¼ŒGraphics Processing Unitï¼‰ä¸»è¦æ˜¯è¿›è¡Œç»˜å›¾è¿ç®—çš„å¾®å¤„ç†å™¨ï¼Œå¯¹å›¾åƒè¿›è¡Œå¤„ç†å’Œç›¸å…³æ˜¾ç¤ºç»˜åˆ¶å·¥ä½œ<br>åé¢éšç€ OpenGL APL å’Œ DirectX åŠŸèƒ½çš„å‡ºç°ï¼Œå›¾å½¢å¤„ç†å™¨å¯ä»¥å¢åŠ å¯ç¼–ç¨‹ç€è‰²çš„èƒ½åŠ›ï¼Œç›®å‰æˆ‘ä»¬å¤„ç†åœ¨å±å¹•ä¸Šæ˜¾ç¤ºçš„ä»»ä½•åƒç´ ï¼Œä¹Ÿå¯ä»¥åœ¨çº¹ç†åœ¨å±å¹•ä¸Šæ˜¾ç¤ºå‰å’Œæ¯ä¸€ä¸ªå‡ ä½•é¡¶ç‚¹åœ¨æŠ•å°„åˆ°å±å¹•å‰éƒ½å¯ä»¥è¿›è¡Œç›¸å…³çš„å¤„ç†å·¥ä½œ</p>
<h2 id="iOS-ç»˜åˆ¶åƒç´ åœ¨å±å¹•ä¸Š"><a href="#iOS-ç»˜åˆ¶åƒç´ åœ¨å±å¹•ä¸Š" class="headerlink" title="iOS ç»˜åˆ¶åƒç´ åœ¨å±å¹•ä¸Š"></a>iOS ç»˜åˆ¶åƒç´ åœ¨å±å¹•ä¸Š</h2><h3 id="APPç»˜åˆ¶åƒç´ è¿‡ç¨‹åˆ†æ"><a href="#APPç»˜åˆ¶åƒç´ è¿‡ç¨‹åˆ†æ" class="headerlink" title="APPç»˜åˆ¶åƒç´ è¿‡ç¨‹åˆ†æ"></a>APPç»˜åˆ¶åƒç´ è¿‡ç¨‹åˆ†æ</h3><p>ä¸‹é¢ç»˜åˆ¶åƒç´ åœ¨å±å¹•ä¸Šçš„åŸç†å›¾ï¼š</p>
<p><img src="/Images/GPUæ˜¾ç¤º.png" alt="iOS ç»˜åˆ¶åƒç´ åœ¨å±å¹•"></p>
<p>iOS ç•Œé¢ä¸Šçš„å†…å®¹å¤§å¤šæ˜¯é€šè¿‡ Core Animation æ¥å®Œæˆç»˜åˆ¶<br>åœ¨ Mac OS å¤§å¤šæ˜¯ç»•è¿‡ Core Animation ä½¿ç”¨ Core Graphics æ¥è¿›è¡Œç»˜åˆ¶<br>æ‰‹æ¸¸è¡Œä¸šä¸­ç›´æ¥ä½¿ç”¨ OpenGL/OpenGL ES æ¥è¿›è¡Œç›¸å…³æè´¨çš„å†…å®¹ç»˜åˆ¶</p>
<p>Core Animation å¤§å¤šä½¿ç”¨ Core Graphics æ¥è¿›è¡Œå†…å®¹çš„æ¸²æŸ“</p>
<p>GPU Driver æ˜¯ç›´æ¥å’Œ GPU è¿›è¡Œç›¸å…³äº¤äº’çš„ä»£ç å—ï¼Œå¯ä»¥å¯¹å¯¹ GPU ç›´æ¥æ“ä½œ</p>
<p>GPU æ˜¯ä¸“é—¨ä¸ºå›¾å½¢é«˜å¹¶å‘è®¡ç®—é‡èº«å®šåˆ¶çš„å¤„ç†å•å…ƒï¼Œä¼˜ç‚¹ï¼šçŸ­æ—¶é—´å¯ä»¥å®ç°å›¾åƒæµ®ç‚¹è¿ç®—ï¼Œè€—ç”µå°‘ï¼Œé«˜æ•ˆ</p>
<h3 id="APPç»˜åˆ¶åƒç´ ç¡¬ä»¶åˆ†æ"><a href="#APPç»˜åˆ¶åƒç´ ç¡¬ä»¶åˆ†æ" class="headerlink" title="APPç»˜åˆ¶åƒç´ ç¡¬ä»¶åˆ†æ"></a>APPç»˜åˆ¶åƒç´ ç¡¬ä»¶åˆ†æ</h3><p><img src="/images/GPUç¼“å­˜.png" alt="iOS ç»˜åˆ¶åƒç´ éœ€è¦çš„ç¡¬ä»¶"></p>
<p>åœ¨å›¾ç‰‡æ˜¾ç¤ºçš„è¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬éœ€è¦ç›¸å…³çš„ GPU å¯¹å›¾ç‰‡ç”Ÿæˆ frame çš„çº¹ç†ï¼Œ<br>æˆ‘ä»¬åœ¨ç”Ÿæˆçº¹ç†çš„è¿‡ç¨‹ä¸­ä¼šä½¿ç”¨ VRAM çš„ç©ºé—´ï¼Œæ‰€ä»¥åœ¨ç”Ÿæˆè¿‡ç¨‹æ˜¯æœ‰é™åˆ¶çš„<br>æŠŠç›¸å…³çš„æ•°æ®ä» CPU ä¸Šä¼ è¾“åˆ° GPU ä¸Š â€”â€”&gt; æ—¢æ˜¯æŠŠå†…å®¹ä» RAM ä¸Šä¼ åˆ° VRAM ä¸Šï¼Œ å¦‚æœä¸Šä¼ çš„çº¹ç†å¤ªå¤§å°±ä¼šå¯¹æ€§èƒ½æœ‰æ‰€å½±å“</p>
<p>åœ¨æ–‡æœ¬æ˜¾ç¤ºçš„è¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨ GPU è¿›è¡Œæ–‡æœ¬çš„ç»˜åˆ¶æ¯”è¾ƒå¤æ‚ï¼Œè¿™ä¼šä¿ƒä½¿ Core Text å’Œ Core Graphics æ¥åˆæˆç”Ÿæˆä¸€ä¸ªæ–‡æœ¬ï¼Œç„¶åä¸Šä¼ åˆ° GPUã€‚<br>ä½†æˆ‘ä»¬åœ¨ç•Œé¢æ»‘åŠ¨è¿‡ç¨‹ä¸­ï¼Œ CPU åªéœ€è¦æŠŠç›¸å…³çš„æ–‡æœ¬åæ ‡å‘é€åˆ° GPU å°±è¡Œï¼Œ GPUä¼šæ ¹æ®ç›¸å…³çš„ä¿¡æ¯è¿›è¡Œç»˜åˆ¶</p>
<h3 id="APPç»˜åˆ¶è¿‡ç¨‹æ–¹å¼å’Œç»†èŠ‚è®²è§£"><a href="#APPç»˜åˆ¶è¿‡ç¨‹æ–¹å¼å’Œç»†èŠ‚è®²è§£" class="headerlink" title="APPç»˜åˆ¶è¿‡ç¨‹æ–¹å¼å’Œç»†èŠ‚è®²è§£"></a>APPç»˜åˆ¶è¿‡ç¨‹æ–¹å¼å’Œç»†èŠ‚è®²è§£</h3><h4 id="åˆæˆï¼š"><a href="#åˆæˆï¼š" class="headerlink" title="åˆæˆï¼š"></a>åˆæˆï¼š</h4><p>åœ¨æˆ‘ä»¬çœ‹åˆ°çš„æ‰€æœ‰çš„è§†å›¾éƒ½æ˜¯åŸºäºä¸åŒå›¾ç‰‡è¿›è¡Œç›¸å…³çš„åˆæˆè€Œæ¥<br>è¿™é‡Œæˆ‘ä¹ˆå‡†å®ˆä¸€åˆ‡çš„å›¾åƒçš†çº¹ç†çš„æ¦‚å¿µï¼Œå½“æŠŠç¬¬äºŒä¸ªçº¹ç†é®åœ¨ç¬¬ä¸€ä¸ªçº¹ç†ä¸Šæ—¶ï¼Œ GPU å°±ä¼šæŠŠç¬¬äºŒä¸ªçº¹ç†åˆæˆåˆ°ç¬¬ä¸€ä¸ªçº¹ç†ä¸­</p>
<blockquote>
<ul>
<li>åˆæˆæ–¹æ³•å¾ˆå¤šç§ï¼š</li>
<li>å¦‚æœä¸¤ä¸ªçº¹ç†å¯¹å…¶æ—¶ï¼šé‡‡ç”¨å…¬å¼    â€”â€”&gt;    R(æœ€ç»ˆæ˜¾ç¤ºçš„è‰²å½©çš„å€¼) = S(ä¸Šå±‚çº¹ç†çš„ç›¸å…³çš„å‚æ•°) +D(ä¸‹å±‚çº¹ç†ç›¸å…³å‚æ•°) * (1 - Sa(ä¸Šå±‚çº¹ç†çš„é€æ˜åº¦))</li>
</ul>
</blockquote>
<h4 id="é€æ˜-VS-ä¸é€æ˜ï¼š"><a href="#é€æ˜-VS-ä¸é€æ˜ï¼š" class="headerlink" title="é€æ˜ VS ä¸é€æ˜ï¼š"></a>é€æ˜ VS ä¸é€æ˜ï¼š</h4><p>å½“çº¹ç†å®Œå…¨ä¸é€æ˜æ—¶ç›®æ ‡åƒç´ å°±æ˜¯çº¹ç†çš„å€¼ï¼Œ GPU å°±åªä¼šä»ç›®æ ‡åƒç´ ç›´æ¥å–å‡ºçº¹ç†æ˜¾ç¤º ä¸ä¼šåšç›¸å…³çš„æ“ä½œ<br>åœ¨åŠ è½½ä¸€å¼ æ²¡æœ‰  alpha çš„å›¾ç‰‡è¿›è¡Œæ˜¾ç¤ºï¼Œä¼šè¢«é»˜è®¤ä¸º opaque çš„å±æ€§æ˜¯ YES ï¼› åŠ è½½ä¸€å¼ å›¾ç‰‡ alpha = 100%ï¼Œ Core Animation ä¼šè®¤ä¸ºæ˜¯ä¸ä¸º 100% å¯¹å…¶è¿›è¡Œè§£æ</p>
<h4 id="åƒç´ å¯¹å…¶-VS-ä¸é‡åˆåœ¨ä¸€èµ·ï¼š"><a href="#åƒç´ å¯¹å…¶-VS-ä¸é‡åˆåœ¨ä¸€èµ·ï¼š" class="headerlink" title="åƒç´ å¯¹å…¶ VS ä¸é‡åˆåœ¨ä¸€èµ·ï¼š"></a>åƒç´ å¯¹å…¶ VS ä¸é‡åˆåœ¨ä¸€èµ·ï¼š</h4><p>å½“ä¸¤ä¸ª layer å®Œå…¨é‡åˆåœ¨ä¸€èµ·ï¼Œè¿™æ—¶å°±éœ€è¦æˆ‘ä»¬å¯¹å…¶è¿›è¡Œç›¸å…³çš„è®¡ç®—<br>layer ä¸Šæ‰€æœ‰çš„åƒç´ å’Œå±å¹•ä¸Šçš„åƒç´ å®Œå…¨å¯¹å…¶ï¼Œè¿™å°±æ˜¯ layer åƒç´ å¯¹å…¶ï¼› </p>
<ol>
<li>åƒç´ å¯¹ä¸é½ä¸»è¦åŸå› ï¼š<blockquote>
<ul>
<li>ç¼©æ”¾ï¼Œåœ¨å›¾åƒè¿›è¡Œç¼©æ–¹æ—¶ï¼Œlayer å’Œå±å¹•çš„åƒç´ å¾ˆéš¾å¯¹å…¶</li>
<li>çº¹ç†çš„èµ·ç‚¹åœ¨åœ¨ä¸€ä¸ªåƒç´ çš„è¾¹ç•Œ </li>
<li>åœ¨åƒç´ ä¸å¯¹å…¶çš„æƒ…å†µä¸‹å¯èƒ½ä¼šè¦ç»è¿‡è¿‡å¤šçš„è¿ç®—ï¼Œ åœ¨ Core Animation å’Œ æ¨¡æ‹Ÿå™¨ä¸­ color misaligned images çš„é€‰é¡¹å¯ä»¥è¿›è¡Œç›¸å…³çš„è°ƒèŠ‚</li>
</ul>
</blockquote>
</li>
</ol>
<h4 id="ç¦»å±æ¸²æŸ“ï¼š"><a href="#ç¦»å±æ¸²æŸ“ï¼š" class="headerlink" title="ç¦»å±æ¸²æŸ“ï¼š"></a>ç¦»å±æ¸²æŸ“ï¼š</h4><p>ç¦»å±æ¸²æŸ“ä¼š  åˆå¹¶/æ¸²æŸ“ å›¾å±‚æ ‘ä¸€éƒ¨åˆ†åˆ°ä¸€ä¸ªæ–°çš„ç¼“å­˜åŒºï¼Œç„¶åè¯¥ç¼“å†²åŒºè¢«æ¸²æŸ“åˆ°å±å¹•ä¸Š</p>
<blockquote>
<ul>
<li>ç¦»å±æ¸²æŸ“ä¹Ÿå¯èƒ½äº§ç”Ÿå‰¯ä½œç”¨ã€‚å¦‚æœä½ æ­£åœ¨ç›´æ¥æˆ–è€…é—´æ¥çš„å°†maskåº”ç”¨åˆ°ä¸€ä¸ªå›¾å±‚ä¸Šï¼ŒCore Animation ä¸ºäº†åº”ç”¨è¿™ä¸ª maskï¼Œä¼šå¼ºåˆ¶è¿›è¡Œå±å¹•å¤–æ¸²æŸ“ã€‚è¿™ä¼šå¯¹ GPU äº§ç”Ÿé‡è´Ÿã€‚é€šå¸¸æƒ…å†µä¸‹ mask åªèƒ½è¢«ç›´æ¥æ¸²æŸ“åˆ°å¸§çš„ç¼“å†²åŒºä¸­(åœ¨å±å¹•å†…)</li>
<li>Instrument çš„ Core Animation å·¥å…·æœ‰ä¸€ä¸ªå«åš Color Offscreen-Rendered Yellow çš„é€‰é¡¹ï¼Œå®ƒä¼šå°†å·²ç»è¢«æ¸²æŸ“åˆ°å±å¹•å¤–ç¼“å†²åŒºçš„åŒºåŸŸæ ‡æ³¨ä¸ºé»„è‰²(è¿™ä¸ªé€‰é¡¹åœ¨æ¨¡æ‹Ÿå™¨ä¸­ä¹Ÿå¯ä»¥ç”¨)ã€‚åŒæ—¶è®°å¾—æ£€æŸ¥ Color Hits Green and Misses Red é€‰é¡¹ã€‚ç»¿è‰²ä»£è¡¨æ— è®ºä½•æ—¶ä¸€ä¸ªå±å¹•å¤–ç¼“å†²åŒºè¢«å¤ç”¨ï¼Œè€Œçº¢è‰²ä»£è¡¨å½“ç¼“å†²åŒºè¢«é‡æ–°åˆ›å»º</li>
</ul>
</blockquote>
<p>rasterized layer çš„ç¼“å†²åŒºå¤§å°æ˜¯æœ‰æ‰€é™åˆ¶çš„ï¼Œå¤§æ¦‚æ˜¯å±å¹•å¤§å°çš„ä¸¤å€ç©ºé—´ å±å¹•å¤–çš„ç¼“å†²åŒº</p>
<h4 id="CALayerï¼š"><a href="#CALayerï¼š" class="headerlink" title="CALayerï¼š"></a>CALayerï¼š</h4><p>GPU æµ‹è¯•çš„æ­¥éª¤ï¼š<br>è¦å‘Šè¯‰ä½ ï¼Œå¦‚æœæ˜¯ GPU é™åˆ¶äº†ä½ çš„æ€§èƒ½ï¼Œä½ å¯ä»¥ä½¿ç”¨ OpenGL ES Driver instrumentã€‚ç‚¹å‡»ä¸Šé¢é‚£ä¸ªå°çš„ i æŒ‰é’®ï¼Œé…ç½®ä¸€ä¸‹ï¼ŒåŒæ—¶æ³¨æ„å‹¾é€‰ Device Utilization %ã€‚ç°åœ¨ï¼Œå½“ä½ è¿è¡Œä½ çš„ app æ—¶ï¼Œä½ å¯ä»¥çœ‹åˆ°ä½  GPU çš„è´Ÿè·ã€‚å¦‚æœè¿™ä¸ªå€¼é è¿‘ 100%ï¼Œé‚£ä¹ˆä½ å°±éœ€è¦æŠŠä½ å·¥ä½œçš„é‡å¿ƒæ”¾åœ¨GPUæ–¹é¢äº†ã€‚</p>
<h4 id="Core-Graphics-amp-Quartz-2Dï¼š"><a href="#Core-Graphics-amp-Quartz-2Dï¼š" class="headerlink" title="Core Graphics &amp; Quartz 2Dï¼š"></a>Core Graphics &amp; Quartz 2Dï¼š</h4><p>Core Graphics æ˜¯åŠŸèƒ½å¼ºå¤§çš„ç»˜å›¾æ¡†æ¶</p>
<p>GPUåŠ é€Ÿä¸‹çš„å›¾åƒå¤„ç†ï¼š<br>å¥½çš„å›¾åƒå¤„ç†çš„å¼€æºç¬¬ä¸‰æ–¹æ¡†æ¶ï¼š</p>
<p>GPUImage ï¼š<a href="https://github.com/BradLarson/GPUImage" target="_blank" rel="external">https://github.com/BradLarson/GPUImage</a></p>
<p>ShaderToy :  <a href="https://www.shadertoy.com" target="_blank" rel="external">https://www.shadertoy.com</a></p>
<p>Shaderific :  <a href="http://www.shaderific.com" target="_blank" rel="external">http://www.shaderific.com</a></p>
<p>ç€è‰²å™¨çš„è°ƒè¯• ï¼šæ˜¯æµ‹ç®—å¸§æ¸²æŸ“çš„æ—¶é—´ï¼Œä¸æ˜¯ 1s æ¸²æŸ“å¤šå°‘å¸§<br>FPSæ˜¯å¸§æ—¶é—´çš„å€’æ•°ï¼Œå¸§æ¸²æŸ“çš„æ—¶é—´ï¼šæ˜¯å¸§å¼€å§‹å¤„ç†åˆ°å®Œå…¨ç»“æŸå¹¶ä¸”æ¸²æŸ“åˆ°å±å¹•æˆ–è€…ä¸€å¼ å›¾ç‰‡æ‰€èŠ±è´¹çš„æ—¶é—´ã€‚</p>
<p>ğŸ‘‰ğŸ¿ åœ¨ç§»åŠ¨ç«¯çš„ GPU ä¸­æœ‰å¾ˆå¤šæ˜¯ æŠŠæŒ‡ä»¤é›†ä¸­èµ·æ¥ï¼Œæœ€åç»Ÿä¸€åšä¸€æ¬¡æ¸²æŸ“  â€”â€”&gt; åœ¨æµ‹è¯•æ—¶éœ€è¦æµ‹è¯•æ•´ä¸ªè¿‡ç¨‹ï¼Œè€Œä¸æ˜¯ä¸€ä¸ªä¸­é—´è¿‡ç¨‹</p>
<p><a href="http://www.sunsetlakesoftware.com/2013/10/21/optimizing-gaussian-blurs-mobile-gpu" target="_blank" rel="external">æµ‹è¯•å¤§ğŸ®çš„åšå®¢ ï¼š</a></p>
<p><a href="https://community.imgtec.com/developers/powervr/" target="_blank" rel="external">GPU çš„æµ‹è¯•æ¡†æ¶ï¼š</a></p>
<p>å¦‚æœæƒ³è¦ä¿æŒé«˜çš„å¸§é€Ÿ  å°±è¦ä¿è¯ç€è‰²å™¨æ¯”è¾ƒä½çš„å‘¨æœŸæ•°  ï¼ˆå¦‚æœæ˜¯ 60å¸§æ¯ç§’ï¼Œ é‚£ä¹ˆåœ¨å®Œæˆä¸€ä¸ªå‘¨æœŸå°±éœ€è¦ä»…ä»… 16.67 æ¯«ç§’ï¼‰</p>
<h3 id="é™ä½ç€è‰²å™¨æ¸²æŸ“å‘¨æœŸæ–¹æ³•ï¼š"><a href="#é™ä½ç€è‰²å™¨æ¸²æŸ“å‘¨æœŸæ–¹æ³•ï¼š" class="headerlink" title="é™ä½ç€è‰²å™¨æ¸²æŸ“å‘¨æœŸæ–¹æ³•ï¼š"></a>é™ä½ç€è‰²å™¨æ¸²æŸ“å‘¨æœŸæ–¹æ³•ï¼š</h3><ul>
<li><p>æ¶ˆé™¤æ¡ä»¶é€»è¾‘ ï¼šæ¡ä»¶é€»è¾‘æœ‰æ—¶æ˜¯å¿…é¡»çš„ï¼Œä½†æœ‰æ—¶å¯ä»¥åšä¼˜åŒ–ã€‚ç€è‰²å™¨ä¸­ä½¿ç”¨ stepï¼ˆï¼‰å‡½æ•°å˜é€šé¿å…é€»è¾‘çš„è¿ç”¨</p>
</li>
<li><p>å‡å°‘ä¾èµ–çº¹ç†çš„è¯»å– ï¼šåœ¨ç‰‡æ®µçš„ç€è‰²å™¨å–æ ·æ—¶ï¼Œå¦‚æœçº¹ç†åæ ‡ä¸æ˜¯ä»¥ varying çš„å½¢å¼ä¼ å…¥ï¼Œè€Œæ˜¯åœ¨ç‰‡æ®µç€è‰²å™¨ä¸­è¿›è¡Œè®¡ç®—ï¼Œå°±ä¼šå‘ç”Ÿçº¹ç†ä¾èµ–ã€‚ï¼ˆğŸ‘‰ğŸ¿æƒ³ä»é™„è¿‘çš„åƒç´ å–æ ·ï¼Œè€Œä¸æ˜¯è®¡ç®—å’Œç‰‡æ®µç€è‰²å™¨ä¸­ç›¸é‚»åƒç´ çš„åå·®ï¼Œæœ€å¥½åœ¨é¡¶ç‚¹ç€è‰²å™¨ä¸­è¿›è¡Œè®¡ç®—ï¼Œç„¶åæŠŠç»“æœä»¥ varying çš„æ–¹å¼ä¼ å…¥ç‰‡æ®µç€è‰²å™¨ğŸ‘ˆï¼‰</p>
</li>
<li><p>è®©è®¡ç®—æ›´åŠ ç®€å• ï¼š åœ¨è®¡ç®—è¿‡ç¨‹ä¸­å¦‚æœä½¿ç”¨ç®€å•çš„è®¡ç®—å¯ä»¥å¾—åˆ°ä¸€ä¸ªè¶³å¤Ÿè¿‘ä¼¼çš„å€¼ï¼Œå°±éœ€è¦é¿å…æ˜‚è´µçš„è®¡ç®—æ–¹å¼ï¼ˆä¾‹å¦‚ï¼šsin()ï¼Œcos()ï¼Œtan() ï¼‰</p>
</li>
<li><p>å¦‚æœæœ‰å¯èƒ½çš„è¯ï¼ŒæŠŠç›¸å…³è®¡ç®—ä½¿ç”¨åˆ°é¡¶ç‚¹ç€è‰²å™¨ã€‚    ğŸ˜ ğŸ˜€ğŸ˜ ğŸ˜€ğŸ˜ ğŸ˜€ é¡¶ç‚¹ç€è‰²å™¨æ˜¯æ¯ä¸ªé¡¶ç‚¹è¿è¡Œä¸€æ¬¡ï¼Œç‰‡æ®µç€è‰²å™¨æ˜¯æ¯ä¸€ä¸ªåƒç´ è¿è¡Œä¸€æ¬¡</p>
</li>
</ul>
<p><a href="https://zh.wikipedia.org/wiki/ä¸­å¤®å¤„ç†å™¨" target="_blank" rel="external">CPU çš„å‚è€ƒèµ„æ–™</a></p>
<p><a href="https://zh.wikipedia.org/wiki/åœ–å½¢è™•ç†å™¨" target="_blank" rel="external">GPU çš„å‚è€ƒèµ„æ–™</a></p>
<p><a href="http://blog.ibireme.com/author/ibireme/" target="_blank" rel="external">èµ„æ–™å‚è€ƒ1</a></p>
<p><a href="https://objccn.io/issue-21-7/" target="_blank" rel="external">å‚è€ƒèµ„æ–™2</a></p>
<p><a href="https://objccn.io/issue-21-8/" target="_blank" rel="external">å‚è€ƒèµ„æ–™3</a></p>
<p><a href="https://objccn.io/issue-3-1/" target="_blank" rel="external">å‚è€ƒèµ„æ–™4</a></p>
<p><a href="http://blog.ibireme.com/2015/11/12/smooth_user_interfaces_for_ios/" target="_blank" rel="external">èµ„æ–™çš„å‚è€ƒ5</a></p>

      

      
    </div>
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<i class="icon-price-tags icon"></i>
		<ul class="article-tag-list">
			 
        		<li class="article-tag-list-item">
        			<a href="javascript:void(0)" class="js-tag article-tag-list-link color4">IOS</a>
        		</li>
      		
		</ul>
	</div>

      
	<div class="article-category tagcloud">
		<i class="icon-book icon"></i>
		<ul class="article-tag-list">
			 
        		<li class="article-tag-list-item">
        			<a href="/categories/IOS/" class="article-tag-list-link color4">IOS</a>
        		</li>
      		
		</ul>
	</div>


      
        <p class="article-more-link">
          <a class="article-more-a" href="/2017/01/13/APPæ§ä»¶åœ¨å±å¹•ä¸Šæ˜¾ç¤º/">å±•å¼€å…¨æ–‡ >></a>
        </p>
      

      
      <div class="clearfix"></div>
    </div>
  </div>
</article>





  
    <article id="post-IOSå“åº”è€…é“¾" class="article article-type-post  article-index" itemscope itemprop="blogPost">
  <div class="article-inner">
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/09/09/IOSå“åº”è€…é“¾/">IOSæ•´ä½“æ¡†æ¶</a>
    </h1>
  

        
        <a href="/2016/09/09/IOSå“åº”è€…é“¾/" class="archive-article-date">
  	<time datetime="2016-09-09T06:01:25.000Z" itemprop="datePublished"><i class="icon-calendar icon"></i>2016-09-09</time>
</a>
        
      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p><a href="">å®˜æ–¹æ–‡æ¡£</a><br><a href="http://itangqi.me/2016/04/18/the-first-meet-with-event-delivery/" target="_blank" rel="external">åˆæ¢ iOS äº‹ä»¶åˆ†å‘æœºåˆ¶</a></p>

      

      
    </div>
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<i class="icon-price-tags icon"></i>
		<ul class="article-tag-list">
			 
        		<li class="article-tag-list-item">
        			<a href="javascript:void(0)" class="js-tag article-tag-list-link color4">IOS</a>
        		</li>
      		
		</ul>
	</div>

      
	<div class="article-category tagcloud">
		<i class="icon-book icon"></i>
		<ul class="article-tag-list">
			 
        		<li class="article-tag-list-item">
        			<a href="/categories/IOS/" class="article-tag-list-link color4">IOS</a>
        		</li>
      		
		</ul>
	</div>


      
        <p class="article-more-link">
          <a class="article-more-a" href="/2016/09/09/IOSå“åº”è€…é“¾/">å±•å¼€å…¨æ–‡ >></a>
        </p>
      

      
      <div class="clearfix"></div>
    </div>
  </div>
</article>





  
    <article id="post-ä¸¤å‘¨æ„Ÿæ‚Ÿ~å¹¿å·" class="article article-type-post  article-index" itemscope itemprop="blogPost">
  <div class="article-inner">
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/07/16/ä¸¤å‘¨æ„Ÿæ‚Ÿ~å¹¿å·/">å¹¿å·~ä¸¤å‘¨æ„Ÿæ‚Ÿ</a>
    </h1>
  

        
        <a href="/2016/07/16/ä¸¤å‘¨æ„Ÿæ‚Ÿ~å¹¿å·/" class="archive-article-date">
  	<time datetime="2016-07-15T16:27:32.000Z" itemprop="datePublished"><i class="icon-calendar icon"></i>2016-07-16</time>
</a>
        
      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>ä»æ±•å¤§æ¯•ä¸šæ¥åˆ°å¹¿å·</p>
<hr>
<p>ä»æ±•å¤§æ¯•ä¸šæ¥åˆ°å¹¿å·ï¼Œç›®å‰ä½åœ¨æ£ ä¸‹æ‘å’Œä¸€ä¸ªå¸ˆå…„ä¸€èµ·ä½ï¼Œæ‰“ç®—è¿‡æ®µæ—¶é—´å‡ºå»æ‰¾æˆ¿å­~æ¬å®¶ğŸ˜‰</p>
<hr>
<p>ç¦»å¼€æ±•å¤§æœ¬æ¥æœ‰äº›æ„Ÿä¼¤ï¼Œä½†æ˜¯æ¥åˆ°è¿™ä¸ªè‡ªå·±å¿ƒä¸­æœ‰æ‰€æœŸæœ›çš„åŸå¸‚åˆå€æ„Ÿé«˜å…´ï¼Œå› ä¸ºå¯ä»¥éšæ—¶å»çœ‹æƒ³çœ‹çš„</p>
<hr>
<p>äººğŸ˜šã€‚å¿ƒä¹‹æ‰€å‘ï¼Œå°±ä¼šæœ‰ä¸€ç§å®¶çš„æ„Ÿè§‰ï¼Œè®©è‡ªå·±æ„Ÿåˆ°æ”¾æ¾ï¼å—¨ï¼Œç›®å‰è‡ªå·±æ²¡æœ‰å®Œå…¨ç¡®å®šä¸‹æ¥å°±ä¸çŸ¥é“è§</p>
<hr>
<p>åˆ°æ€ä¹ˆè¯´ğŸ˜‚ï¼Œä½†æ˜¯ç¦»ä½ å¾ˆè¿‘ï¼Œæ‰“è½¦20åˆ†é’Ÿå¤šè·¯ç¨‹â€¦ â€¦ Miss you!</p>
<hr>

      

      
    </div>
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<i class="icon-price-tags icon"></i>
		<ul class="article-tag-list">
			 
        		<li class="article-tag-list-item">
        			<a href="javascript:void(0)" class="js-tag article-tag-list-link color3">éšç¬”</a>
        		</li>
      		
		</ul>
	</div>

      
	<div class="article-category tagcloud">
		<i class="icon-book icon"></i>
		<ul class="article-tag-list">
			 
        		<li class="article-tag-list-item">
        			<a href="/categories/éšç¬”/" class="article-tag-list-link color3">éšç¬”</a>
        		</li>
      		
		</ul>
	</div>


      
        <p class="article-more-link">
          <a class="article-more-a" href="/2016/07/16/ä¸¤å‘¨æ„Ÿæ‚Ÿ~å¹¿å·/">å±•å¼€å…¨æ–‡ >></a>
        </p>
      

      
      <div class="clearfix"></div>
    </div>
  </div>
</article>





  
    <article id="post-UIView&amp;CALayer&amp;Core Animation~1" class="article article-type-post  article-index" itemscope itemprop="blogPost">
  <div class="article-inner">
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/06/16/UIView&CALayer&Core Animation~1/">UIView &amp; CALayer&amp; Core Animation ~ ï¼ˆUIView å’Œ CALayerï¼‰ï¼ˆ1ï¼‰</a>
    </h1>
  

        
        <a href="/2016/06/16/UIView&CALayer&Core Animation~1/" class="archive-article-date">
  	<time datetime="2016-06-16T06:41:28.000Z" itemprop="datePublished"><i class="icon-calendar icon"></i>2016-06-16</time>
</a>
        
      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>ç›®å‰domeå·²ç»åšå¥½å•¦ï¼Œä½†æ˜¯æ„Ÿè§‰è‡ªå·±ç†è§£è¿˜ä¸æ˜¯å¾ˆé€å½»ã€‚æ‰“ç®—æ”¹ä¸‹è‡ªå·±çš„åšå®¢ä»å¤´å¼€å§‹å¯¹åšå®¢è¿›è¡Œé‡æ–°æ›´æ–°ï¼Œæ›´æ–°æ—¶é—´6/12/2016ã€‚</p>
<div style="color:#008B8B"><br><p>ä»Šå¤©ä¹Ÿæ‰“ç®—å†™å…³äºå›¾ç‰‡ã€éŸ³é¢‘å’Œè§†é¢‘åœ¨æ·±å±‚åŸç†ï¼Œä»¥åŠå›¾åƒåœ¨å±å¹•æ˜¾ç¤ºåŸç†ä»¥åŠåé¢æå‡ºå¦‚ä½•è¿›è¡Œåœ¨æ­¤æ–¹é¢ä¼˜åŒ–ã€‚<br>ä¸‹é¢å°±è®²è¿°åœ¨IOSå¼€å‘è¿‡ç¨‹ä¸­ç»å¸¸ä½¿ç”¨çš„UIViewå’ŒCALayerä¸¤è€…ä¹‹é—´çš„å…³ç³»å’Œåœ¨åŠ¨ç”»ä½¿ç”¨è¿‡ç¨‹çš„å…·ä½“å°è£…ï¼ˆç½‘ä¸Šä¹Ÿæœ‰è®¸å¤šå…³äºè¿™ä¸ªè¯é¢˜çš„æ–‡ç« ï¼Œä¹Ÿæ˜¯ç«™åœ¨å·¨äººè‚©è†€ä¸Šï¼‰ã€‚</p><br></div>

<h3 id="UIViewå’ŒCALayerä¹‹é—´çš„å…³ç³»"><a href="#UIViewå’ŒCALayerä¹‹é—´çš„å…³ç³»" class="headerlink" title="UIViewå’ŒCALayerä¹‹é—´çš„å…³ç³»"></a>UIViewå’ŒCALayerä¹‹é—´çš„å…³ç³»</h3><p>æ‰“å¼€UIViewå’ŒCALyerä¸­å®é™…å®ç°çš„ä»£ç ï¼Œä¸‹é¢æ˜¯UIViewå®ç°æºç </p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">NS_CLASS_AVAILABLE_IOS</span>(<span class="number">2</span>_0) <span class="class"><span class="keyword">@interface</span> <span class="title">UIView</span> : <span class="title">UIResponder</span> &lt;<span class="title">NSCoding</span>, <span class="title">UIAppearance</span>, <span class="title">UIAppearanceContainer</span>, <span class="title">UIDynamicItem</span>, <span class="title">UITraitEnvironment</span>, <span class="title">UICoordinateSpace</span>, <span class="title">UIFocusEnvironment</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">@property</span>(<span class="keyword">nonatomic</span>,<span class="keyword">readonly</span>,<span class="keyword">strong</span>)                 <span class="built_in">CALayer</span>  *layer; </span><br></pre></td></tr></table></figure>
<p>CALayerå®ç°æºç ï¼š<br><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">@interface</span> <span class="title">CALayer</span> : <span class="title">NSObject</span> &lt;<span class="title">NSCoding</span>, <span class="title">CAMediaTiming</span>&gt;</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">@private</span></span><br><span class="line">  <span class="keyword">struct</span> _CALayerIvars &#123;</span><br><span class="line">    int32_t refcount;</span><br><span class="line">    uint32_t magic;</span><br><span class="line">    <span class="keyword">void</span> *layer;</span><br><span class="line"><span class="meta">#if TARGET_OS_MAC &amp;&amp; !TARGET_RT_64_BIT</span></span><br><span class="line">    <span class="keyword">void</span> *unused1[<span class="number">8</span>];</span><br><span class="line"><span class="meta">#endif</span></span><br><span class="line">  &#125; _attr;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><br>æˆ‘ä»¬å¯ä»¥çœ‹å‡ºUIViewæ˜¯ç»§æ‰¿è‡ªUIResponderï¼Œè€ŒCALayerç»§æ‰¿è‡ªNSObjectã€‚è¿™ä¹Ÿæ˜¯UIViewå¯ä»¥ç›¸åº”è§¦æ‘¸äº‹ä»¶ï¼Œå¹¶å®ç°å“åº”é“¾ä¸­æœ€åä¸€ç¯æ‰€åœ¨åé¢æˆ‘ä»¬ä¼šå…·ä½“è®²è¿°ã€‚CALayerç»§æ‰¿è‡ªNSObjectï¼Œå…¶ä¸­UIViewä¸­åˆåŒ…å«è‡ªå·±æ‰€ç‰¹æœ‰çš„layerã€‚æˆ‘ä»¬å¯ä»¥çœ‹åšCALayeræ˜¯UIViewçš„å…·ä½“å†…å®¹ç»†èŠ‚çš„å®ç°ï¼Œä¸¤è€…å…·æœ‰å¹³è¡Œå…³ç³»ã€‚</p>
<div style="color:#008B8B"><p>ä¸ºä»€ä¹ˆä¸æŠŠä¸¤è€…ä½•åœ¨ä¸€èµ·è¿›è¡Œå®ç°å‘¢ï¼Œåˆ†å¼€å®ç°å…·ä½“åŠŸèƒ½å‘¢ï¼Ÿ<br>æˆ‘æƒ³å¯èƒ½æ˜¯ä¸ºå•¦åˆ†å±‚éœ€è¦ï¼ŒæŠŠåŠŸèƒ½å…·ä½“åˆ†éš”å¼€æ¥ã€‚UIViewå®ç°è§¦æ‘¸å“åº”ï¼ŒCALayerå®ç°å…·ä½“çš„å†…å®¹å±•ç¤ºã€‚<br></p><br></div>

<p>å‚è€ƒèµ„æ–™ï¼š<br><br><a href="https://developer.apple.com/library/ios/documentation/Cocoa/Conceptual/CoreAnimation_guide/CoreAnimationBasics/CoreAnimationBasics.html#//apple_ref/doc/uid/TP40004514-CH2-SW12" target="_blank" rel="external">UIVieå’ŒCALayerå…³ç³»æºç </a>;</p>
<p><br><br>ä¸‹é¢æˆ‘ä»¬å°†å†™å…³äºUIViewå’ŒCALayerçš„ä¸€äº›ç›¸å…³çš„çŸ¥è¯†ï¼š</p>
<hr>
<p>åˆ—å‡ºåœ¨UIViewå®ç°ä¸äº†çš„CALayerçš„åŠŸèƒ½ï¼š</p>
<ul><br><li>é˜´å½±ï¼Œåœ†è§’ï¼Œå¸¦é¢œè‰²çš„è¾¹æ¡†</li><br><li>3Då˜æ¢</li><br><li>éçŸ©å½¢èŒƒå›´</li><br><li>é€æ˜é®ç½©</li><br><li>å¤šçº§éçº¿æ€§åŠ¨ç”»</li><br></ul>

<hr>
<p>æˆ‘ä»¬ä¹Ÿéƒ½çŸ¥é“åœ¨Iphoneæ‰‹æœºå†…å­˜æ˜¯å›ºå®šä¸èƒ½è¿›è¡Œæ‹“å±•ï¼Œæ‰€ä»¥æˆ‘ä»¬æ‰‹æœºå†…å­˜æ˜¯å¾ˆå®è´µçš„ã€‚å¦‚æœæˆ‘ä»¬æƒ³è¦åŠ è½½å¤§å®¹é‡çš„å›¾ç‰‡ï¼Œä¼šå ç”¨å¾ˆå¤§çš„å†…å­˜ã€‚<br><br><br>ä¸ºæ­¤ï¼ŒAppleé‡‡ç”¨äº†ä¸€ç§æ¯”è¾ƒå·§å¦™çš„ç­–ç•¥ã€‚åœ¨ä½å†…å­˜çš„æƒ…å†µä¸‹ï¼Œç³»ç»Ÿä¼šå¼ºåˆ¶æ¸…é™¤UIImageå¯¹è±¡æ‰€æŒ‡å‘çš„å›¾ç‰‡æ•°æ®ï¼Œä»¥é‡Šæ”¾éƒ¨åˆ†å†…å­˜ã€‚æ³¨æ„ï¼Œè¿™ç§æ¸…é™¤è¡Œä¸ºå½±å“åˆ°çš„åªæ˜¯å›¾ç‰‡æ•°æ®ï¼Œè€Œä¸ä¼šå½±å“åˆ°UIImageå¯¹è±¡æœ¬èº«ã€‚å½“æˆ‘ä»¬éœ€è¦ç»˜åˆ¶é‚£äº›å›¾ç‰‡æ•°æ®å·²ç»è¢«æ¸…é™¤çš„UIImageå¯¹è±¡æ—¶ï¼Œå¯¹è±¡ä¼šè‡ªåŠ¨ä»æºæ–‡ä»¶ä¸­é‡æ–°åŠ è½½æ•°æ®ã€‚å½“ç„¶ï¼Œè¿™æ˜¯ä»¥æ—¶é—´æ¢ç©ºé—´çš„ä¸€ç§ç­–ç•¥ï¼Œä¼šå¯¼è‡´ä¸€å®šçš„æ€§èƒ½æŸè€—ã€‚ä¸‹é¢ç»™å‡ºä¸€äº›å›¾ç‰‡å¤„ç†å°æŠ€å·§</p>
<h3 id="UIImageç¼“å­˜"><a href="#UIImageç¼“å­˜" class="headerlink" title="UIImageç¼“å­˜"></a>UIImageç¼“å­˜</h3><p>æˆ‘ä»¬çŸ¥é“åœ¨ä½¿ç”¨imageNamedè¿›è¡Œå›¾ç‰‡æ˜¾ç¤ºï¼Œå›¾ç‰‡ä¼šç¼“å­˜ã€‚ä½†å…·ä½“ç¼“å­˜æ˜¯æ€ä¹ˆå®ç°ï¼Œå…¶ä¸­è§£æå’Œæ¸…é™¤æ—¶é—´æ˜¯ä»€ä¹ˆæ—¶å€™å‘¢ï¼Ÿ<div style="color:#008B8B"></div></p>
<p></p><p>å½“æˆ‘ä»¬ä½¿ç”¨imageNamed:æ—¶åˆ›å»ºå›¾ç‰‡ï¼Œç³»ç»Ÿä¼šé€šè¿‡Bundleçš„æ–‡ä»¶ä¸­æ‰¾åˆ°å›¾ç‰‡çš„æ–‡ä»¶åï¼Œç„¶åæŠŠç›¸å…³çš„åå­—æ”¾åˆ°UIImageè¿”å›ï¼Œæ­¤æ—¶å¹¶æ²¡æœ‰è§£æå›¾ç‰‡ã€‚å½“å›¾ç‰‡åœ¨ç¬¬ä¸€æ¬¡æ˜¾ç¤ºæ—¶ï¼Œå›¾ç‰‡æ‰ä¼šè°ƒç”¨å†…éƒ¨è§£ç æ–¹æ³•ï¼Œè§£ç ä¼šæ”¾åˆ°ä¸€ä¸ªå…¨å±€å˜é‡ä¸­ã€‚å›¾ç‰‡åœ¨è§£ç åï¼Œä¼šåœ¨APPç¬¬ä¸€æ¬¡è¿›å…¥åå°æˆ–è€…å†…å­˜è­¦å‘Šæ—¶ï¼Œè¯¥å›¾ç‰‡çš„ç¼“å­˜æ‰ä¼šè¢«æ¸…ç©ºï¼Œå…¶ä»–æƒ…å†µç¼“å­˜ä¼šä¸€ç›´å­˜åœ¨ã€‚<br></p><br><p></p>
<h3 id="ä½¿ç”¨imageWithDataå¯ä»¥é¿å…ç¼“å­˜å—ï¼Ÿ"><a href="#ä½¿ç”¨imageWithDataå¯ä»¥é¿å…ç¼“å­˜å—ï¼Ÿ" class="headerlink" title="ä½¿ç”¨imageWithDataå¯ä»¥é¿å…ç¼“å­˜å—ï¼Ÿ"></a>ä½¿ç”¨imageWithDataå¯ä»¥é¿å…ç¼“å­˜å—ï¼Ÿ</h3><p>æˆ‘ä»¬åœ¨åˆ›å»ºUIImageæ—¶ï¼ŒUIImageçš„åº•å±‚ä¼šè°ƒç”¨ImageIOçš„CGImageSourceCreateWithData()ï¼Œæ­¤æ–¹æ³•æœ‰ä¸ªå‚æ•° ShouldCacheï¼Œåœ¨64ä½çš„å¤„ç†å™¨ä¸Šæ˜¯é»˜è®¤å¼€å¯çš„ã€‚å›¾ç‰‡ä¹Ÿä¼šåœ¨ç¬¬ä¸€æ¬¡æ˜¾ç¤ºåœ¨å±å¹•ä¸Šæ‰ä¼šè¢«è§£ç ï¼Œè§£ç æ•°æ®ä¹Ÿä¼šä¿å­˜åœ¨CGimageçš„å†…éƒ¨ã€‚</p>
<div style="color:#008B8B"><br><p>ä½†æ˜¯ä¸ä¸Šé¢ä½¿ç”¨imageNameçš„æƒ…å†µä¸åŒï¼Œåœ¨UIImageè¢«é‡Šæ”¾æ˜¯å…¶ç¼“å­˜ä¹Ÿä¼šè¿›è¡Œé‡Šæ”¾ã€‚</p></div>

<h3 id="æ€æ ·é¿å…ç¼“å­˜"><a href="#æ€æ ·é¿å…ç¼“å­˜" class="headerlink" title="æ€æ ·é¿å…ç¼“å­˜"></a>æ€æ ·é¿å…ç¼“å­˜</h3><ul><br><li>ä¸Šé¢æˆ‘ä»¬å¯ä»¥çœ‹åˆ°å¦‚æœç›´æ¥ä½¿ç”¨CGImageSourceCreateWithData()ï¼Œå¹¶ä¸”å…³é—­ShouldCache å’Œ ShouldCacheImmediatelyï¼Œä½†æ˜¯è¿™æ ·çš„è¯æ¯æ¬¡å›¾ç‰‡éœ€è¦æ˜¾ç¤ºçš„è¯ï¼Œéƒ½ä¼šè¿›è¡Œå›¾ç‰‡è§£ç ï¼Œè¿™æ ·ä¼šå ç”¨è¾ƒå¤§CPU</li><br><li>æŠŠå›¾ç‰‡ç”¨ CGContextDrawImage() ç»˜åˆ¶åˆ°ç”»å¸ƒä¸Šï¼Œç„¶åæŠŠç”»å¸ƒçš„æ•°æ®å–å‡ºæ¥å½“ä½œå›¾ç‰‡ã€‚è¿™ä¹Ÿæ˜¯å¸¸è§çš„ç½‘ç»œå›¾ç‰‡åº“çš„åšæ³•</li><br></ul>

<p><a href="http://blog.ibireme.com/2015/11/02/ios_image_tips/" target="_blank" rel="external">å‚è€ƒèµ„æ–™~iOS å¤„ç†å›¾ç‰‡çš„ä¸€äº›å° Tip</a></p>
<hr>
<p><a href="http://bihongbo.com/2016/01/03/memoryGhostdrawRect/" target="_blank" rel="external">å†…å­˜æ¶é¬¼drawRect</a><br><br>æ€»çš„å‚è€ƒèµ„æ–™åœ°å€<br><br><a href="https://github.com/AttackOnDobby/iOS-Core-Animation-Advanced-Techniques/blob/master/1-å›¾å±‚æ ‘/å›¾å±‚æ ‘.md" target="_blank" rel="external">å›¾å±‚çš„æ ‘çŠ¶ç»“æ„</a><br><br><a href="https://github.com/AttackOnDobby/iOS-Core-Animation-Advanced-Techniques/blob/master/2-å¯„å®¿å›¾/å¯„å®¿å›¾.md#contentså±æ€§" target="_blank" rel="external">å¯„å®¿å›¾</a><br><br><a href="https://github.com/AttackOnDobby/iOS-Core-Animation-Advanced-Techniques" target="_blank" rel="external">UIViewå’ŒCALayeræ€»çš„å‚è€ƒåœ°å€</a></p>

      

      
    </div>
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<i class="icon-price-tags icon"></i>
		<ul class="article-tag-list">
			 
        		<li class="article-tag-list-item">
        			<a href="javascript:void(0)" class="js-tag article-tag-list-link color5">å›¾ç‰‡è§†é¢‘</a>
        		</li>
      		
		</ul>
	</div>

      
	<div class="article-category tagcloud">
		<i class="icon-book icon"></i>
		<ul class="article-tag-list">
			 
        		<li class="article-tag-list-item">
        			<a href="/categories/è§†å›¾&amp;å›¾å±‚&amp;åŠ¨ç”»/" class="article-tag-list-link color4">è§†å›¾&å›¾å±‚&åŠ¨ç”»</a>
        		</li>
      		
		</ul>
	</div>


      
        <p class="article-more-link">
          <a class="article-more-a" href="/2016/06/16/UIView&CALayer&Core Animation~1/">å±•å¼€å…¨æ–‡ >></a>
        </p>
      

      
      <div class="clearfix"></div>
    </div>
  </div>
</article>





  
    <article id="post-UIView&amp;CALayer&amp;Core Animation-æ€»ä½“" class="article article-type-post  article-index" itemscope itemprop="blogPost">
  <div class="article-inner">
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/06/16/UIView&CALayer&Core Animation-æ€»ä½“/">UIView&amp;CALayer&amp;Core Animation~å¼€ç¯‡</a>
    </h1>
  

        
        <a href="/2016/06/16/UIView&CALayer&Core Animation-æ€»ä½“/" class="archive-article-date">
  	<time datetime="2016-06-16T06:35:22.000Z" itemprop="datePublished"><i class="icon-calendar icon"></i>2016-06-16</time>
</a>
        
      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>ä¸€ç›´æƒ³åšä¸ªdomeæ¥å®è·µè‡ªå·±æ‰€å­¦çš„çŸ¥è¯†ï¼Œçœ‹åˆ°ç½‘ä¸Šæœ‰å¾ˆå¤šèµ„æ–™æ„Ÿè§‰å‹åŠ›æ¯”è¾ƒå¤§ï¼Œæ‰€ä»¥å†³å®šç«™åœ¨å·¨äººè‚©è†€ä¸Šå¯¹äºUIView&amp;CALayer&amp;Core Animation è¿›è¡Œåˆ†è£…åšå‡ºä¸€ä¸ªdomeã€‚</p>
<p>ä¸‹é¢ç»™å‡ºæ•´ç†çš„æ€ç»´å¯¼å›¾ç‰‡ï¼š</p>
<p><img src="/images/UIView&amp;CALayeråŠ¨ç”».png" alt="image"></p>
<p><a href="https://github.com/boilWater/boilWater.github.io/tree/master/Xmind" target="_blank" rel="external">æ€ç»´å¯¼å›¾ä¸‹è½½åœ°å€</a></p>

      

      
    </div>
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<i class="icon-price-tags icon"></i>
		<ul class="article-tag-list">
			 
        		<li class="article-tag-list-item">
        			<a href="javascript:void(0)" class="js-tag article-tag-list-link color5">å›¾ç‰‡è§†é¢‘</a>
        		</li>
      		
		</ul>
	</div>

      
	<div class="article-category tagcloud">
		<i class="icon-book icon"></i>
		<ul class="article-tag-list">
			 
        		<li class="article-tag-list-item">
        			<a href="/categories/è§†å›¾&amp;å›¾å±‚&amp;åŠ¨ç”»/" class="article-tag-list-link color4">è§†å›¾&å›¾å±‚&åŠ¨ç”»</a>
        		</li>
      		
		</ul>
	</div>


      
        <p class="article-more-link">
          <a class="article-more-a" href="/2016/06/16/UIView&CALayer&Core Animation-æ€»ä½“/">å±•å¼€å…¨æ–‡ >></a>
        </p>
      

      
      <div class="clearfix"></div>
    </div>
  </div>
</article>





  
    <article id="post-IOS 10" class="article article-type-post  article-index" itemscope itemprop="blogPost">
  <div class="article-inner">
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/06/15/IOS 10/">IOS 10.0</a>
    </h1>
  

        
        <a href="/2016/06/15/IOS 10/" class="archive-article-date">
  	<time datetime="2016-06-14T16:07:59.000Z" itemprop="datePublished"><i class="icon-calendar icon"></i>2016-06-15</time>
</a>
        
      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>ä»Šå¤©æœ‰ç‚¹æ‚²å‰§ï¼Œå›åˆ°ä½çš„åœ°æ–¹èº«ä½“å°±å¼€å§‹ä¸èˆ’æœï¼Œä¸€è§‰ç¡åˆ°ç°åœ¨ã€‚çœ‹åˆ°11ç‚¹å¤šï¼Œèµ¶ç´§æ‰¾æ—¶é—´å¼€å§‹ç IOS 10.0æ–°çš„æ”¹å˜ã€‚<br><br>æ˜¨å¤©å‡Œæ™¨IOS ä¸¾è¡Œ WWDCå…¨çƒå‘å¸ƒè€…å¤§ä¼šï¼Œwatch OSã€tv OSã€OS Xä»¥åŠiOS 10ç³»ç»Ÿçš„æ–°ç‰¹æ€§ã€‚<br><br><a href="http://www.apple.com/apple-events/june-2016/" target="_blank" rel="external">WWDC-13/6/2016~è§†é¢‘åœ°å€</a></p>
<p>å±•ç¤ºä¼šç¬¬ä¸€ä¸ªæ˜¯APPLEçš„æŒèˆµäººæ˜¯åº“å…‹ï¼Œæœ‰ç‚¹æç¬‘çš„æ˜¯å¤§å®¶å¥½åƒæ²¡æœ‰ç†è§£åº“å…‹çš„ç¬¬ä¸€ä¸ªæ¢—å¤§å®¶éƒ½æ²¡æœ‰æ¬¢å‘¼ã€‚çœ‹å®Œè§†é¢‘ç»™æˆ‘æ¯”è¾ƒå¥½çš„æ„Ÿè§‰å°±æ˜¯åœ¨siriæ“ä½œç¨‹åºå’ŒApple Payçš„ä½¿ç”¨è¿‡ç¨‹ï¼Œä»˜æ¬¾ä½¿ç”¨èµ·æ¥æ„Ÿè§‰æ¯”æ”¯ä»˜å®æ›´åŠ ä¾¿æ·ã€‚</p>
<p>ä¸‹é¢æˆ‘ä»¬åˆ—è¡¨IOS 10çš„æ–°åŠŸèƒ½çš„ä½“ç°ï¼Œä¸‹é¢å°†ç»™å‡ºç›¸å…³çŸ¥è¯†çš„æ€ç»´å¯¼å›¾ã€‚</p>
<p><img src="/Images/WWDCï¼ˆ2016ï¼‰.png" alt="image"></p>
<h2 id="Watch-OS"><a href="#Watch-OS" class="headerlink" title="Watch OS"></a>Watch OS</h2><h3 id="å¯»æ‰¾APPS"><a href="#å¯»æ‰¾APPS" class="headerlink" title="å¯»æ‰¾APPS"></a>å¯»æ‰¾APPS</h3><p>æˆ‘ä»¬é€šè¿‡Apple Watchå‚è¾¹çš„æ—‹è½¬æ‰‹æŸ„å¯ä»¥å¿«é€Ÿå¯»æ‰¾æˆ‘ä»¬è£…åœ¨çš„APPä»¥åŠè®¾å®šé¦–ç•Œé¢æ˜¾ç¤ºçš„å…·ä½“å†…å®¹</p>
<h3 id="è¡¨ç›˜ç•Œé¢"><a href="#è¡¨ç›˜ç•Œé¢" class="headerlink" title="è¡¨ç›˜ç•Œé¢"></a>è¡¨ç›˜ç•Œé¢</h3><p>Apple Watchæä¾›å¤šä¸ªè¡¨ç›˜ç•Œé¢ï¼Œå…¶ä¸­ä¸€ä¸ªç«Ÿç„¶æ˜¯ç±³è€é¼ çš„æ˜¾ç¤ºæ—¶é—´çœŸå¿ƒé†‰å•¦ï¼Œæ²¡æœ‰ä¿æŒä¹”å¸®ä¸»æ—¶doubleåšæ³•</p>
<h3 id="æ´»åŠ¨"><a href="#æ´»åŠ¨" class="headerlink" title="æ´»åŠ¨"></a>æ´»åŠ¨</h3><p>æ´»åŠ¨æ–¹é¢Apple Watchä¸ºæˆ‘ä»¬æ·»åŠ ä¸€äº›ä½¿ç”¨çš„åŠŸèƒ½ã€‚æˆ‘ä»¬å¯ä»¥å¯¹æ´»åŠ¨ä»»åŠ¡è¿›è¡Œåˆ†äº«ã€æŸ¥çœ‹æ´»åŠ¨å®Œæˆè¿›åº¦å’Œä¸æœ‹å‹æ´»åŠ¨è¿›åº¦è¿›è¡Œæ¯”è¾ƒ</p>
<h3 id="Wheelchair-Use"><a href="#Wheelchair-Use" class="headerlink" title="Wheelchair Use"></a>Wheelchair Use</h3><p>ä¸ºåšè½®æ¤…çš„äººæä¾›å¯ä»¥å¸®åŠ©ï¼Œå¯ä»¥æé†’ä½¿ç”¨è€…ä¼‘æ¯ã€å·¥ä½œå’Œæ˜¾ç¤ºæ—‹è½¬é€Ÿåº¦</p>
<h3 id="Workout"><a href="#Workout" class="headerlink" title="Workout"></a>Workout</h3><p>åœ¨å·¥ä½œä¹‹ä½™æˆ‘ä»¬å¯ä»¥ä½¿ç”¨Apple Watchæ¥æŸ¥çœ‹æˆ‘ä»¬èµ°çš„è·ç¦»ã€watchçš„æ´»è·ƒå†…å­˜ç©ºé—´ã€æ¶ˆè€—å¡è·¯é‡Œã€å¿ƒç‡å’Œè¿åŠ¨æ—¶é—´ï¼Œå¯ä»¥é€‰æ‹©é‡è¦çš„è¿åŠ¨é¡¹ç›®ï¼Œè¿›è¡Œç‰¹åˆ«æ ‡æ³¨ï¼Œåœ¨è·‘æ­¥è¿‡ç¨‹ä¼šè‡ªåŠ¨åœæ­¢</p>
<h3 id="Breathe-App"><a href="#Breathe-App" class="headerlink" title="Breathe App"></a>Breathe App</h3><p>å¸®åŠ©ä½ å¯ä»¥è¿›è¡Œå†¥æƒ³ï¼Œé‡Šæ”¾è‡ªå·±çš„å‹åŠ›ï¼ŒæŠŠè¯­éŸ³ä¿¡å¿ƒè½¬æ¢ä¸ºæ–‡å­—ï¼Œè¿›è¡Œå›å¤</p>
<h3 id="Messages"><a href="#Messages" class="headerlink" title="Messages"></a>Messages</h3><p>æŠŠè¯­éŸ³ä¿¡å¿ƒè½¬æ¢ä¸ºæ–‡å­—ï¼Œè¿›è¡Œå›å¤ï¼Œé‡è¦çš„æ˜¯æ”¯æŒæ±‰å­—æ‰‹å†™</p>
<h3 id="ä¿ç•™åŠŸèƒ½"><a href="#ä¿ç•™åŠŸèƒ½" class="headerlink" title="ä¿ç•™åŠŸèƒ½"></a>ä¿ç•™åŠŸèƒ½</h3><ul><br><li>Homeï¼šå¯ä»¥é€šè¿‡Apple Watché“¾æ¥æ§åˆ¶å®¶ä¸­ä½¿ç”¨Homeçš„æ‰€æœ‰ç¡¬ä»¶è®¾å¤‡</li><br><li>SOSï¼šè¯•ä¸‹ç´§æ€¥å‘¼å«çš„åŠŸèƒ½</li><br><li>Apple Payï¼šå¯ä»¥åœ¨Macä¸Šè´­ä¹°ç„¶åé€šè¿‡IPhoneç›´æ¥æŒ‡çº¹è¯†åˆ«è¿›è¡Œä»˜æ¬¾</li><br><li>Unlock Macï¼šè§£é”æˆ‘ä»¬ä½¿ç”¨çš„Macç”µè„‘</li><br></ul>


<h2 id="IOS-10"><a href="#IOS-10" class="headerlink" title="IOS 10"></a>IOS 10</h2><h3 id="å…¨æ–°ç•Œé¢åŠŸèƒ½è®¾è®¡"><a href="#å…¨æ–°ç•Œé¢åŠŸèƒ½è®¾è®¡" class="headerlink" title="å…¨æ–°ç•Œé¢åŠŸèƒ½è®¾è®¡"></a>å…¨æ–°ç•Œé¢åŠŸèƒ½è®¾è®¡</h3><p>é¦–å…ˆæ˜¯æ–°çš„é”å±ç•Œé¢ï¼Œäº’åŠ¨æ€§å¤§å¹…å¢å¼ºï¼Œæ”¯æŒæ–°çš„é€šçŸ¥æ˜¾ç¤ºæ–¹å¼å’Œæ‰‹åŠ¿åŠŸèƒ½ï¼Œå¯ä»¥ç›´æ¥ä½¿ç”¨ 3D Touch è¿›è¡Œé¢„è§ˆä¸ä¿¡æ¯å›å¤ï¼Œæˆ–è€…é‡æŒ‰å…¨éƒ¨æ¸…é™¤é€šçŸ¥ï¼Œæ›´å¿«é€Ÿçš„è¿›å…¥æ‹ç…§ç•Œé¢ç­‰ï¼Œç•Œé¢çœ‹èµ·æ¥æ›´åŠ æ¸…æ™°ç›´è§‚ã€‚</p>
<p>å€¼å¾—ä¸€æçš„æ˜¯ï¼ŒiPhone æ”¯æŒæŠ¬æ‰‹å”¤é†’å±å¹•åŠŸèƒ½äº†ï¼Œ å½“ä½ æŠ¬èµ· iPhone çš„æ—¶å€™é”å±ç•Œé¢å°±ä¼šäº®èµ·ï¼Œç›´æ¥æ˜¾ç¤ºé€šçŸ¥ä¿¡æ¯å’Œç›¸å…³å†…å®¹ï¼Œè€Œä¸è§¦ç¢°ä»»ä½•æŒ‰é”®å’Œæ‰€åŠ¨æ“ä½œï¼Œæœ‰ç‚¹ç±»ä¼¼äºç«äº‰å¯¹æ‰‹çš„å¹³å°è®¾è®¡ç†å¿µã€‚</p>
<p>é€šçŸ¥ä¸­å¿ƒå’Œæ§åˆ¶ä¸­å¿ƒç•Œé¢è¿›è¡Œäº†æ–°çš„è®¾è®¡ï¼ŒåŒ…æ‹¬æ¡Œé¢äº¦æ˜¯å¦‚æ­¤ï¼Œå¾ˆå¤šæ“ä½œæ“ä½œåˆ©ç”¨ 3D Touch æ›´åŠ ä¾¿æ·ï¼Œæ¯”å¦‚åœ¨ app å›¾æ ‡ä¸Šé¢„è§ˆæ›´å¤šç›¸å…³ä¿¡æ¯ï¼Œç”šè‡³æ˜¯è§†é¢‘é¢„è§ˆã€‚</p>
<h3 id="Siri"><a href="#Siri" class="headerlink" title="Siri"></a>Siri</h3><p>Siri æœç„¶æ¯ä¸€å¹´éƒ½ä¼šåŠªåŠ›æå‡ Siri çš„æ°´å¹³ï¼Œè‹¹æœè¡¨ç¤ºæ¯å‘¨æœ‰ 200 ä¸‡ä¸ªç”¨æˆ·ä½¿ç”¨ Siriã€‚æ–°å‡çº§ä¹‹å Siri å¯ä»¥æœç´¢çš„å†…å®¹æ›´å¤šäº†ï¼Œæ¯”å¦‚å›¾ç‰‡æœç´¢ã€åº”ç”¨æœç´¢ï¼ŒåŒæ—¶ Siri è¿˜èƒ½å¤ŸæŸ¥çœ‹æ—¥æœŸã€æ‰“å¼€ appã€å‘é€çŸ­æ¯ã€‚</p>
<p>è‹¹æœå®£å¸ƒ Siri SDK å¼€æ”¾ï¼Œä¹‹åå¼€å‘è€…å¯ä»¥å°†ç¬¬ä¸‰æ–¹åº”ç”¨ç¨‹åºå’ŒæœåŠ¡ä¸ Siri é›†æˆï¼Œä»è€Œåœ¨è‡ªå®¶çš„åº”ç”¨ä¸­åˆ©ç”¨ Siri å®ç°è¯­éŸ³äº¤äº’ã€äººå·¥æ™ºèƒ½ç­‰åŠŸèƒ½ã€‚è‹¹æœç§° Whatsappã€å¾®ä¿¡å’Œæ»´æ»´æ‰“è½¦éƒ½ä¼šé›†æˆï¼Œç”¨æˆ·å¯ä»¥é€šè¿‡ Siri è¯­éŸ³å‘½ä»¤â€œWeChat xxx to è°è°è°â€ï¼Œå°±èƒ½å¤Ÿå®Œæˆå¾®ä¿¡çš„å‘é€äº†ï¼Œä¹Ÿå¯ä»¥ç”¨ Siri æ¥ä½¿ç”¨æ»´æ»´æ‰“è½¦ã€‚</p>
<p>å¦ä¸€ä¸º iOS 10 ä¸Š Siri å¢åŠ çš„åŠŸèƒ½æ˜¯ iCloud Voicemailï¼Œå¯ä»¥å°†è¯­éŸ³ä¿¡ç®±ä¸­çš„å†…å®¹è½¬æ¢æˆæ–‡å­—ï¼Œè®©ç”¨æˆ·èƒ½å¤Ÿå¿«é€Ÿæµè§ˆå’Œé˜…è¯»ã€‚</p>
<h3 id="Quick-type"><a href="#Quick-type" class="headerlink" title="Quick type"></a>Quick type</h3><p>Quick type è¿™éƒ¨åˆ†æ›´è¡Œé‡åœ¨ Siri çš„å…¨æ–°å‡çº§çš„äººå·¥æ™ºèƒ½ç‰¹å¾æ‰€å¸¦æ¥çš„ä¾¿åˆ©æ€§ï¼Œå› ä¸º Siri æ”¯æŒæ·±åº¦å­¦ä¹ ä½ çš„ä¸€åˆ‡ä¿¡æ¯ï¼ŒåŒ…æ‹¬ç›‘æµ‹ä½ çš„æ—¥ç¨‹å®‰æ’ï¼Œæ‰€ä»¥ä¸ä»…å¯ä»¥å¸®åŠ©æ›´å¿«é€Ÿçš„ç»„ç»‡è¯­è¨€ä¸€è¾¹å¿«é€Ÿå›å¤ï¼Œè¿˜èƒ½å¤Ÿæ ¹æ®ä¿¡æ¯æä¾›ç›¸å…³å»ºè®®ï¼Œå¸®åŠ©è‡ªåŠ¨å¡«å……åœ°å€ä¿¡æ¯ç­‰ç­‰ã€‚åŸºæœ¬ä¸Šï¼Œæ–°å‡çº§ä¹‹åèƒ½å¤Ÿä¸ºç”¨æˆ·çœå»æ›´å¤šæ‰‹åŠ¨è¾“å…¥éº»çƒ¦ã€‚</p>
<h3 id="ç…§ç‰‡åº”ç”¨"><a href="#ç…§ç‰‡åº”ç”¨" class="headerlink" title="ç…§ç‰‡åº”ç”¨"></a>ç…§ç‰‡åº”ç”¨</h3><p>iOS 10 ä¸­çš„ç…§ç‰‡åº”ç”¨æ‹¥æœ‰äº†æ›´åŠ å¼ºå¤§çš„ç®¡ç†åŠŸèƒ½ï¼Œè‹¹æœå¤šæ¬¡æåˆ°çš„å°±æ˜¯æ”¯æŒâ€œè¯†åˆ«åˆ†ç±»â€åŠŸèƒ½ï¼Œå¯ä»¥è¿›è¡Œè„¸éƒ¨ã€å¯¹è±¡å’Œåœºæ™¯çš„è¯†åˆ«ã€‚æ¯”å¦‚é€šè¿‡ä»»åŠ¡çš„è„¸éƒ¨å¤´åƒè¿›è¡Œåˆ†ç±»ï¼Œå½“æ™ºèƒ½æœç´¢åˆ†ç±»å®Œæˆä¹‹åï¼Œç”¨æˆ·è¿˜å¯ä»¥ç›´æ¥æœç´¢å›¾ç‰‡ä¸Šçš„äº‹ä»¶å†…å®¹ï¼Œæœç´¢éª‘é©¬ä¹Ÿèƒ½æ‰¾åˆ°ç…§ç‰‡ã€‚</p>
<p>æ€»ä¹‹ï¼Œåˆ©ç”¨ iCloud ç…§ç‰‡åº“å°±å¯ä»¥è½»æ¾æ ¹æ®åœ°ç†ä½ç½®ä¿¡æ¯ã€æ—¶é—´ã€ä»»åŠ¡ã€è¯é¢˜ç­‰ç­‰è¿›è¡Œåˆ†ç±»ï¼Œæ¯ä¸€ä¸ªç”¨æˆ·éƒ½å¯ä»¥å¾ˆæ–¹ä¾¿æ›´æ»¡æ„çš„åˆ›å»ºæ™ºèƒ½ç›¸å†Œï¼Œå¹¶ä¸”è¿™äº›æ–°åŠŸèƒ½åœ¨ Macä¸Šçš„ Photos ä¹Ÿå°†åŒæ ·å¾—åˆ°æ”¯æŒã€‚</p>
<h3 id="åœ°å›¾åº”ç”¨"><a href="#åœ°å›¾åº”ç”¨" class="headerlink" title="åœ°å›¾åº”ç”¨"></a>åœ°å›¾åº”ç”¨</h3><p>è‹¹æœè‡ªå®¶çš„åœ°å›¾åº”ç”¨åœ¨ iOS 10 ä¸­å¾—åˆ°äº†è¾ƒå¤§æ”¹è¿›ï¼Œé‡æ–°è®¾è®¡ä¹‹åæ›´ç®€å•ã€æ›´ç›´è§‚ä¹Ÿæ›´äººæ€§åŒ–ï¼Œæ— è®ºæ˜¯å¯¼èˆªç•Œé¢è¿˜æ˜¯è·¯çº¿ä¿¡æ¯ã€äº¤é€šä¿¡æ¯ç­‰éƒ½ä¸ä»¥å¾€æœ‰æ‰€ä¸åŒã€‚å‘¨è¾¹æ™ºèƒ½åŒ–å»ºè®®è¿›ä¸€æ­¥å¢å¼ºï¼Œæ‰€åœ¨ä½ç½®æ‰“å¼€åœ°å›¾â€œå¥½å»å¤„â€çš„å»ºè®®æ›´åŠ ä¸°å¯Œï¼Œé™„ä»¶çš„åŠ æ²¹ç«™ã€é¤é¦†å’Œå’–å•¡å…ç­‰ä¸€è§ˆæ— é—ï¼Œç”¨è‹¹æœçš„è¯æ¥è¯´ç®€ç›´å°±æ˜¯â€œæƒ…æŠ¥ä¸­å¿ƒâ€ã€‚</p>
<p>è‹¹æœåœ°å›¾ä¹Ÿå°†å¼€å‘ SDK ç»™å¼€å‘è€…ï¼Œè‹¹æœè¡¨ç¤ºä¸­å›½çš„å¤§ä¼—ç‚¹è¯„å’Œæ»´æ»´æ‰“è½¦å°†å…¨é¢æ•´åˆè‹¹æœåœ°å›¾ï¼Œè¾¾åˆ°ä¸åŸç”Ÿæ— ç¼æ–œè¡—çš„ä½“éªŒï¼Œæ¯”å¦‚è¯´ç›´æ¥åœ¨è‹¹æœåœ°å›¾ä¸Šä½¿ç”¨æ»´æ»´æ‰“è½¦è¿›è¡Œå«è½¦ã€‚å¦å¤–ï¼Œè‹¹æœåœ°å›¾ç°åœ¨ä¹Ÿæ”¯æŒ Carplay äº†ã€‚</p>
<h3 id="Apple-Music"><a href="#Apple-Music" class="headerlink" title="Apple Music"></a>Apple Music</h3><p>å¯¹äº Apple Music è‹¹æœè¡¨ç¤ºï¼Œè¯¥æœåŠ¡æ¨å‡ºè‡³ä»Šå·²ç»è·å¾—äº†å·¨å¤§çš„æˆåŠŸï¼Œç›®å‰ä»˜è´¹è®¢é˜…ç”¨æˆ·å·²ç»è¶…è¿‡ 1500 ä¸‡ã€‚</p>
<p>å…¨æ–°çš„ Apple Music ç•Œé¢è¿›è¡Œäº†é‡æ–°è®¾è®¡ï¼Œæ–°çš„ç•Œé¢æ›´åŠ ç®€æ´ã€æ›´åŠ æ¼‚äº®äº†ï¼Œå¦‚ä¼ é—»æ‰€è¿°å»æ‰äº†å¾ˆå¤šä¸°å¯Œçš„é¢œè‰²å…ƒç´ ï¼Œå˜å¾—æ›´åŠ ç›´è§‚ï¼Œçªå‡ºé»‘ç™½èƒŒæ™¯å’Œæ–‡å­—ã€‚æ¼”ç¤ºæ¥çœ‹ï¼Œæ–° Apple Music  è¿›ä¸€æ­¥æ•´åˆè‹¹æœå…¬å¸è‡ªä¸»å¼€å‘çš„æ—§é‡‘å±±å­—ä½“ï¼Œèœå•å’Œæ ‡ç­¾çš„å­—ä½“ä¼šæ˜¯åŠ ç²—çš„ã€æ›´å¤§çš„é»‘è‰²çš„ç‰ˆæœ¬ã€‚</p>
<p>å¦å¤–ï¼ŒApple Music å¯ä»¥æŒ‰ç…§è‰ºæœ¯å®¶ä¸“è¾‘ç­‰è¿›è¡Œåˆ†ç±»ï¼Œè¿˜æ”¯æŒæ­Œè¯è‡ªåŠ¨åŠ è½½æ˜¾ç¤ºã€‚ç”µå°å¹¿æ’­æœåŠ¡å¾—åˆ°äº†æ”¹è¿›ï¼Œä¸åªæ˜¯åˆ†ç±»æ›´ç›´è§‚ï¼Œç”¨æˆ·å¯ä»¥å¾ˆæ–¹ä¾¿åœ°å¯»æ‰¾è‡ªå·±æƒ³å¬çš„ç”µå°ï¼Œè€Œä¸”è‹¹æœè¡¨ç¤ºå°†ä¼šæœ‰æ›´å¤šçš„ä¸»æ’­å‚ä¸å½“ä¸­ã€‚</p>
<h3 id="Apple-News"><a href="#Apple-News" class="headerlink" title="Apple News"></a>Apple News</h3><p>è‹¹æœè¡¨ç¤ºï¼ŒApple News æœ‰è¶…è¿‡ 600 ä¸‡çš„è¯»è€…ï¼Œæ–°çš„æ›´æ–°å°†æ‹¥æœ‰å…¨æ–°è®¾è®¡çš„ç•Œé¢ï¼Œå¹¶å¯è®¢é˜…æ›´å¤šé¢‘é“ã€‚æ¨èåŠŸèƒ½å˜å¾—æ›´å¼ºå¤§æ›´æ™ºèƒ½ï¼Œæ”¯æŒåŸºäºç”¨æˆ·é˜…è¯»ä¹ æƒ¯è¿›è¡Œæ¨èï¼Œä¸ºæ¯ä¸€ä½ç”¨æˆ·é€‰æ‹©æ€§çš„æ¨é€æœ€éœ€è¦çš„æ–°é—»ä¿¡æ¯ã€‚</p>
<h3 id="HomeKit"><a href="#HomeKit" class="headerlink" title="HomeKit"></a>HomeKit</h3><p>ç‰©è”ç½‘æ˜¯å¤§åŠ¿æ‰€è¶‹ï¼Œè‹¹æœä¸º iOS 10 å¸¦æ¥äº† HomeKit çš„å…¨æ–°è¿›å±•ã€‚é¦–å…ˆï¼ŒHomeKit å°†ä»¥ç‹¬ç«‹åº”ç”¨çš„å½¢å¼å‡ºç°åœ¨ iOS 10 ä¸Šï¼Œå‘½åä¸º Homeï¼Œä¹‹å‰è‹¹æœå¯ç”³è¯·è¿‡â€œHomeâ€çš„å•†æ ‡ï¼Œå¹¶ä¸æ„å¤–ã€‚</p>
<p>å½“ HomeKit ç‹¬ç«‹æˆä¸€ä¸ªåº”ç”¨ä¹‹åï¼Œå®ƒå°†æœ‰èƒ½åŠ›å°†å¹³å°ä¸Šæ‰€æœ‰çš„å…¼å®¹è®¾å¤‡ç½®äºåŒä¸€ä¸ªç®¡ç†ä¸­å¿ƒä¸­ã€‚åªéœ€è¦æ‰“å¼€ iOS 10 ä¸Šçš„ Home  åº”ç”¨ï¼Œå°±å¯ä»¥å¯¹æ‰€æœ‰å…¼å®¹ HomeKit çš„è®¾å¤‡è¿›è¡Œç»Ÿä¸€çš„åŒ¹é…å’Œæ§åˆ¶ç®¡ç†ï¼ŒHome  åº”ç”¨ä¸­åŒ…å«äº†éå¸¸å…¨é¢çš„å®¶ç”µæ§åˆ¶é¢æ¿é€‰é¡¹ï¼Œæ”¯æŒ 3D Touch ä¹Ÿæ”¯æŒ Siri è¿›è¡Œæ§åˆ¶ï¼ŒiPadã€Apple Watch ä¹Ÿä¼šæä¾› Home åº”ç”¨ã€‚</p>
<p>è‹¹æœè¡¨ç¤ºï¼Œä»Šå¤©æœ‰å¥½å¤šå¼€å‘å•†éƒ½å‚ä¸åˆ°äº† HomeKit å¼€å‘å…¶ä¸­ï¼Œé€šè¿‡ HomeKit ç”¨æˆ·å¯ä»¥æ§åˆ¶å®¶é‡Œæ‰€æœ‰æ™ºèƒ½ç”µå™¨ï¼ŒåŒ…æ‹¬æ§åˆ¶é—¨é”ã€é£æ‰‡ã€ç¯ï¼Œæ‰“å¼€æˆ¿é—¨å’Œè½¦ç©ºé—¨ç­‰ç­‰ï¼Œä¸ä»…å¯ä»¥æŸ¥çœ‹é—¨é”æ‘„åƒå¤´çš„å®æ—¶è§†é¢‘ï¼Œè€Œä¸”è¿˜èƒ½æ§åˆ¶è®©æµ´ç¼¸çš„çƒ­æ°´åœ¨æ²¡å›å®¶ä¹‹å‰å°±ç»™ç”¨æˆ·æ”¾å¥½ã€‚</p>
<h3 id="ç”µè¯"><a href="#ç”µè¯" class="headerlink" title="ç”µè¯"></a>ç”µè¯</h3><p>é»˜è®¤ç”µè¯ app  è¿™éƒ¨åˆ†çš„å†…å®¹è®²å¾—æ¯”è¾ƒå°‘ï¼Œä¸€äº›æ¯”è¾ƒçªå‡ºçš„æ›´æ–°åŒ…æ‹¬æ”¯æŒæ˜¾ç¤ºåƒåœ¾ç”µè¯ï¼Œæ”¯æŒ VoIPï¼Œæ”¯æŒè¯­éŸ³ä¿¡ç®±è½¬æ–‡æœ¬æ˜¾ç¤ºç­‰ç­‰ã€‚ä»ç°åœºå›¾æ¥çœ‹ï¼Œè”ç³»äººç•Œé¢è¿›è¡Œäº†å…¨æ–°çš„è®¾è®¡ã€‚</p>
<h3 id="ä¿¡æ¯"><a href="#ä¿¡æ¯" class="headerlink" title="ä¿¡æ¯"></a>ä¿¡æ¯</h3><p>è‹¹æœè¡¨ç¤ºï¼Œä¿¡æ¯æ˜¯ iOS ä¸­ä½¿ç”¨æœ€ä¸ºé¢‘ç¹çš„åº”ç”¨ä¹‹ä¸€ã€‚æ‰€ä»¥ï¼Œè¿™ä¸€æ¬¡ä¿¡æ¯åº”ç”¨è‹¹æœèŠ±äº†å¤§é‡æ—¶é—´è¿›è¡Œæ¼”ç¤ºï¼Œä¸è¿‡å¾ˆå¤šåŠŸèƒ½éƒ½ä¸å›½å†…çš„å³æ—¶èŠå¤©åº”ç”¨ç±»ä¼¼ã€‚</p>

      

      
    </div>
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<i class="icon-price-tags icon"></i>
		<ul class="article-tag-list">
			 
        		<li class="article-tag-list-item">
        			<a href="javascript:void(0)" class="js-tag article-tag-list-link color4">IOS</a>
        		</li>
      		
		</ul>
	</div>

      
	<div class="article-category tagcloud">
		<i class="icon-book icon"></i>
		<ul class="article-tag-list">
			 
        		<li class="article-tag-list-item">
        			<a href="/categories/éšç¬”/" class="article-tag-list-link color3">éšç¬”</a>
        		</li>
      		
		</ul>
	</div>


      
        <p class="article-more-link">
          <a class="article-more-a" href="/2016/06/15/IOS 10/">å±•å¼€å…¨æ–‡ >></a>
        </p>
      

      
      <div class="clearfix"></div>
    </div>
  </div>
</article>





  
    <article id="post-SDWebImageä¹‹å›¾ç‰‡ç¼“å­˜åˆ†æ" class="article article-type-post  article-index" itemscope itemprop="blogPost">
  <div class="article-inner">
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/06/04/SDWebImageä¹‹å›¾ç‰‡ç¼“å­˜åˆ†æ/">SDWebImageä¹‹å›¾ç‰‡ç¼“å­˜å¤„ç†</a>
    </h1>
  

        
        <a href="/2016/06/04/SDWebImageä¹‹å›¾ç‰‡ç¼“å­˜åˆ†æ/" class="archive-article-date">
  	<time datetime="2016-06-04T08:55:11.000Z" itemprop="datePublished"><i class="icon-calendar icon"></i>2016-06-04</time>
</a>
        
      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>è¿™ç¯‡æ–‡ç« æˆ‘å°†æ¥ç€èŠ‚è®²è¿°å…³äºSDWebImageå›¾ç‰‡ä¸‹è½½åå¤„ç†æ–¹å¼ï¼Œç¼“å­˜è¿›è¡Œè®²è§£ã€‚<br><br><br>ç»è¿‡ä¸Šé¢æˆ‘ä»¬å¯ä»¥çŸ¥é“SDWebImageæ˜¯å¯ä»¥ä»è¿œç¨‹çš„æœåŠ¡å™¨åŠ è½½å›¾ç‰‡ï¼Œç„¶ååœ¨UIImageViewä¸Šè¿›è¡Œæ˜¾ç¤ºã€‚ä½†æ˜¯ä½ æœ‰æƒ³è¿‡SDWebImageåˆ°åº•æ˜¯ä»€ä¹ˆå‘¢ï¼Ÿ</p>
<p>åœ¨ä½¿ç”¨æ—¶æˆ‘ä»¬çŸ¥é“éœ€è¦å¯¼å…¥åŒ…ï¼šUIImageView+WebCache.hæˆ‘ä»¬å¯ä»¥æ ¹æ®è¿™çœ‹å‡ºSDWebImageæ˜¯ä¸€ä¸ªUIImageViewçš„åˆ†ç±»ï¼Œä½¿ç”¨Categoryè¿›è¡Œåˆ†è£…çš„ç±»ã€‚ä¸‹é¢åˆ—å‡ºSDWebImageå¯ä»¥å®ç°çš„åŠŸèƒ½ï¼š</p>
<p><ul></ul></p>
<p><li>æä¾›UIImageViewçš„ä¸€ä¸ªåˆ†ç±»ï¼Œå¯ä»¥å¯¹å›¾ç‰‡è¿›è¡Œå¼‚æ­¥åŠ è½½å’Œç¼“å­˜ç®¡ç†</li></p>
<p><li>ä¸€æ­¥å†…å­˜ &amp; ç£ç›˜ç®¡ç† &amp; è‡ªåŠ¨å¯¹è¿‡æœŸçš„ç¼“å­˜è¿›è¡Œç›¸å…³çš„å¤„ç†</li></p>
<p><li>ä¸€ä¸ªä¸€æ­¥å›¾ç‰‡çš„åŠ è½½å™¨</li></p>
<p><li>æ”¯æŒGIFçš„å›¾ç‰‡åŠ è½½</li></p>
<p><li>åå°å¯¹å›¾ç‰‡è¿›è¡Œè§£å‹å¤„ç†</li></p>
<p><li>ç¡®ä¿åŒæ„URLçš„å›¾ç‰‡ä¸ä¼šè¢«æ•°æ¬¡åŠ è½½</li></p>
<p><li>ç¡®ä¿è™šå‡çš„URLä¸ä¼šè¢«åå¤åŠ è½½</li></p>
<p><li>ç¡®ä¿ä¸‹è½½å’Œç¼“å­˜æ—¶ä¸»çº¿ç¨‹ä¸ä¼šè¢«é˜»å¡</li></p>
<p><li>ä¼˜è‰¯ä½¿ç”¨æ€§èƒ½</li></p>
<p><li>é‡‡ç”¨GCDå¯ä»¥é‡‡ç”¨å¹¶è¡Œå¤„ç†ï¼ŒIOS 5.0çš„ARCè‡ªåŠ¨è®¡æ•°åŸåˆ™</li></p>
<p><li>æ”¯æŒArm64(64ä½CPUå¤„ç†)</li><br></p>
<div style="color:#008B8B"><p><br>æœ¬ç¯‡åšå®¢æ˜¯åœ¨SDWebImageçš„å›¾ç‰‡åŠ è½½åŸºç¡€ä¹‹ä¸Šè¿›è¡Œæ¢ç´¢ï¼Œä¸‹é¢æˆ‘ä»¬å°±æ¥çœ‹ä¸‹SDWebImageæ˜¯å¦‚ä½•å®ç°å¯¹å›¾ç‰‡å®è¡Œç¼“å­˜å¤„ç†ã€‚</p></div>

<h3 id="å®ä¾‹"><a href="#å®ä¾‹" class="headerlink" title="å®ä¾‹"></a>å®ä¾‹</h3><p>SDImageCacheæ˜¯å›¾ç‰‡ä¸‹è½½åå†…å­˜ç¼“å­˜ç®¡ç†å’Œç£ç›˜ç¼“å­˜ç®¡ç†çš„ç±»ï¼Œä¸è¿‡è¿˜æ˜¯æˆ‘ä»¬æœ€å¸¸è§çš„å•ä¾‹æ¨¡å¼sharedImageCacheæ¥è¿›è¡Œå¾—åˆ°å®ä¾‹ã€‚é»˜è®¤çš„ç¼“å­˜ç©ºé—´ä¸Šæ˜¯defaultï¼Œå¦‚æœè‡ªå·±çœ‹ç€ä¸æ€ä¹ˆå¥½çš„è¯å¯ä»¥è‡ªå·±è¿›è¡Œç›¸å…³çš„ç©ºé—´ç”³è¯·ã€‚ä¸‹é¢æ˜¯SDWebCacheçš„ç®€ä»‹ï¼š</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">+ (SDImageCache *)sharedImageCache &#123;</span><br><span class="line">    <span class="keyword">static</span> <span class="built_in">dispatch_once_t</span> once;</span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">id</span> instance;</span><br><span class="line">    <span class="built_in">dispatch_once</span>(&amp;once, ^&#123;</span><br><span class="line">        instance = [<span class="keyword">self</span> new];</span><br><span class="line">    &#125;);</span><br><span class="line">    <span class="keyword">return</span> instance;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>è¿™é‡Œä½¿ç”¨dispatch_onceçš„å½¢å¼æ¯æ¬¡å¼€å¯ä¸€ä¸ªçº¿ç¨‹ï¼Œè¿™æ ·å¯ä»¥é˜²æ­¢å¤šä¸ªå•ä¾‹è¿›è¡ŒåŒæ—¶çš„åˆå§‹åŒ–ã€‚<a href="http://www.cocoachina.com/ios/20151117/14225.html" target="_blank" rel="external">è¯¦æƒ…å¯ä»¥å‚è€ƒGCDç›¸å…³çš„çŸ¥è¯†</a></p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br></pre></td><td class="code"><pre><span class="line">- (<span class="keyword">id</span>)init &#123;</span><br><span class="line">    <span class="keyword">return</span> [<span class="keyword">self</span> initWithNamespace:<span class="string">@"default"</span>];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (<span class="keyword">id</span>)initWithNamespace:(<span class="built_in">NSString</span> *)ns &#123;</span><br><span class="line">    <span class="built_in">NSString</span> *path = [<span class="keyword">self</span> makeDiskCachePath:ns];</span><br><span class="line">    <span class="keyword">return</span> [<span class="keyword">self</span> initWithNamespace:ns diskCacheDirectory:path];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (<span class="keyword">id</span>)initWithNamespace:(<span class="built_in">NSString</span> *)ns diskCacheDirectory:(<span class="built_in">NSString</span> *)directory &#123;</span><br><span class="line">    <span class="keyword">if</span> ((<span class="keyword">self</span> = [<span class="keyword">super</span> init])) &#123;</span><br><span class="line">        <span class="built_in">NSString</span> *fullNamespace = [<span class="string">@"com.hackemist.SDWebImageCache."</span> stringByAppendingString:ns];</span><br><span class="line"></span><br><span class="line">     <span class="comment">// initialise PNG signature data</span></span><br><span class="line">     kPNGSignatureData = [<span class="built_in">NSData</span> dataWithBytes:kPNGSignatureBytes length:<span class="number">8</span>];</span><br><span class="line"></span><br><span class="line">     <span class="comment">// Create IO serial queue</span></span><br><span class="line">     _ioQueue = dispatch_queue_create(<span class="string">"com.hackemist.SDWebImageCache"</span>, DISPATCH_QUEUE_SERIAL);</span><br><span class="line"></span><br><span class="line">     <span class="comment">// Init default values</span></span><br><span class="line">     _maxCacheAge = kDefaultCacheMaxCacheAge;</span><br><span class="line"></span><br><span class="line">     <span class="comment">// Init the memory cache</span></span><br><span class="line">     _memCache = [[AutoPurgeCache alloc] init];</span><br><span class="line">     _memCache.name = fullNamespace;</span><br><span class="line"></span><br><span class="line">     <span class="comment">// Init the disk cache</span></span><br><span class="line">     <span class="keyword">if</span> (directory != <span class="literal">nil</span>) &#123;</span><br><span class="line">         _diskCachePath = [directory stringByAppendingPathComponent:fullNamespace];</span><br><span class="line">     &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">         <span class="built_in">NSString</span> *path = [<span class="keyword">self</span> makeDiskCachePath:ns];</span><br><span class="line">         _diskCachePath = path;</span><br><span class="line">     &#125;</span><br><span class="line"></span><br><span class="line">     <span class="comment">// Set decompression to YES</span></span><br><span class="line">     _shouldDecompressImages = <span class="literal">YES</span>;</span><br><span class="line"></span><br><span class="line">     <span class="comment">// memory cache enabled</span></span><br><span class="line">     _shouldCacheImagesInMemory = <span class="literal">YES</span>;</span><br><span class="line"></span><br><span class="line">     <span class="comment">// Disable iCloud</span></span><br><span class="line">     _shouldDisableiCloud = <span class="literal">YES</span>;</span><br><span class="line"></span><br><span class="line">     <span class="built_in">dispatch_sync</span>(_ioQueue, ^&#123;</span><br><span class="line">         _fileManager = [<span class="built_in">NSFileManager</span> new];</span><br><span class="line">     &#125;);</span><br><span class="line"></span><br><span class="line"><span class="meta">#if TARGET_OS_IPHONE</span></span><br><span class="line">     <span class="comment">// Subscribe to app events</span></span><br><span class="line">     [[<span class="built_in">NSNotificationCenter</span> defaultCenter] addObserver:<span class="keyword">self</span></span><br><span class="line">                                              selector:<span class="keyword">@selector</span>(clearMemory)</span><br><span class="line">                                                  name:<span class="built_in">UIApplicationDidReceiveMemoryWarningNotification</span></span><br><span class="line">                                                object:<span class="literal">nil</span>];</span><br><span class="line"></span><br><span class="line">     [[<span class="built_in">NSNotificationCenter</span> defaultCenter] addObserver:<span class="keyword">self</span></span><br><span class="line">                                              selector:<span class="keyword">@selector</span>(cleanDisk)</span><br><span class="line">                                                  name:<span class="built_in">UIApplicationWillTerminateNotification</span></span><br><span class="line">                                                object:<span class="literal">nil</span>];</span><br><span class="line"></span><br><span class="line">     [[<span class="built_in">NSNotificationCenter</span> defaultCenter] addObserver:<span class="keyword">self</span></span><br><span class="line">                                              selector:<span class="keyword">@selector</span>(backgroundCleanDisk)</span><br><span class="line">                                                  name:<span class="built_in">UIApplicationDidEnterBackgroundNotification</span></span><br><span class="line">                                                object:<span class="literal">nil</span>];</span><br><span class="line"><span class="meta">#endif</span></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">self</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<div style="color:#008B8B"><p><br>ä¸Šé¢æˆ‘ä»¬å¯ä»¥çœ‹å‡ºåœ¨æˆ‘ä»¬ä½¿ç”¨initæ¥è¿›è¡Œåˆå§‹åŒ–ç¼“å­˜ç©ºé—´ï¼Œç´§æ¥ç€å°±è°ƒç”¨initWithNamespace: &amp; initWithNamespace: diskCacheDirectory:æ¥è¿›ä¸€æ­¥å¯¹ç£ç›˜è¿›è¡Œç¼“å­˜ç©ºé—´çš„åˆå§‹åŒ–ã€‚<br></p></div>

<h3 id="å†…å­˜ç¼“å­˜ç±»"><a href="#å†…å­˜ç¼“å­˜ç±»" class="headerlink" title="å†…å­˜ç¼“å­˜ç±»"></a>å†…å­˜ç¼“å­˜ç±»</h3><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">@interface</span> <span class="title">AutoPurgeCache</span> : <span class="title">NSCache</span></span></span><br><span class="line"><span class="keyword">@end</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">@implementation</span> <span class="title">AutoPurgeCache</span></span></span><br><span class="line"></span><br><span class="line">- (<span class="keyword">id</span>)init</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">self</span> = [<span class="keyword">super</span> init];</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">self</span>) &#123;</span><br><span class="line">        [[<span class="built_in">NSNotificationCenter</span> defaultCenter] addObserver:<span class="keyword">self</span> selector:<span class="keyword">@selector</span>(removeAllObjects) name:<span class="built_in">UIApplicationDidReceiveMemoryWarningNotification</span> object:<span class="literal">nil</span>];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">self</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (<span class="keyword">void</span>)dealloc</span><br><span class="line">&#123;</span><br><span class="line">    [[<span class="built_in">NSNotificationCenter</span> defaultCenter] removeObserver:<span class="keyword">self</span> name:<span class="built_in">UIApplicationDidReceiveMemoryWarningNotification</span> object:<span class="literal">nil</span>];</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">@end</span></span><br></pre></td></tr></table></figure>
<p>ä¸Šé¢æˆ‘ä»¬å¯ä»¥çœ‹å‡ºåœ¨ç¼“å­˜è¿‡ç¨‹ä¸­æˆ‘ä»¬é‡‡ç”¨çš„æ˜¯NSCacheçš„å­ç±»AutoPurgeCacheè¿›è¡Œçº¿ç®¡çš„ç¼“å­˜å¤„ç†ï¼Œä½†æ˜¯æˆ‘ä»¬ä¹Ÿå¯ä»¥ç›´æ¥ä½¿ç”¨NSdictionaryæ¥è¿›è¡Œå¤„ç†ï¼Œä¸ºä»€ä¹ˆä¸ä½¿ç”¨å‘¢ï¼Ÿåé¢æˆ‘å°†ä¼šè®²å‡ºğŸ˜¸ã€‚è¿”å›ä¸Šé¢ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹å‡ºåœ¨ç¼“å­˜æ—¶æˆ‘ä»¬é‡‡ç”¨æ³¨å†Œå’Œç›‘å¬çš„æ¨¡å¼å¯¹ç¼“å­˜çš„å†…å­˜ç›‘å¬ï¼Œä¸€æ—¦ç¼“å­˜æ•°æ®è¾¾åˆ°ä¸´ç•Œç‚¹å°±è¦æ¡ç”¨removeAllObjectsã€‚è¿™é‡Œæœ‰å…³äºæ–¹æ³•åœ¨è¿è¡Œæ—¶ç¼–è¯‘æƒ…å†µä¸‹çš„è¿‡ç¨‹<br><a href="http://boilwater.github.io/2016/05/29/runtimeç†è§£/" target="_blank" rel="external">runtimeè§£æ</a>ã€‚</p>
<div style="color:#008B8B"><p><br>åœ¨ç¼“å­˜è¿‡ç¨‹ä¸­æˆ‘ä»¬ä½¿ç”¨çš„æ˜¯NSCacheè€Œä¸æ˜¯ç”¨NSDictionaryå‘¢ï¼Œä¸‹é¢æˆ‘ä»¬çœ‹ä¸‹NSCacheçš„ä¼˜ç‚¹ï¼š<br><ul><br><li>è‡ªåŠ¨åˆ å‡åŠŸèƒ½</li><br><li>çº¿ç¨‹å®‰å…¨</li><br><li>ä¸ä¼šæ‹·è´å¥</li><br></ul><br>åŸºäºä¸Šé¢NSCacheçš„ç‰¹ç‚¹é€‰ç€ä½¿ç”¨NSCacheæ˜¯æ›´åŠ æ˜“äºå¯¹ç¼“å­˜çš„ç®¡ç†<br></p></div>

<p><a href="http://thenewself.blog.163.com/blog/static/198501330201251311025928/" target="_blank" rel="external">NSCacheçš„å‚è€ƒèµ„æ–™</a><br><br></p>
<h2 id="ç¼“å­˜åœ¨APPå‘¨æœŸçš„è®¾ç½®"><a href="#ç¼“å­˜åœ¨APPå‘¨æœŸçš„è®¾ç½®" class="headerlink" title="ç¼“å­˜åœ¨APPå‘¨æœŸçš„è®¾ç½®"></a>ç¼“å­˜åœ¨APPå‘¨æœŸçš„è®¾ç½®</h2><p>åœ¨åº”ç”¨å¼€å‘å¯¹å†…å®¹ç¼“å­˜çš„è¿‡ç¨‹æˆ‘ä»¬ä¹Ÿå¯ä»¥å‚è€ƒä¸‹é¢ç¼“å­˜çš„å¤„ç†æœºåˆ¶ï¼Œè¿™ä¹Ÿå¯¹æˆ‘ä»¬APPçš„æ€§èƒ½ä¼šæœ‰æ¯”è¾ƒå¤§çš„æå‡ã€‚ä¸‹é¢æŒ‰ç…§APPçš„åˆ†ä¸ºï¼šå†…å­˜è­¦å‘Šã€ç¨‹åºç»ˆæ­¢å’Œåå°ä¸‰ç§æƒ…å†µå®ç°ç¼“å­˜ç­–ç•¥ã€‚</p>
<h3 id="å†…å­˜è­¦å‘Š"><a href="#å†…å­˜è­¦å‘Š" class="headerlink" title="å†…å­˜è­¦å‘Š"></a>å†…å­˜è­¦å‘Š</h3><p>åœ¨æˆ‘ä»¬ä½¿ç”¨SDWebImageè¿‡ç¨‹æ—¶ç¨‹åºä¸€ç›´éƒ½ä¼šå¯¹æˆ‘ä»¬è®¿çš„å›¾ç‰‡è¿›è¡Œç›¸å…³ç¼“å­˜å¤„ç†ï¼Œä½†æ˜¯å½“æˆ‘ä»¬ç¼“å­˜è¾ƒå¤§æ—¶å°±ä¼šäº§ç”Ÿè­¦å‘Š</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">- (<span class="keyword">void</span>)clearMemory &#123;</span><br><span class="line">    [<span class="keyword">self</span>.memCache removeAllObjects];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ä¸Šé¢æ˜¯æˆ‘ä»¬æ³¨å†Œå‘ç°å†…å­˜è¿‡å¤§éœ€è¦è°ƒç”¨çš„æ–¹æ³•ã€‚</p>
<h3 id="ç¨‹åºç»ˆæ­¢"><a href="#ç¨‹åºç»ˆæ­¢" class="headerlink" title="ç¨‹åºç»ˆæ­¢"></a>ç¨‹åºç»ˆæ­¢</h3><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br></pre></td><td class="code"><pre><span class="line">- (<span class="keyword">void</span>)cleanDisk &#123;</span><br><span class="line">    [<span class="keyword">self</span> cleanDiskWithCompletionBlock:<span class="literal">nil</span>];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (<span class="keyword">void</span>)cleanDiskWithCompletionBlock:(SDWebImageNoParamsBlock)completionBlock &#123;</span><br><span class="line">    <span class="built_in">dispatch_async</span>(<span class="keyword">self</span>.ioQueue, ^&#123;</span><br><span class="line">        <span class="built_in">NSURL</span> *diskCacheURL = [<span class="built_in">NSURL</span> fileURLWithPath:<span class="keyword">self</span>.diskCachePath isDirectory:<span class="literal">YES</span>];</span><br><span class="line">        <span class="built_in">NSArray</span> *resourceKeys = @[<span class="built_in">NSURLIsDirectoryKey</span>, <span class="built_in">NSURLContentModificationDateKey</span>, <span class="built_in">NSURLTotalFileAllocatedSizeKey</span>];</span><br><span class="line"></span><br><span class="line"><span class="comment">// This enumerator prefetches useful properties for our cache files.</span></span><br><span class="line">      <span class="built_in">NSDirectoryEnumerator</span> *fileEnumerator = [_fileManager enumeratorAtURL:diskCacheURL</span><br><span class="line">                                                 includingPropertiesForKeys:resourceKeys</span><br><span class="line">                                                                    options:<span class="built_in">NSDirectoryEnumerationSkipsHiddenFiles</span></span><br><span class="line">                                                               errorHandler:<span class="literal">NULL</span>];</span><br><span class="line"></span><br><span class="line">      <span class="built_in">NSDate</span> *expirationDate = [<span class="built_in">NSDate</span> dateWithTimeIntervalSinceNow:-<span class="keyword">self</span>.maxCacheAge];</span><br><span class="line">      <span class="built_in">NSMutableDictionary</span> *cacheFiles = [<span class="built_in">NSMutableDictionary</span> dictionary];</span><br><span class="line">      <span class="built_in">NSUInteger</span> currentCacheSize = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">      <span class="comment">// Enumerate all of the files in the cache directory.  This loop has two purposes:</span></span><br><span class="line">      <span class="comment">//</span></span><br><span class="line">      <span class="comment">//  1. Removing files that are older than the expiration date.</span></span><br><span class="line">      <span class="comment">//  2. Storing file attributes for the size-based cleanup pass.</span></span><br><span class="line">      <span class="built_in">NSMutableArray</span> *urlsToDelete = [[<span class="built_in">NSMutableArray</span> alloc] init];</span><br><span class="line">      <span class="keyword">for</span> (<span class="built_in">NSURL</span> *fileURL <span class="keyword">in</span> fileEnumerator) &#123;</span><br><span class="line">          <span class="built_in">NSDictionary</span> *resourceValues = [fileURL resourceValuesForKeys:resourceKeys error:<span class="literal">NULL</span>];</span><br><span class="line"></span><br><span class="line">          <span class="comment">// Skip directories.</span></span><br><span class="line">          <span class="keyword">if</span> ([resourceValues[<span class="built_in">NSURLIsDirectoryKey</span>] boolValue]) &#123;</span><br><span class="line">              <span class="keyword">continue</span>;</span><br><span class="line">          &#125;</span><br><span class="line"></span><br><span class="line">          <span class="comment">// Remove files that are older than the expiration date;</span></span><br><span class="line">          <span class="built_in">NSDate</span> *modificationDate = resourceValues[<span class="built_in">NSURLContentModificationDateKey</span>];</span><br><span class="line">          <span class="keyword">if</span> ([[modificationDate laterDate:expirationDate] isEqualToDate:expirationDate]) &#123;</span><br><span class="line">              [urlsToDelete addObject:fileURL];</span><br><span class="line">              <span class="keyword">continue</span>;</span><br><span class="line">          &#125;</span><br><span class="line"></span><br><span class="line">          <span class="comment">// Store a reference to this file and account for its total size.</span></span><br><span class="line">          <span class="built_in">NSNumber</span> *totalAllocatedSize = resourceValues[<span class="built_in">NSURLTotalFileAllocatedSizeKey</span>];</span><br><span class="line">          currentCacheSize += [totalAllocatedSize unsignedIntegerValue];</span><br><span class="line">          [cacheFiles setObject:resourceValues forKey:fileURL];</span><br><span class="line">      &#125;</span><br><span class="line">      </span><br><span class="line">      <span class="keyword">for</span> (<span class="built_in">NSURL</span> *fileURL <span class="keyword">in</span> urlsToDelete) &#123;</span><br><span class="line">          [_fileManager removeItemAtURL:fileURL error:<span class="literal">nil</span>];</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      <span class="comment">// If our remaining disk cache exceeds a configured maximum size, perform a second</span></span><br><span class="line">      <span class="comment">// size-based cleanup pass.  We delete the oldest files first.</span></span><br><span class="line">      <span class="keyword">if</span> (<span class="keyword">self</span>.maxCacheSize &gt; <span class="number">0</span> &amp;&amp; currentCacheSize &gt; <span class="keyword">self</span>.maxCacheSize) &#123;</span><br><span class="line">          <span class="comment">// Target half of our maximum cache size for this cleanup pass.</span></span><br><span class="line">          <span class="keyword">const</span> <span class="built_in">NSUInteger</span> desiredCacheSize = <span class="keyword">self</span>.maxCacheSize / <span class="number">2</span>;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// Sort the remaining cache files by their last modification time (oldest first).</span></span><br><span class="line">        <span class="built_in">NSArray</span> *sortedFiles = [cacheFiles keysSortedByValueWithOptions:<span class="built_in">NSSortConcurrent</span></span><br><span class="line">                                                        usingComparator:^<span class="built_in">NSComparisonResult</span>(<span class="keyword">id</span> obj1, <span class="keyword">id</span> obj2) &#123;</span><br><span class="line">                                                            <span class="keyword">return</span> [obj1[<span class="built_in">NSURLContentModificationDateKey</span>] compare:obj2[<span class="built_in">NSURLContentModificationDateKey</span>]];</span><br><span class="line">                                                        &#125;];</span><br><span class="line"></span><br><span class="line">        <span class="comment">// Delete files until we fall below our desired cache size.</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="built_in">NSURL</span> *fileURL <span class="keyword">in</span> sortedFiles) &#123;</span><br><span class="line">            <span class="keyword">if</span> ([_fileManager removeItemAtURL:fileURL error:<span class="literal">nil</span>]) &#123;</span><br><span class="line">                <span class="built_in">NSDictionary</span> *resourceValues = cacheFiles[fileURL];</span><br><span class="line">                <span class="built_in">NSNumber</span> *totalAllocatedSize = resourceValues[<span class="built_in">NSURLTotalFileAllocatedSizeKey</span>];</span><br><span class="line">                currentCacheSize -= [totalAllocatedSize unsignedIntegerValue];</span><br><span class="line"></span><br><span class="line">                <span class="keyword">if</span> (currentCacheSize &lt; desiredCacheSize) &#123;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">          &#125;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">if</span> (completionBlock) &#123;</span><br><span class="line">          <span class="built_in">dispatch_async</span>(dispatch_get_main_queue(), ^&#123;</span><br><span class="line">              completionBlock();</span><br><span class="line">          &#125;);</span><br><span class="line">      &#125;</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ä»ä¸Šé¢æˆ‘ä»¬å¯ä»¥çœ‹å‡ºå½“æ”¶åˆ°UIApplicationWillTerminateNotificationæ—¶ï¼ŒSDImageCacheå°†ä¼šä½¿ç”¨ioQueueå¼‚æ­¥åœ°æ¸…ç†ç£ç›˜ç¼“å­˜ã€‚</p>
<p>æ¸…é™¤è¿‡ç¨‹çš„é€»è¾‘å¦‚ä¸‹ï¼š</p>
<div style="color:#008B8B"><p><br><ul><br><li>å…ˆæ¸…é™¤å·²è¶…è¿‡æœ€å¤§ç¼“å­˜æ—¶é—´çš„ç¼“å­˜æ–‡ä»¶ï¼ˆæœ€å¤§ç¼“å­˜æ—¶é—´é»˜è®¤ä¸ºä¸€æ˜ŸæœŸï¼‰</li><br><li>åœ¨ç¬¬ä¸€è½®æ¸…é™¤çš„è¿‡ç¨‹ä¸­ä¿å­˜æ–‡ä»¶å±æ€§ï¼Œç‰¹åˆ«æ˜¯ç¼“å­˜æ–‡ä»¶å¤§å°</li><br><li>åœ¨ç¬¬ä¸€è½®æ¸…é™¤åï¼Œå¦‚æœè®¾ç½®äº†æœ€å¤§ç¼“å­˜å¹¶ä¸”ä¿ç•™ä¸‹æ¥çš„ç£ç›˜ç¼“å­˜æ–‡ä»¶ä»ç„¶è¶…è¿‡äº†é…ç½®çš„æœ€å¤§ç¼“å­˜ï¼Œé‚£ä¹ˆè¿›è¡Œç¬¬äºŒè½®ä»¥å¤§å°ä¸ºåŸºç¡€çš„æ¸…é™¤ã€‚</li><br><li>é¦–å…ˆåˆ é™¤æœ€è€çš„æ–‡ä»¶ï¼Œç›´åˆ°è¾¾åˆ°æœŸæœ›çš„æ€»çš„ç¼“å­˜å¤§å°ï¼Œå³æœ€å¤§ç¼“å­˜çš„ä¸€åŠã€‚</li><br></ul><br></p></div>

<h3 id="ç¨‹åºè¿›å…¥åå°"><a href="#ç¨‹åºè¿›å…¥åå°" class="headerlink" title="ç¨‹åºè¿›å…¥åå°"></a>ç¨‹åºè¿›å…¥åå°</h3><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">- (<span class="keyword">void</span>)backgroundCleanDisk &#123;</span><br><span class="line">    Class <span class="built_in">UIApplicationClass</span> = <span class="built_in">NSClassFromString</span>(<span class="string">@"UIApplication"</span>);</span><br><span class="line">    <span class="keyword">if</span>(!<span class="built_in">UIApplicationClass</span> || ![<span class="built_in">UIApplicationClass</span> respondsToSelector:<span class="keyword">@selector</span>(sharedApplication)]) &#123;</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">UIApplication</span> *application = [<span class="built_in">UIApplication</span> performSelector:<span class="keyword">@selector</span>(sharedApplication)];</span><br><span class="line">    __block <span class="built_in">UIBackgroundTaskIdentifier</span> bgTask = [application beginBackgroundTaskWithExpirationHandler:^&#123;</span><br><span class="line">        <span class="comment">// Clean up any unfinished task business by marking where you</span></span><br><span class="line">        <span class="comment">// stopped or ending the task outright.</span></span><br><span class="line">        [application endBackgroundTask:bgTask];</span><br><span class="line">        bgTask = <span class="built_in">UIBackgroundTaskInvalid</span>;</span><br><span class="line">    &#125;];</span><br><span class="line"></span><br><span class="line">   <span class="comment">// Start the long-running task and return immediately.</span></span><br><span class="line">   [<span class="keyword">self</span> cleanDiskWithCompletionBlock:^&#123;</span><br><span class="line">       [application endBackgroundTask:bgTask];</span><br><span class="line">       bgTask = <span class="built_in">UIBackgroundTaskInvalid</span>;</span><br><span class="line">   &#125;];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>å½“æ”¶åˆ°UIApplicationDidEnterBackgroundNotificationæ—¶ï¼Œåœ¨æ‰‹æœºç³»ç»Ÿåå°è¿›è¡Œå¦‚ä¸Šé¢æè¿°çš„å¼‚æ­¥ç£ç›˜ç¼“å­˜æ¸…ç†ã€‚è¿™é‡Œåˆ©ç”¨Objectiveï¼Cçš„åŠ¨æ€è¯­è¨€ç‰¹æ€§ï¼Œå¾—åˆ°UIApplicationçš„å•ä¾‹sharedApplicationï¼Œä½¿ç”¨sharedApplicationå¼€å¯åå°ä»»åŠ¡cleanDiskWithCompletionBlock:</p>
<p><a href="http://boilwater.github.io/2016/05/29/runtimeç†è§£/" target="_blank" rel="external">runtimeçš„è¯¦è§£</a></p>
<h3 id="æŸ¥è¯¢å›¾ç‰‡"><a href="#æŸ¥è¯¢å›¾ç‰‡" class="headerlink" title="æŸ¥è¯¢å›¾ç‰‡"></a>æŸ¥è¯¢å›¾ç‰‡</h3><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line">- (<span class="built_in">NSOperation</span> *)queryDiskCacheForKey:(<span class="built_in">NSString</span> *)key done:(SDWebImageQueryCompletedBlock)doneBlock &#123;</span><br><span class="line">   <span class="keyword">if</span> (!doneBlock) &#123;</span><br><span class="line">       <span class="keyword">return</span> <span class="literal">nil</span>;</span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line">   <span class="keyword">if</span> (!key) &#123;</span><br><span class="line">       doneBlock(<span class="literal">nil</span>, SDImageCacheTypeNone);</span><br><span class="line">       <span class="keyword">return</span> <span class="literal">nil</span>;</span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line">   <span class="comment">// First check the in-memory cache...</span></span><br><span class="line">   <span class="built_in">UIImage</span> *image = [<span class="keyword">self</span> imageFromMemoryCacheForKey:key];</span><br><span class="line">   <span class="keyword">if</span> (image) &#123;</span><br><span class="line">       doneBlock(image, SDImageCacheTypeMemory);</span><br><span class="line">       <span class="keyword">return</span> <span class="literal">nil</span>;</span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line">   <span class="built_in">NSOperation</span> *operation = [<span class="built_in">NSOperation</span> new];</span><br><span class="line">   <span class="built_in">dispatch_async</span>(<span class="keyword">self</span>.ioQueue, ^&#123;</span><br><span class="line">       <span class="keyword">if</span> (operation.isCancelled) &#123;</span><br><span class="line">           <span class="keyword">return</span>;</span><br><span class="line">       &#125;</span><br><span class="line"></span><br><span class="line">       <span class="keyword">@autoreleasepool</span> &#123;</span><br><span class="line">           <span class="built_in">UIImage</span> *diskImage = [<span class="keyword">self</span> diskImageForKey:key];</span><br><span class="line">           <span class="keyword">if</span> (diskImage &amp;&amp; <span class="keyword">self</span>.shouldCacheImagesInMemory) &#123;</span><br><span class="line">               <span class="built_in">NSUInteger</span> cost = SDCacheCostForImage(diskImage);</span><br><span class="line">               [<span class="keyword">self</span>.memCache setObject:diskImage forKey:key cost:cost];</span><br><span class="line">           &#125;</span><br><span class="line"></span><br><span class="line">           <span class="built_in">dispatch_async</span>(dispatch_get_main_queue(), ^&#123;</span><br><span class="line">               doneBlock(diskImage, SDImageCacheTypeDisk);</span><br><span class="line">           &#125;);</span><br><span class="line">       &#125;</span><br><span class="line">   &#125;);</span><br><span class="line"></span><br><span class="line">   <span class="keyword">return</span> operation;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>æŸ¥è¯¢ç¼“å­˜ï¼Œé»˜è®¤ä½¿ç”¨æ–¹æ³•queryDiskCacheForKey:done:ï¼Œå¦‚æœæ­¤æ–¹æ³•è¿”å›nilï¼Œåˆ™è¯´æ˜ç¼“å­˜ä¸­ç°åœ¨è¿˜æ²¡æœ‰è¿™å¼ ç…§ç‰‡ï¼Œå› æ­¤ä½ éœ€è¦å¾—åˆ°å¹¶ç¼“å­˜è¿™å¼ å›¾ç‰‡ã€‚ç¼“å­˜keyæ˜¯ç¼“å­˜å›¾ç‰‡çš„ç¨‹åºå”¯ä¸€çš„æ ‡è¯†ç¬¦ï¼Œä¸€èˆ¬ä½¿ç”¨å›¾ç‰‡çš„å®Œæ•´URLã€‚</p>
<p>å¦‚æœä¸æƒ³SDImageCacheæŸ¥è¯¢ç£ç›˜ç¼“å­˜ï¼Œä½ å¯ä»¥è°ƒç”¨å¦ä¸€ä¸ªæ–¹æ³•ï¼šimageFromMemoryCacheForKey:ã€‚</p>
<p>è¿”å›å€¼ä¸ºNSOprationï¼Œå•ç‹¬ä½¿ç”¨SDImageCacheæ²¡ç”¨ï¼Œä½†æ˜¯ä½¿ç”¨SDWebImageManagerå°±å¯ä»¥å¯¹å¤šä¸ªä»»åŠ¡çš„ä¼˜å…ˆçº§ã€ä¾èµ–ï¼Œå¹¶ä¸”å¯ä»¥å–æ¶ˆã€‚</p>
<p>è‡ªå®šä¹‰@autoreleasepoolï¼Œautoreleasepoolä»£ç æ®µé‡Œé¢æœ‰å¤§é‡çš„å†…å­˜æ¶ˆè€—æ“ä½œï¼Œè‡ªå®šä¹‰autoreleasepoolå¯ä»¥åŠæ—¶åœ°é‡Šæ”¾æ‰å†…å­˜ã€‚<br><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line">- (<span class="built_in">NSString</span> *)cachePathForKey:(<span class="built_in">NSString</span> *)key inPath:(<span class="built_in">NSString</span> *)path &#123;</span><br><span class="line">    <span class="built_in">NSString</span> *filename = [<span class="keyword">self</span> cachedFileNameForKey:key];</span><br><span class="line">    <span class="keyword">return</span> [path stringByAppendingPathComponent:filename];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (<span class="built_in">NSString</span> *)defaultCachePathForKey:(<span class="built_in">NSString</span> *)key &#123;</span><br><span class="line">    <span class="keyword">return</span> [<span class="keyword">self</span> cachePathForKey:key inPath:<span class="keyword">self</span>.diskCachePath];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">#pragma mark SDImageCache (private)</span></span><br><span class="line"></span><br><span class="line">- (<span class="built_in">NSString</span> *)cachedFileNameForKey:(<span class="built_in">NSString</span> *)key &#123;</span><br><span class="line">    <span class="keyword">const</span> <span class="keyword">char</span> *str = [key UTF8String];</span><br><span class="line">    <span class="keyword">if</span> (str == <span class="literal">NULL</span>) &#123;</span><br><span class="line">        str = <span class="string">""</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">unsigned</span> <span class="keyword">char</span> r[CC_MD5_DIGEST_LENGTH];</span><br><span class="line">    CC_MD5(str, (CC_LONG)strlen(str), r);</span><br><span class="line">    <span class="built_in">NSString</span> *filename = [<span class="built_in">NSString</span> stringWithFormat:<span class="string">@"%02x%02x%02x%02x%02x%02x%02x%02x%02x%02x%02x%02x%02x%02x%02x%02x%@"</span>,</span><br><span class="line">                          r[<span class="number">0</span>], r[<span class="number">1</span>], r[<span class="number">2</span>], r[<span class="number">3</span>], r[<span class="number">4</span>], r[<span class="number">5</span>], r[<span class="number">6</span>], r[<span class="number">7</span>], r[<span class="number">8</span>], r[<span class="number">9</span>], r[<span class="number">10</span>],</span><br><span class="line">                          r[<span class="number">11</span>], r[<span class="number">12</span>], r[<span class="number">13</span>], r[<span class="number">14</span>], r[<span class="number">15</span>], [[key pathExtension] isEqualToString:<span class="string">@""</span>] ? <span class="string">@""</span> : [<span class="built_in">NSString</span> stringWithFormat:<span class="string">@".%@"</span>, [key pathExtension]]];</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> filename;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (<span class="built_in">NSData</span> *)diskImageDataBySearchingAllPathsForKey:(<span class="built_in">NSString</span> *)key &#123;</span><br><span class="line">    <span class="built_in">NSString</span> *defaultPath = [<span class="keyword">self</span> defaultCachePathForKey:key];</span><br><span class="line">    <span class="built_in">NSData</span> *data = [<span class="built_in">NSData</span> dataWithContentsOfFile:defaultPath];</span><br><span class="line">    <span class="keyword">if</span> (data) &#123;</span><br><span class="line">        <span class="keyword">return</span> data;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// fallback because of https://github.com/rs/SDWebImage/pull/976 that added the extension to the disk file name</span></span><br><span class="line">    <span class="comment">// checking the key with and without the extension</span></span><br><span class="line">    data = [<span class="built_in">NSData</span> dataWithContentsOfFile:[defaultPath stringByDeletingPathExtension]];</span><br><span class="line">    <span class="keyword">if</span> (data) &#123;</span><br><span class="line">        <span class="keyword">return</span> data;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">NSArray</span> *customPaths = [<span class="keyword">self</span>.customPaths <span class="keyword">copy</span>];</span><br><span class="line">    <span class="keyword">for</span> (<span class="built_in">NSString</span> *path <span class="keyword">in</span> customPaths) &#123;</span><br><span class="line">        <span class="built_in">NSString</span> *filePath = [<span class="keyword">self</span> cachePathForKey:key inPath:path];</span><br><span class="line">        <span class="built_in">NSData</span> *imageData = [<span class="built_in">NSData</span> dataWithContentsOfFile:filePath];</span><br><span class="line">        <span class="keyword">if</span> (imageData) &#123;</span><br><span class="line">            <span class="keyword">return</span> imageData;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// fallback because of https://github.com/rs/SDWebImage/pull/976 that added the extension to the disk file name</span></span><br><span class="line">        <span class="comment">// checking the key with and without the extension</span></span><br><span class="line">        imageData = [<span class="built_in">NSData</span> dataWithContentsOfFile:[filePath stringByDeletingPathExtension]];</span><br><span class="line">        <span class="keyword">if</span> (imageData) &#123;</span><br><span class="line">            <span class="keyword">return</span> imageData;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="literal">nil</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<div style="color:#008B8B"><p><br>ä¸Šé¢ä»£ç æ®µæ˜¯ä»ç£ç›˜è·å–å›¾ç‰‡çš„ä»£ç ã€‚å¾—åˆ°å›¾ç‰‡å¯¹åº”çš„UIDataåï¼Œè¿˜è¦ç»è¿‡å¦‚ä¸‹æ­¥éª¤ï¼Œæ‰èƒ½è¿”å›å¯¹åº”çš„å›¾ç‰‡ï¼š<br><ul><br><li>æ ¹æ®å›¾ç‰‡çš„ä¸åŒç§ç±»ï¼Œç”Ÿæˆå¯¹åº”çš„UIImage</li><br><li>æ ¹æ®keyå€¼ï¼Œè°ƒæ•´imageçš„scaleå€¼</li><br><li>å¦‚æœè®¾ç½®å›¾ç‰‡éœ€è¦è§£å‹ç¼©ï¼Œåˆ™è¿˜éœ€å¯¹UIImageè¿›è¡Œè§£ç </li><br></ul><br></p></div>

<h3 id="ä¸‹é¢æ˜¯MD5çš„åŠ å¯†æ–¹å¼"><a href="#ä¸‹é¢æ˜¯MD5çš„åŠ å¯†æ–¹å¼" class="headerlink" title="ä¸‹é¢æ˜¯MD5çš„åŠ å¯†æ–¹å¼"></a>ä¸‹é¢æ˜¯MD5çš„åŠ å¯†æ–¹å¼</h3><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">- (<span class="built_in">NSString</span> *)cachedFileNameForKey:(<span class="built_in">NSString</span> *)key &#123;</span><br><span class="line">    <span class="keyword">const</span> <span class="keyword">char</span> *str = [key UTF8String];</span><br><span class="line">    <span class="keyword">if</span> (str == <span class="literal">NULL</span>) &#123;</span><br><span class="line">        str = <span class="string">""</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">unsigned</span> <span class="keyword">char</span> r[CC_MD5_DIGEST_LENGTH];</span><br><span class="line">    CC_MD5(str, (CC_LONG)strlen(str), r);</span><br><span class="line">    <span class="built_in">NSString</span> *filename = [<span class="built_in">NSString</span> stringWithFormat:<span class="string">@"%02x%02x%02x%02x%02x%02x%02x%02x%02x%02x%02x%02x%02x%02x%02x%02x%@"</span>,</span><br><span class="line">                          r[<span class="number">0</span>], r[<span class="number">1</span>], r[<span class="number">2</span>], r[<span class="number">3</span>], r[<span class="number">4</span>], r[<span class="number">5</span>], r[<span class="number">6</span>], r[<span class="number">7</span>], r[<span class="number">8</span>], r[<span class="number">9</span>], r[<span class="number">10</span>],</span><br><span class="line">                          r[<span class="number">11</span>], r[<span class="number">12</span>], r[<span class="number">13</span>], r[<span class="number">14</span>], r[<span class="number">15</span>], [[key pathExtension] isEqualToString:<span class="string">@""</span>] ? <span class="string">@""</span> : [<span class="built_in">NSString</span> stringWithFormat:<span class="string">@".%@"</span>, [key pathExtension]]];</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> filename;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="å›¾ç‰‡çš„ä¿å­˜"><a href="#å›¾ç‰‡çš„ä¿å­˜" class="headerlink" title="å›¾ç‰‡çš„ä¿å­˜"></a>å›¾ç‰‡çš„ä¿å­˜</h3><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br></pre></td><td class="code"><pre><span class="line">- (<span class="keyword">void</span>)storeImage:(<span class="built_in">UIImage</span> *)image recalculateFromImage:(<span class="built_in">BOOL</span>)recalculate imageData:(<span class="built_in">NSData</span> *)imageData forKey:(<span class="built_in">NSString</span> *)key toDisk:(<span class="built_in">BOOL</span>)toDisk &#123;</span><br><span class="line">    <span class="keyword">if</span> (!image || !key) &#123;</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// if memory cache is enabled</span></span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">self</span>.shouldCacheImagesInMemory) &#123;</span><br><span class="line">        <span class="built_in">NSUInteger</span> cost = SDCacheCostForImage(image);</span><br><span class="line">        [<span class="keyword">self</span>.memCache setObject:image forKey:key cost:cost];</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (toDisk) &#123;</span><br><span class="line">        <span class="built_in">dispatch_async</span>(<span class="keyword">self</span>.ioQueue, ^&#123;</span><br><span class="line">            <span class="built_in">NSData</span> *data = imageData;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> (image &amp;&amp; (recalculate || !data)) &#123;</span><br><span class="line"><span class="meta">#if TARGET_OS_IPHONE</span></span><br><span class="line">                <span class="comment">// We need to determine if the image is a PNG or a JPEG</span></span><br><span class="line">                <span class="comment">// PNGs are easier to detect because they have a unique signature (http://www.w3.org/TR/PNG-Structure.html)</span></span><br><span class="line">                <span class="comment">// The first eight bytes of a PNG file always contain the following (decimal) values:</span></span><br><span class="line">                <span class="comment">// 137 80 78 71 13 10 26 10</span></span><br><span class="line"></span><br><span class="line">                <span class="comment">// If the imageData is nil (i.e. if trying to save a UIImage directly or the image was transformed on download)</span></span><br><span class="line">                <span class="comment">// and the image has an alpha channel, we will consider it PNG to avoid losing the transparency</span></span><br><span class="line">                <span class="keyword">int</span> alphaInfo = <span class="built_in">CGImageGetAlphaInfo</span>(image.CGImage);</span><br><span class="line">                <span class="built_in">BOOL</span> hasAlpha = !(alphaInfo == kCGImageAlphaNone ||</span><br><span class="line">                                  alphaInfo == kCGImageAlphaNoneSkipFirst ||</span><br><span class="line">                                  alphaInfo == kCGImageAlphaNoneSkipLast);</span><br><span class="line">                <span class="built_in">BOOL</span> imageIsPng = hasAlpha;</span><br><span class="line"></span><br><span class="line">                <span class="comment">// But if we have an image data, we will look at the preffix</span></span><br><span class="line">                <span class="keyword">if</span> ([imageData length] &gt;= [kPNGSignatureData length]) &#123;</span><br><span class="line">                    imageIsPng = ImageDataHasPNGPreffix(imageData);</span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line">                <span class="keyword">if</span> (imageIsPng) &#123;</span><br><span class="line">                    data = <span class="built_in">UIImagePNGRepresentation</span>(image);</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">else</span> &#123;</span><br><span class="line">                    data = <span class="built_in">UIImageJPEGRepresentation</span>(image, (<span class="built_in">CGFloat</span>)<span class="number">1.0</span>);</span><br><span class="line">                &#125;</span><br><span class="line"><span class="meta">#else</span></span><br><span class="line">                data = [<span class="built_in">NSBitmapImageRep</span> representationOfImageRepsInArray:image.representations usingType: <span class="built_in">NSJPEGFileType</span> properties:<span class="literal">nil</span>];</span><br><span class="line"><span class="meta">#endif</span></span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> (data) &#123;</span><br><span class="line">                <span class="keyword">if</span> (![_fileManager fileExistsAtPath:_diskCachePath]) &#123;</span><br><span class="line">                    [_fileManager createDirectoryAtPath:_diskCachePath withIntermediateDirectories:<span class="literal">YES</span> attributes:<span class="literal">nil</span> error:<span class="literal">NULL</span>];</span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line">                <span class="comment">// get cache Path for image key</span></span><br><span class="line">                <span class="built_in">NSString</span> *cachePathForKey = [<span class="keyword">self</span> defaultCachePathForKey:key];</span><br><span class="line">                <span class="comment">// transform to NSUrl</span></span><br><span class="line">                <span class="built_in">NSURL</span> *fileURL = [<span class="built_in">NSURL</span> fileURLWithPath:cachePathForKey];</span><br><span class="line"></span><br><span class="line">                [_fileManager createFileAtPath:cachePathForKey contents:data attributes:<span class="literal">nil</span>];</span><br><span class="line"></span><br><span class="line">                <span class="comment">// disable iCloud backup</span></span><br><span class="line">                <span class="keyword">if</span> (<span class="keyword">self</span>.shouldDisableiCloud) &#123;</span><br><span class="line">                    [fileURL setResourceValue:[<span class="built_in">NSNumber</span> numberWithBool:<span class="literal">YES</span>] forKey:<span class="built_in">NSURLIsExcludedFromBackupKey</span> error:<span class="literal">nil</span>];</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (<span class="keyword">void</span>)storeImage:(<span class="built_in">UIImage</span> *)image forKey:(<span class="built_in">NSString</span> *)key &#123;</span><br><span class="line">    [<span class="keyword">self</span> storeImage:image recalculateFromImage:<span class="literal">YES</span> imageData:<span class="literal">nil</span> forKey:key toDisk:<span class="literal">YES</span>];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (<span class="keyword">void</span>)storeImage:(<span class="built_in">UIImage</span> *)image forKey:(<span class="built_in">NSString</span> *)key toDisk:(<span class="built_in">BOOL</span>)toDisk &#123;</span><br><span class="line">    [<span class="keyword">self</span> storeImage:image recalculateFromImage:<span class="literal">YES</span> imageData:<span class="literal">nil</span> forKey:key toDisk:toDisk];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>å­˜å‚¨ä¸€ä¸ªå›¾ç‰‡åˆ°ç¼“å­˜ä¸­ï¼Œå¯ä»¥ä½¿ç”¨æ–¹æ³•storeImage:forKey:method:ï¼Œé»˜è®¤ï¼Œå›¾ç‰‡æ—¢ä¼šå­˜å‚¨åˆ°å†…å­˜ç¼“å­˜ä¸­ï¼Œä¹Ÿä¼šå¼‚æ­¥åœ°ä¿å­˜åˆ°ç£ç›˜ç¼“å­˜ä¸­ã€‚å¦‚æœåªæƒ³ä½¿ç”¨å†…å­˜ç¼“å­˜ï¼Œå¯ä»¥ä½¿ç”¨å¦å¤–ä¸€ä¸ªæ–¹æ³•storeImage:forKey:toDiskï¼Œç¬¬ä¸‰ä¸ªå‚æ•°ä¼ å…¥falseå€¼å°±å¥½äº†ã€‚</p>

      

      
    </div>
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<i class="icon-price-tags icon"></i>
		<ul class="article-tag-list">
			 
        		<li class="article-tag-list-item">
        			<a href="javascript:void(0)" class="js-tag article-tag-list-link color2">ä¸‰æ–¹æ¡†æ¶è§£æ</a>
        		</li>
      		
		</ul>
	</div>

      
	<div class="article-category tagcloud">
		<i class="icon-book icon"></i>
		<ul class="article-tag-list">
			 
        		<li class="article-tag-list-item">
        			<a href="/categories/ç¬¬ä¸‰æ–¹æ¡†æ¶/" class="article-tag-list-link color1">ç¬¬ä¸‰æ–¹æ¡†æ¶</a>
        		</li>
      		
		</ul>
	</div>


      
        <p class="article-more-link">
          <a class="article-more-a" href="/2016/06/04/SDWebImageä¹‹å›¾ç‰‡ç¼“å­˜åˆ†æ/">å±•å¼€å…¨æ–‡ >></a>
        </p>
      

      
      <div class="clearfix"></div>
    </div>
  </div>
</article>





  
    <article id="post-SDWebImage" class="article article-type-post  article-index" itemscope itemprop="blogPost">
  <div class="article-inner">
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/06/03/SDWebImage/">SDWebImageä¹‹å›¾ç‰‡ä¸‹è½½</a>
    </h1>
  

        
        <a href="/2016/06/03/SDWebImage/" class="archive-article-date">
  	<time datetime="2016-06-03T13:23:21.000Z" itemprop="datePublished"><i class="icon-calendar icon"></i>2016-06-03</time>
</a>
        
      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>æˆ‘ä»¬ç»å¸¸ä½¿ç”¨SDWebImageåœ¨åŠ è½½å›¾ç‰‡ï¼Œä½†å¯¹äºå›¾ç‰‡åŠ è½½è¿‡ç¨‹ä¸­æ€ä¹ˆæ ·å®ç°ä¸ä¼šæ·±ç©¶ã€‚ä¸‹é¢æˆ‘ä»¬å°±å¯¹SDWebImageè¿›è¡Œç›¸åº”çš„åˆ†æï¼š<br><a href="https://github.com/rs/SDWebImage" target="_blank" rel="external">æºç åœ°å€</a></p>
<h2 id="SDWebImageçš„ä¸‹è½½å™¨"><a href="#SDWebImageçš„ä¸‹è½½å™¨" class="headerlink" title="SDWebImageçš„ä¸‹è½½å™¨"></a>SDWebImageçš„ä¸‹è½½å™¨</h2><p>SDWebImageçš„ä¸‹è½½å™¨æ˜¯SDWebImageDownloaderåˆ©ç”¨å•ä¾‹æ¨¡å¼sharedDownloaderï¼Œå¯ä»¥å¯¹ä¸‹è½½çš„å›¾ç‰‡è¿›è¡Œç›¸å…³é…ç½®ã€‚å¯ä»¥é…ç½®çš„éƒ¨åˆ†å¦‚ä¸‹ï¼š</p>
<p><ul></ul></p>
<p><li>ä¸‹è½½é€‰é¡¹</li></p>
<p><li>HTTPçš„å¤´éƒ¨</li></p>
<p><li>å‹ç¼©ã€ä¸‹è½½è¶…æ—¶ã€ä¸‹è½½é¡ºåºã€æœ€å¤§å¹¶å‘æ•°ç­‰</li><br></p>
<h3 id="ä¸‹è½½é€‰é¡¹"><a href="#ä¸‹è½½é€‰é¡¹" class="headerlink" title="ä¸‹è½½é€‰é¡¹"></a>ä¸‹è½½é€‰é¡¹</h3><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">typedef</span> <span class="built_in">NS_OPTIONS</span>(<span class="built_in">NSUInteger</span>, SDWebImageDownloaderOptions) &#123;</span><br><span class="line">   <span class="comment">//ä¸‹è½½çš„ä¼˜å…ˆçº§</span></span><br><span class="line">   SDWebImageDownloaderLowPriority = <span class="number">1</span> &lt;&lt; <span class="number">0</span>,</span><br><span class="line">   <span class="comment">//ä¸‹è½½è¿›åº¦</span></span><br><span class="line">   SDWebImageDownloaderProgressiveDownload = <span class="number">1</span> &lt;&lt; <span class="number">1</span>,</span><br><span class="line">   <span class="comment">//ä¸‹è½½è·¯å¾„ç¼“å­˜</span></span><br><span class="line">   SDWebImageDownloaderUseNSURLCache = <span class="number">1</span> &lt;&lt; <span class="number">2</span>,</span><br><span class="line">   <span class="comment">//ä¸‹è½½è¿‡ç¨‹çš„è¯·æ±‚ç¼“å­˜</span></span><br><span class="line">   SDWebImageDownloaderIgnoreCachedResponse = <span class="number">1</span> &lt;&lt; <span class="number">3</span>,</span><br><span class="line">   <span class="comment">//åå°è¿›è¡Œç»§ç»­ä¸‹è½½</span></span><br><span class="line">   SDWebImageDownloaderContinueInBackground = <span class="number">1</span> &lt;&lt; <span class="number">4</span>,</span><br><span class="line">    </span><br><span class="line">   SDWebImageDownloaderHandleCookies = <span class="number">1</span> &lt;&lt; <span class="number">5</span>,</span><br><span class="line">   </span><br><span class="line">   SDWebImageDownloaderAllowInvalidSSLCertificates = <span class="number">1</span> &lt;&lt; <span class="number">6</span>,</span><br><span class="line">   </span><br><span class="line">   SDWebImageDownloaderHighPriority = <span class="number">1</span> &lt;&lt; <span class="number">7</span>,</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h3 id="HTTPçš„å¤´éƒ¨è®¾ç½®"><a href="#HTTPçš„å¤´éƒ¨è®¾ç½®" class="headerlink" title="HTTPçš„å¤´éƒ¨è®¾ç½®"></a>HTTPçš„å¤´éƒ¨è®¾ç½®</h3><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#ifdef SD_WEBP</span></span><br><span class="line">        _HTTPHeaders = [@&#123;<span class="string">@"Accept"</span>: <span class="string">@"image/webp,image/*;q=0.8"</span>&#125; mutableCopy];</span><br><span class="line"><span class="meta">#else</span></span><br><span class="line">        _HTTPHeaders = [@&#123;<span class="string">@"Accept"</span>: <span class="string">@"image/*;q=0.8"</span>&#125; mutableCopy];</span><br><span class="line"><span class="meta">#endif</span></span><br><span class="line"></span><br><span class="line">-(<span class="keyword">void</span>)setValue:(<span class="built_in">NSString</span> *)value forHTTPHeaderField:(<span class="built_in">NSString</span> *)field &#123;</span><br><span class="line">    <span class="keyword">if</span> (value) &#123;</span><br><span class="line">        <span class="keyword">self</span>.HTTPHeaders[field] = value;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> &#123;</span><br><span class="line">        [<span class="keyword">self</span>.HTTPHeaders removeObjectForKey:field];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">-(<span class="built_in">NSString</span> *)valueForHTTPHeaderField:(<span class="built_in">NSString</span> *)field &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">self</span>.HTTPHeaders[field];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>æˆ‘ä»¬å¯ä»¥é€šè¿‡ä¸Šè¿°forHTTPHeaderFieldçš„å‚æ•°è¿›è¡Œç›¸åº”HTTPheaderçš„è®¾ç½®ï¼Œä½¿ç”¨è€…å¯ä»¥å¯¹å¤´éƒ¨ä¿¡æ¯è¿›è¡Œç›¸å…³çš„æ·»åŠ æˆ–è€…æ˜¯åˆ é™¤HTTPå¤´éƒ¨ä¿¡æ¯ã€‚</p>
<h3 id="çº¿ç¨‹å®‰å…¨"><a href="#çº¿ç¨‹å®‰å…¨" class="headerlink" title="çº¿ç¨‹å®‰å…¨"></a>çº¿ç¨‹å®‰å…¨</h3><p>åœ¨å›¾ç‰‡ä¸‹è½½è¿‡ç¨‹ä¸­æˆ‘ä»¬è¦ä¿çº¿ç¨‹è®¿é—®çš„å®‰å…¨æ€§ï¼ŒbarrierQueueæ˜¯å®ç°ç½‘ç»œå“åº”çš„åºåˆ—åŒ–å®ä¾‹ã€‚<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">// This queue is used to serialize the handling of the network responses of all</span><br><span class="line">the download operation in a single queue</span><br><span class="line">@property (SDDispatchQueueSetterSementics, nonatomic) dispatch_queue_t barrierQueue;</span><br></pre></td></tr></table></figure></p>
<p>åœ¨ä¿è¯çº¿ç¨‹å®‰å…¨çš„èµ·è§ï¼Œæˆ‘ä»¬å¯¹äºURLCallbacksè¿›è¡Œå¢æ”¹éƒ½éœ€è¦æ”¾åœ¨dispatch_barrier_syncçš„å½¢å¼æ”¾å…¥åˆ°barrierQueueã€‚ä½†æ˜¯å¦‚æœæˆ‘ä»¬åªè¦è¿›è¡Œç›¸å…³çš„æŸ¥è¯¢é‚£å°±ä½¿ç”¨dispatch_syncæ”¾å…¥barrierQueueä¸­å³å¯ã€‚</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">__block <span class="built_in">NSArray</span> *callbacksForURL;</span><br><span class="line"><span class="built_in">dispatch_sync</span>(sself.barrierQueue, ^&#123;</span><br><span class="line">    callbacksForURL = [sself.URLCallbacks[url] <span class="keyword">copy</span>];</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">dispatch_barrier_sync(<span class="keyword">self</span>.barrierQueue, ^&#123;</span><br><span class="line">    <span class="built_in">BOOL</span> first = <span class="literal">NO</span>;</span><br><span class="line">    <span class="keyword">if</span> (!<span class="keyword">self</span>.URLCallbacks[url]) &#123;</span><br><span class="line">        <span class="keyword">self</span>.URLCallbacks[url] = [<span class="built_in">NSMutableArray</span> new];</span><br><span class="line">        first = <span class="literal">YES</span>;</span><br><span class="line">    &#125;</span><br><span class="line"><span class="comment">// Handle single download of simultaneous download request for the same URL</span></span><br><span class="line"><span class="built_in">NSMutableArray</span> *callbacksForURL = <span class="keyword">self</span>.URLCallbacks[url];</span><br><span class="line"><span class="built_in">NSMutableDictionary</span> *callbacks = [<span class="built_in">NSMutableDictionary</span> new];</span><br><span class="line"><span class="keyword">if</span> (progressBlock) callbacks[kProgressCallbackKey] = [progressBlock <span class="keyword">copy</span>];</span><br><span class="line"><span class="keyword">if</span> (completedBlock) callbacks[kCompletedCallbackKey] = [completedBlock <span class="keyword">copy</span>];</span><br><span class="line">[callbacksForURL addObject:callbacks];</span><br><span class="line"><span class="keyword">self</span>.URLCallbacks[url] = callbacksForURL;</span><br><span class="line"><span class="keyword">if</span> (first) &#123;</span><br><span class="line">      createCallback();</span><br><span class="line">&#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<h3 id="å›è°ƒ"><a href="#å›è°ƒ" class="headerlink" title="å›è°ƒ"></a>å›è°ƒ</h3><p>åœ¨æˆ‘ä»¬ä¸‹è½½å›¾ç‰‡çš„è¿‡ç¨‹ä¸­ï¼Œæ¯ä¸€å¼ å›¾ç‰‡éƒ½éœ€è¦å¼€å¯ä¸€ä¸ªçº¿ç¨‹ï¼Œåœ¨æ¯ä¸€ä¸ªçº¿ç¨‹ä¸­éƒ½éœ€è¦å¯¹æ‰§è¡Œä¸€å®šçš„å›è°ƒä¿¡æ¯ã€‚è¿™äº›å›è°ƒçš„ä¿¡æ¯ä¼šä»¥blockçš„å®è¡Œå‡ºç°ï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">typedef void(^SDWebImageDownloaderProgressBlock)(NSInteger receivedSize,</span><br><span class="line">NSInteger expectedSize);</span><br><span class="line"></span><br><span class="line">typedef void(^SDWebImageDownloaderCompletedBlock)(UIImage *image, NSData *data,</span><br><span class="line">NSError *error, BOOL finished);</span><br><span class="line"></span><br><span class="line">typedef NSDictionary *(^SDWebImageDownloaderHeadersFilterBlock)(NSURL *url, </span><br><span class="line">NSDictionary *headers);</span><br></pre></td></tr></table></figure><br>å›¾ç‰‡ä¸‹è½½çš„è¿™äº›å›è°ƒä¿¡æ¯å­˜å‚¨åœ¨SDWebImageDownloaderç±»çš„URLCallbackså±æ€§ä¸­ï¼Œè¯¥å±æ€§æ˜¯ä¸€ä¸ªå­—å…¸ï¼Œkeyæ˜¯å›¾ç‰‡çš„URLåœ°å€ï¼Œvalueåˆ™æ˜¯ä¸€ä¸ªæ•°ç»„ï¼ŒåŒ…å«æ¯ä¸ªå›¾ç‰‡çš„å¤šç»„å›è°ƒä¿¡æ¯ã€‚</p>
<h3 id="ä¸‹è½½å™¨"><a href="#ä¸‹è½½å™¨" class="headerlink" title="ä¸‹è½½å™¨"></a>ä¸‹è½½å™¨</h3><p>æ•´ä¸ªä¸‹è½½è¿‡ç¨‹ä¸­æˆ‘ä»¬éœ€è¦æ‰§è¡Œåœ¨æœ¬å°ç»“è®²è¿°çš„ä¸‹è½½å™¨ä¸­è¿›è¡Œï¼Œä¸‹è½½å™¨å¯¹äºä¸‹è½½çš„ç®¡ç†éƒ½æ˜¯æ”¾åœ¨-(id <sdwebimageoperation>)downloadImageWithURL:ä¸­çš„ï¼š</sdwebimageoperation></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br></pre></td><td class="code"><pre><span class="line">- (id &lt;SDWebImageOperation&gt;)downloadImageWithURL:(NSURL *)url options:(SDWebImageDownloaderOptions)options progress:(SDWebImageDownloaderProgressBlock)progressBlock completed:(SDWebImageDownloaderCompletedBlock)completedBlock &#123;</span><br><span class="line">__block SDWebImageDownloaderOperation *operation;</span><br><span class="line">__weak __typeof(self)wself = self;</span><br><span class="line">[self addProgressCallback:progressBlock completedBlock:completedBlock forURL:url createCallback:^&#123;</span><br><span class="line">        NSTimeInterval timeoutInterval = wself.downloadTimeout;</span><br><span class="line">        if (timeoutInterval == 0.0) &#123;</span><br><span class="line">            timeoutInterval = 15.0;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">// In order to prevent from potential duplicate caching (NSURLCache + SDImageCache) we disable the cache for image requests if told otherwise</span><br><span class="line"></span><br><span class="line">NSMutableURLRequest *request = [[NSMutableURLRequest alloc] initWithURL:url</span><br><span class="line">cachePolicy:(options &amp; SDWebImageDownloaderUseNSURLCache ? </span><br><span class="line">NSURLRequestUseProtocolCachePolicy : NSURLRequestReloadIgnoringLocalCacheData)</span><br><span class="line">timeoutInterval:timeoutInterval];</span><br><span class="line">request.HTTPShouldHandleCookies = (options &amp; SDWebImageDownloaderHandleCookies);</span><br><span class="line">request.HTTPShouldUsePipelining = YES;</span><br><span class="line">      if (wself.headersFilter) &#123;</span><br><span class="line">          request.allHTTPHeaderFields = wself.headersFilter(url, [wself.HTTPHeaders copy]);</span><br><span class="line">      &#125;</span><br><span class="line">      else &#123;</span><br><span class="line">          request.allHTTPHeaderFields = wself.HTTPHeaders;</span><br><span class="line">      &#125;</span><br><span class="line">      operation = [[wself.operationClass alloc] initWithRequest:request</span><br><span class="line">                                                        options:options</span><br><span class="line">                                                       progress:^(NSInteger receivedSize, NSInteger expectedSize) &#123;</span><br><span class="line">                                                           SDWebImageDownloader *sself = wself;</span><br><span class="line">                                                           if (!sself) return;</span><br><span class="line">                                                           __block NSArray *callbacksForURL;</span><br><span class="line">                                                           dispatch_sync(sself.barrierQueue, ^&#123;</span><br><span class="line">                                                               callbacksForURL = [sself.URLCallbacks[url] copy];</span><br><span class="line">                                                           &#125;);</span><br><span class="line">                                                           for (NSDictionary *callbacks in callbacksForURL) &#123;</span><br><span class="line">                                                               dispatch_async(dispatch_get_main_queue(), ^&#123;</span><br><span class="line">                                                                   SDWebImageDownloaderProgressBlock callback = callbacks[kProgressCallbackKey];</span><br><span class="line">                                                                   if (callback) callback(receivedSize, expectedSize);</span><br><span class="line">                                                               &#125;);</span><br><span class="line">                                                           &#125;</span><br><span class="line">                                                       &#125;</span><br><span class="line">                                                      completed:^(UIImage *image, NSData *data, NSError *error, BOOL finished) &#123;</span><br><span class="line">                                                          SDWebImageDownloader *sself = wself;</span><br><span class="line">                                                          if (!sself) return;</span><br><span class="line">                                                          __block NSArray *callbacksForURL;</span><br><span class="line">                                                          dispatch_barrier_sync(sself.barrierQueue, ^&#123;</span><br><span class="line">                                                              callbacksForURL = [sself.URLCallbacks[url] copy];</span><br><span class="line">                                                              if (finished) &#123;</span><br><span class="line">                                                                  [sself.URLCallbacks removeObjectForKey:url];</span><br><span class="line">                                                              &#125;</span><br><span class="line">                                                          &#125;);</span><br><span class="line">                                                          for (NSDictionary *callbacks in callbacksForURL) &#123;</span><br><span class="line">                                                              SDWebImageDownloaderCompletedBlock callback = callbacks[kCompletedCallbackKey];</span><br><span class="line">                                                              if (callback) callback(image, data, error, finished);</span><br><span class="line">                                                          &#125;</span><br><span class="line">                                                      &#125;</span><br><span class="line">                                                      cancelled:^&#123;</span><br><span class="line">                                                          SDWebImageDownloader *sself = wself;</span><br><span class="line">                                                          if (!sself) return;</span><br><span class="line">                                                          dispatch_barrier_async(sself.barrierQueue, ^&#123;</span><br><span class="line">                                                              [sself.URLCallbacks removeObjectForKey:url];</span><br><span class="line">                                                          &#125;);</span><br><span class="line">                                                      &#125;];</span><br><span class="line">      operation.shouldDecompressImages = wself.shouldDecompressImages;</span><br><span class="line">      </span><br><span class="line">      if (wself.urlCredential) &#123;</span><br><span class="line">          operation.credential = wself.urlCredential;</span><br><span class="line">      &#125; else if (wself.username &amp;&amp; wself.password) &#123;</span><br><span class="line">          operation.credential = [NSURLCredential credentialWithUser:wself.username password:wself.password persistence:NSURLCredentialPersistenceForSession];</span><br><span class="line">      &#125;</span><br><span class="line">      </span><br><span class="line">      if (options &amp; SDWebImageDownloaderHighPriority) &#123;</span><br><span class="line">          operation.queuePriority = NSOperationQueuePriorityHigh;</span><br><span class="line">      &#125; else if (options &amp; SDWebImageDownloaderLowPriority) &#123;</span><br><span class="line">          operation.queuePriority = NSOperationQueuePriorityLow;</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      [wself.downloadQueue addOperation:operation];</span><br><span class="line">      if (wself.executionOrder == SDWebImageDownloaderLIFOExecutionOrder) &#123;</span><br><span class="line">          // Emulate LIFO execution order by systematically adding new operations as last operation&apos;s dependency</span><br><span class="line">          [wself.lastAddedOperation addDependency:operation];</span><br><span class="line">          wself.lastAddedOperation = operation;</span><br><span class="line">      &#125;</span><br><span class="line">  &#125;];</span><br><span class="line"></span><br><span class="line">  return operation;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>æˆ‘ä»¬åœ¨ä¸Šé¢çš„æ–¹æ³•ä¸­è°ƒç”¨çš„æ–¹æ³•(void)addProgressCallback:completedBlock:forURL:createCallback:å°†åœ¨è®¿é—®å›¾ç‰‡è¯·æ±‚çš„ä¿¡æ¯ç›´æ¥æ”¾å…¥ä¸‹è½½å™¨ã€‚</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">- (<span class="keyword">void</span>)addProgressCallback:(SDWebImageDownloaderProgressBlock)progressBlock completedBlock:(SDWebImageDownloaderCompletedBlock)completedBlock forURL:(<span class="built_in">NSURL</span>*)url createCallback:(SDWebImageNoParamsBlock)createCallback &#123;</span><br><span class="line"><span class="comment">// The URL will be used as the key to the callbacks dictionary so it cannot be nil. If it is nil immediately call the completed block with no image or data.</span></span><br><span class="line">    <span class="keyword">if</span> (url == <span class="literal">nil</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (completedBlock != <span class="literal">nil</span>) &#123;</span><br><span class="line">            completedBlock(<span class="literal">nil</span>, <span class="literal">nil</span>, <span class="literal">nil</span>, <span class="literal">NO</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">dispatch_barrier_sync(<span class="keyword">self</span>.barrierQueue, ^&#123;</span><br><span class="line">   <span class="built_in">BOOL</span> first = <span class="literal">NO</span>;</span><br><span class="line">   <span class="keyword">if</span> (!<span class="keyword">self</span>.URLCallbacks[url]) &#123;</span><br><span class="line">       <span class="keyword">self</span>.URLCallbacks[url] = [<span class="built_in">NSMutableArray</span> new];</span><br><span class="line">       first = <span class="literal">YES</span>;</span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line">   <span class="comment">// Handle single download of simultaneous download request for the same URL</span></span><br><span class="line">   <span class="built_in">NSMutableArray</span> *callbacksForURL = <span class="keyword">self</span>.URLCallbacks[url];</span><br><span class="line">   <span class="built_in">NSMutableDictionary</span> *callbacks = [<span class="built_in">NSMutableDictionary</span> new];</span><br><span class="line">   <span class="keyword">if</span> (progressBlock) callbacks[kProgressCallbackKey] = [progressBlock <span class="keyword">copy</span>];</span><br><span class="line">   <span class="keyword">if</span> (completedBlock) callbacks[kCompletedCallbackKey] = [completedBlock <span class="keyword">copy</span>];</span><br><span class="line">   [callbacksForURL addObject:callbacks];</span><br><span class="line">   <span class="keyword">self</span>.URLCallbacks[url] = callbacksForURL;</span><br><span class="line"></span><br><span class="line">   <span class="keyword">if</span> (first) &#123;</span><br><span class="line">       createCallback();</span><br><span class="line">   &#125;</span><br><span class="line">&#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="ä¸‹è½½æ“ä½œ"><a href="#ä¸‹è½½æ“ä½œ" class="headerlink" title="ä¸‹è½½æ“ä½œ"></a>ä¸‹è½½æ“ä½œ</h3><p>åœ¨æ¯å¼ å›¾ç‰‡ä¸‹è½½è¿‡ç¨‹ä¸­éƒ½è¦è°ƒç”¨ä¸€æ¬¡å…·ä½“çš„æ“ä½œéƒ½ä¼šè°ƒç”¨Operationï¼Œä¸‹é¢å°±åˆ†æä¸€ä¸‹ä¸­é—´çš„å…·ä½“è¿‡ç¨‹ã€‚<br>æˆ‘ä»¬æ‰“å¼€SDWebImageçš„æ–‡ä»¶å¤¹å¯ä»¥åˆ°å…¶ä¸­æœ‰ä¸€ä¸ªSDWebImageOperationçš„ç±»ï¼Œå¦‚ä¸‹ï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">#import &lt;Foundation/Foundation.h&gt;</span><br><span class="line"></span><br><span class="line">@protocol SDWebImageOperation &lt;NSObject&gt;</span><br><span class="line"></span><br><span class="line">- (void)cancel;</span><br><span class="line"></span><br><span class="line">@end</span><br></pre></td></tr></table></figure><br>å…¶ä¸­æˆ‘ä»¬ä½¿ç”¨NSOpationçš„å­ç±»æ¥å®Œæˆå…·ä½“å›¾ç‰‡ä¸‹è½½çš„è¿‡ç¨‹ï¼Œè¿™ä¸ªç±»å°±æ˜¯SDWebImageDownloaderOperationã€‚åœ¨SDWebImageDownloaderOperationç±»ä¸­ç»§æ‰¿NSOperationçš„ç±»è€Œä¸”å®ç°SDWebImageOperationçš„cancelçš„å–æ¶ˆåè®®ã€‚é™¤äº†ç»§æ‰¿è€Œæ¥çš„æ–¹æ³•ï¼Œè¯¥ç±»åªå‘å¤–æš´éœ²äº†ä¸€ä¸ªæ–¹æ³•ï¼Œå³ä¸Šé¢æ‰€ç”¨åˆ°çš„åˆå§‹åŒ–æ–¹æ³•initWithRequest:options:pregress:completed:cancelled:ã€‚</p>
<p>å¯¹äºå›¾ç‰‡çš„ä¸‹è½½ï¼ŒSDWebImageDownloaderOperationå®Œå…¨ä¾èµ–äºURLåŠ è½½ç³»ç»Ÿä¸­çš„NSURLConnectionç±»ï¼ˆå¹¶æœªä½¿ç”¨iOS7ä»¥åçš„NSURLSessionç±»ï¼‰ã€‚æˆ‘ä»¬å…ˆæ¥åˆ†æä¸€ä¸‹SDWebImageDownloaderOperationç±»ä¸­å¯¹äºå›¾ç‰‡å®é™…æ•°æ®çš„ä¸‹è½½å¤„ç†ï¼Œå³NSURLConnectionå„ä»£ç†æ–¹æ³•çš„å®ç°ã€‚</p>
<p>é¦–å…ˆï¼ŒSDWebImageDownloaderOperationåœ¨Extentionä¸­é‡‡ç”¨äº†NSURLConnectionDataDelegateåè®®ï¼Œå¹¶å®ç°äº†åè®®çš„ä»¥ä¸‹å‡ ä¸ªæ–¹æ³•ï¼š</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">connection:didReceiveResponse:</span><br><span class="line">connection:didReceiveData:</span><br><span class="line">connectionDidFinishLoading:</span><br><span class="line">connection:didFailWithError:</span><br><span class="line">connection:willCacheResponse:</span><br><span class="line">connectionShouldUseCredentialStorage:</span><br><span class="line">connection:willSendRequestForAuthenticationChallenge:</span><br></pre></td></tr></table></figure>
<p>è¿™äº›æ–¹æ³•æˆ‘ä»¬å°±ä¸é€ä¸€åˆ†æäº†ï¼Œå°±ç»ˆç‚¹åˆ†æä¸€ä¸‹connection:didReceiveResponse:å’Œconnection:didReceiveData:ä¸¤ä¸ªæ–¹æ³•ã€‚</p>
<p>connection:didReceiveResponseæ–¹æ³•é€šè¿‡åˆ¤æ–­NSURLResponseçš„å®é™…ç±»å‹å’ŒçŠ¶æ€ç ï¼Œå¯¹é™¤304ä»¥å¤–400ä»¥å†…çš„çŠ¶æ€ç ååº”ã€‚</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line">- (<span class="keyword">void</span>)connection:(<span class="built_in">NSURLConnection</span> *)connection didReceiveResponse:(<span class="built_in">NSURLResponse</span> *)response &#123;</span><br><span class="line"> </span><br><span class="line"> <span class="comment">//'304 Not Modified' is an exceptional one</span></span><br><span class="line"> <span class="keyword">if</span> (![response respondsToSelector:<span class="keyword">@selector</span>(statusCode)] ||([((<span class="built_in">NSHTTPURLResponse</span> *)response) statusCode] &lt; <span class="number">400</span> &amp;&amp; [((<span class="built_in">NSHTTPURLResponse</span>  *)response) statusCode] != <span class="number">304</span>)) &#123;</span><br><span class="line">      <span class="built_in">NSInteger</span> expected = response.expectedContentLength &gt; <span class="number">0</span> ? (<span class="built_in">NSInteger</span>)</span><br><span class="line">      response.expectedContentLength : <span class="number">0</span>;</span><br><span class="line">     <span class="keyword">self</span>.expectedSize = expected;</span><br><span class="line">     <span class="keyword">if</span> (<span class="keyword">self</span>.progressBlock) &#123;</span><br><span class="line">         <span class="keyword">self</span>.progressBlock(<span class="number">0</span>, expected);</span><br><span class="line">     &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">self</span>.imageData = [[<span class="built_in">NSMutableData</span> alloc] initWithCapacity:expected];</span><br><span class="line">  <span class="keyword">self</span>.response = response;</span><br><span class="line">  <span class="built_in">dispatch_async</span>(dispatch_get_main_queue(), ^&#123;</span><br><span class="line">      [[<span class="built_in">NSNotificationCenter</span> defaultCenter] postNotificationName:</span><br><span class="line">      SDWebImageDownloadReceiveResponseNotification object:<span class="keyword">self</span>];</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span> &#123;</span><br><span class="line">   <span class="built_in">NSUInteger</span> code = [((<span class="built_in">NSHTTPURLResponse</span> *)response) statusCode];</span><br><span class="line">   </span><br><span class="line">   <span class="comment">//This is the case when server returns '304 Not Modified'. It means that </span></span><br><span class="line">   remote image is not changed.</span><br><span class="line">   <span class="comment">//In case of 304 we need just cancel the operation and return cached image       </span></span><br><span class="line">   from the cache.</span><br><span class="line">   <span class="keyword">if</span> (code == <span class="number">304</span>) &#123;</span><br><span class="line">       [<span class="keyword">self</span> cancelInternal];</span><br><span class="line">   &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">       [<span class="keyword">self</span>.connection cancel];</span><br><span class="line">   &#125;</span><br><span class="line">   <span class="built_in">dispatch_async</span>(dispatch_get_main_queue(), ^&#123;</span><br><span class="line">       [[<span class="built_in">NSNotificationCenter</span> defaultCenter] postNotificationName:SDWebImageDownloadStopNotification object:<span class="keyword">self</span>];</span><br><span class="line">   &#125;);</span><br><span class="line"></span><br><span class="line">   <span class="keyword">if</span> (<span class="keyword">self</span>.completedBlock) &#123;</span><br><span class="line">       <span class="keyword">self</span>.completedBlock(<span class="literal">nil</span>, <span class="literal">nil</span>, [<span class="built_in">NSError</span> errorWithDomain:</span><br><span class="line">       <span class="built_in">NSURLErrorDomain</span> code:[((<span class="built_in">NSHTTPURLResponse</span> *)response) statusCode] </span><br><span class="line">       userInfo:<span class="literal">nil</span>], <span class="literal">YES</span>);</span><br><span class="line">   &#125;</span><br><span class="line">   <span class="built_in">CFRunLoopStop</span>(<span class="built_in">CFRunLoopGetCurrent</span>());</span><br><span class="line">   [<span class="keyword">self</span> done];</span><br><span class="line"> &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>connection:didReceiveData:æ–¹æ³•çš„ä¸»è¦ä»»åŠ¡æ˜¯æ¥å—æ•°æ®ã€‚æ¯æ¬¡æ¥æ”¶åˆ°æ•°æ®æ—¶ï¼Œéƒ½ä¼šç”¨ç°æœ‰çš„æ•°æ®åˆ›å»ºä¸€ä¸ªCGImageSourceRefå¯¹è±¡ä»¥ä½œå¤„ç†ã€‚åœ¨é¦–æ¬¡è·å–åˆ°æ•°æ®æ—¶ï¼ˆwidth+height==0ï¼‰ä¼šä»è¿™äº›åŒ…å«å›¾åƒä¿¡æ¯çš„æ•°æ®ä¸­å–å‡ºå›¾åƒçš„é•¿ã€å®½ã€æ–¹å‘ç­‰ä¿¡æ¯ä»¥å¤‡ä½¿ç”¨ã€‚è€Œååœ¨å›¾ç‰‡ä¸‹è½½å®Œæˆä¹‹å‰ï¼Œä¼šä½¿ç”¨CGImageSourceRefå¯¹è±¡åˆ›å»ºä¸€ä¸ªå›¾åƒå¯¹è±¡ï¼Œç»è¿‡ç¼©æ”¾ã€è§£å‹ç¼©æ“ä½œåç”Ÿæˆä¸€ä¸ªUIImageå¯¹è±¡ä¾›å®Œæˆå›è°ƒä½¿ç”¨ã€‚å½“ç„¶ï¼Œåœ¨è¿™ä¸ªæ–¹æ³•ä¸­è¿˜éœ€è¦å¤„ç†çš„å°±æ˜¯è¿›åº¦ä¿¡æ¯ã€‚å¦‚æœæˆ‘ä»¬æœ‰è®¾ç½®è¿›åº¦å›è°ƒçš„è¯ï¼Œå°±è°ƒç”¨è¿›åº¦å›è°ƒä»¥å¤„ç†å½“å‰å›¾ç‰‡çš„ä¸‹è½½è¿›åº¦ã€‚</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br></pre></td><td class="code"><pre><span class="line">- (<span class="keyword">void</span>)connection:(<span class="built_in">NSURLConnection</span> *)connection didReceiveData:(<span class="built_in">NSData</span> *)data</span><br><span class="line">&#123;</span><br><span class="line">    [<span class="keyword">self</span>.imageData appendData:data];</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> ((<span class="keyword">self</span>.options &amp; SDWebImageDownloaderProgressiveDownload) &amp;&amp; <span class="keyword">self</span>.expectedSize &gt; <span class="number">0</span> &amp;&amp; <span class="keyword">self</span>.completedBlock) &#123;</span><br><span class="line"><span class="comment">// The following code is from http://www.cocoaintheshell.com/2011/05/</span></span><br><span class="line">progressive-images-download-imageio/</span><br><span class="line"><span class="comment">// Thanks to the author @Nyx0uf</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// Get the total bytes downloaded </span></span><br><span class="line">     <span class="keyword">const</span> <span class="built_in">NSInteger</span> totalSize = <span class="keyword">self</span>.imageData.length;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Update the data source, we must pass ALL the data, not just the new bytes</span></span><br><span class="line">     <span class="built_in">CGImageSourceRef</span> imageSource = <span class="built_in">CGImageSourceCreateWithData</span>((__bridge <span class="built_in">CFDataRef</span>)<span class="keyword">self</span>.imageData, <span class="literal">NULL</span>);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (width + height == <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="built_in">CFDictionaryRef</span> properties = <span class="built_in">CGImageSourceCopyPropertiesAtIndex</span>(imageSource, <span class="number">0</span>, <span class="literal">NULL</span>);</span><br><span class="line">            <span class="keyword">if</span> (properties) &#123;</span><br><span class="line">                <span class="built_in">NSInteger</span> orientationValue = <span class="number">-1</span>;</span><br><span class="line">                <span class="built_in">CFTypeRef</span> val = <span class="built_in">CFDictionaryGetValue</span>(properties, kCGImagePropertyPixelHeight);</span><br><span class="line">                <span class="keyword">if</span> (val) <span class="built_in">CFNumberGetValue</span>(val, kCFNumberLongType, &amp;height);</span><br><span class="line">                val = <span class="built_in">CFDictionaryGetValue</span>(properties, kCGImagePropertyPixelWidth);</span><br><span class="line">                <span class="keyword">if</span> (val) <span class="built_in">CFNumberGetValue</span>(val, kCFNumberLongType, &amp;width);</span><br><span class="line">                val = <span class="built_in">CFDictionaryGetValue</span>(properties, kCGImagePropertyOrientation);</span><br><span class="line">                <span class="keyword">if</span> (val) <span class="built_in">CFNumberGetValue</span>(val, kCFNumberNSIntegerType, &amp;orientationValue);</span><br><span class="line">                <span class="built_in">CFRelease</span>(properties);</span><br><span class="line"><span class="comment">// When we draw to Core Graphics, we lose orientation information,</span></span><br><span class="line"><span class="comment">// which means the image below born of initWithCGIImage will be</span></span><br><span class="line"><span class="comment">// oriented incorrectly sometimes. (Unlike the image born of initWithData</span></span><br><span class="line"><span class="comment">// in connectionDidFinishLoading.) So save it here and pass it on later.</span></span><br><span class="line"></span><br><span class="line">                orientation = [[<span class="keyword">self</span> class] orientationFromPropertyValue:(orientationValue == <span class="number">-1</span> ? <span class="number">1</span> : orientationValue)];</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (width + height &gt; <span class="number">0</span> &amp;&amp; totalSize &lt; <span class="keyword">self</span>.expectedSize) &#123;</span><br><span class="line">            <span class="comment">// Create the image</span></span><br><span class="line">            <span class="built_in">CGImageRef</span> partialImageRef = <span class="built_in">CGImageSourceCreateImageAtIndex</span>(imageSource, <span class="number">0</span>, <span class="literal">NULL</span>);</span><br><span class="line"></span><br><span class="line"><span class="meta">#ifdef TARGET_OS_IPHONE</span></span><br><span class="line">            <span class="comment">// Workaround for iOS anamorphic image</span></span><br><span class="line">            <span class="keyword">if</span> (partialImageRef) &#123;</span><br><span class="line">                <span class="keyword">const</span> size_t partialHeight = <span class="built_in">CGImageGetHeight</span>(partialImageRef);</span><br><span class="line">                <span class="built_in">CGColorSpaceRef</span> colorSpace = <span class="built_in">CGColorSpaceCreateDeviceRGB</span>();</span><br><span class="line">                <span class="built_in">CGContextRef</span> bmContext = <span class="built_in">CGBitmapContextCreate</span>(<span class="literal">NULL</span>, width, height, <span class="number">8</span>, width * <span class="number">4</span>, colorSpace, kCGBitmapByteOrderDefault | kCGImageAlphaPremultipliedFirst);</span><br><span class="line">                <span class="built_in">CGColorSpaceRelease</span>(colorSpace);</span><br><span class="line">                <span class="keyword">if</span> (bmContext) &#123;</span><br><span class="line">                    <span class="built_in">CGContextDrawImage</span>(bmContext, (<span class="built_in">CGRect</span>)&#123;.origin.x = <span class="number">0.0</span>f, .origin.y = <span class="number">0.0</span>f, .size.width = width, .size.height = partialHeight&#125;, partialImageRef);</span><br><span class="line">                    <span class="built_in">CGImageRelease</span>(partialImageRef);</span><br><span class="line">                    partialImageRef = <span class="built_in">CGBitmapContextCreateImage</span>(bmContext);</span><br><span class="line">                    <span class="built_in">CGContextRelease</span>(bmContext);</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">else</span> &#123;</span><br><span class="line">                    <span class="built_in">CGImageRelease</span>(partialImageRef);</span><br><span class="line">                    partialImageRef = <span class="literal">nil</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line"><span class="meta">#endif</span></span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> (partialImageRef) &#123;</span><br><span class="line">                <span class="built_in">UIImage</span> *image = [<span class="built_in">UIImage</span> imageWithCGImage:partialImageRef scale:<span class="number">1</span> orientation:orientation];</span><br><span class="line">                <span class="built_in">NSString</span> *key = [[SDWebImageManager sharedManager] cacheKeyForURL:<span class="keyword">self</span>.request.URL];</span><br><span class="line">                <span class="built_in">UIImage</span> *scaledImage = [<span class="keyword">self</span> scaledImageForKey:key image:image];</span><br><span class="line">                <span class="keyword">if</span> (<span class="keyword">self</span>.shouldDecompressImages) &#123;</span><br><span class="line">                    image = [<span class="built_in">UIImage</span> decodedImageWithImage:scaledImage];</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">else</span> &#123;</span><br><span class="line">                    image = scaledImage;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="built_in">CGImageRelease</span>(partialImageRef);</span><br><span class="line">                dispatch_main_sync_safe(^&#123;</span><br><span class="line">                    <span class="keyword">if</span> (<span class="keyword">self</span>.completedBlock) &#123;</span><br><span class="line">                        <span class="keyword">self</span>.completedBlock(image, <span class="literal">nil</span>, <span class="literal">nil</span>, <span class="literal">NO</span>);</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="built_in">CFRelease</span>(imageSource);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">self</span>.progressBlock) &#123;</span><br><span class="line">        <span class="keyword">self</span>.progressBlock(<span class="keyword">self</span>.imageData.length, <span class="keyword">self</span>.expectedSize);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>æˆ‘ä»¬å‰é¢è¯´è¿‡SDWebImageDownloaderOperationç±»æ˜¯ç»§æ‰¿è‡ªNSOperationç±»ã€‚å®ƒæ²¡æœ‰ç®€å•çš„å®ç°mainæ–¹æ³•ï¼Œè€Œæ˜¯é‡‡ç”¨æ›´åŠ çµæ´»çš„startæ–¹æ³•ï¼Œä»¥ä¾¿è‡ªå·±ç®¡ç†ä¸‹è½½çš„çŠ¶æ€ã€‚</p>
<p>åœ¨startæ–¹æ³•ä¸­ï¼Œåˆ›å»ºäº†æˆ‘ä»¬ä¸‹è½½æ‰€ä½¿ç”¨çš„NSURLConnectionå¯¹è±¡ï¼Œå¼€å¯äº†å›¾ç‰‡çš„ä¸‹è½½ï¼ŒåŒæ—¶æŠ›å‡ºä¸€ä¸ªä¸‹è½½å¼€å§‹çš„é€šçŸ¥ã€‚startæ–¹æ³•çš„å…·ä½“å®ç°å¦‚ä¸‹ï¼š</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br></pre></td><td class="code"><pre><span class="line">- (<span class="keyword">void</span>)start &#123;</span><br><span class="line">    <span class="keyword">@synchronized</span> (<span class="keyword">self</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">self</span>.isCancelled) &#123;</span><br><span class="line">            <span class="keyword">self</span>.finished = <span class="literal">YES</span>;</span><br><span class="line">            [<span class="keyword">self</span> reset];</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">#if TARGET_OS_IPHONE &amp;&amp; __IPHONE_OS_VERSION_MAX_ALLOWED &gt;= __IPHONE_4_0</span></span><br><span class="line">        Class <span class="built_in">UIApplicationClass</span> = <span class="built_in">NSClassFromString</span>(<span class="string">@"UIApplication"</span>);</span><br><span class="line">        <span class="built_in">BOOL</span> hasApplication = <span class="built_in">UIApplicationClass</span> &amp;&amp; [<span class="built_in">UIApplicationClass</span> respondsToSelector:<span class="keyword">@selector</span>(sharedApplication)];</span><br><span class="line">        <span class="keyword">if</span> (hasApplication &amp;&amp; [<span class="keyword">self</span> shouldContinueWhenAppEntersBackground]) &#123;</span><br><span class="line">            __<span class="keyword">weak</span> __typeof__ (<span class="keyword">self</span>) wself = <span class="keyword">self</span>;</span><br><span class="line">            <span class="built_in">UIApplication</span> * app = [<span class="built_in">UIApplicationClass</span> performSelector:<span class="keyword">@selector</span>(sharedApplication)];</span><br><span class="line">            <span class="keyword">self</span>.backgroundTaskId = [app beginBackgroundTaskWithExpirationHandler:^&#123;</span><br><span class="line">                __<span class="keyword">strong</span> __<span class="keyword">typeof</span> (wself) sself = wself;</span><br><span class="line"></span><br><span class="line">                <span class="keyword">if</span> (sself) &#123;</span><br><span class="line">                    [sself cancel];</span><br><span class="line"></span><br><span class="line">                    [app endBackgroundTask:sself.backgroundTaskId];</span><br><span class="line">                    sself.backgroundTaskId = <span class="built_in">UIBackgroundTaskInvalid</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;];</span><br><span class="line">        &#125;</span><br><span class="line"><span class="meta">#endif</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">self</span>.executing = <span class="literal">YES</span>;</span><br><span class="line">        <span class="keyword">self</span>.connection = [[<span class="built_in">NSURLConnection</span> alloc] initWithRequest:<span class="keyword">self</span>.request delegate:<span class="keyword">self</span> startImmediately:<span class="literal">NO</span>];</span><br><span class="line">        <span class="keyword">self</span>.thread = [<span class="built_in">NSThread</span> currentThread];</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    [<span class="keyword">self</span>.connection start];</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">self</span>.connection) &#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">self</span>.progressBlock) &#123;</span><br><span class="line">            <span class="keyword">self</span>.progressBlock(<span class="number">0</span>, <span class="built_in">NSURLResponseUnknownLength</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">dispatch_async</span>(dispatch_get_main_queue(), ^&#123;</span><br><span class="line">            [[<span class="built_in">NSNotificationCenter</span> defaultCenter] postNotificationName:SDWebImageDownloadStartNotification object:<span class="keyword">self</span>];</span><br><span class="line">        &#125;);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (floor(<span class="built_in">NSFoundationVersionNumber</span>) &lt;= <span class="built_in">NSFoundationVersionNumber_iOS_5_1</span>) &#123;</span><br><span class="line">            <span class="comment">// Make sure to run the runloop in our background thread so it can process downloaded data</span></span><br><span class="line">            <span class="comment">// Note: we use a timeout to work around an issue with NSURLConnection cancel under iOS 5</span></span><br><span class="line">            <span class="comment">//       not waking up the runloop, leading to dead threads (see https://github.com/rs/SDWebImage/issues/466)</span></span><br><span class="line">            <span class="built_in">CFRunLoopRunInMode</span>(kCFRunLoopDefaultMode, <span class="number">10</span>, <span class="literal">false</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="built_in">CFRunLoopRun</span>();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (!<span class="keyword">self</span>.isFinished) &#123;</span><br><span class="line">            [<span class="keyword">self</span>.connection cancel];</span><br><span class="line">            [<span class="keyword">self</span> connection:<span class="keyword">self</span>.connection didFailWithError:[<span class="built_in">NSError</span> errorWithDomain:<span class="built_in">NSURLErrorDomain</span> code:<span class="built_in">NSURLErrorTimedOut</span> userInfo:@&#123;<span class="built_in">NSURLErrorFailingURLErrorKey</span> : <span class="keyword">self</span>.request.URL&#125;]];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">self</span>.completedBlock) &#123;</span><br><span class="line">            <span class="keyword">self</span>.completedBlock(<span class="literal">nil</span>, <span class="literal">nil</span>, [<span class="built_in">NSError</span> errorWithDomain:<span class="built_in">NSURLErrorDomain</span> code:<span class="number">0</span> userInfo:@&#123;<span class="built_in">NSLocalizedDescriptionKey</span> : <span class="string">@"Connection can't be initialized"</span>&#125;], <span class="literal">YES</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">#if TARGET_OS_IPHONE &amp;&amp; __IPHONE_OS_VERSION_MAX_ALLOWED &gt;= __IPHONE_4_0</span></span><br><span class="line">    Class <span class="built_in">UIApplicationClass</span> = <span class="built_in">NSClassFromString</span>(<span class="string">@"UIApplication"</span>);</span><br><span class="line">    <span class="keyword">if</span>(!<span class="built_in">UIApplicationClass</span> || ![<span class="built_in">UIApplicationClass</span> respondsToSelector:<span class="keyword">@selector</span>(sharedApplication)]) &#123;</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">self</span>.backgroundTaskId != <span class="built_in">UIBackgroundTaskInvalid</span>) &#123;</span><br><span class="line">        <span class="built_in">UIApplication</span> * app = [<span class="built_in">UIApplication</span> performSelector:<span class="keyword">@selector</span>(sharedApplication)];</span><br><span class="line">        [app endBackgroundTask:<span class="keyword">self</span>.backgroundTaskId];</span><br><span class="line">        <span class="keyword">self</span>.backgroundTaskId = <span class="built_in">UIBackgroundTaskInvalid</span>;</span><br><span class="line">    &#125;</span><br><span class="line"><span class="meta">#endif</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>åœ¨ä¸‹è½½å®Œåæˆ–è€…æ˜¯ä¸‹è½½å¤±è´¥åéƒ½ä¼šåœæ­¢å½“å‰è°ƒç”¨çš„runloopï¼Œæ¸…æ¥šé“¾æ¥éšåå°±æŠ›å‡ºä¸‹è½½åœæ­¢çš„æ¶ˆæ¯ã€‚<br>å¦‚æœä¸‹è½½æˆåŠŸï¼Œåˆ™ä¼šå¤„ç†å®Œæ•´çš„å›¾ç‰‡æ•°æ®ï¼Œå¯¹å…¶è¿›è¡Œé€‚å½“çš„ç¼©æ”¾ä¸è§£å‹ç¼©æ“ä½œï¼Œä»¥æä¾›ç»™å®Œæˆå›è°ƒä½¿ç”¨ã€‚å…·ä½“å¯å‚è€ƒ-connectionDidFinishLoading:ä¸-connection:didFailWithError:çš„å®ç°ã€‚</p>
<h3 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h3><p>æˆ‘ä»¬åœ¨ä¸Šé¢çš„ä»‹ç»å¯ä»¥çœ‹å‡ºåœ¨ä¸‹è½½å›¾ç‰‡çš„è¿‡ç¨‹ä¸­ï¼Œæ¯æ¬¡ä¸‹è½½å›¾ç‰‡éƒ½ä¼šè°ƒç”¨NSOperationçš„å‡½æ•°è¿›è¡Œå¤„ç†ï¼Œæ¯æ¬¡æ•°æ®å®é™…å®ç°æ˜¯ä½¿ç”¨NSURLConnectionã€‚æˆ‘ä»¬æŠŠå…·ä½“å®ç°çš„çº¿ç¨‹æ”¾ç½®åœ¨é˜Ÿåˆ—ä¸­è¿›è¡Œæ‰§è¡Œæ“ä½œã€‚å¦‚æœä¸‹è½½æˆåŠŸï¼Œåˆ™ä¼šå¤„ç†å®Œæ•´çš„å›¾ç‰‡æ•°æ®ï¼Œå¯¹å…¶è¿›è¡Œé€‚å½“çš„ç¼©æ”¾ä¸è§£å‹ç¼©æ“ä½œï¼Œä»¥æä¾›ç»™å®Œæˆå›è°ƒä½¿ç”¨ã€‚å…·ä½“å¯å‚è€ƒ-connectionDidFinishLoading:ä¸-connection:didFailWithError:çš„å®ç°ã€‚</p>
<p><a href="http://boilwater.github.io/2016/06/04/SDWebImageä¹‹å›¾ç‰‡ç¼“å­˜åˆ†æ/" target="_blank" rel="external">ä¸‹ä¸€èŠ‚æˆ‘ä»¬å°†è®²è¿°å¦‚ä½•å¯¹ä¸‹è½½çš„å›¾ç‰‡è¿›è¡Œç¼“å­˜å¤„ç†</a>;</p>

      

      
    </div>
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<i class="icon-price-tags icon"></i>
		<ul class="article-tag-list">
			 
        		<li class="article-tag-list-item">
        			<a href="javascript:void(0)" class="js-tag article-tag-list-link color2">ä¸‰æ–¹æ¡†æ¶è§£æ</a>
        		</li>
      		
		</ul>
	</div>

      
	<div class="article-category tagcloud">
		<i class="icon-book icon"></i>
		<ul class="article-tag-list">
			 
        		<li class="article-tag-list-item">
        			<a href="/categories/ç¬¬ä¸‰æ–¹æ¡†æ¶/" class="article-tag-list-link color1">ç¬¬ä¸‰æ–¹æ¡†æ¶</a>
        		</li>
      		
		</ul>
	</div>


      
        <p class="article-more-link">
          <a class="article-more-a" href="/2016/06/03/SDWebImage/">å±•å¼€å…¨æ–‡ >></a>
        </p>
      

      
      <div class="clearfix"></div>
    </div>
  </div>
</article>





  
    <article id="post-IOSé¢è¯•æ¢³ç†&amp;è‡ªå·±ç†è§£&amp;è¯¦ç»†èµ„æ–™åº“" class="article article-type-post  article-index" itemscope itemprop="blogPost">
  <div class="article-inner">
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/06/02/IOSé¢è¯•æ¢³ç†&è‡ªå·±ç†è§£&è¯¦ç»†èµ„æ–™åº“/">IOSé¢è¯•&amp;è‡ªå·±ç†è§£&amp;è¯¦ç»†èµ„æ–™åº“</a>
    </h1>
  

        
        <a href="/2016/06/02/IOSé¢è¯•æ¢³ç†&è‡ªå·±ç†è§£&è¯¦ç»†èµ„æ–™åº“/" class="archive-article-date">
  	<time datetime="2016-06-02T11:01:41.000Z" itemprop="datePublished"><i class="icon-calendar icon"></i>2016-06-02</time>
</a>
        
      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>å¼€å¯å…³äºIOSé¢è¯•ä¹‹è·¯æ€»ç»“ï¼Œè¯´å®è¯ç›®å‰IOSå¼€å‘çœŸæ˜¯å¤ªå¤šå¾ˆå¤šæƒ…å†µä¸‹å¤§å®¶æƒ…å†µè‰¯è ä¸é½å¾ˆéš¾åˆ†è¾¨ã€‚ç›®å‰è¿˜æ˜¯åœ¨å¹¿å·ï¼Œå…¶å®è¿˜æ˜¯å¾ˆå¼€å¿ƒçš„ï¼Œå› ä¸ºè¿™é‡Œæœ‰è‡ªå·±ğŸ˜äº‹ç‰©æ‰€åœ¨ã€‚</p>
<h3 id="OCçš„ç†è§£å’Œç‰¹æ€§"><a href="#OCçš„ç†è§£å’Œç‰¹æ€§" class="headerlink" title="OCçš„ç†è§£å’Œç‰¹æ€§"></a>OCçš„ç†è§£å’Œç‰¹æ€§</h3><p>ä½œä¸ºå¼€å‘è€…æˆ‘ä»¬éƒ½çŸ¥é“è¯­è¨€çš„ç‰¹æ€§åŒ…æ‹¬ï¼šé¢å¯¹å¯¹è±¡ï¼Œé¢å‘è¿‡ç¨‹ã€‚Objcå°±æ˜¯å…³äºé¢å¯¹å¯¹è±¡è¯­è¨€ï¼Œä¹Ÿå°±åŒ…æ‹¬é¢å‘å¯¹è±¡çš„ç‰¹ç‚¹ï¼šå°è£…ã€ç»§æ‰¿ã€å¤šæ€ã€‚ä¸‹é¢æ˜¯å¯¹ä¸‰è€…ä¼˜ç‚¹åˆ—è¡¨ğŸ˜‰</p>
<ul><br><li>å°è£…ï¼šå¯¹äºè¦å¤„ç†çš„é—®é¢˜è¿›è¡Œæ¨¡å—å¼€å‘ï¼Œå¥½å¤„æœ‰åˆ©äºæˆ‘ä»¬å¯¹äºåŠŸèƒ½çš„æ‹“å±•</li><br><li>ç»§æ‰¿ï¼šé€šè¿‡ç»§æ‰¿å®ç°å¯¹çˆ¶ç±»æ–¹æ³•çš„å®ç°ï¼Œä¹Ÿå¯ä»¥åœ¨å­ç±»ä¸­é‡å†™çˆ¶ç±»æ–¹æ³•</li><br><li>å¤šæ€ï¼šé€šè¿‡åŒåå‡½æ•°ä½†æ˜¯è¾“å…¥å½¢å¼å‚æ•°çš„ç§ç±»ï¼Œæ•°ç›®ï¼Œç±»å‹ä¸åŒå®ç°å…·ä½“å‡½æ•°åŠŸèƒ½ä¸åŒï¼ˆå…·ä½“å®ç°å¯ä»¥å‚ç…§C&amp;C++åœ¨ç¼–è¯‘åå½¢å¼~æƒ³äº†è§£çš„å¯ä»¥è‡ªå·±æŸ¥æ‰¾ï¼‰</li><br></ul><br>Objcçš„åŠ¨æ€ç‰¹æ€§ï¼šåŠ¨æ€ç±»å‹ã€åŠ¨æ€åŠ è½½ã€åŠ¨æ€ç»‘å®šã€‚å…¶å®å‰é¢æˆ‘ä»¬åœ¨runtimeçš„ç†è§£è¿‡ç¨‹ä¸­æœ‰æ‰€è®²è§£ã€‚<a href="http://boilwater.github.io/2016/05/29/runtimeç†è§£/" target="_blank" rel="external">å‚è€ƒåœ°å€</a><br><ul><br><li>åŠ¨æ€ç±»å‹ï¼šåœ¨IOSä¸­æˆ‘ä»¬ç»å¸¸è§åˆ°idç±»å‹ï¼Œidç±»å‹æŒ‡åœ¨Objcä¸­åŠ¨æ€ç±»å‹ã€‚åœ¨å®é™…åº”ç”¨ä¸­æˆ‘ä»¬ä¸€èˆ¬ä½¿ç”¨é™æ€ç±»å‹ï¼Œé™æ€ç±»å‹ï¼šå›ºå®šå’Œå¯é¢„çŸ¥æ€§ã€‚é™æ€ç±»å‹æ˜¯å¼ºç±»å‹ï¼ŒåŠ¨æ€ç±»å‹æ˜¯å¼±ç±»å‹ã€‚ä¾‹å¦‚ï¼šæˆ‘ä»¬ç»å¸¸è§åˆ°çš„protrcolå§”æ‰˜åè®®å°±æ˜¯é‡‡å–@proerty(nonatomic, weak) id<protrcol> delegate</protrcol></li><br><li>åŠ¨æ€åŠ è½½ï¼šåŸºäºåŠ¨æ€ç±»å‹ï¼Œåœ¨æŸä¸ªå®ä¾‹å¯¹è±¡è¢«ç¡®å®šåï¼Œå…¶ç±»å‹ä¾¿è¢«ç¡®å®šäº†ï¼Œè¯¥å¯¹è±¡å¯¹åº”çš„å±æ€§å’Œå“åº”æ¶ˆæ¯ä¹Ÿè¢«å®Œå…¨ç¡®å®šã€‚</li><br><li>åŠ¨æ€ç»‘å®šï¼šæ˜¯æˆ‘ä»¬åœ¨é€‚é…æœºå‹åŠ è½½è¿‡ç¨‹ä¸­ï¼ŒåŠ¨æ€å®ç°å›¾ç‰‡çš„å®ç°ã€‚ä¾‹å¦‚ï¼Œåœ¨Retinaè®¾å¤‡ä¸ŠåŠ è½½@2xçš„å›¾ç‰‡ã€‚</li><br></ul>

<h3 id="å†…å­˜ç®¡ç†åŸåˆ™"><a href="#å†…å­˜ç®¡ç†åŸåˆ™" class="headerlink" title="å†…å­˜ç®¡ç†åŸåˆ™"></a>å†…å­˜ç®¡ç†åŸåˆ™</h3><ul><br><li>IOS5.0ä¹‹å‰ï¼šåœ¨IOS 5.0ä¹‹å‰Objcå†…å­˜ç®¡ç†è¯•è¡Œè°åˆ›å»ºï¼Œè°é‡Šæ”¾çš„åŸåˆ™ã€‚å¦‚æœè¦å¯¹æ˜¯åˆå§‹åŒ–çš„ç±»å‹è¿›è¡Œalloc,retain,copyï¼Œå°±éœ€è¦æ‰‹åŠ¨è¿›è¡Œreleaseè¿›è¡Œé‡Šæ”¾ã€‚å½“è®¡æ•°ä¸º0æ—¶æ‰ä¼šé‡Šæ”¾å¯¹åº”çš„åˆå§‹åŒ–å†…å­˜ç©ºé—´å’ŒæŒ‡é’ˆï¼Œæˆ‘ä»¬ç§°ä¸ºMRCæ—¶ä»£ã€‚</li><br><li>IOS 5.0ä¹‹åï¼šä½¿ç”¨æˆè¨€IOSå¼€å‘é‚£å°±æ˜¯ä¸€ä¸ªå­—ï¼šçˆ½ã€‚åœ¨ARCï¼šè‡ªåŠ¨è®¡æ•°æ¨¡å¼å¼€å‘ç¨‹åºï¼Œæˆ‘ä»¬ä¸ç”¨å†æ‰‹åŠ¨é‡Šæ”¾ç”³è¯·çš„å¯¹è±¡ï¼Œç¨‹åºå¼€å‘è¿‡ç¨‹ç»ˆäºè§ä¸åˆ°release,autorelease,retainè¯­å¥ã€‚ä¸è¿‡æˆ‘ä»¬è¿™æ˜¯å°±è¯¥æ³¨æ„åˆ°strongå’Œweakçš„ç»†å¾®åŒºåˆ«ã€‚</li><br></ul>

<hr>
<p>strong &amp; weakåŒºåˆ«</p>
<ul><br><li>strong:ç”¨æ¥ä¿®é¥°å¼ºå¼•ç”¨å±æ€§</li><br><li>weak:ç”¨æ¥ä¿®é¥°å¼±å¼•ç”¨å±æ€§</li><br></ul><br>strong &amp; weakå®ç°å…·ä½“æƒ…å†µ<br><ul><br><li>æˆ‘ä»¬çŸ¥é“strongçš„ä½¿ç”¨æ—¶å¼ºå¼•ç”¨ï¼Œä½¿ç”¨å¼ºå¼•ç”¨ä½¿æˆ‘ä»¬åœ¨èµ‹å€¼æ—¶ä¼šä½¿è®¡æ•°å™¨+1ï¼›<br><br><br>é‡Šæ”¾æ—¶é—´ï¼šå½“æŒ‡é’ˆæŒ‡å‘æ–°å€¼æˆ–è€…æŒ‡é’ˆä¸å­˜åœ¨ï¼ŒæŒ‡é’ˆä¸å­˜åœ¨ä¸€èˆ¬æ˜¯åœ¨è‡ªåŠ¨è®¡æ•°ä¸º0æ—¶æŒ‡é’ˆä¼šè‡ªåŠ¨é‡Šæ”¾ã€‚</li><br><li>weakæ˜¯å¼±å¼•ç”¨ï¼Œæ‚²å‰§çš„æ˜¯å¼±å¼•ç”¨æ˜¯ä¸ä¼šå†è®¡æ•°+1çš„ã€‚ä¸è¿‡è¿™ä¹Ÿä½¿æˆ‘ä»¬åœ¨ä½¿ç”¨æ—¶å¾ˆæ–¹ä¾¿ï¼Œå› ä¸ºæˆ‘ä»¬å¦‚æœè¦é˜²æ­¢blockä¸­å‘ç”Ÿå¾ªç¯å¼•ç”¨çš„æ—¶å€™ï¼Œå¯ä»¥åœ¨blockå¤–ä½¿ç”¨_weakè¿›è¡Œä¿®é¥°ã€‚<br><br><br>é‡Šæ”¾æ—¶é—´ï¼šå¯¹è±¡çš„æ‹¥æœ‰è€…æŒ‡å‘æ–°å€¼æˆ–è€…ä¸å­˜åœ¨æ—¶weakä¿®é¥°çš„æŒ‡é’ˆä¼šè‡ªåŠ¨ç½®ä¸ºnilã€‚<br><br><br>weakçš„å®ç°åŸç†ï¼šåœ¨æ¯ä¸€ä¸ªç±»ä¸­éƒ½æœ‰ä¸€ä¸ªå¼±å¼•ç”¨çš„åˆ—è¡¨ï¼Œåœ¨é‡Šæ”¾æ—¶éƒ½ä¼šå¯¹åˆ—è¡¨è¿›è¡Œè®¿é—®ã€‚å¦‚æœæ‰¾åˆ°ç›¸åº”çš„å¯¹è±¡å°±æ‰§è¡Œé‡Šæ”¾ã€‚<br><br><br>Strongï¼šæ˜¯é€šè¿‡ARCçš„è‡ªåŠ¨è®¡æ•°æ¥å®ç°å¯¹äºå¯¹è±¡çš„é‡Šæ”¾ã€‚<br></li><br></ul>

<hr>
<p><a href="http://blog.csdn.net/leikezhu1981/article/details/42697977" target="_blank" rel="external">å‚è€ƒèµ„æ–™</a></p>
<ul><br><li>åœ¨æƒ³ä¸€ä¸ªå¯¹è±¡å‘é€autoreleaseæ¶ˆæ¯æ—¶ï¼Œå…¶å®ç›®æ ‡ä¸ä¼šç«‹å³é‡Šæ”¾ï¼Œä¼šæœ‰ä¸€ä¸ªå…·ä½“çš„æ—¶é—´å€¼ã€‚åœ¨autoreleaseè°ƒç”¨çš„æ—¶å€™ï¼Œä¼šå¯¹å…¶ä¸­çš„å¯¹è±¡æŒ¨ä¸ªå‘é€releaseè¯­å¥å¯¹äºæ¯ä¸ªå¯¹è±¡è¿›è¡Œç›¸åº”çš„é‡Šæ”¾ã€‚åé¢ä¼šå¯¹äºautoreleaseè¿›è¡Œä¸“é¡¹è®²è§£ï¼Œä¸è¿‡è¿™é‡Œå¯ä»¥ç»™å¤§ç‰›èµ„æ–™ï¼Œä¸‹æ–‡</li><br><li>åœ¨ARCä¸­æˆ‘ä»¬ä¸ç”¨æ‰‹åŠ¨å‘å®ä¾‹åŒ–å¯¹è±¡å‘é€releaseè¿›è¡Œé‡Šæ”¾ï¼Œä½†æ˜¯åœ¨MRCä¸­å°±éœ€è¦æˆ‘ä»¬å¯¹ç”³è¯·çš„å¯¹è±¡è¿›è¡Œæ‰‹åŠ¨é‡Šæ”¾å¯¹è±¡ã€‚é‚£ä¹ˆé—®é¢˜æ¥å•¦ï¼Œå¯¹è±¡ä¼šç«‹å³é‡Šæ”¾å—ï¼Ÿ<br><br><br>è®°ä½ä¸€ç‚¹åœ¨MRCä¹Ÿæ˜¯å¯¹è±¡æœ‰æ—¶ä¹Ÿä¸ä¼šç«‹å³é‡Šæ”¾ï¼Œéœ€è¦å½“å‰å¯¹è±¡çš„è®¡æ•°ä¸º0æ—¶æ‰ä¼šä½¿ç”¨deallocè¿›è¡Œå¯¹è±¡ä¸­æ‰€æœ‰çš„å†…å®¹ã€‚<br></li><br></ul><br><a href="http://www.cocoachina.com/ios/20150610/12093.html" target="_blank" rel="external">AutoreleasePoolå¤§ç‰›çš„èµ„æ–™</a><br><br>#### å…¶ä»–æ³¨æ„äº‹é¡¹<br><br><ul><br><li>å½“ä¸€ä¸ªå¯¹è±¡è¢«_strongæŒ‡å‘æ—¶ï¼Œè¯¥å¯¹è±¡æ˜¯ä¸ä¼šè¢«é‡Šæ”¾çš„ã€‚ä½†æ˜¯å½“å¯¹è±¡åœ¨è¶…å‡ºå…¶ä½œç”¨åŒºåŸŸæ—¶ï¼ˆåœ¨C++ä¸­å±€éƒ¨å˜é‡åœ¨è¶…å‡ºä½œç”¨åŒºåŸŸå°±ä¼šnilï¼‰ï¼Œæ­¤æ—¶æŒ‡é’ˆä¹Ÿä¼šè¢«ç½®ä¸ºniläºæ­¤åŒæ—¶æŒ‡é’ˆæ‰€æŒ‡çš„å†…å­˜ç©ºé—´ä¹Ÿä¼šè¢«é‡Šæ”¾ã€‚<br><br><br>è¿˜æœ‰å°±æ˜¯å½“è¯•å›¾æ§åˆ¶å™¨ï¼ˆViewControllerï¼‰è¿›è¡Œé‡Šæ”¾ï¼Œå…¶ä¸­çš„å…¨å±€å˜é‡å’Œå±€éƒ¨å˜é‡éƒ½ä¼šè¢«é‡Šæ”¾ã€‚ä¹Ÿæœ‰æ„å¤–å°±æ˜¯å®ç°å¾ªç¯å¼•ç”¨ï¼Œæ­å–œä½ å¥½å¥½ä¿®æ”¹ä¸‹å§ï¼Œå› ä¸ºè¿™æ˜¯ä¸ªBUGã€‚<br></li><br><li>å±€éƒ¨å˜é‡ï¼šä¸Šé¢è®²åˆ°çš„å±€éƒ¨å˜é‡å¦‚æœè¶…å‡ºå…¶èŒƒå›´å°±ä¼šç½®ä¸ºnil</li><br><li>åœ¨æ–¹æ³•ä¸­å¯¹è±¡åˆ›å»ºï¼Œä¸ºå•¦ä½¿å†…å­˜èƒ½å¤Ÿå°½å¯èƒ½çš„å‡å°‘å¯ä»¥ä½¿ç”¨autoreleasepoolã€‚ä½¿ç”¨æ–¹æ³•ï¼š@autoreleasepool{};</li><br><li>blockä¸­ä¸ºäº†é¿å…å¾ªç¯å¼•ç”¨å°±ä¼šä½¿ç”¨_weakè¿›è¡Œä¿®é¥°</li><br><li>ARCä¸æ˜¯ä¸‡èƒ½çš„ğŸ”‘ï¼šARCæ˜¯åŸºäºåœ¨Foundationä¹‹ä¸Šè¿›è¡Œçš„å˜é‡çš„ç®¡ç†ï¼Œå¦‚æœæ˜¯CGtypeRefç±»å‹å°±æ— æ³•è¿›è¡Œç®¡ç†ã€‚ä¾‹å¦‚ï¼šCGImageRefçš„å›¾ç‰‡çš„ä¿¡æ¯</li><br><li>åŒæ ·æˆ‘ä»¬å¯ä»¥å®ç°ARCå’ŒéARCä¹‹é—´çš„è¿›è¡Œæ··åˆç¼–è¯‘ï¼Œå…·ä½“æ“ä½œå¦‚ä¸‹ï¼š<br><br><br>åœ¨ARCä¸­è¿›è¡ŒéARCç¨‹åºçš„æ··åˆç¼–è¯‘ï¼š-fno-fobjc-arc;<br><br><br>åœ¨éARCä¸­è¿›è¡ŒARCçš„æ··åˆç¼–è¯‘ï¼š-fobjc-arc;<br><br><br>ä¸è¿‡ç›®å‰æˆ‘ä»¬ä½¿ç”¨ARCè¾ƒå¤šï¼Œæ‰€ä»¥ä½¿ç”¨ç¬¬ä¸€ç§çš„æƒ…å½¢è¾ƒå¤šã€‚swiftæ¯•ç«Ÿä¹Ÿå‘å¸ƒä¸¤å¹´ä¹‹ä¹…ï¼Œå¾ˆå¤šåˆ›ä¸šå…¬å¸å·²ç»å¼€å§‹ä½¿ç”¨swift<br></li><br></ul>



<h4 id="æ‹“å±•ä»‹ç»"><a href="#æ‹“å±•ä»‹ç»" class="headerlink" title="æ‹“å±•ä»‹ç»"></a>æ‹“å±•ä»‹ç»</h4><hr>
<ul><br><li>nonatomic:åŸå­æ“ä½œï¼Œç¦æ­¢å¤šçº¿ç¨‹è¿›è¡Œæ“ä½œ</li><br><li>atomic:åŸå­æ“ä½œï¼Œå¤šçº¿ç¨‹å®‰å…¨æ˜¯propertyçš„é»˜è®¤æ“ä½œåŸºæœ¬ç±»å‹</li><br><li>assign:è¡¨ç¤ºè®¾ç½®å™¨å¯ä»¥ç›´æ¥è¿›è¡Œå¤åˆ¶ï¼ŒåŸºæœ¬ç”¨äºåŸºæœ¬æ•°æ®ç±»å‹ï¼ˆNSInteger,CGFloatï¼‰å’ŒCè¯­è¨€çš„åŸºæœ¬æ•°æ®ç±»å‹ï¼ˆint,float,double,charï¼‰</li><br><li>readwrite:å¯ä»¥è¿›è¡Œè¯»å†™</li><br><li>readonly:è¿›è¡Œåªè¯»</li><br><li>copy:åœ¨èµ‹å€¼è¿‡ç¨‹ä¸­ä¼ å…¥ä¸€ä»½å€¼å¾—copyï¼Œåœ°å€å’Œå†…å®¹éƒ½ä¼šé‡æ–°èµ‹å€¼</li><br><li>retain:åœ¨èµ‹å€¼è¿‡ç¨‹ä¸­ä¼šä½¿ç”¨retainå¯¹è±¡ï¼ŒæŒ‡å‘å†…å®¹çš„æŒ‡é’ˆä¼šcopy</li><br></ul>

<hr>
<p><a href="http://blog.csdn.net/Mars2639/article/details/7352540" target="_blank" rel="external">è¯¦ç»†å†…å®¹å‚è€ƒåœ°å€</a></p>
<h3 id="è®¾è®¡æ¨¡å¼"><a href="#è®¾è®¡æ¨¡å¼" class="headerlink" title="è®¾è®¡æ¨¡å¼"></a>è®¾è®¡æ¨¡å¼</h3><p>å¼€å‘è¿‡ç¨‹ä¸­æˆ‘ä»¬éƒ½ä¼šä½¿ç”¨åˆ°è®¾è®¡æ¨¡å¼ï¼Œè¿™é‡Œå°±ä»¥ä¸¤ç§è®¾è®¡æ¨¡å¼è¿›è¡Œä¸¾ä¾‹ï¼š</p>
<h4 id="MVCè®¾è®¡æ¨¡å¼"><a href="#MVCè®¾è®¡æ¨¡å¼" class="headerlink" title="MVCè®¾è®¡æ¨¡å¼"></a>MVCè®¾è®¡æ¨¡å¼</h4><p>MVCæ˜¯ä¸€ç§æ¶æ„æ¨¡å¼ï¼ŒMè¡¨ç¤ºMOdelï¼ŒVè¡¨ç¤ºè§†å›¾Viewï¼ŒCè¡¨ç¤ºæ§åˆ¶å™¨Controllerï¼š<br>å…¶å®é‡è¦çš„è¿˜æ˜¯éœ€è¦è‡ªå·±åŠ¨æ‰‹äº²è‡ªå®ç°ï¼Œè¿™æ ·å¯ä»¥é”»ç‚¼è‡ªå·±çš„ç¼–ç èƒ½åŠ›ã€‚<br><a href="http://www.cocoachina.com/design/20130917/7009.html" target="_blank" rel="external">èµ„æ–™ç‚¹å‡»</a>ã€‚</p>
<ul><br><li>Modelè´Ÿè´£å­˜å‚¨ã€å®šä¹‰ã€æ“ä½œæ•°æ®ï¼›</li><br><li>Viewç”¨æ¥å±•ç¤ºä¹¦ç»™ç”¨æˆ·ï¼Œå’Œç”¨æˆ·è¿›è¡Œæ“ä½œäº¤äº’ï¼›</li><br><li>Controlleræ˜¯Modelå’ŒViewçš„åè°ƒè€…ï¼ŒControlleræŠŠModelä¸­çš„æ•°æ®æ‹¿è¿‡æ¥ç»™Viewç”¨ã€‚Controllerå¯ä»¥ç›´æ¥ä¸Modelå’ŒViewè¿›è¡Œé€šä¿¡ï¼Œè€ŒViewä¸èƒ½å’ŒControllerç›´æ¥é€šä¿¡ã€‚Viewä¸Controlleré€šä¿¡éœ€è¦åˆ©ç”¨ä»£ç†åè®®çš„æ–¹å¼ï¼Œå½“æœ‰æ•°æ®æ›´æ–°æ—¶ï¼ŒMOdelä¹Ÿè¦ä¸Controllerè¿›è¡Œé€šä¿¡ï¼Œè¿™ä¸ªæ—¶å€™å°±è¦ç”¨Notificationå’ŒKVOï¼Œè¿™ä¸ªæ–¹å¼å°±åƒä¸€ä¸ªå¹¿æ’­ä¸€æ ·ï¼ŒMOdelå‘ä¿¡å·ï¼ŒControllerè®¾ç½®ç›‘å¬æ¥å—ä¿¡å·ï¼Œå½“æœ‰æ•°æ®æ›´æ–°æ—¶å°±å‘ä¿¡å·ç»™Controllerï¼ŒModelå’ŒViewä¸èƒ½ç›´æ¥è¿›è¡Œé€šä¿¡ï¼Œè¿™æ ·ä¼šè¿èƒŒMVCè®¾è®¡æ¨¡å¼ã€‚</li><br></ul>

<h4 id="MVVMè®¾è®¡æ¨¡å¼"><a href="#MVVMè®¾è®¡æ¨¡å¼" class="headerlink" title="MVVMè®¾è®¡æ¨¡å¼"></a>MVVMè®¾è®¡æ¨¡å¼</h4><p>è¿™é‡Œå…³äºMVVMçš„è®¾è®¡æ¨¡å¼å°±ä¸å¤šè¯´ï¼Œå› ä¸ºç›®å‰è¿˜æ²¡æœ‰ä½¿ç”¨è¿‡ã€‚<br><br><a href="http://www.cocoachina.com/ios/20160301/15425.html" target="_blank" rel="external">MVVMå‚è€ƒèµ„æ–™åœ°å€</a><br><br><a href="http://www.cocoachina.com/ios/20160517/16309.html" target="_blank" rel="external">MVVMå‡çº§åˆ°MVVMM</a><br><br><a href="http://www.cocoachina.com/ios/20160330/15823.html" target="_blank" rel="external">MVVM With ReactiveCocoa</a></p>
<h3 id="Objcä¸­çš„åè®®"><a href="#Objcä¸­çš„åè®®" class="headerlink" title="Objcä¸­çš„åè®®"></a>Objcä¸­çš„åè®®</h3><p>æˆ‘ä»¬åœ¨IOSå¼€å‘è¿‡ç¨‹ä¸­æˆ‘ä»¬ç»å¸¸ä¼šä½¿ç”¨åè®®å’Œä»£ç†æ¨¡å¼æ¥è¿›è¡Œæ¶ˆæ¯ä¼ é€’ï¼Œåè®®ä¸€èˆ¬æ˜¯ä¼´éšç€ä»£ç†äº§ç”Ÿè€Œäº§ç”Ÿã€‚æˆ‘ä»¬åœ¨å®ç°åè®®çš„åŒæ—¶ä¸€èˆ¬éƒ½ä¼šæœ‰ä»£ç†å½¢å¼è¿›è¡Œå®Œæˆã€‚<br>åè®®ä¸­æœ‰ä¸¤ä¸ªå±æ€§ï¼š</p>
<ul><br><li>@required:æ˜¯è¡¨æ˜æ­¤ä¸­çš„æ–¹æ³•ä¸€å®šè¦å®ç°ï¼Œåœ¨æˆ‘ä»¬ä½¿ç”¨UITableViewDataSourceDeleteå°±æœ‰ä¸¤ä¸ªå¿…é¡»å®ç°çš„æ–¹æ³•</li><br><li>@optional:æ–¹æ³•å¯ä»¥æ ¹æ®è‡ªå·±é€‰ç€å®ç°æ–¹æ³•</li><br></ul><br>åœ¨åšå®¢ä¸­æœ‰å…³äºprotrcolçš„ç›¸å…³ä½¿ç”¨<br><br><br><a href="http://boilwater.github.io/2016/05/29/blockï¼Œæ³¨å†Œç›‘å¬ï¼Œå§”æ‰˜åè®®å’ŒKVO/" target="_blank" rel="external">å‚è€ƒåœ°å€</a><br><br>### Categoryçš„ä¼˜ç¼ºç‚¹<br>æˆ‘ä»¬ä½¿ç”¨Categoryä¸€èˆ¬æ˜¯åœ¨ä¸€ä¸ªç°æœ‰ç±»ä¸­å®šå‘æ·»åŠ æ–¹æ³•ï¼Œå…¶å®æˆ‘ä»¬ä½¿ç”¨å¸¸è§çš„SDWebImageæœ¬è´¨å°±æ˜¯ä¸€ä¸ªç±»çš„ç±»ç›®ï¼šUIImageView<br>ä¼˜ç‚¹ï¼š<br><ul><br><li>æˆ‘ä»¬åœ¨ä¸€ä¸ªç°æœ‰ç±»ä¸­å¯ä»¥å¢åŠ æ–¹æ³•ï¼Œäºæ­¤åŒæ—¶æˆ‘ä»¬åˆä¸éœ€è¦æ”¹å˜åŸæ¥å¯¹è±¡çš„å±æ€§ã€‚å¢åŠ æ–¹æ³•å’ŒåŸæ¥æ–¹æ³•ä½¿ç”¨æ˜¯ä¸€æ ·çš„</li><br><li>åœ¨å¤šæ–¹æ³•çš„ä½¿ç”¨è¿‡ç¨‹ä¸­æˆ‘ä»¬å¯ä»¥é€šè¿‡ä½¿ç”¨Categoryå®ç°å¯¹ç±»è¿›è¡ŒåŒºåˆ†ï¼Œè¾¾åˆ°æ–¹ä¾¿ç®¡ç†ç±»ç§æ–¹æ³•çš„åŸåˆ™</li><br></ul>

<p>ç¼ºç‚¹ï¼š</p>
<ul><br><li>Categoryå…è®¸æˆ‘ä»¬å¯¹ç±»è¿›è¡Œæ·»åŠ ç‰¹å®šæ–¹æ³•ï¼Œä½†æ˜¯æˆ‘ä»¬ä¸èƒ½å‘ç±»ä¸­æ·»åŠ æˆå‘˜å˜é‡ã€‚ä½†æ˜¯æˆ‘ä»¬å¯ä»¥ç»§æ‰¿ç±»åœ¨å­ç±»ä¸­è¿›è¡Œç›¸å…³æˆå‘˜å±æ€§æ·»åŠ </li><br><li>åœ¨å¢åŠ æ–¹æ³•çš„è¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬å¢åŠ æ–¹æ³•çš„ä¼˜å…ˆçº§åˆ«æ¯”è¾ƒé«˜å› æ­¤ä¼šè¦†ç›–çˆ¶ç±»ä¸­çš„æ–¹æ³•ã€‚ä¾‹å¦‚ï¼šåœ¨ç•Œé¢æˆ‘ä»¬ç›¸åº”æ‰‹æŒ‡è§¦æ‘¸æ—¶æœ‰å“åº”é“¾ï¼Œå¦‚æœåœ¨å­ç±»ä¸­è°ƒç”¨touchæ–¹æ³•æ²¡æœ‰è°ƒç”¨çˆ¶ç±»å°±ä¼šä½¿å“åº”è€…è¿ä¸­æ–­</li><br></ul>

<p><a href="http://www.cocoachina.com/ios/20120614/4361.html" target="_blank" rel="external">Objective-C Categoryåˆä½“éªŒ</a><br> <br><br><a href="http://www.cocoachina.com/ios/20140212/7808.html" target="_blank" rel="external">Objective-Cç›¸å…³Categoryçš„æ”¶é›†</a></p>
<h3 id="é”®è·¯å¾„-keyPath-ã€é”®å€¼ç¼–ç ï¼ˆKVCï¼‰å’Œé”®å€¼è§‚å¯Ÿï¼ˆKVOï¼‰"><a href="#é”®è·¯å¾„-keyPath-ã€é”®å€¼ç¼–ç ï¼ˆKVCï¼‰å’Œé”®å€¼è§‚å¯Ÿï¼ˆKVOï¼‰" class="headerlink" title="é”®è·¯å¾„(keyPath)ã€é”®å€¼ç¼–ç ï¼ˆKVCï¼‰å’Œé”®å€¼è§‚å¯Ÿï¼ˆKVOï¼‰"></a>é”®è·¯å¾„(keyPath)ã€é”®å€¼ç¼–ç ï¼ˆKVCï¼‰å’Œé”®å€¼è§‚å¯Ÿï¼ˆKVOï¼‰</h3><p>åœ¨æˆ‘çš„åšå®¢ä¸­æœ‰æ‰€è®²è¿°ï¼Œåœ¨è¿™é‡Œå°±ä¸èµ˜è¿°å•¦ã€‚ä¸è¿‡è¿™é‡Œç»™å¤§å®¶ç•™ä¸€ä¸ªé—®é¢˜ï¼Ÿä¸ºä»€ä¹ˆä½¿ç”¨KVCï¼ˆKey-value-codingï¼‰åœ¨æ•ˆç‡ä¸æ˜¯å¾ˆé«˜ï¼Ÿ<br><br><a href="http://boilwater.github.io/2016/05/29/block%EF%BC%8C%E6%B3%A8%E5%86%8C%E7%9B%91%E5%90%AC%EF%BC%8C%E5%A7%94%E6%89%98%E5%8D%8F%E8%AE%AE%E5%92%8CKVO/" target="_blank" rel="external">å‚è€ƒè·¯å¾„</a><br>å…¶ä»–å‚è€ƒèµ„æ–™ï¼š<br><br><a href="http://www.cocoachina.com/ios/20160408/15868.html" target="_blank" rel="external">è°ˆKVCã€KVOï¼ˆé‡ç‚¹è§‚å¯Ÿè€…æ¨¡å¼ï¼‰æœºåˆ¶ç¼–ç¨‹</a><br><br><br><a href="http://www.cocoachina.com/ios/20140224/7866.html" target="_blank" rel="external">iOS KVC &amp; KVO</a></p>
<h3 id="NSNotificationã€Blockã€Delegateå’ŒKVOçš„åŒºåˆ«"><a href="#NSNotificationã€Blockã€Delegateå’ŒKVOçš„åŒºåˆ«" class="headerlink" title="NSNotificationã€Blockã€Delegateå’ŒKVOçš„åŒºåˆ«"></a>NSNotificationã€Blockã€Delegateå’ŒKVOçš„åŒºåˆ«</h3><p>åšå®¢ä¸­æœ‰è¯¦ç»†ä»‹ç»<br><br><br><a href="http://boilwater.github.io/2016/05/29/block%EF%BC%8C%E6%B3%A8%E5%86%8C%E7%9B%91%E5%90%AC%EF%BC%8C%E5%A7%94%E6%89%98%E5%8D%8F%E8%AE%AE%E5%92%8CKVO/" target="_blank" rel="external">è¯¦ç»†å‚çœ‹</a></p>
<h3 id="Objective-Cä¸­å¯ä¿®æ”¹å’Œä¸å¯ä»¥ä¿®æ”¹ç±»å‹"><a href="#Objective-Cä¸­å¯ä¿®æ”¹å’Œä¸å¯ä»¥ä¿®æ”¹ç±»å‹" class="headerlink" title="Objective-Cä¸­å¯ä¿®æ”¹å’Œä¸å¯ä»¥ä¿®æ”¹ç±»å‹"></a>Objective-Cä¸­å¯ä¿®æ”¹å’Œä¸å¯ä»¥ä¿®æ”¹ç±»å‹</h3><p>å¯ä¿®æ”¹å’Œä¸å¯ä¿®æ”¹çš„é›†åˆç±»ï¼Œæˆ‘ä»¬åœ¨IOSå¼€å‘è¿‡ç¨‹ä¸­ç»å¸¸ä¼šé‡åˆ°NSArrayå’ŒNSMutableArrayä¸¤ç§ï¼Œä¸¤è€…çš„åŒºåˆ«ï¼š</p>
<ul><br><li>ä¸€ä¸ªæ˜¯å¯ä»¥åŠ¨æ€æ·»åŠ ï¼Œä¸€ä¸ªä¸å¯ä»¥åŠ¨æ€æ·»åŠ </li><br><li>å‰è€…åˆå§‹åŒ–åå†…å­˜æ˜¯å›ºå®šä¸è¾¹çš„ï¼Œåè€…ç»è¿‡åˆå§‹åŒ–å†…å­˜æ˜¯å¯ä»¥å‘ç”Ÿæ”¹å˜çš„</li><br></ul>

<hr>
<p>è¿™é‡Œæˆ‘å°±å¼•å‡ºä¸€ä¸ªæ¦‚å¿µï¼šéå®¹å™¨å¯¹è±¡å’Œå®¹å™¨å¯¹è±¡ã€‚</p>
<ul><br><li>éå®¹å™¨å¯¹è±¡ï¼šNSNumberï¼ŒNSStingç­‰åªèƒ½æ”¾å•ä¸ªå­—ç¬¦æˆ–è€…æ•°å­—</li><br><li>å®¹å™¨å¯¹è±¡ï¼šNSArrayï¼ŒNSDictionaryç­‰å¯ä»¥æ”¾ç½®å¤šä¸ªæ•°æ®ç±»å‹</li><br></ul><br>ä½†æ˜¯åœ¨æˆ‘ä»¬ç†Ÿæ‚‰çš„copyè¿‡ç¨‹ä¸­ä¼šå‘ç”Ÿå“ªäº›æƒ…å†µå‘¢ï¼Ÿ<br><br>è¿™é‡Œåˆæå‡ºå¦å¤–çš„copçš„æ–°æ¦‚å¿µï¼šcopy, mutableCopy<br><ul><br><li>copyï¼šå¤åˆ¶äº†ä¸€ä¸ªimutableçš„å¯¹è±¡+ copyWithZone:</li><br><li>mutableCopyï¼šå¤åˆ¶çš„æ˜¯ä¸€ä¸ªmutableçš„å¯¹è±¡ï¼Œä½¿ç”¨çš„æ–¹æ³•+ mutableCopyWithZone:</li><br></ul><br>ä¸‹é¢æˆ‘ä»¬ç»™å‡ºåœ¨éå®¹å™¨å¯¹è±¡å¤åˆ¶åçš„å…·ä½“æƒ…å†µ<br><br>éå®¹å™¨å¯¹è±¡     | ä¸å˜ç±»ï¼ˆNSStringï¼‰ |  å¯å˜ç±»ï¼ˆNSMustbleStringï¼‰<br>â€”â€”â€”â€” | â€”â€”â€”â€”â€”â€”| â€”â€”â€”â€”<br>copy         | æµ…Copy            | æ·±Copy~è¿”å›çš„å¯¹è±¡æ˜¯ä¸å¯å˜çš„å¯¹è±¡<br>mutableCopy  | æ·±Copy            | æ·±Copy<br><br>ä¸‹é¢æˆ‘ä»¬ç»™å‡ºå®¹å™¨å¯¹è±¡ä¸­å¤åˆ¶çš„å…·ä½“æƒ…å†µ<br><br>å®¹å™¨ç±»å‹      | ä¸å˜ç±»å‹ï¼ˆNSArrayï¼‰ | å¯å˜ç±»å‹ï¼ˆNSMutableArrayï¼‰<br>â€”â€”â€”â€” | â€”â€”â€”â€”â€”- | â€”â€”â€”â€”<br>copy         | æµ…copy            | æ·±copy<br>mutableCopy  | æ·±copy            | æ·±copy<br><br><div style="color:#008B8B"><br><p>ä½†æ˜¯åœ¨å®¹å™¨å¯¹è±¡å¤åˆ¶è¿‡ç¨‹ä¸­æˆ‘ä»¬éœ€è¦è®°ä½ä¸€ç‚¹ï¼Œæˆ‘ä»¬å¯¹äºNSArrayå’ŒNSMutableçš„copyæ˜¯å¯¹äºæ•´ä½“æŒ‡é’ˆå’Œå†…å­˜æ¥è¯´ã€‚ä½†æ˜¯åœ¨å®¹å™¨å†…éƒ¨æ¯ä¸€ä¸ªå…ƒç´ æˆ‘ä»¬è¿›è¡Œçš„éƒ½æ˜¯æŒ‡é’ˆcopy,ä¹Ÿå°±æ˜¯æˆ‘ä»¬æ‰€è¯´çš„æµ…copyã€‚</p><br></div><br>ä»ä¸Šé¢åˆ—ä¸¾çš„ä¾‹å­æˆ‘ä»¬å¯ä»¥å¾—å‡ºä¸€ä¸ªç»“è®ºï¼š<br><ul><br><li>æ— è®ºæ˜¯éå®¹å™¨ç±»å‹è¿˜æ˜¯å®¹å™¨ç±»å‹åªæœ‰åœ¨ä¸å¯å˜æ—¶ï¼ˆNSArrayï¼ŒNSStringï¼‰ä½¿ç”¨copyæ‰æ˜¯æµ…å¤åˆ¶ï¼Œä¹Ÿå°±æ˜¯è¯´åªæ˜¯å¤åˆ¶æŒ‡é’ˆè€Œä¸å¤åˆ¶å†…å­˜ã€‚</li><br><li>åœ¨å¯å˜çš„ç±»å‹ï¼ˆNSMutableString, NSMutableArrayï¼‰åœ¨ä½¿ç”¨copyæ—¶ä¼šç”Ÿæˆä¸å¯å˜ç±»å‹ã€‚</li><br></ul><br>å…·ä½“ä¸ºä»€ä¹ˆå®ç°è¿™ç§åŸç†å¯ä»¥çœ‹ä¸‹åœ¨NSArrayå’ŒNSMutableå®ç°æ¥å£ï¼Œä»¥åŠå‚ç…§C++çš„åŸç†è¿›è¡Œè§£é‡Šã€‚<br><br>â€”<br><br>ä¸‹é¢æ˜¯å‚è€ƒèµ„æ–™ï¼š<br><br><a href="http://www.fanliugen.com/?p=278" target="_blank" rel="external">copyä¸mutableCopy</a><br><br><a href="http://www.cnblogs.com/-Eric-Liu/p/5564030.html" target="_blank" rel="external">NSArrayä¸NSMutableArrayçš„åŒºåˆ«</a><br><br>### å½“æˆ‘ä»¬è°ƒç”¨ä¸€ä¸ªé™æ€æ–¹æ³•æ—¶,éœ€è¦å¯¹å¯¹è±¡è¿›è¡Œ release å—?<br><br>ä¸è¦å¯¹é™æ€æ–¹æ³•è¿›è¡Œé‡Šæ”¾ï¼Œå› ä¸ºé™æ€æ–¹æ³•ä¼šæ”¾åˆ°è‡ªåŠ¨é‡Šæ”¾æ± ä¸­ï¼Œåé¢ä¼šè‡ªåŠ¨é‡Šæ”¾ã€‚<br><br>æˆ‘åœ¨åšå®¢ä¸­å†™è¿‡å…³äºRuntimeçš„è§£æï¼Œåœ¨é‚£é‡Œæˆ‘ä»¬å¯ä»¥çœ‹å‡ºä¸€ä¸ªç±»åœ¨è§£æè¿‡ç¨‹ä¸­å…¶ä¸­ç±»ä¸­è°ƒç”¨æ–¹æ³•æ˜¯Methodå½¢å¼ï¼Œæ”¾åœ¨Structçš„Classä¸­çš„ã€‚æ‰§è¡Œè¿‡ç¨‹AutoReleasePoolä¼šè¿›è¡Œç®¡ç†ã€‚<br><br><a href="http://www.cocoachina.com/ios/20150601/11970.html" target="_blank" rel="external">æ·±å…¥ç†è§£RunLoop</a>å¤§ç¥æ–‡ç« å†™å¾—å¾ˆè¯¦ç»†<br><br>### å½“æˆ‘ä»¬é‡Šæ”¾æˆ‘ä»¬çš„å¯¹è±¡æ—¶,ä¸ºä»€ä¹ˆéœ€è¦è°ƒç”¨[super dealloc]æ–¹æ³•,å®ƒçš„ä½ç½®åˆæ˜¯å¦‚ä½•çš„å‘¢?<br><br>å› ä¸ºå­ç±»çš„æŸäº›å®ä¾‹æ˜¯ç»§æ‰¿è‡ªçˆ¶ç±»çš„,å› æ­¤éœ€è¦è°ƒç”¨[super dealloc]æ–¹æ³•, æ¥é‡Šæ”¾çˆ¶ç±»æ‹¥æœ‰çš„å®ä¾‹,å…¶å®ä¹Ÿå°±æ˜¯å­ç±»æœ¬èº«çš„ã€‚ä¸€èˆ¬æ¥è¯´æˆ‘ä»¬ä¼˜å…ˆé‡Šæ”¾å­ç±»æ‹¥ æœ‰çš„å®ä¾‹,æœ€åé‡Šæ”¾çˆ¶ç±»æ‰€æ‹¥æœ‰çš„å®ä¾‹ã€‚<br><br>### staticã€selfã€superå…³é”®å­—çš„ä½œç”¨<br><br>static æ˜¯åœ¨Cå’ŒC++ä¸­ç»å¸¸ä½¿ç”¨çš„ï¼Œåœ¨Objcä¸­æˆ‘ä»¬ä¹Ÿæ˜¯å¸¸å¸¸ä½¿ç”¨staticæ¥å®šä¹‰cellçš„identiferç›®å‰å°±æƒ³åˆ°è¿™äº›ã€‚ä¸‹é¢ç»™å‡ºstaticçš„å…·ä½“ä½œç”¨ï¼š<br><ul><br><li>staticä¿®é¥°çš„å˜é‡åªæ˜¯åœ¨ç¬¬ä¸€æ¬¡è°ƒç”¨è¿‡ç¨‹è¿›è¡Œåˆå§‹åŒ–ï¼Œæ‰€ä»¥åœ¨ç¬¬äºŒæ¬¡è°ƒç”¨æ—¶ä¼šç»´æŒä¸Šä¸€æ¬¡çš„å€¼</li><br><li>åœ¨æ¨¡å—å†…æˆ‘ä»¬ä½¿ç”¨çš„staticå˜é‡å¯ä»¥åœ¨æ¨¡å—ä¸­æ‰€æœ‰å‡½æ•°ä½¿ç”¨ï¼Œä½†æ˜¯åœ¨æ¨¡å—å¤–å°±ä¸å¯ä»¥è¿›è¡Œè®¿é—®</li><br><li>åœ¨æ¨¡å—å†…çš„staticçš„å‡½æ•°åªèƒ½è¢«æ¨¡å—å†…çš„å‡½æ•°è¿›è¡Œè°ƒç”¨ï¼Œä¸èƒ½è¢«æ¨¡å—å¤–çš„å…¶ä»–å‡½æ•°å£°æ˜</li><br><li>åœ¨ç±»ä¸­çš„saticçš„å…¨å±€å˜é‡ï¼Œåœ¨æ•´ä¸ªç±»ä¸­æœ‰ä¸”ä»…ä»…åªæœ‰ä¸€ä»½çš„copy</li><br></ul><br>self: æ˜¯æˆ‘ä»¬åœ¨å½“å‰ç±»æ¶ˆæ¯çš„æ¥å—è€…<br><br>super: æ˜¯æˆ‘ä»¬è°ƒç”¨çˆ¶ç±»çš„æ–¹æ³•ï¼Œæ¶ˆæ¯é“¾è¿‡ç¨‹ä¸­æˆ‘ä»¬åœ¨touchè°ƒç”¨superå°±æ˜¯è°ƒç”¨çˆ¶ç±»æ–¹æ³•ï¼Œé˜²æ­¢æ¶ˆæ¯é“¾ä¸­æ–­ã€‚<br><br>### #includeä¸#importçš„åŒºåˆ«ï¼Œ#import ä¸@class çš„åŒºåˆ«<br><br><ul><br><li>#includeæ˜¯æˆ‘ä»¬åœ¨C/C++ç»å¸¸ä½¿ç”¨åˆ°çš„å¼•å…¥åˆ°æ–‡ä»¶çš„æ–¹å¼</li><br><li>#importæ˜¯æˆ‘ä»¬åœ¨Objcä¸­ä½¿ç”¨å¼•å…¥å¤´æ–‡ä»¶çš„æ–¹å¼ï¼Œå¯ä»¥é˜²æ­¢å¤´æ–‡ä»¶è¢«å¤šæ¬¡å¼•ç”¨ï¼ˆå¦‚æœå¤´æ–‡ä»¶è¢«å¤šæ¬¡åº”ç”¨ï¼Œç¨‹åºåœ¨ç¼–è¯‘è¿‡ç¨‹ä¸­ä¼šæŠŠåº“å‡½æ•°ç¼–è¯‘åˆ°ç±»ä¸­è¿™æ ·å°±å ç”¨è¾ƒå¤šå†…å­˜ï¼‰</li><br><br>#importå’Œ@classä¸¤è€…ä¹‹é—´çš„åŒºåˆ«<br><li>@classæ˜¯åªæ˜¯å®šä¹‰ç±»åï¼Œå¯¹å…¶ä¸­çš„è¡Œä¸ºå¹¶ä¸çŸ¥é“ï¼Œæˆ‘ä»¬ç»å¸¸å¯ä»¥å†å¾ˆå¤šç±»çš„.hæ–‡ä»¶å¯ä»¥çœ‹åˆ°</li><br><li>@classç”±äºä»…ä»…æ˜¯å®šä¹‰ç±»çš„åå­—ï¼Œæ‰€ä»¥åœ¨ç¼–è¯‘è¿‡ç¨‹è¦æ¯”importçš„æ•ˆç‡é«˜</li><br><li>æ­¤å¤–@class å’Œ#import çš„ä¸»è¦åŒºåˆ«åœ¨äºè§£å†³å¼•ç”¨æ­»é”çš„é—®é¢˜</li><br></ul><br><a href="http://www.cnblogs.com/stevenschen/p/3825044.html" target="_blank" rel="external">å‚è€ƒèµ„æ–™ç‚¹å‡»</a><br><br>### @publicã€@protectedã€@private å®ƒä»¬çš„å«ä¹‰ä¸ä½œç”¨<br><br><ul><br><li>@public:å¯¹è±¡çš„å®ä¾‹å˜é‡çš„ä½œç”¨åŸŸåœ¨ä»»æ„åœ°æ–¹éƒ½å¯ä»¥è¢«è®¿é—®</li><br><li>@protected:å¯¹è±¡çš„å®ä¾‹å˜é‡ä½œç”¨åŸŸåœ¨æœ¬ç±»å’Œå­ç±»éƒ½å¯ä»¥è¢«è®¿é—®</li><br><li>@private:å®ä¾‹å˜é‡çš„ä½œç”¨åŸŸåªèƒ½åœ¨æœ¬ç±»(è‡ªèº«)ä¸­è®¿é—® </li><br></ul>

<h3 id="è§£é‡Š-id-ç±»å‹"><a href="#è§£é‡Š-id-ç±»å‹" class="headerlink" title="è§£é‡Š id ç±»å‹"></a>è§£é‡Š id ç±»å‹</h3><p>ä»»æ„ç±»å‹å¯¹è±¡ï¼Œç¨‹åºè¿è¡Œæ—¶æ‰å†³å®šå¯¹è±¡çš„ç±»å‹ã€‚ è¿™ä¹Ÿæ˜¯æˆ‘ä»¬åœ¨ä¸Šé¢è§£é‡Šçš„åŠ¨æ€ç±»å‹ã€‚</p>
<h3 id="switch-è¯­å¥-if-è¯­å¥åŒºåˆ«ä¸è”ç³»"><a href="#switch-è¯­å¥-if-è¯­å¥åŒºåˆ«ä¸è”ç³»" class="headerlink" title="switch è¯­å¥ if è¯­å¥åŒºåˆ«ä¸è”ç³»"></a>switch è¯­å¥ if è¯­å¥åŒºåˆ«ä¸è”ç³»</h3><p>ä¸¤è€…å‡æ˜¯åˆ¤æ–­è¯­å¥ã€‚ä½†æ˜¯switchåªå¯ä»¥åˆ¤æ–­æ•´å½¢ï¼Œå­—ç¬¦å‹ï¼Œæšä¸¾ç±»å‹ï¼›ä½†æ˜¯ifå¹¶æ²¡æœ‰ç±»å‹é™åˆ¶ã€‚</p>
<h3 id="isMemberOfClass-å’Œ-isKindOfClass-è”ç³»ä¸åŒºåˆ«"><a href="#isMemberOfClass-å’Œ-isKindOfClass-è”ç³»ä¸åŒºåˆ«" class="headerlink" title="isMemberOfClass å’Œ isKindOfClass è”ç³»ä¸åŒºåˆ«"></a>isMemberOfClass å’Œ isKindOfClass è”ç³»ä¸åŒºåˆ«</h3><ul><br><li>ä¸¤è€…éƒ½å¯ä»¥åˆ¤æ–­ä¸€ä¸ªå¯¹è±¡æ˜¯å¦æ˜¯æŸä¸ªç±»çš„æˆå‘˜</li><br><li>isKindOfClesssä¸ç´§å¯ä»¥åˆ¤æ–­å¯¹è±¡æ˜¯å¦æ˜¯ä¸€ä¸ªç±»çš„æˆå‘˜ï¼Œä¹Ÿå¯ä»¥åˆ¤æ–­ä¸€ä¸ªå¯¹è±¡æ˜¯å¦æ´¾ç”Ÿäºç±»çš„ç±»æˆå‘˜</li><br><li>ä¸¾ä¾‹ï¼šå¦‚ ClassAæ´¾ ç”Ÿ è‡ªNSObject ç±» , ClassA *a = [ClassA alloc] init];,[a isKindOfClass:[NSObject class]] å¯ä»¥æ£€æŸ¥å‡º a æ˜¯å¦æ˜¯ NSObjectæ´¾ç”Ÿç±» çš„æˆå‘˜,ä½† isMemberOfClass åšä¸åˆ°</li><br></ul>

<h3 id="iOS-å¼€å‘ä¸­æ•°æ®æŒä¹…æ€§æœ‰å“ªå‡ ç§"><a href="#iOS-å¼€å‘ä¸­æ•°æ®æŒä¹…æ€§æœ‰å“ªå‡ ç§" class="headerlink" title="iOS å¼€å‘ä¸­æ•°æ®æŒä¹…æ€§æœ‰å“ªå‡ ç§?"></a>iOS å¼€å‘ä¸­æ•°æ®æŒä¹…æ€§æœ‰å“ªå‡ ç§?</h3><p><a href="http://boilwater.github.io/2016/05/29/IOS%E7%9A%84%E6%B0%B8%E4%B9%85%E8%AF%9D%E5%82%A8%E5%AD%98/" target="_blank" rel="external">å‚è€ƒèµ„æ–™~IOSçš„æ°¸ä¹…è¯å‚¨å­˜</a></p>
<h3 id="è‡ªåŠ¨é‡Šæ”¾æ± å·¥ä½œåŸç†"><a href="#è‡ªåŠ¨é‡Šæ”¾æ± å·¥ä½œåŸç†" class="headerlink" title="è‡ªåŠ¨é‡Šæ”¾æ± å·¥ä½œåŸç†"></a>è‡ªåŠ¨é‡Šæ”¾æ± å·¥ä½œåŸç†</h3><p><a href="http://www.cocoachina.com/ios/20160602/16569.html" target="_blank" rel="external">è‡ªåŠ¨é‡Šæ”¾æ± çš„å‰ä¸–ä»Šç”Ÿ</a><br><br><a href="http://www.cocoachina.com/ios/20150610/12093.html" target="_blank" rel="external">Objective-C Autorelease Pool çš„å®ç°åŸç†</a></p>

      

      
    </div>
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<i class="icon-price-tags icon"></i>
		<ul class="article-tag-list">
			 
        		<li class="article-tag-list-item">
        			<a href="javascript:void(0)" class="js-tag article-tag-list-link color3">IOSåŸºç¡€çŸ¥è¯†</a>
        		</li>
      		
		</ul>
	</div>

      
	<div class="article-category tagcloud">
		<i class="icon-book icon"></i>
		<ul class="article-tag-list">
			 
        		<li class="article-tag-list-item">
        			<a href="/categories/IOS/" class="article-tag-list-link color4">IOS</a>
        		</li>
      		
		</ul>
	</div>


      
        <p class="article-more-link">
          <a class="article-more-a" href="/2016/06/02/IOSé¢è¯•æ¢³ç†&è‡ªå·±ç†è§£&è¯¦ç»†èµ„æ–™åº“/">å±•å¼€å…¨æ–‡ >></a>
        </p>
      

      
      <div class="clearfix"></div>
    </div>
  </div>
</article>





  
    <article id="post-cocoaPodsä½¿ç”¨å’Œé™æ€åº“çš„å»ºç«‹" class="article article-type-post  article-index" itemscope itemprop="blogPost">
  <div class="article-inner">
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/05/29/cocoaPodsä½¿ç”¨å’Œé™æ€åº“çš„å»ºç«‹/">cocoaPodsä½¿ç”¨å’Œé™æ€åº“çš„å»ºç«‹</a>
    </h1>
  

        
        <a href="/2016/05/29/cocoaPodsä½¿ç”¨å’Œé™æ€åº“çš„å»ºç«‹/" class="archive-article-date">
  	<time datetime="2016-05-29T11:47:03.000Z" itemprop="datePublished"><i class="icon-calendar icon"></i>2016-05-29</time>
</a>
        
      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>cocoaPodsä¸ªäººä»‹ç»ï¼šæ˜¯åŸºäºRubyçš„åŸºç¡€ä¹‹ä¸Šçš„ï¼ŒcocoaPodsä¸ªäººä½œç”¨æ˜¯å¯ä»¥å¸®åŠ©è‹¦é€¼çš„ç å†œå¯¹ç¬¬ä¸‰æ–¹åº“å’Œæ¡†æ¶è¿›è¡Œç®¡ç†ï¼Œè®©ç å†œä¸“æ³¨äºè‡ªå·±APPæ–¹é¢ä¼˜åŒ–</p>
<p>ä¸€èˆ¬æˆ‘ä»¬å¤åˆ¶ä¸‰æ–¹æ¡†æ¶åˆ°é¡¹ç›®æœ‰ä¸¤ç§æ–¹å¼ï¼šï¼ˆ1ï¼‰ç›´æ¥è¿›è¡Œå¤åˆ¶ï¼Œï¼ˆ2ï¼‰ä½¿ç”¨cocoaPodsæ¥è¿›è¡Œç®¡ç†ï¼Œæœ¬äººå»ºè®®å¯ä»¥å­¦ä¹ ä½¿ç”¨cocoaPodsè¿™æ ·æ›´åŠ æ–¹ä¾¿ï¼Œä¸‹é¢è®²ç›´æ¥å¤åˆ¶é—®é¢˜</p>
<p>ä½†æ˜¯ç›´æ¥å¤åˆ¶å­˜åœ¨é—®é¢˜ï¼š</p>
<p>(1)åº“æ›´æ–°å­˜åœ¨é—®é¢˜ï¼Œå¦‚æœä¸€ä¸ªåº“å¼•ç”¨å¦ä¸€ä¸ªåº“ï¼Œéœ€è¦å¯¹äºåº“å…¨éƒ¨æ›´æ–°</p>
<p>(2)å¯¹äºæˆ‘ä»¬å¼•ç”¨çš„ç¬¬ä¸‰æ–¹åº“è¿›è¡Œä¿®æ”¹ï¼Œåœ¨åšæ›´æ–°æ¯”è¾ƒå›°éš¾ã€‚ä¾‹å¦‚ï¼šæˆ‘åœ¨ä½¿ç”¨SedWebImageæ—¶å¯¹å›¾ç‰‡è¿›è¡Œæˆªå›¾å¾—åˆ°åœ†å½¢å›¾ç‰‡ï¼Œå¦‚æœè¿›è¡Œæ›´æ–°å°±æœ‰é—®é¢˜</p>
<p>(3)æ¯”è¾ƒéš¾åˆ¤æ–­åœ¨APPå¼•è¿›åº“çš„å…·ä½“ç‰ˆæœ¬ï¼Œé™¤éåœ¨ä»¥å‰APPä¸­è¿›è¡Œè®°å½•</p>
<p>(4)æ²¡æœ‰ä¸­å¿ƒç®¡ç†ï¼Œå¾ˆéš¾å¯¹äºæ‰€æœ‰çš„ç¬¬ä¸‰æ–¹åº“è¿›è¡Œç»Ÿä¸€ç®¡ç†<br>cocoaPodsï¼ˆ<a href="https://realm.io/cn/news/gotocph-rackwitz-therox-learnings-from-cocoapods/" target="_blank" rel="external">cocoaPodsé“¾æ¥</a>ï¼‰å¯¹äºä¸Šé¢é—®é¢˜æœ‰å¾ˆå¥½å¤„ç†ï¼šå¯ä»¥è§£å†³åº“ä¹‹é—´å­˜åœ¨ä¾èµ–å…³ç³»ï¼Œè€Œä¸”å¸®å¿™å‘ç°æ˜¯æ–°çš„åº“ï¼Œä»¥æœ€ç®€å•æ–¹å¼ä¸ºæˆ‘ä»¬ç å†œé…ç½®ç¯</p>
<p>åºŸè¯ä¸å¤šè¯´ï¼Œä¸‹é¢å¼€å§‹åœ¨macä¸­é…ç½®å®‰è£…cocoaPods</p>
<p>å¦‚æœç³»ç»Ÿæ˜¯10.7ä¹‹åç³»ç»Ÿä¸­å¸¦æœ‰é…ç½®Rubyç¯å¢ƒï¼Œåªéœ€å®‰è£…cocoaPodså³å¯ï¼Œå¦‚æœä¸æ˜¯å¯ä»¥æœç´¢ä¸‹Rubyç¯å¢ƒå®‰è£…</p>
<p>æ–¹æ³•ä¸€ï¼š(1)æ‰“å¼€ç»ˆç«¯ï¼šcontrol+ç©ºæ ¼é”®ï¼Œç„¶åæœç´¢â€œç»ˆç«¯â€</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ sudo gem install cocoaPods </span><br></pre></td></tr></table></figure>
<p>(2)ç„¶ååœ¨ç»ˆç«¯ä¸­è¿›è¡Œè®¾ç½®</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ pod setup --verbose</span><br></pre></td></tr></table></figure>
<p>å¦‚æœåœ¨æ‰§è¡Œä¸€æ—¶æ¯”è¾ƒæ…¢æˆ‘ä»¬å°±éœ€è¦æ‰§è¡Œå…¶ä»–å®‰è£…ï¼Œé€šè¿‡åªç”¨æ·˜å®çš„Rubyè¿›è¡Œè®¿é—®cocoaPodï¼Œ</p>
<p>æ–¹æ³•äºŒï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ gem sources --remove https://rubygems.org/</span><br></pre></td></tr></table></figure>
<p>//ç­‰æœ‰ååº”ä¹‹åå†æ•²å…¥ä»¥ä¸‹å‘½ä»¤</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ gem sources -a http://ruby.taobao.org/</span><br></pre></td></tr></table></figure>
<p>å¦‚æœè¦æŸ¥çœ‹æ˜¯å¦æ˜¯taobaoé•œåƒ</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ gem source -l</span><br></pre></td></tr></table></figure>
<p>å¦‚æœæ˜¾ç¤ºä¸€ä¸‹æƒ…å†µ<br><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">*** CURRENT SOURCES ***</span><br><span class="line"></span><br><span class="line"><span class="symbol">http:</span>/<span class="regexp">/ruby.taobao.org/</span></span><br></pre></td></tr></table></figure></p>
<p>æœ€åæ‰§è¡Œï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ sudo gem install cocoaPods</span><br></pre></td></tr></table></figure></p>
<p>ç»è¿‡ä¸Šè¿°çˆ½è¿‡ä¹‹åï¼Œæˆ‘ä»¬å°±æˆåŠŸå®‰è£…cocosPodsï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬æ¥çœ‹ä¸‹æ€ä¹ˆä½¿ç”¨<br>ï¼ˆ1ï¼‰ä½¿ç”¨cocoaPodsæŸ¥çœ‹ç›¸å…³æ¡†æ¶ä¿¡æ¯ï¼ŒæŸ¥çœ‹AFNetWorkingä¿¡æ¯</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ pod search AFNetWorking</span><br></pre></td></tr></table></figure>
<p>ä¸‹é¢åœ¨é¡¹ç›®ä¸­ä½¿ç”¨cocoaPodsåŠ å…¥ç¬¬ä¸‰æ–¹æ¡†æ¶<br>ï¼ˆ1ï¼‰æ‰“å¼€ç»ˆç«¯ï¼Œè¿›è¡Œé¡¹ç›®æ–‡ä»¶çš„æ ¹ç›®å½•ç„¶åä½¿ç”¨vimåˆ›å»ºpodFileæ–‡ä»¶ï¼šä¾‹å¦‚æˆ‘ä»¬é¡¹ç›®æ”¾åœ¨ æ–‡æ¡£/é¡¹ç›®å</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$cd /users/ç”¨æˆ·å/documents/é¡¹ç›®å</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$vim podFile</span><br></pre></td></tr></table></figure>
<p>ï¼ˆ2ï¼‰å†è¾“å¦‚æ¡†ä¸­è¾“å…¥åŠ å…¥å¹³å°å’Œç›¸å…³æ¡†æ¶ä»¥åŠæ¡†æ¶ç‰ˆæœ¬å·ï¼ˆå¦‚æœå‡ºç°ä¸èƒ½è¾“å…¥å°±è¦æŒ‰é”®aåè€…æ˜¯iï¼Œè¿›è¡Œæ–‡æœ¬ç¼–è¾‘ï¼‰<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">paltform : iOS, &apos;7.0&apos;</span><br></pre></td></tr></table></figure></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pod &quot;AFNetworking&quot;, &quot;~&gt; 2.0&quot;</span><br></pre></td></tr></table></figure>
<p>ï¼ˆ3ï¼‰è¾“å…¥ä¸Šè¿°æ–‡æœ¬ï¼Œåä¿å­˜å¹¶é€€å‡ºç¼–è¾‘æŒ‰é”®escè¿›è¡Œé€€å‡ºï¼Œè¾“å…¥ä¸‹é¢æ–‡ä»¶</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">:wq</span><br></pre></td></tr></table></figure>
<p>ï¼ˆ4ï¼‰æœ€åä¸‹è½½AFNetWorkingæ–‡ä»¶</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$pod install</span><br></pre></td></tr></table></figure>
<p>å¤§åŠŸå‘Šæˆï¼Œè¿™æ ·å°±å¯ä»¥åœ¨æˆ‘ä»¬æ–‡ä»¶ä¸­ç”Ÿæˆä¸€ä¸ªpodsæ–‡ä»¶ï¼Œæ‰“å¼€é¡¹ç›®å°±å¯ä»¥çœ‹åˆ°ä¸‹é¢é™¤å•¦æˆ‘ä»¬é¡¹ç›®å¤–è¿˜å¤šä½™ä¸€ä¸ªpodsæ–‡ä»¶</p>
<p>æ³¨ï¼šå¯ä»¥åœ¨æ–‡ä»¶ä¸­æ”¾ç½®å¤šä¸ªæ¡†æ¶ï¼Œåªè¦åœ¨ä¸Šé¢ï¼ˆ2ï¼‰ä¸­pod â€œæ¡†æ¶åâ€, â€œ~&gt;3.0â€<br>cocosPodsåç»­äº§ç”Ÿé—®é¢˜è§£æï¼š</p>
<p>å¦‚æœæˆ‘ä»¬ä»githubä¸Šä¸‹è½½å¼€æºé¡¹ç›®æœ‰çš„é¡¹ç›®æ—¶éœ€è¦æˆ‘ä»¬é‡æ–°æ›´æ–°é…ç½®å¼€æºæ¡†æ¶ï¼›</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">cd ~/desktop/é¡¹ç›®å                  //æˆ‘çš„é¡¹ç›®æ”¾åœ¨æ¡Œé¢</span><br><span class="line"></span><br><span class="line">pod install </span><br></pre></td></tr></table></figure>
<p>å¦‚æœå‡ºç°</p>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">[!] The dependency <span class="string">`Masonry (~&gt; 0.6.2)`</span> is <span class="keyword">not</span> used <span class="keyword">in</span> any concrete target.</span><br><span class="line"></span><br><span class="line">The dependency <span class="string">`SDWebImage (~&gt; 3.7)`</span> is <span class="keyword">not</span> used <span class="keyword">in</span> any concrete target.</span><br><span class="line"></span><br><span class="line">The dependency <span class="string">`GPUImage`</span> is <span class="keyword">not</span> used <span class="keyword">in</span> any concrete target.</span><br><span class="line">æ‰“å¼€é…ç½®æ–‡ä»¶Podfileæ–‡ä»¶ä¿®æ”¹é…ç½®æ–‡ä»¶</span><br><span class="line"></span><br><span class="line">target <span class="string">'BeautifyFaceDemo'</span> <span class="keyword">do</span></span><br><span class="line"></span><br><span class="line">pod <span class="string">'Masonry'</span>, <span class="string">'~&gt; 0.6.2'</span></span><br><span class="line"></span><br><span class="line">pod <span class="string">'SDWebImage'</span>, <span class="string">'~&gt;3.7'</span></span><br><span class="line"></span><br><span class="line">pod <span class="string">'GPUImage'</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">end</span> </span><br></pre></td></tr></table></figure>
<p>æ—¢å¯ä»¥è§£å†³ç”Ÿé¢çš„é—®é¢˜ã€‚</p>

      

      
    </div>
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<i class="icon-price-tags icon"></i>
		<ul class="article-tag-list">
			 
        		<li class="article-tag-list-item">
        			<a href="javascript:void(0)" class="js-tag article-tag-list-link color4">IOS</a>
        		</li>
      		
		</ul>
	</div>

      
	<div class="article-category tagcloud">
		<i class="icon-book icon"></i>
		<ul class="article-tag-list">
			 
        		<li class="article-tag-list-item">
        			<a href="/categories/IOS/" class="article-tag-list-link color4">IOS</a>
        		</li>
      		
		</ul>
	</div>


      
        <p class="article-more-link">
          <a class="article-more-a" href="/2016/05/29/cocoaPodsä½¿ç”¨å’Œé™æ€åº“çš„å»ºç«‹/">å±•å¼€å…¨æ–‡ >></a>
        </p>
      

      
      <div class="clearfix"></div>
    </div>
  </div>
</article>





  
    <article id="post-IOSçš„æ°¸ä¹…è¯å‚¨å­˜" class="article article-type-post  article-index" itemscope itemprop="blogPost">
  <div class="article-inner">
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/05/29/IOSçš„æ°¸ä¹…è¯å‚¨å­˜/">IOSçš„æ°¸ä¹…è¯å‚¨å­˜</a>
    </h1>
  

        
        <a href="/2016/05/29/IOSçš„æ°¸ä¹…è¯å‚¨å­˜/" class="archive-article-date">
  	<time datetime="2016-05-29T11:32:04.000Z" itemprop="datePublished"><i class="icon-calendar icon"></i>2016-05-29</time>
</a>
        
      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>æ²™ç›’ï¼šIOSåº”ç”¨ä¸­æ¯ä¸ªåº”ç”¨å‡æœ‰è‡ªå·±æ²™ç›’ï¼Œç”¨æ¥å‚¨å­˜APPè‡ªå·±çš„æ•°æ®ï¼Œæ¯ä¸ªåº”ç”¨çš„æ²™ç›’å‡æ˜¯åº”ç”¨ç‰¹æœ‰çš„ä¸èƒ½äº¤å‰è®¿é—®ã€‚</p>
<p>æ²™ç›’ä¸­æœ‰ä¸‰ä¸ªæ–‡ä»¶å¤¹ï¼šdocumentï¼Œlibraryï¼Œtemp</p>
<p>(1)documentï¼šä¿å­˜åº”ç”¨è¿è¡Œæ—¶ç”Ÿæˆé‡è¦çš„æ•°æ®ï¼ŒItunesä¹Ÿä¼šåŒæ­¥åˆ°è¿›è¡Œå¤‡ä»½æ•°æ®ã€‚ä¸€èˆ¬å‚¨å­˜æ¯”è¾ƒé‡è¦æ•°æ®ï¼ˆæ•°æ®ä½¿ç”¨æ‰‹æœºè¿æ¥macå¯ä»¥åœ¨itunesä¸­è¿›è¡ŒæŸ¥çœ‹ï¼‰</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">NSString</span> *path = <span class="built_in">NSHomeDirectory</span>();</span><br><span class="line"><span class="built_in">NSString</span> *docPath = [path stringByAppendingString:<span class="string">@"/saveMessage"</span>];</span><br><span class="line"><span class="built_in">NSString</span> *docPath1 = [path stringByAppendingPathComponent:<span class="string">@"saveMessage"</span>];</span><br><span class="line"><span class="built_in">NSString</span> *docPath2 = [<span class="built_in">NSSearchPathForDirectoriesInDomains</span>(<span class="built_in">NSDocumentDirectory</span>, <span class="built_in">NSUserDomainMask</span>, <span class="literal">YES</span>)lastObject];</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">å¯¹äºæ•°æ®ç›¸å…³çš„path è¿›è¡Œæ“ä½œï¼Œåˆ¤æ–­å…¶æ˜¯å¦å­˜åœ¨ï¼Œå¦‚æœå­˜åœ¨å°±å¯ä»¥è¿›è¡Œç›¸å…³æ“ä½œ</span><br></pre></td></tr></table></figure>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">NSFileManager</span> *fileManger = [<span class="built_in">NSFileManager</span> defaultManager];</span><br><span class="line"><span class="built_in">NSArray</span> *pathLists = [fileManger contentsOfDirectoryAtPath:path error:<span class="literal">nil</span>];</span><br><span class="line"><span class="built_in">BOOL</span> flag = [fileManger fileExistsAtPath:docPath1];</span><br><span class="line">[fileManger removeItemAtPath:docPath1 error:<span class="literal">nil</span>];</span><br></pre></td></tr></table></figure>
<p>(2)tempï¼šä¿å­˜è¿è¡Œæ—¶éœ€è¦çš„ä¸´æ—¶æ•°æ®ï¼Œå½“APPç»“æŸåå°±ä¼šæ¸…æ¥šå…¶ä¸­çš„æ•°æ®ã€‚å½“APPæ²¡æœ‰è¿è¡Œæ—¶å…¶ä¸­æ•°æ®ä¹Ÿå¯èƒ½è¢«åˆ é™¤</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">NSString *temp =  NSTemporaryDirectory();</span><br></pre></td></tr></table></figure>
<p>(3)libraryï¼šå…¶ä¸­æœ‰ä¸¤ä¸ªæ–‡ä»¶cacheså’Œpreferenceã€‚cachesä¸­å­˜æ”¾ä¸´æ—¶ç¨‹åºè¿è¡Œæ—¶ä¸´æ—¶æ•°æ®ï¼Œå°±åƒæˆ‘ä»¬åœ¨æ¯ä¸ªAPPä¸­çš„ç¼“å­˜å¯ä»¥è¿›è¡Œæ¸…é™¤ã€‚preferenceä¸­å­˜æ”¾æˆ‘ä»¬è‡ªå·±è®¾ç½®æ˜¯plistæ–‡ä»¶å­˜æ”¾åœ°å€</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">NSString</span> *library = [<span class="built_in">NSSearchPathForDirectoriesInDomains</span>(<span class="built_in">NSLibraryDirectory</span>, <span class="built_in">NSUserDomainMask</span>, <span class="literal">YES</span>)lastObject];</span><br><span class="line"><span class="built_in">NSString</span> *chches = [<span class="built_in">NSSearchPathForDirectoriesInDomains</span>(<span class="built_in">NSCachesDirectory</span>, <span class="built_in">NSUserDomainMask</span>, <span class="literal">YES</span>)lastObject];</span><br></pre></td></tr></table></figure>
<p>è®¿é—®ä¸Šé¢ä¸‰ä¸ªæ–‡ä»¶å¤¹æ–¹æ³•ï¼ˆ<a href="http://www.cnblogs.com/xiejw/p/5196798.html" target="_blank" rel="external">å‚è€ƒé“¾æ¥</a>ï¼‰</p>
<p>ä¸Šè¿°æ˜¯å…³äºåœ¨IOSå‚¨å­˜æ•°æ®æ˜¯å…·ä½“å‚¨å­˜ä½ç½®å’Œå…¶è·å–çš„æ–¹æ³•ï¼Œè¿‡ç¨‹å¤§åŒå°å¼‚ã€‚ä½†æ˜¯åœ¨å‚¨å­˜æ•°æ®æ˜¯æˆ‘ä»¬è¦æ³¨æ„ç»†èŠ‚ï¼šæ¯”å¦‚æ˜¯ä½¿ç”¨NSSarryæ˜¯æˆ‘ä»¬éœ€è¦å‚¨å­˜arrayæ•°æ®ï¼Œå¦‚æœæ˜¯å…¶ä»–æ•°æ®ä¾‹å¦‚NSdataéœ€è¦å°†å…¶è½¬åŒ–</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">NSArray</span> *arr1 = [[<span class="built_in">NSArray</span> alloc]initWithObjects:<span class="string">@"0"</span>,<span class="string">@"5"</span>,<span class="literal">nil</span>];</span><br><span class="line"><span class="built_in">NSData</span> *data = [<span class="built_in">NSKeyedArchiver</span> archivedDataWithRootObject:arr1];</span><br></pre></td></tr></table></figure>
<p>é™¤æ²™ç›’å¤–IOSè¿˜å‘æˆ‘ä»¬æä¾›å…¶ä»–çš„å‚¨å­˜æ–¹å¼ï¼šSqliteï¼ŒCore data, NSKeyedArchiver(coding)å½’æ¡£ï¼ŒNSUserDefaults</p>
<p>(1)Sqliteï¼šiOSè‡ªå¸¦æ•°æ®åº“ï¼Œå¯ä»¥ä¿å­˜æ•°æ®</p>
<h3 id="ä½¿ç”¨çš„ç¬¬ä¸‰æ–¹çš„åº“FMDB"><a href="#ä½¿ç”¨çš„ç¬¬ä¸‰æ–¹çš„åº“FMDB" class="headerlink" title="ä½¿ç”¨çš„ç¬¬ä¸‰æ–¹çš„åº“FMDB"></a>ä½¿ç”¨çš„ç¬¬ä¸‰æ–¹çš„åº“<a href="https://github.com/ccgus/fmdb.git" target="_blank" rel="external">FMDB</a></h3><p>(2)Core dataï¼šæ˜¯è‹¹æœæå‡ºçš„åŸºäºsqliteå‚¨å­˜æ•°æ®çš„ç»“æ„ï¼Œå®é™…æ˜¯sqliteåªä¸è¿‡å¯¹å…¶è¿›è¡Œç®€åŒ–</p>
<p>(3)NSkeyedArchiver(coding)ï¼š</p>
<p>(4)NSUserDefaultsï¼šå°±æ˜¯æˆ‘ä»¬ä¸Šè¿°æ‰€è¯´çš„æ”¾åœ¨library/preferenceä¸­çš„åå¥½è®¾ç½®ï¼Œå®é™…æ˜¯å­˜æ”¾åœ¨plistæ–‡ä»¶ä¸­ã€‚å­˜å‚¨æ•°æ®ç±»å‹æ˜¯NSString,NSData,NSInteger,NSDictionary,NSArray,NSNumber,boolå’Œå…¶ä»–çš„åŸºæœ¬æ•°æ®ç±»å‹ï¼ˆä½†æ˜¯NSUserDefaultsæœ‰ä¸ªç¼ºç‚¹ï¼šåœ¨å‚¨å­˜è¿‡ç¨‹ä¸­å¯èƒ½ç”±äºæ—¶é—´é—®é¢˜ç»“æŸå­˜å‚¨ï¼Œè€Œä¸”å¦‚æœä¿®æ”¹å…¶ä¸­ä¸€é¡¹æ•°æ®æ•´ä¸ªæ•°æ®éƒ½è¦é‡æ–°åŠ è½½ï¼‰</p>
<p><a href="https://developer.apple.com/library/ios/documentation/Cocoa/Reference/Foundation/Classes/NSUserDefaults_Class/" target="_blank" rel="external">å®˜æ–¹æ–‡æ¡£</a>ï¼š<br><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">The <span class="built_in">NSUserDefaults</span> class provides convenience methods <span class="keyword">for</span> accessing common types such as floats, doubles, integers, Booleans, and URLs. A <span class="keyword">default</span> object must be a property list, that is, an instance of (or <span class="keyword">for</span> collections a combination of instances of): <span class="built_in">NSData</span>, <span class="built_in">NSString</span>, <span class="built_in">NSNumber</span>, <span class="built_in">NSDate</span>, <span class="built_in">NSArray</span>, or <span class="built_in">NSDictionary</span>. If you want to store any other type of object, you should typically archive it to create an instance of <span class="built_in">NSData</span>.</span><br></pre></td></tr></table></figure><br>æ–‡ç« æ˜¯å¯¹äºæ•°æ®å‚¨å­˜åˆæ¬¡æ¢ç©¶ï¼Œåé¢ä¼šå¯¹æ–‡ç« è¿›è¡Œä¿®æ”¹æœ‰è¯¦ç»†çš„ä½¿ç”¨æ–¹æ³•å’Œå…·ä½“å®˜æ–¹æ–‡æ¡£è¡¥å……</p>

      

      
    </div>
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<i class="icon-price-tags icon"></i>
		<ul class="article-tag-list">
			 
        		<li class="article-tag-list-item">
        			<a href="javascript:void(0)" class="js-tag article-tag-list-link color4">IOS</a>
        		</li>
      		
		</ul>
	</div>

      
	<div class="article-category tagcloud">
		<i class="icon-book icon"></i>
		<ul class="article-tag-list">
			 
        		<li class="article-tag-list-item">
        			<a href="/categories/IOS/" class="article-tag-list-link color4">IOS</a>
        		</li>
      		
		</ul>
	</div>


      
        <p class="article-more-link">
          <a class="article-more-a" href="/2016/05/29/IOSçš„æ°¸ä¹…è¯å‚¨å­˜/">å±•å¼€å…¨æ–‡ >></a>
        </p>
      

      
      <div class="clearfix"></div>
    </div>
  </div>
</article>





  
    <article id="post-IOSæ•´ä½“æ¡†æ¶" class="article article-type-post  article-index" itemscope itemprop="blogPost">
  <div class="article-inner">
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/05/29/IOSæ•´ä½“æ¡†æ¶/">IOSæ•´ä½“æ¡†æ¶</a>
    </h1>
  

        
        <a href="/2016/05/29/IOSæ•´ä½“æ¡†æ¶/" class="archive-article-date">
  	<time datetime="2016-05-29T11:21:14.000Z" itemprop="datePublished"><i class="icon-calendar icon"></i>2016-05-29</time>
</a>
        
      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>æ„Ÿè§‰åœ¨åšå®¢ä¸Šæœ‰å¤§ç‰›ä»‹ç»IOSæ¡†æ¶è®²è§£çš„æ¯”è¾ƒè¯¦ç»†ï¼Œåœ¨æ­¤å‘å¤§ç‰›è‡´æ•¬å†™ç¯‡æ–‡ç« ã€‚<a href="http://www.cnblogs.com/kenshincui/p/3885689.html#foundation" target="_blank" rel="external">å¤§ç‰›æ–‡ç« å…³äºæ¡†æ¶</a></p>
<p>æˆ‘ä»¬åœ¨åšIOSå¼€å‘è¿‡ç¨‹é’ˆå¯¹å¯¹è±¡æ¥è¿›è¡Œç±»çš„åˆ†è£…ï¼Œç„¶åå®ç°å…·ä½“æ–¹æ³•è§£å†³é—®é¢˜ã€‚ä½†æ˜¯æˆ‘ä»¬æ•´ä½“è¯­è¨€æ¡†æ¶ä¸æ˜¯å¾ˆæ¸…æ¥šï¼ŒåºŸè¯ä¸å¤šè¯´å¼€å§‹ï¼š</p>
<p>ä¸‹é¢æ˜¯å…³äºOS Xçš„ç»“æ„å›¾ï¼ˆ<a href="https://developer.apple.com/library/mac/documentation/MacOSX/Conceptual/OSX_Technology_Overview/About/About.html#//apple_ref/doc/uid/TP40001067-CH204-TPXREF101" target="_blank" rel="external">å®˜ç½‘åœ°å€</a>ï¼‰ï¼š<br><img src="/path/to/img.jpg" alt="alt text" title="Title"></p>
<h3 id="å®˜æ–¹æ–‡æ¡£çš„å…·ä½“å†…å®¹ï¼š"><a href="#å®˜æ–¹æ–‡æ¡£çš„å…·ä½“å†…å®¹ï¼š" class="headerlink" title="å®˜æ–¹æ–‡æ¡£çš„å…·ä½“å†…å®¹ï¼š"></a>å®˜æ–¹æ–‡æ¡£çš„å…·ä½“å†…å®¹ï¼š</h3><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">The Cocoa (Application) layerï¼ˆåº”ç”¨å±‚ï¼‰ includes technologies <span class="keyword">for</span> building an </span><br><span class="line">appâ€™s user interface, <span class="keyword">for</span> responding to user events, and <span class="keyword">for</span> managing app </span><br><span class="line">behavior.</span><br></pre></td></tr></table></figure>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">The Media layer ï¼ˆåª’ä½“å±‚ï¼‰encompasses specialized technologies <span class="keyword">for</span> playing, </span><br><span class="line">recording, and editing audiovisual media and <span class="keyword">for</span> rendering and animating <span class="number">2</span>D and </span><br><span class="line"><span class="number">3</span>D graphics.</span><br></pre></td></tr></table></figure>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">The Core Services layerï¼ˆæ ¸å¿ƒæœåŠ¡å±‚ï¼‰ contains many fundamental services and </span><br><span class="line">technologies that range from Automatic Reference Counting and low-level network </span><br><span class="line">communication to string manipulation and data formatting.</span><br></pre></td></tr></table></figure>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">The Core OS layer ï¼ˆæ ¸å¿ƒç³»ç»Ÿæ“ä½œå±‚ï¼‰defines programming interfaces that are </span><br><span class="line">related to hardware and networking, including interfaces <span class="keyword">for</span> running high-</span><br><span class="line">performance computation tasks on a computerâ€™s CPU and GPU.</span><br></pre></td></tr></table></figure>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">The Kernel and Device Drivers layerï¼ˆå†…æ ¸å’Œé©±åŠ¨å±‚ï¼‰ consists of the Mach kernel </span><br><span class="line">environment, device drivers, BSD library functions (libSystem), and other low-</span><br><span class="line">level components. The layer includes support <span class="keyword">for</span> file systems, networking, </span><br><span class="line">security, interprocess communication, programming languages, device drivers, </span><br><span class="line">and extensions to the kernel.</span><br></pre></td></tr></table></figure>
<h3 id="ä¸‹é¢å¯¹äºæ¯å±‚çš„è®²è§£ï¼š"><a href="#ä¸‹é¢å¯¹äºæ¯å±‚çš„è®²è§£ï¼š" class="headerlink" title="ä¸‹é¢å¯¹äºæ¯å±‚çš„è®²è§£ï¼š"></a>ä¸‹é¢å¯¹äºæ¯å±‚çš„è®²è§£ï¼š</h3><p>ï¼ˆ1ï¼‰åº”ç”¨å±‚å³å¯è§¦æ‘¸å±‚ï¼ˆcocoa touch layerï¼‰<a href="https://developer.apple.com/library/mac/documentation/MacOSX/Conceptual/OSX_Technology_Overview/CocoaApplicationLayer/CocoaApplicationLayer.html#//apple_ref/doc/uid/TP40001067-CH274-SW1" target="_blank" rel="external">åœ°å€</a>:æä¾›æ¥å£ä¸ºåº”ç”¨ï¼Œä¸»è¦ç”¨äºtouchå’Œç®¡ç†åº”ç”¨çš„æ“ä½œã€‚å…¶ä¸­æˆ‘ä»¬æœ€å¸¸ç”¨çš„UIKitçš„æ¡†æ¶åœ¨Cocoa Touchå±‚</p>
<p><img src="/path/to/img.jpg" alt="alt text" title="Title"></p>
<p>ï¼ˆ2ï¼‰åª’ä½“å±‚ï¼ˆmedia layerï¼‰<a href="https://developer.apple.com/library/mac/documentation/MacOSX/Conceptual/OSX_Technology_Overview/MediaLayer/MediaLayer.html#//apple_ref/doc/uid/TP40001067-CH273-SW1" target="_blank" rel="external">å®˜æ–¹åœ°å€</a>ï¼šåŒ…æ‹¬å¤šç§å¤šæ ·çš„åª’ä½“æ–‡ä»¶ï¼Œå½•éŸ³ï¼Œæ’­æ”¾ï¼Œå›¾åƒç»˜åˆ¶ï¼Œ2Då’Œ3Då›¾å½¢åŸºç¡€åŠ¨ç”»</p>
<p><img src="/path/to/img.jpg" alt="alt text" title="Title"></p>
<p>ä¸»è¦åŒ…æ‹¬ä»¥ä¸‹ï¼šAV Foundation, Core Animation, Core Audio, Core Image, Core Text, OpenAl, OpenGL, Quartez</p>
<p>ï¼ˆ3ï¼‰æ ¸å¿ƒæœåŠ¡å±‚ï¼ˆCore Service Layerï¼‰<a href="https://developer.apple.com/library/mac/documentation/MacOSX/Conceptual/OSX_Technology_Overview/CoreServicesLayer/CoreServicesLayer.html#//apple_ref/doc/uid/TP40001067-CH270-BCICAIFJ" target="_blank" rel="external">å®˜æ–¹åœ°å€</a>ï¼šé€šè¿‡æä¾›ä¸€äº›æ¥å£è¿›è¡Œç½‘ç»œè¿æ¥ï¼ŒåŒ…æ‹¬ä¸€äº›åœ¨CPUå’ŒGPUæ›´é«˜è®¡ç®—æ€§èƒ½ï¼Œä½¿ç”¨å¹¿æ³›çš„Foundationæ¡†æ¶ä½äºæœ¬å±‚</p>
<p><img src="/path/to/img.jpg" alt="alt text" title="Title"></p>
<p>åªè¦åŒ…æ‹¬ä»¥ä¸‹ï¼šAddress Book, Core Foundation, Foundation, Core Data, Quick Look</p>
<p>, Social, WebKit, Security</p>
<p>(4)æ ¸å¿ƒç³»ç»Ÿæ“ä½œå±‚ï¼ˆCore OS Layerï¼‰<a href="https://developer.apple.com/library/mac/documentation/MacOSX/Conceptual/OSX_Technology_Overview/CoreOSLayer/CoreOSLayer.html#//apple_ref/doc/uid/TP40001067-CH9-SW1" target="_blank" rel="external">å®˜æ–¹åœ°å€</a>ï¼šå†…å­˜ç®¡ç†ã€æ–‡ä»¶ç³»ç»Ÿã€ç”µæºç®¡ç†ä»¥åŠä¸€äº›å…¶ä»–çš„æ“ä½œç³»ç»Ÿä»»åŠ¡ã€‚å®ƒå¯ä»¥ç›´æ¥å’Œç¡¬ä»¶è®¾å¤‡è¿›è¡Œäº¤äº’</p>
<p><img src="/path/to/img.jpg" alt="alt text" title="Title"></p>
<p>åªè¦åŒ…æ‹¬ä»¥ä¸‹ï¼šAccelerate, Open CL, Directory Services, System Configuration, Disk Arbitration</p>
<p>è¿™åªæ˜¯å†™å‡ºåŸºæœ¬çš„å±‚æ¬¡æ¨¡å‹ï¼Œåç»­å°†å¯¹æ­¤è¿›è¡Œç›¸å…³çš„æ›´æ–°å’Œæ€»ç»“ã€‚</p>

      

      
    </div>
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<i class="icon-price-tags icon"></i>
		<ul class="article-tag-list">
			 
        		<li class="article-tag-list-item">
        			<a href="javascript:void(0)" class="js-tag article-tag-list-link color4">IOS</a>
        		</li>
      		
		</ul>
	</div>

      
	<div class="article-category tagcloud">
		<i class="icon-book icon"></i>
		<ul class="article-tag-list">
			 
        		<li class="article-tag-list-item">
        			<a href="/categories/IOS/" class="article-tag-list-link color4">IOS</a>
        		</li>
      		
		</ul>
	</div>


      
        <p class="article-more-link">
          <a class="article-more-a" href="/2016/05/29/IOSæ•´ä½“æ¡†æ¶/">å±•å¼€å…¨æ–‡ >></a>
        </p>
      

      
      <div class="clearfix"></div>
    </div>
  </div>
</article>





  
    <article id="post-runtimeç†è§£" class="article article-type-post  article-index" itemscope itemprop="blogPost">
  <div class="article-inner">
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/05/29/runtimeç†è§£/">runtimeç†è§£</a>
    </h1>
  

        
        <a href="/2016/05/29/runtimeç†è§£/" class="archive-article-date">
  	<time datetime="2016-05-29T04:15:38.000Z" itemprop="datePublished"><i class="icon-calendar icon"></i>2016-05-29</time>
</a>
        
      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>ç½‘ä¸Šå…¶å®æœ‰å¾ˆå¤šå…³äºè®²è¿°runtimeçš„å­¦ä¹ èµ„æ–™ï¼Œä¹Ÿæ˜¯ç«™åœ¨å·¨äººè‚©ä¸Šçœ‹çš„æ›´è¿œã€‚å†™è¿™ç¯‡æ–‡ç« ä¹Ÿæ˜¯å¯¹äºå…¶ä»–äººå€Ÿé‰´å’Œç¿»é˜…æºç ï¼Œå‘æºç å¯»æ±‚è§£é‡Šå§ã€‚<br><br>æ— æ„é—´çœ‹åˆ°ä¸€ä»½å…³äºruntimeçš„åšå®¢ï¼Œæ„Ÿè§‰å†™çš„æŒºä¸é”™çš„å°±è€å¿ƒçš„çœ‹ä¸‹ã€‚çœ‹åå‘ç°è‡ªå·±å¯¹runtimeçš„ç†è§£è¿˜æ˜¯æ¯”è¾ƒæµ…ï¼Œå°±å†³å®šå¯¹è‡ªå·±åšå®¢è¿›è¡Œé‡æ–°ä¿®æ”¹ã€‚</p>
<div style="color:#008B8B"><br><p>éšä¾¿åœ¨è¿™é‡ŒæŠ›å‡ºä¸€ä¸ªé—®é¢˜ï¼šå‡å¦‚æˆ‘ä»¬ç¨‹åºå‘˜è‡ªå·±æ˜¯ç³»ç»Ÿæˆ‘ä»¬æ€ä¹ˆæ‰§è¡Œç¨‹åºå‘¢ï¼Ÿå½“ç„¶æ¢ä¸ªé«˜çº§ç‚¹çš„è¯´æ³•ï¼Œå¦‚æœæˆ‘ä»¬æ˜¯ç³»ç»Ÿè®¾è®¡è€…æˆ‘ä»¬æƒ³è¦runtimeæ€ä¹ˆè¿è¡Œï¼Ÿ</p><br></div>

<p>åœ¨ä»‹ç»runtimeä¹‹å‰æˆ‘ç°åœ¨è¿™é‡Œç»™å¤§å®¶æ¢³ç†ä¸€ä¸‹æˆ‘ä»¬åœ¨Objcç±»ä¸­å¯èƒ½è§åˆ°çš„å†…å®¹ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">-æˆå‘˜å˜é‡ã€æˆå‘˜å±æ€§ï¼š&lt;br&gt;</span><br><span class="line">-æ•°æ®æˆå‘˜ï¼š&lt;/br&gt;</span><br><span class="line">-åè®®å®ç°ï¼š&lt;/br&gt;</span><br></pre></td></tr></table></figure>
<h3 id="runtimeç®€ä»‹"><a href="#runtimeç®€ä»‹" class="headerlink" title="runtimeç®€ä»‹"></a>runtimeç®€ä»‹</h3><p>Objcè¢«æˆ‘ä»¬æˆä¸ºåŠ¨æ€è¯­è¨€ï¼Œæ¢å¥è¯è¯´å°±æ˜¯æŠŠæˆ‘ä»¬å¹³æ—¶çœ‹åˆ°ä¸€äº›å…³é”®æ–¹æ³•ç”±ç¼–è¯‘è¿æ¥æ¨è¿Ÿåˆ°è¿è¡Œæ—¶æ‰§è¡Œã€‚Objcåº•å±‚æ˜¯åŸºäºC/C++çš„ç¼–è¯‘è¯­è¨€ï¼Œåœ¨C/C++é¡¹ç›®è¿è¡Œè¿‡ç¨‹ä¸­é“¾æ¥ã€ç¼–è¯‘ç”Ÿæˆå¯æ‰§è¡Œæ–‡ä»¶ã€‚è€ŒObjcè¯­è¨€æ˜¯åœ¨æ‰§è¡Œè¿‡ç¨‹ä¸­è¿›è¡Œç¼–è¯‘æºç ï¼Œç”Ÿæˆæˆ‘ä»¬ç†Ÿæ‚‰çš„C/C++åé¢æœ€ç»ˆç”Ÿæˆæœºå™¨å¯ä»¥è¯†åˆ«çš„æ±‡ç¼–è¯­è¨€ã€‚Objcä¸­æœ‰ä¸‰å¤§è‡ªå·±ç‰¹è‰²ï¼šåŠ¨æ€ç±»å‹ï¼ŒåŠ¨æ€ç»‘å®šå’ŒåŠ¨æ€åŠ è½½ã€‚<br><br>è·runtimeçš„æºç ç‚¹å‡»<a href="https://developer.apple.com/library/ios/documentation/Cocoa/Reference/ObjCRuntimeRef/index.html#//apple_ref/doc/uid/TP40001418" target="_blank" rel="external">è¿™é‡Œ</a></p>
<p>è¿™é‡Œæˆ‘ä»¬ä¸»è¦æ¢ç©¶runtime.hå’Œmessage.hä¸¤ä¸ªæ–‡ä»¶å¤¹ä¸­ä¸€äº›ä½¿ç”¨æ–¹æ³•ã€‚<br>ä¸‹é¢åˆ—å‡ºruntime.hæ–‡ä»¶ä¸­ä»£ç ï¼š</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">typedef</span> <span class="keyword">struct</span> objc_method *Method;  <span class="comment">//ä»£è¡¨ç±»å®šä¹‰å½“ä¸­çš„ä½¿ç”¨æ–¹æ³•</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">struct</span> objc_ivar *Ivar;  <span class="comment">//ä»£è¡¨ç±»å®šä¹‰ä¸­å®ä¾‹å˜é‡å’Œå±æ€§</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">struct</span> objc_category *Category; <span class="comment">//ä»£è¡¨æ·»åŠ æˆå‘˜å‡½æ•°</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">struct</span> objc_property *objc_property_t; <span class="comment">//å£°æ˜çš„å±æ€§</span></span><br><span class="line"><span class="keyword">struct</span> objc_class &#123;</span><br><span class="line">    Class isa;</span><br><span class="line">    <span class="meta">#if !__OBJC2__</span></span><br><span class="line"></span><br><span class="line">    Class super_class                                        OBJC2_UNAVAILABLE;<span class="comment">//çˆ¶ç±»</span></span><br><span class="line">    <span class="keyword">const</span> <span class="keyword">char</span> *name                                         OBJC2_UNAVAILABLE;<span class="comment">//ç±»å</span></span><br><span class="line">    <span class="keyword">long</span> version                                             OBJC2_UNAVAILABLE;<span class="comment">//ç±»çš„ç‰ˆæœ¬ä¿¡å¿ƒï¼Œé»˜è®¤çš„æƒ…å†µä¸‹æ˜¯0</span></span><br><span class="line">    <span class="keyword">long</span> info                                                OBJC2_UNAVAILABLE;<span class="comment">//ç±»ä¿¡æ¯</span></span><br><span class="line">    <span class="keyword">long</span> instance_size                                       OBJC2_UNAVAILABLE;<span class="comment">//ç±»çš„å®ä¾‹å˜é‡çš„å¤§å°</span></span><br><span class="line">    <span class="keyword">struct</span> objc_ivar_list *ivars                             OBJC2_UNAVAILABLE;<span class="comment">//ç±»æˆå‘˜å˜é‡çš„åˆ—è¡¨</span></span><br><span class="line">    <span class="keyword">struct</span> objc_method_list **methodLists                    OBJC2_UNAVAILABLE;<span class="comment">//ç±»çš„æ–¹æ³•åˆ—è¡¨</span></span><br><span class="line">    <span class="keyword">struct</span> objc_cache *cache                                 OBJC2_UNAVAILABLE;<span class="comment">//æ–¹æ³•ç¼“å­˜</span></span><br><span class="line">    <span class="keyword">struct</span> objc_protocol_list *protocols                     OBJC2_UNAVAILABLE;<span class="comment">//ç±»çš„åè®®åˆ—è¡¨</span></span><br><span class="line">     <span class="meta">#endif&#125; </span></span><br><span class="line">    OBJC2_UNAVAILABLE;</span><br></pre></td></tr></table></figure>
<h3 id="çœ‹å…¶ä¸­ä¸€ç§å®ç°æ–¹å¼"><a href="#çœ‹å…¶ä¸­ä¸€ç§å®ç°æ–¹å¼" class="headerlink" title="çœ‹å…¶ä¸­ä¸€ç§å®ç°æ–¹å¼"></a>çœ‹å…¶ä¸­ä¸€ç§å®ç°æ–¹å¼</h3><p>å…¶ä¸­æˆ‘ä»¬å°±ä»¥ç±»ä¸­struct objc_ivar_list *ivars ,ä¸ºä¾‹æ¥çœ‹æ˜¯æ€æ ·å®ç°<br><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">struct</span> objc_ivar_list &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">int</span> ivar_count                                           OBJC2_UNAVAILABLE;<span class="comment">//æˆå‘˜åˆ—è¡¨çš„æ•°é‡</span></span><br><span class="line"><span class="meta">#ifdef __LP64__</span></span><br><span class="line">    <span class="keyword">int</span> space                                                OBJC2_UNAVAILABLE;<span class="comment">//æˆå‘˜åˆ—è¡¨çš„ç©ºé—´</span></span><br><span class="line"><span class="meta">#endif</span></span><br><span class="line">    <span class="comment">/* variable length structure */</span></span><br><span class="line">    <span class="keyword">struct</span> objc_ivar ivar_list[<span class="number">1</span>]                            OBJC2_UNAVAILABLE;</span><br><span class="line">&#125;                                                            OBJC2_UNAVAILABLE;</span><br></pre></td></tr></table></figure></p>
<p>å¯ä»¥çœ‹å‡ºå®ä¾‹å˜é‡å’Œå±æ€§æ˜¯å­˜æ”¾æ—¶ä¸€ä¸ªstructçš„listçš„æ•°ç»„ä¸­ï¼Œå…¶ä¸­åŒ…æ‹¬listçš„æ•°ç›®ã€æ‰€å ç©ºé—´å’ŒåŸºæœ¬å‚¨å­˜objc_ivarã€‚<br></p>
<p>ä¸Šé¢objc_ivaråœ¨runtime.hä¸­å½¢å¼ï¼š<br>typedef struct objc_ivar Ivar;<br>objc_ivarä¸­å®ä¾‹å˜é‡å‚¨å­˜æ–¹å¼ï¼š</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">struct</span> objc_ivar &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">char</span> *ivar_name                       OBJC2_UNAVAILABLE;<span class="comment">//æˆå‘˜çš„åå­—</span></span><br><span class="line">    <span class="keyword">char</span> *ivar_type                       OBJC2_UNAVAILABLE;<span class="comment">//æˆå‘˜æ•°æ®çš„ç±»å‹</span></span><br><span class="line">    <span class="keyword">int</span> ivar_offset                      OBJC2_UNAVAILABLE;<span class="comment">//æˆå‘˜çš„åç§»é‡</span></span><br><span class="line">    <span class="meta">#indef _LP64_</span></span><br><span class="line">    <span class="keyword">int</span> space                             OBJC2_UNAVAILABLE;<span class="comment">//æˆå‘˜å˜é‡æ‰€å ç©ºé—´</span></span><br><span class="line">    <span class="meta">#endif</span></span><br><span class="line"> </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ä»ä¸Šé¢å¯ä»¥çœ‹å‡ºç±»çš„å®ä¾‹å˜é‡å’Œå±æ€§ç»è¿‡runtimeç¼–è¯‘åæ˜¯ä»¥structçš„å‚¨å­˜å½¢å¼å­˜åœ¨ï¼Œå¹¶ä¸”å•ä¸ªå®ä¾‹å˜é‡ä¿å­˜å…¶åå­—ã€ç±»å‹ã€åç§»é‡å’Œå‚¨å­˜ç©ºé—´ã€‚ç±»ä¸­æ‰€æœ‰å®ä¾‹å˜é‡æ˜¯ä»¥listç±»å‹è¿›è¡Œå‚¨å­˜ã€‚</p>
<blockquote>
<p>é€šè¿‡å¯¹runtime.hæ–‡ä»¶æºç åˆ†ææˆ‘ä»¬å¯ä»¥çœ‹å‡ºï¼Œåœ¨IOSç¨‹åºè¿è¡Œè¿‡ç¨‹ä¸­æŠŠæˆ‘ä»¬ç±»ç¼–è¯‘ä¸ºC/C++å½¢å¼ã€‚ä¸”ç¼–è¯‘è¿‡ç¨‹æ˜¯ä¸€ä¸ªåŠ¨æ€è¿‡ç¨‹ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥é€šè¿‡æ­¤æ–¹å¼å¯¹æˆ‘ä»¬ç¨‹åºè¿›è¡ŒåŠ¨æ€æ“ä½œ</p>
</blockquote>
<h3 id="runtimeåŠ¨æ€æ“ä½œ"><a href="#runtimeåŠ¨æ€æ“ä½œ" class="headerlink" title="runtimeåŠ¨æ€æ“ä½œ"></a>runtimeåŠ¨æ€æ“ä½œ</h3><ul>åœ¨åŠ¨æ€ç¼–è¯‘è¿‡ç¨‹ä¸­æ— è®ºæ˜¯å±æ€§ã€å®ä¾‹å˜é‡ã€æˆå‘˜å‡½æ•°ã€ç±»æ–¹æ³•çš„å‡å¯ä»¥æ“ä½œï¼Œä¸€ä¸‹å°±ä»¥æ¯”è¾ƒç®€å•çš„è¿›è¡Œè®²è§£<br><li>è·å–ç±»çš„å¯¹è±¡å</li><br><li>è·å–ç±»ä¸­æˆå®ä¾‹å˜é‡å’Œå±æ€§</li><br><li>åŠ¨æ€æ·»åŠ æ–¹æ³•</li><br></ul>

<h3 id="è·å–ç±»çš„å¯¹è±¡å"><a href="#è·å–ç±»çš„å¯¹è±¡å" class="headerlink" title="è·å–ç±»çš„å¯¹è±¡å"></a>è·å–ç±»çš„å¯¹è±¡å</h3><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">unsigned</span> <span class="keyword">int</span> count = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">Class *classes = objc_copyClassList(&amp;count);</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; count; i++) &#123;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">char</span> *name = class_getName(classes[i]);</span><br><span class="line"></span><br><span class="line"><span class="built_in">NSLog</span>(<span class="string">@"%s"</span>, name);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>æ‰“å°å‡ºçš„å†…å®¹å¯èƒ½å‡ºä¹ä½ çš„æ„æ–™ï¼</p>
<h3 id="è·å–ç±»çš„å®ä¾‹å˜é‡å’Œå±æ€§"><a href="#è·å–ç±»çš„å®ä¾‹å˜é‡å’Œå±æ€§" class="headerlink" title="è·å–ç±»çš„å®ä¾‹å˜é‡å’Œå±æ€§"></a>è·å–ç±»çš„å®ä¾‹å˜é‡å’Œå±æ€§</h3><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">Class clazz = <span class="built_in">NSClassFromString</span>(<span class="string">@"Graduater"</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">unsigned</span> <span class="keyword">int</span> count = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">    Ivar *var = class_copyIvarList(clazz, &amp;count);</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; count; i++) &#123;</span><br><span class="line">        <span class="keyword">const</span> <span class="keyword">char</span> *name = ivar_getName(var[i]);</span><br><span class="line">        <span class="built_in">NSLog</span>(<span class="string">@"%s"</span>, name);</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>
<p>æˆ‘å®šä¹‰ä¸€ä¸ªæ¯•ä¸šç”Ÿç±»ï¼Œç„¶åå°±å¯ä»¥æ‰“å°å‡ºå…¶ä¸­çš„å‡½æ•°å®ä¾‹å˜é‡å’Œå±æ€§ï¼ˆä¸å¤šè®°å¾—è¦å¼•å…¥<objc runtime.h="">çš„å¤´æ–‡ä»¶ï¼‰ï¼›</objc></p>
<h3 id="åŠ¨æ€çš„æ·»åŠ æ–¹æ³•"><a href="#åŠ¨æ€çš„æ·»åŠ æ–¹æ³•" class="headerlink" title="åŠ¨æ€çš„æ·»åŠ æ–¹æ³•"></a>åŠ¨æ€çš„æ·»åŠ æ–¹æ³•</h3><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#import <span class="meta-string">&lt;objc/runtime.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">void</span> abc(<span class="keyword">id</span> <span class="keyword">self</span>, SEL _cmd)&#123;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">NSLog</span>(<span class="string">@"%@hello"</span>, <span class="keyword">self</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">@implementation</span> <span class="title">Graduater</span></span></span><br><span class="line"></span><br><span class="line">+(<span class="built_in">BOOL</span>)resolveInstanceMethod:(SEL)sel&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> ([<span class="built_in">NSStringFromSelector</span>(sel) isEqualToString:<span class="string">@"sihai"</span>]) &#123;</span><br><span class="line">        class_addMethod(<span class="keyword">self</span>, sel, abc, <span class="string">"v@:"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">YES</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ç„¶ååœ¨å‡½æ•°è°ƒç”¨æ—¶æ‰§è¡Œä¸‹åˆ—ï¼š</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Graduater *graduate = [[Graduater alloc] init];</span><br><span class="line"></span><br><span class="line">[graduate performSelector:<span class="keyword">@selector</span>(sihai) withObject:<span class="literal">nil</span>];</span><br></pre></td></tr></table></figure>
<p>æ‰§è¡Œçš„ç»“æœå¯ä»¥æ¡ç”¨æˆ‘ä»¬æ·»åŠ çš„@select(abc)çš„æ–¹æ³•ã€‚</p>
<h3 id="runtimeä½¿ç”¨APIçš„ä»‹ç»ï¼š"><a href="#runtimeä½¿ç”¨APIçš„ä»‹ç»ï¼š" class="headerlink" title="runtimeä½¿ç”¨APIçš„ä»‹ç»ï¼š"></a>runtimeä½¿ç”¨APIçš„ä»‹ç»ï¼š</h3><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="keyword">char</span> * class_getName(Class cls) <span class="comment">//è·å–classçš„åå­—</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">BOOL</span> class_addIvar(Class cls, <span class="keyword">const</span> <span class="keyword">char</span> *name, size_t size, uint8_t alignment, <span class="keyword">const</span> <span class="keyword">char</span> *types)  <span class="comment">//å¢æ·»å®ä¾‹å˜é‡</span></span><br><span class="line"></span><br><span class="line">objc_property_t  class_getProperty(Class cls, <span class="keyword">const</span> <span class="keyword">char</span> *name) <span class="comment">//è·å–å±æ€§</span></span><br><span class="line"></span><br><span class="line">objc_property_t * class_copyPropertyList(Class cls, <span class="keyword">unsigned</span> <span class="keyword">int</span> *outCount) <span class="comment">//è·å–å±æ€§åˆ—è¡¨</span></span><br><span class="line"></span><br><span class="line">Method class_getInstanceMethod(Class aClass, SEL aSelector) <span class="comment">//è·å–æ–¹æ³•</span></span><br><span class="line"></span><br><span class="line">objc_allocateClassPair(Class superclass, <span class="keyword">const</span> <span class="keyword">char</span> *name, size_t extraBytes) <span class="comment">//æ·»åŠ åŠ¨æ€ç±»</span></span><br></pre></td></tr></table></figure>
<p>é™¤å»ä¸Šé¢æˆ‘ä»¬åˆ—ä¸¾å…¶ä¸­æå°‘æ•°çš„è°ƒç”¨å®ä¾‹ï¼Œå¦‚æœæƒ³äº†è§£æ›´å¤šç‚¹å‡»<a href="https://developer.apple.com/library/ios/documentation/Cocoa/Reference/ObjCRuntimeRef/index.html#//apple_ref/doc/uid/TP40001418-CH1g-211911" target="_blank" rel="external">è¿™é‡Œ</a>ã€‚</p>
<blockquote>
<p>åœ¨ä½¿ç”¨runtimeè¿‡ç¨‹ï¼Œå¯¹äºæ“ä½œå¯¹è±¡å®è¡Œæ–¹æ³•æ”¹å–„<br>å¯¹äºå¯¹è±¡è¿›è¡Œç›¸å…³æ“ä½œä¸€èˆ¬ä»¥objc<em>å¼€å¤´<br>å¯¹äºç±»çš„å¯¹è±¡è¿›è¡Œæ“ä½œä¸€èˆ¬ä»¥class</em>å¼€å¤´<br>å¯¹äºä½¿ç”¨æ–¹æ³•å¯¹è±¡æ“ä½œä¸€èˆ¬ä»¥method<em>å¼€å¤´<br>å¯¹äºä½¿ç”¨ç”³æ˜å±æ€§ï¼ˆpropertyï¼‰ä¸€èˆ¬æ˜¯ä»¥property</em>å¼€å¤´<br>å¯¹äºä½¿ç”¨ç±»æˆå‘˜å˜é‡ä¸€èˆ¬ä½¿ç”¨ivar_å¼€å¤´</p>
</blockquote>
<h3 id="æ¶ˆæ¯ä¼ é€æœºåˆ¶"><a href="#æ¶ˆæ¯ä¼ é€æœºåˆ¶" class="headerlink" title="æ¶ˆæ¯ä¼ é€æœºåˆ¶"></a>æ¶ˆæ¯ä¼ é€æœºåˆ¶</h3><p>åœ¨IOSçš„ä¸€ä¸ªç±»ä¸­æˆ‘ä»¬è°ƒç”¨æ–¹æ³•ä½¿ç”¨ä¹Ÿæ˜¯æ¯”è¾ƒå¤šï¼Œå¦‚</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[<span class="keyword">self</span> method];</span><br></pre></td></tr></table></figure>
<p>ä½†æ˜¯åœ¨runtimeç¼–è¯‘è¿‡ç¨‹ä¸­å…·ä½“å®ç°çš„æ–¹å¼æ˜¯ä»€ä¹ˆå‘¢ï¼Ÿ<br>é¦–å…ˆæˆ‘ä»¬çœ‹å…ˆmessage.hä¸­çš„æºç </p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* Basic Messaging Primitives</span><br><span class="line"> * On some architectures, use objc_msgSend_stret for some struct return types.</span><br><span class="line"> * On some architectures, use objc_msgSend_fpret for some float return types.</span><br><span class="line"> * These functions must be cast to an appropriate function pointer type </span><br><span class="line"> * before being called. */</span></span><br><span class="line"></span><br><span class="line">OBJC_EXPORT <span class="keyword">id</span> objc_msgSend(<span class="keyword">id</span> <span class="keyword">self</span>, SEL op, ...);</span><br><span class="line"></span><br><span class="line">OBJC_EXPORT <span class="keyword">id</span> objc_msgSendSuper(<span class="keyword">struct</span> objc_super *<span class="keyword">super</span>, SEL op, ...);</span><br></pre></td></tr></table></figure>
<p>ä»ä¸Šé¢çš„è§£é‡Šæˆ‘ä»¬å¯ä»¥çš„å‡ºå¦‚æœè¿”å›ç±»å‹ä¸ºfloatè°ƒç”¨objc_msgSend_fpretï¼Œå¦‚æœæ˜¯æ•°æ®ç»“æ„è¿”å›ä½¿ç”¨objc_msgSend_stretã€‚è€Œæˆ‘ä»¬è®²è§£æ—¶ä½¿ç”¨ objc_msgSend(id self, SEL op, â€¦)ï¼Œå°±åƒæˆ‘ä»¬ä¸Šé¢çš„ä¾‹å­å°±ä¼šè½¬åŒ–ä¸ºobjc_msgSend(self @select(method))ï¼Œä½†æ˜¯æ‰¾åˆ°æˆ‘ä»¬æ‰€ä½¿ç”¨çš„æ–¹æ³•å…·ä½“æ˜¯æ€ä¹ˆå®ç°çš„ï¼Ÿ</p>
<div style="color:#008B8B"><br><p>åœ¨æ­¤åœ°æ–¹æˆ‘å°±å°†æ·»åŠ ä¸Šé¢çœ‹åˆ°çš„å…³äºobjc_msgSend,objc_msgSendSuper,SEL</p><br></div>

<hr>
<p>æ•°æ®ç±»å‹ï¼š<br>ï¼ˆ1ï¼‰SEL:<br>     SELåˆå«åšé€‰æ‹©å™¨ï¼Œè¡¨ç¤ºä¸€ä¸ª@selectorçš„æŒ‡é’ˆï¼Œæ˜ å°„æ–¹æ³•çš„åå­—ã€‚åœ¨Objcç¼–è¯‘çš„è¿‡ç¨‹ä¸­é€šè¿‡æ¯ä¸ªæ–¹æ³•çš„åå­—å’Œå‚æ•°æ˜¯ç”Ÿæˆçš„å”¯ä¸€çš„æ ‡ç¤ºï¼ˆæ­¤æ ‡ç¤ºæ˜¯intçš„ç±»å‹ï¼‰ï¼Œæˆ‘ä»¬æŠŠè¿™ä¸ªæ ‡ç¤ºç§°ä½œä¸ºSELã€‚<br><br>     SElçš„ä½œç”¨æ˜¯ä½œä¸ºIMPï¼ˆå…³äºIMPçš„å…·ä½“è¯´æ˜ä¼šåœ¨ä¸‹é¢å±•ç¤ºï¼‰çš„keyå­˜åœ¨ï¼Œå­˜å‚¨åœ¨NSSetçš„ä¸­ï¼Œè¿™æ ·å¯ä»¥æ–¹ä¾¿æˆ‘ä»¬ä½¿ç”¨hashçš„å¿«é€ŸæŸ¥æ‰¾ã€‚SELä½¿æˆ‘ä»¬æŸ¥æ‰¾IMPï¼ˆæŒ‡å‘å®ç°å‡½æ•°çš„æŒ‡é’ˆï¼‰keyï¼Œå¦‚æœSELå¯ä»¥ç›¸åŒçš„è¯æˆ‘ä»¬è°ƒç”¨å‡½æ•°å°±ä¼šå‘ç”Ÿé”™è¯¯ã€‚æ‰€ä»¥SELæ˜¯ä¸å¯ä»¥é‡å¤çš„ï¼Œæ–¹æ³•ä¹Ÿæ˜¯ä¸å¯ä»¥é‡å¤çš„ã€‚è¿™ä¹Ÿå°±æ˜¯æˆ‘ä»¬åœ¨Objcå¼€å‘è¿‡ç¨‹ä¸­åœ¨åŒä¸€ä¸ªç±»ä¸­ä¸å¯ä»¥ä½¿ç”¨åŒåçš„å‡½æ•°~~~æ­¤å¤„å’ŒC++æ”¯æŒé‡è½½æœ‰å¾ˆå¤§åŒºåˆ«ã€‚<br><br><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">typedef</span> <span class="keyword">struct</span> objc_selector *SEL;</span><br></pre></td></tr></table></figure><br>è™½è¯´åœ¨runtime.hä¸­æ²¡æœ‰æ˜¾ç¤ºobjc_selectorç»“æ„ä½“ç±»å‹ï¼Œä½†æ˜¯ä½œä¸ºç¨‹åºå‘˜çš„æˆ‘ä»¬å¯ä»¥æ‰¾åˆ°æ–¹æ³•è¿›è¡ŒéªŒè¯ï¼Œä½¿ç”¨logæ‰“å°SELè¯•ä¸‹ï¼Ÿ<br><br>ï¼ˆ2ï¼‰IMP:<br>      IMPä¸Šé¢è®²åˆ°IMPæŠŠSELä½œä¸ºkeyå€¼ï¼ŒIMPè¯´ç™½å•¦å°±æ˜¯æŒ‡å‘æˆ‘ä»¬æ–¹æ³•çš„æŒ‡é’ˆï¼Œä¹Ÿå°±æ˜¯æˆ‘ä»¬æ¡ç”¨å…·ä½“å‡½æ•°æ–¹æ³•çš„å…¥å£ã€‚</p>
<figure class="highlight plain"><figcaption><span>lang: objc</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">typedefine id (*IMP)(id, SEL, ...)</span><br></pre></td></tr></table></figure>
<p>ï¼ˆ3ï¼‰Method<br>       Method:ä¸Šé¢æˆ‘ä»¬åœ¨ç±»çš„Structçš„ç»“æ„ä¸­å¯ä»¥çœ‹å‡ºMethodæ˜¯æ”¾ç½®æˆ‘ä»¬ä½¿ç”¨çš„æ–¹æ³•ï¼Œä¹Ÿæ˜¯æˆ‘ä»¬ä½¿ç”¨SELå’ŒIMPçš„ä¸€ä¸ªå…·ä½“çš„ç»‘å®šã€‚é€šè¿‡ä½¿ç”¨SELæ¥æ‰¾åˆ°å¯¹åº”çš„IMPè¿›è€Œå®ç°æˆ‘ä»¬æ–¹æ³•çš„å…·ä½“è°ƒç”¨ã€‚ä¸‹é¢çœ‹ä»£ç ï¼š</p>
<figure class="highlight plain"><figcaption><span>lang: objc</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">typedef struct objc_method *Method;</span><br><span class="line"></span><br><span class="line">struct objc_method &#123;</span><br><span class="line">    SEL method_name                 OBJC2_UNAVAILABLE;  // æ–¹æ³•å</span><br><span class="line">    char *method_types                  OBJC2_UNAVAILABLE; // å‚æ•°ç±»å‹</span><br><span class="line">    IMP method_imp                      OBJC2_UNAVAILABLE;  // æ–¹æ³•å®ç°</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ä¸‹é¢æˆ‘ä»¬çœ‹ä¸‹åœ¨ç±»ä¸­æ–¹æ³•å…·ä½“å®ç°çš„å½¢å¼ï¼š</p>
<figure class="highlight plain"><figcaption><span>lang: objc</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">struct objc_method_list &#123;</span><br><span class="line">    struct objc_method_list *obsolete                        OBJC2_UNAVAILABLE;</span><br><span class="line">    int method_count                                                 OBJC2_UNAVAILABLE;</span><br><span class="line">#ifdef __LP64__</span><br><span class="line">    int space                                                              OBJC2_UNAVAILABLE;</span><br><span class="line">#endif</span><br><span class="line">    /* variable length structure */</span><br><span class="line">    struct objc_method method_list[1]                        OBJC2_UNAVAILABLE;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ï¼ˆ4ï¼‰æ–¹æ³•ç¼“å­˜<br>æˆ‘ä»¬åœ¨è°ƒç”¨æ–¹æ³•çš„è¿‡ç¨‹å…¶å®æ˜¯Lazyè°ƒç”¨çš„è¿‡ç¨‹ï¼Œæ–¹æ³•åœ¨ç¬¬ä¸€æ¬¡è°ƒç”¨åŠ è½½åä¼šæ”¾åˆ°ç¼“å­˜æ± ä¸­ã€‚objcç¨‹åºå¯åŠ¨åï¼Œéœ€è¦è¿›è¡Œç±»çš„åˆå§‹åŒ–ã€è°ƒç”¨æ–¹æ³•æ—¶çš„cacheåˆå§‹åŒ–ï¼Œå†å‘é€æ¶ˆæ¯çš„æ—¶å€™å°±ç›´æ¥èµ°ç¼“å­˜ã€‚<br><br>ä¸‹é¢æˆ‘ä¼šå¯¹æ–¹æ³•ç¼“å­˜åšè¯¦ç»†çš„è§£é‡Šã€‚</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">struct</span> objc_cache &#123;</span><br><span class="line">    <span class="comment">// ç¼“å­˜bucketçš„æ€»æ•°</span></span><br><span class="line">    <span class="keyword">unsigned</span> <span class="keyword">int</span> mask <span class="comment">/* total = mask + 1 */</span>                 OBJC2_UNAVAILABLE;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// å®é™…ç¼“å­˜bucketçš„æ€»æ•°</span></span><br><span class="line">    <span class="keyword">unsigned</span> <span class="keyword">int</span> occupied                                    OBJC2_UNAVAILABLE;</span><br><span class="line">    <span class="comment">// æŒ‡å‘Methodæ•°æ®ç»“æ„æŒ‡é’ˆçš„æ•°ç»„</span></span><br><span class="line">    Method buckets[<span class="number">1</span>]                                        OBJC2_UNAVAILABLE;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<hr>
<h3 id="æ¶ˆæ¯è½¬å‘æœºåˆ¶å…·ä½“å®ç°"><a href="#æ¶ˆæ¯è½¬å‘æœºåˆ¶å…·ä½“å®ç°" class="headerlink" title="æ¶ˆæ¯è½¬å‘æœºåˆ¶å…·ä½“å®ç°"></a>æ¶ˆæ¯è½¬å‘æœºåˆ¶å…·ä½“å®ç°</h3><p>åœ¨åŠ¨æ€æ·»åŠ æ–¹æ³•è¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨å¦‚ä¸‹æ–¹å¼ï¼š</p>
<h3 id="1åŠ¨æ€è§£ææ–¹æ³•"><a href="#1åŠ¨æ€è§£ææ–¹æ³•" class="headerlink" title="1åŠ¨æ€è§£ææ–¹æ³•"></a>1åŠ¨æ€è§£ææ–¹æ³•</h3><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">+(<span class="built_in">BOOL</span>)resolveInstanceMethod:(SEL)sel;</span><br></pre></td></tr></table></figure>
<p>å…·ä½“å®ä¾‹å¦‚ä¸‹ï¼š<br><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">+(<span class="built_in">BOOL</span>)resolveInstanceMethod:(SEL)sel&#123;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> ([<span class="built_in">NSStringFromSelector</span>(sel) isEqualToString:<span class="string">@"sihai"</span>])</span><br><span class="line"> &#123;</span><br><span class="line"></span><br><span class="line">   class_addMethod(<span class="keyword">self</span>, sel, abc, <span class="string">"v@:"</span>);</span><br><span class="line">   </span><br><span class="line">   <span class="keyword">return</span> <span class="literal">YES</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">   <span class="keyword">return</span> <span class="literal">NO</span>;</span><br><span class="line"></span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure></p>
<p>ä»è¿™é‡Œæˆ‘ä»¬å°±å¯ä»¥çœ‹å‡ºåœ¨å‡½æ•°è°ƒç”¨è¿‡ç¨‹ä¸­runtimeä¼šæ ¹æ®SElè¯†åˆ«å­è¿›è¡Œå¯»æ‰¾ï¼Œåœ¨ä¾‹å­ä¸­æˆ‘ä»¬æœ‰ç›¸åº”çš„è¯†åˆ«å¯ä»¥æŸ¥è¯¢ï¼Œå¦‚æœæ²¡æœ‰ç›¸åº”çš„è¯†åˆ«å­å‘¢ï¼Ÿ</p>
<blockquote>
<p>åœ¨ç³»ç»Ÿä¸­å¦‚æœåœ¨æŸ¥æ‰¾è¿‡ç¨‹ä¸­æ²¡æœ‰æ‰¾åˆ°ç›¸åº”çš„é€‰æ‹©å­ï¼Œå°±ä¼šè°ƒç”¨ä¸Šé¢çš„å‡½æ•°<br>+(BOOL)resolveInstanceMethod:(SEL)selï¼›ç”Ÿæˆå®ä¾‹æ–¹æ³•ï¼Œå¦‚ä¸Šé¢ä¾‹å­ï¼ˆæ·»åŠ ç›¸åº”çš„å®ä¾‹æ–¹æ³•å¯ä»¥å®ç°ï¼Œå°±è·³è½¬æ–¹æ³•å®ç°ï¼‰ã€‚æŠŠæ·»åŠ æ–¹æ³•æ”¾å…¥åˆ°ç¼“å­˜ä¸­ï¼Œå¯ä»¥ä¾›æˆ‘ä»¬è¿›è¡Œä¸‹æ¬¡çš„è°ƒç”¨</p>
</blockquote>
<p>å¦‚æœä¸Šé¢æˆ‘ä»¬æ‰¾åˆ°ç›¸åº”çš„è¯†åˆ«å­ï¼Œå°±ä¼šè¿›è¡Œç¬¬äºŒæ¬¡å¯¹é€‰æ‹©å­è¿›è¡Œç›¸å…³çš„å¤„ç†ã€‚</p>
<h3 id="2å¤‡æ´æ¥æ”¶åˆ°"><a href="#2å¤‡æ´æ¥æ”¶åˆ°" class="headerlink" title="2å¤‡æ´æ¥æ”¶åˆ°"></a>2å¤‡æ´æ¥æ”¶åˆ°</h3><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">-(<span class="keyword">id</span>)forwardingTargetForSelector:(SEL)aSelector;</span><br><span class="line">å…·ä½“å®ä¾‹å¦‚ä¸‹ï¼š</span><br><span class="line"></span><br><span class="line">-(<span class="keyword">id</span>)forwardingTargetForSelector:(SEL)aSelector&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> ([<span class="built_in">NSStringFromSelector</span>(aSelector) isEqualToString:<span class="string">@"sihai"</span>]) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">self</span>;</span><br><span class="line">    &#125;</span><br><span class="line">        <span class="keyword">return</span> [<span class="keyword">super</span> forwardingTargetForSelector:aSelector];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ç³»ç»Ÿä¼šæŠŠé€‰æ‹©å­ä½œä¸ºå‚æ•°ï¼Œè¿”å›ç»™æˆ‘ä»¬ä¸€ä¸ªé€‰æ‹©å­å¯¹è±¡ã€‚è¿è¡Œçš„ç³»ç»Ÿå°±ä¼šå¯¹ç›¸å…³æ–¹æ³•å®ä¾‹è¿›è¡ŒæŸ¥æ‰¾ï¼Œå¦‚æœæ‰¾åˆ°ç›¸å…³æ–¹æ³•å°±å®è¡Œï¼Œæ‰¾ä¸åˆ°å°±ç»“æŸè½¬å‘ã€‚</p>
<h3 id="3å®Œæ•´çš„æ¶ˆæ¯ä¼ é€’"><a href="#3å®Œæ•´çš„æ¶ˆæ¯ä¼ é€’" class="headerlink" title="3å®Œæ•´çš„æ¶ˆæ¯ä¼ é€’"></a>3å®Œæ•´çš„æ¶ˆæ¯ä¼ é€’</h3><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">-(<span class="keyword">void</span>)forwardInvocation:(<span class="built_in">NSInvocation</span> *)anInvocation;</span><br><span class="line">å®ç°çš„å…·ä½“æ–¹æ³•å¦‚ä¸‹ï¼š</span><br><span class="line"></span><br><span class="line">-(<span class="built_in">NSMethodSignature</span>*)methodSignatureForSelector:(SEL)aSelector&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> ([<span class="built_in">NSStringFromSelector</span>(aSelector) isEqualToString:<span class="string">@"sihai"</span>]) &#123;</span><br><span class="line">        <span class="keyword">return</span> [<span class="built_in">NSMethodSignature</span> signatureWithObjCTypes:<span class="string">"v@:"</span>];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> [<span class="keyword">super</span> methodSignatureForSelector:aSelector];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">-(<span class="keyword">void</span>)forwardInvocation:(<span class="built_in">NSInvocation</span> *)anInvocation&#123;</span><br><span class="line"></span><br><span class="line">        anInvocation.selector = <span class="keyword">@selector</span>(fly);</span><br><span class="line">        [anInvocation invokeWithTarget:<span class="keyword">self</span>];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>å¦‚æœä¸Šé¢2æ­¥éª¤ä¸­è¿”å›ä¾ç„¶æ˜¯nilï¼Œä¹Ÿä¼šæ‰§è¡Œå®Œæ•´çš„æ¶ˆæ¯ä¼ è¾“æ¶ˆæ¯æœºåˆ¶ã€‚åœ¨è¯¥æ–¹æ³•ä¸­æˆ‘ä»¬å¯ä»¥æ”¹å˜å…¶ç›®æ ‡ï¼Œç„¶åè¿è¡Œç³»ç»Ÿå°±ä¼šæ ¹æ®æ”¹å˜çš„ç›®æ ‡ï¼Œåœ¨å…¶ç›®æ ‡ä¸­æŸ¥è¯¢å®ç°æ–¹æ³•åˆ«è°ƒç”¨ã€‚å½“ç„¶ä¹Ÿå¯ä»¥è¿›è¡Œä¿®æ”¹é€‰æ‹©å­ã€‚</p>
<h3 id="å¦‚æœæ–¹æ³•è°ƒç”¨å¤±è´¥"><a href="#å¦‚æœæ–¹æ³•è°ƒç”¨å¤±è´¥" class="headerlink" title="å¦‚æœæ–¹æ³•è°ƒç”¨å¤±è´¥"></a>å¦‚æœæ–¹æ³•è°ƒç”¨å¤±è´¥</h3><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">-(<span class="keyword">void</span>)doesNotRecognizeSelector:(SEL)aSelector;</span><br></pre></td></tr></table></figure>
<p>é€šè¿‡å¯¹äº[self method];æ–¹æ³•çš„å®ç°è¿‡ç¨‹çš„è¿›è¡Œæ¢ç©¶æˆ‘ä»¬æˆ‘ä»¬å¯ä»¥äº†è§£åˆ°åœ¨æ¶ˆæ¯ä¼ é€’è¿‡ç¨‹æ˜¯å¦‚ä½•å®ç°çš„ï¼Œè€Œä¸”æˆ‘ä»¬å¯ä»¥æ›´å…·æˆ‘ä»¬éœ€æ±‚å¯¹å…¶ä¸­çš„æ–¹æ³•è¿›è¡Œç›¸åº”çš„è€Œä¿®æ”¹ã€‚</p>
<blockquote>
<p>runtimeæ˜¯Objcè¯­è¨€ç‰¹æ€§ï¼Œæœ¬äººé€šè¿‡å¯¹äºçš„ç ”ç©¶ç†è§£æ˜¯ï¼šé€šè¿‡runtimeæˆ‘ä»¬å¯ä»¥ç­‰åˆ°æˆ‘ä»¬ç±»ä¸­æ‰€æœ‰å…ƒç´ çš„èµ„æ–™ä¿¡æ¯ï¼Œå¯ä»¥ä½¿ç”¨æœŸåŒå·¥çš„APIå¯¹ç±»è¿›è¡Œæˆ‘ä»¬æƒ³åˆ°è¾¾åˆ°çš„ç›®çš„ï¼›åœ¨æˆ‘ä»¬è°ƒè¯•è¿‡ç¨‹ä¸­ä¹Ÿå¯ä»¥é€šè¿‡æ‰“å°æ¥ç®€åŒ–æˆ‘ä»¬è°ƒè¯•ä¿¡æ¯ï¼›æœ€æ£’çš„å°±æ˜¯æˆ‘ä»¬å¯ä»¥äº†è§£ç¨‹åºè¿è¡Œè¿‡ç¨‹å¯ä»¥åœ¨å¼€å‘ä¸­ä½¿æˆ‘ä»¬æ›´åŠ å¾—å¿ƒåº”æ‰‹ã€‚</p>
</blockquote>
<p><br></p>
<h3 id="å‚è€ƒæ¥ä¹‹ï¼š"><a href="#å‚è€ƒæ¥ä¹‹ï¼š" class="headerlink" title="å‚è€ƒæ¥ä¹‹ï¼š"></a>å‚è€ƒæ¥ä¹‹ï¼š</h3><p><a href="http://www.cocoachina.com/ios/20151015/13769.html" target="_blank" rel="external">Runtimeåˆæ¶‰ä¹‹æ¶ˆæ¯è½¬å‘</a><br><br><br><a href="http://www.cocoachina.com/ios/20150901/13173.html" target="_blank" rel="external">å­¦ä¹ runtimeçš„ç†è§£å’Œå¿ƒå¾—</a><br><br><br><a href="https://developer.apple.com/library/ios/documentation/Cocoa/Reference/ObjCRuntimeRef/index.html#//apple_ref/doc/uid/TP40001418-CH1g-88778" target="_blank" rel="external">runtime æºç </a><br><br><a href="http://www.jianshu.com/p/f900de4a1495#" target="_blank" rel="external">OCåˆ¨æ ¹é—®åº•-Runtimeç®€å•ç²—æš´ç†è§£</a></p>

      

      
    </div>
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<i class="icon-price-tags icon"></i>
		<ul class="article-tag-list">
			 
        		<li class="article-tag-list-item">
        			<a href="javascript:void(0)" class="js-tag article-tag-list-link color4">IOS</a>
        		</li>
      		
		</ul>
	</div>

      
	<div class="article-category tagcloud">
		<i class="icon-book icon"></i>
		<ul class="article-tag-list">
			 
        		<li class="article-tag-list-item">
        			<a href="/categories/IOS/" class="article-tag-list-link color4">IOS</a>
        		</li>
      		
		</ul>
	</div>


      
        <p class="article-more-link">
          <a class="article-more-a" href="/2016/05/29/runtimeç†è§£/">å±•å¼€å…¨æ–‡ >></a>
        </p>
      

      
      <div class="clearfix"></div>
    </div>
  </div>
</article>





  
    <article id="post-Fastlaneè®²è§£" class="article article-type-post  article-index" itemscope itemprop="blogPost">
  <div class="article-inner">
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/05/29/Fastlaneè®²è§£/">Fastlaneè®²è§£</a>
    </h1>
  

        
        <a href="/2016/05/29/Fastlaneè®²è§£/" class="archive-article-date">
  	<time datetime="2016-05-29T04:13:46.000Z" itemprop="datePublished"><i class="icon-calendar icon"></i>2016-05-29</time>
</a>
        
      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>å¤§æ¦‚åœ¨ä¸€ä¸ªæœˆå·¦å³å†™è¿‡å…³äºcocoaPodså®‰è£…å’Œä½¿ç”¨æ–¹æ³•ï¼Œå¦‚æœè¯´cocoaPodsæ˜¯æˆ‘ä»¬ç›¾ç‰Œï¼ˆå¯ä»¥è®©æˆ‘ä»¬åœ¨å¼€å‘è¿‡ç¨‹ä¸­ä¸“æ³¨å®ç°ä»£ç éƒ¨åˆ†ï¼‰ï¼Œé‚£ä¹ˆfastlaneå°±ä¼šæ˜¯æˆ‘ä»¬å¼€å‘è¿‡ç¨‹ä¸­çš„é•¿çŸ›ï¼ˆå¸®åŠ©æˆ‘ä»¬åœ¨å¼€å‘è¿‡ç¨‹ä¸­æäº¤æµ‹è¯•ã€å¿«é€Ÿå‘å¸ƒï¼‰ã€‚<br>æƒ³çŸ¥é“fastlaneäº†è§£ç‚¹å‡»<a href="https://fastlane.tools" target="_blank" rel="external">è¿™é‡Œ<br></a>è·å–fastlançš„githubä¸‹è½½ç‚¹å‡»<a href="https://github.com/fastlane/fastlane" target="_blank" rel="external">è¿™é‡Œ</a></p>
<h3 id="fastlaneå®‰è£…"><a href="#fastlaneå®‰è£…" class="headerlink" title="fastlaneå®‰è£…"></a>fastlaneå®‰è£…</h3><p>fastlaneæ˜¯åŸºäºRubyçš„å¼€å‘è„šæœ¬é›†åˆæœ‰åŠ©äºæˆ‘ä»¬åœ¨IOSå¼€å‘è¿‡ç¨‹ä¸­è¾¾åˆ°ç®€ä¾¿çš„å¼€å‘ã€‚å¦‚æœä½ åœ¨è‡ªå·±MACä¸Šå·²ç»å®‰è£…RubyåŠå…¶ç¯å¢ƒï¼Œåªéœ€è¦æ‰§è¡Œä¸‹åˆ—å®‰è£…å°±å¯ä»¥å®ç°<br>    sudo gem install fastlane â€“verbose<br>ç¡®å®šè‡ªå·±å®‰è£…çš„æ˜¯æœ€æ–°ç‰ˆæœ¬çš„Xcode:</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Xcode-select --install</span><br><span class="line"></span><br><span class="line">å¦‚æœåœ¨å¯åŠ¨fastlaneæ¯”è¾ƒæ…¢çš„æƒ…å†µå¯ä»¥æ‰§è¡Œ:</span><br><span class="line"></span><br><span class="line">gem cleanup</span><br></pre></td></tr></table></figure>
<h3 id="fastlaneä½¿ç”¨å…·ä½“æ–¹æ³•å’Œå…·ä½“åŠŸèƒ½"><a href="#fastlaneä½¿ç”¨å…·ä½“æ–¹æ³•å’Œå…·ä½“åŠŸèƒ½" class="headerlink" title="fastlaneä½¿ç”¨å…·ä½“æ–¹æ³•å’Œå…·ä½“åŠŸèƒ½"></a>fastlaneä½¿ç”¨å…·ä½“æ–¹æ³•å’Œå…·ä½“åŠŸèƒ½</h3><p>äº†è§£å…·ä½“ä½¿ç”¨ç‚¹å‡»<a href="https://github.com/fastlane/fastlane/tree/master/deliver" target="_blank" rel="external">è¿™é‡Œ</a></p>
<ul><br><li>deliverï¼šä¸Šä¼ å±å¹•æˆªå›¾ã€äºŒè¿›åˆ¶ç¨‹åºæ•°æ®å’Œåº”ç”¨ç¨‹åºåˆ°AppStore</li><br><li>snapshotï¼šè‡ªåŠ¨æˆªå–ä½ çš„ç¨‹åºåœ¨æ¯ä¸ªè®¾å¤‡ä¸Šçš„å›¾ç‰‡</li><br><li>frameitï¼šåº”ç”¨æˆªå±å¤–æ·»åŠ è®¾å¤‡æ¡†æ¶</li><br><li>pemï¼šå¯ä»¥è‡ªåŠ¨åŒ–åœ°ç”Ÿæˆå’Œæ›´æ–°åº”ç”¨æ¨é€é€šçŸ¥æè¿°æ–‡ä»¶</li><br><li>sighï¼šç”Ÿæˆä¸‹è½½å¼€å‘å•†åº—çš„é…ç½®æ–‡ä»¶</li><br><li>pilotï¼šæœ€å¥½çš„åœ¨ç»ˆç«¯ç®¡ç†æµ‹è¯•å’Œå»ºç«‹çš„æ–‡ä»¶</li><br><li>boardingï¼šå¾ˆå®¹æ˜“çš„æ–¹å¼é‚€è¯·ä½ æµ‹è¯•betaæµ‹è¯•</li><br><li>gypï¼šå»ºç«‹æ–°çš„å‘å¸ƒçš„ç‰ˆæœ¬</li><br><li>matchï¼šä½¿ç”¨gitåŒæ­¥ä½ æˆå‘˜é—´çš„å¼€å‘è€…è¯ä¹¦å’Œæ–‡ä»¶é…ç½®</li><br></ul>

<h3 id="fastlaneä¸¾ä¾‹ï¼š"><a href="#fastlaneä¸¾ä¾‹ï¼š" class="headerlink" title="fastlaneä¸¾ä¾‹ï¼š"></a>fastlaneä¸¾ä¾‹ï¼š</h3><p>ä½¿ç”¨deliverè‡ªåŠ¨æ‰“åŒ…æˆ‘ä»¬Appæäº¤åˆ°AppStoreï¼Œå®˜æ–¹ä½¿ç”¨ç‚¹å‡»<a href="https://github.com/fastlane/fastlane/tree/master/deliver" target="_blank" rel="external">è¿™é‡Œ</a><br>æ‰“å¼€ç»ˆç«¯è¿›è¡Œæˆ‘ä»¬é¡¹ç›®æ‰€åœ¨çš„floderï¼Œæˆ‘çš„é¡¹ç›®æ˜¯åœ¨æ¡Œé¢ä¸Šåç§°æ˜¯hello<br><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">cd ~/desktop/hello</span><br><span class="line"></span><br><span class="line">ç„¶åè¾“å…¥ï¼š</span><br><span class="line"></span><br><span class="line">deliver init</span><br><span class="line"></span><br><span class="line">ç„¶åè¾“å…¥æˆ‘ä»¬çš„Apple ID Username:</span><br><span class="line">å†è¾“å…¥æˆ‘ä»¬çš„Password </span><br></pre></td></tr></table></figure></p>
<h3 id="fastlaneä½¿ç”¨åœºæ™¯"><a href="#fastlaneä½¿ç”¨åœºæ™¯" class="headerlink" title="fastlaneä½¿ç”¨åœºæ™¯"></a>fastlaneä½¿ç”¨åœºæ™¯</h3><ul><br><li>åœ¨æˆ‘ä»¬å¼€å‘åæ¯æ¬¡æäº¤æ—¶æ‰§è¡Œçš„æµ‹è¯•ï¼ˆæœ‰teamçš„å•å…ƒæµ‹è¯•å’Œå›¢é˜Ÿå¼€å‘çš„é›†æˆæµ‹è¯•ï¼‰(pilot)</li><br><li>æ„å»ºæˆ‘ä»¬ä½¿ç”¨çš„Bateç‰ˆæœ¬æ—¶ï¼ˆboardingï¼‰</li><br><li>å¼€å‘å¥½é¡¹ç›®éœ€è¦æç»™ç•Œé¢æˆªå›¾æ—¶(snapshot)</li><br><li>æ„å»ºå¹¶åˆ†å‘è‡³åº”ç”¨å•†åº—ï¼ˆè¿™åŒ…æ‹¬æ›´æ–°é…ç½®æ–‡ä»¶ï¼Œåˆ›å»ºæ–°çš„å±å¹•æˆªå›¾ï¼Œä¸Šä¼ åº”ç”¨è‡³åº”ç”¨å•†åº—å¹¶æäº¤åº”ç”¨ï¼‰(deliver)</li><br></ul>

<h3 id="fastlaneå…¸å‹çš„å¼€å‘æµç¨‹"><a href="#fastlaneå…¸å‹çš„å¼€å‘æµç¨‹" class="headerlink" title="fastlaneå…¸å‹çš„å¼€å‘æµç¨‹"></a>fastlaneå…¸å‹çš„å¼€å‘æµç¨‹</h3><p>æ­¤å¼€å‘æµç¨‹ä¹Ÿæ˜¯æˆ‘ä»¬å›¢é˜Ÿå¼€å‘è¿‡ç¨‹ä¸­åŸºæœ¬å¼€å‘é¡ºåº<br><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">lane :appstore <span class="keyword">do</span></span><br><span class="line">  increment_build_number</span><br><span class="line">  cocoapods</span><br><span class="line">  xctool</span><br><span class="line">  snapshot</span><br><span class="line">  sigh</span><br><span class="line">  deliver</span><br><span class="line">  frameit</span><br><span class="line">  sh <span class="string">"./customScript.sh"</span></span><br><span class="line">  slack</span><br><span class="line">end</span><br></pre></td></tr></table></figure></p>
<p>cocoaPodså¸®åŠ©æˆ‘ä»¬ç®¡ç†ä¸‰æ–¹å¼€æºåº“ï¼Œfastlaneå¯ä»¥åœ¨æˆ‘ä»¬å¼€å‘è¿‡ç¨‹ä¸­ç®€åŒ–æˆ‘ä»¬å¼€å‘è¿‡ç¨‹ä»¥åŠç®€åŒ–æˆ‘ä»¬å‘å¸ƒæµç¨‹ã€‚å¦‚æœè¦æé«˜è‡ªå·±IOSæ–¹é¢èƒ½åŠ›éœ€è¦æˆ‘ä»¬è¿›ä¸€æ­¥æ·±å…¥ç ”ç©¶ã€‚</p>

      

      
    </div>
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<i class="icon-price-tags icon"></i>
		<ul class="article-tag-list">
			 
        		<li class="article-tag-list-item">
        			<a href="javascript:void(0)" class="js-tag article-tag-list-link color4">IOS</a>
        		</li>
      		
		</ul>
	</div>

      
	<div class="article-category tagcloud">
		<i class="icon-book icon"></i>
		<ul class="article-tag-list">
			 
        		<li class="article-tag-list-item">
        			<a href="/categories/IOS/" class="article-tag-list-link color4">IOS</a>
        		</li>
      		
		</ul>
	</div>


      
        <p class="article-more-link">
          <a class="article-more-a" href="/2016/05/29/Fastlaneè®²è§£/">å±•å¼€å…¨æ–‡ >></a>
        </p>
      

      
      <div class="clearfix"></div>
    </div>
  </div>
</article>





  
    <article id="post-blockï¼Œæ³¨å†Œç›‘å¬ï¼Œå§”æ‰˜åè®®å’ŒKVO" class="article article-type-post  article-index" itemscope itemprop="blogPost">
  <div class="article-inner">
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/05/29/blockï¼Œæ³¨å†Œç›‘å¬ï¼Œå§”æ‰˜åè®®å’ŒKVO/">blockï¼Œæ³¨å†Œç›‘å¬ï¼Œå§”æ‰˜åè®®å’ŒKVO</a>
    </h1>
  

        
        <a href="/2016/05/29/blockï¼Œæ³¨å†Œç›‘å¬ï¼Œå§”æ‰˜åè®®å’ŒKVO/" class="archive-article-date">
  	<time datetime="2016-05-29T04:12:40.000Z" itemprop="datePublished"><i class="icon-calendar icon"></i>2016-05-29</time>
</a>
        
      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h3 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h3><p>IOSä¸­å…³äºä¿¡æ¯ä¼ é€’è¿‡ç¨‹ä¸­ç»å¸¸ä¼šä½¿ç”¨blockï¼Œå§”æ‰˜ä»£ç†ï¼ŒNSNotificationï¼ŒKVOè¿›è¡Œè°ƒç”¨ï¼Œä½†æ˜¯æŸ¥æ‰¾èµ„æ–™åæœ‰äº›èµ„æ–™ä¸æ˜¯å¾ˆå…¨ã€‚</p>
<h3 id="å››è€…æ€»ä½“æ¯”è¾ƒç„¶åè¿›è¡Œä¸€ä¸€è¯¦è§£è¿›è¡Œè®²è§£ï¼š"><a href="#å››è€…æ€»ä½“æ¯”è¾ƒç„¶åè¿›è¡Œä¸€ä¸€è¯¦è§£è¿›è¡Œè®²è§£ï¼š" class="headerlink" title="å››è€…æ€»ä½“æ¯”è¾ƒç„¶åè¿›è¡Œä¸€ä¸€è¯¦è§£è¿›è¡Œè®²è§£ï¼š"></a>å››è€…æ€»ä½“æ¯”è¾ƒç„¶åè¿›è¡Œä¸€ä¸€è¯¦è§£è¿›è¡Œè®²è§£ï¼š</h3><p>blockï¼šä¸€å¯¹ä¸€è¿›è¡Œé€šä¿¡ï¼Œæ¯”èµ·å…¶ä»–ä¸‰è€…æ›´åŠ ç®€æ´ï¼Œä½†æ˜¯äº‹ä»¶æ¯”è¾ƒå¤šæ—¶å¯ä»¥ä½¿ç”¨delegateã€‚<br>å§”æ‰˜ä»£ç†ï¼šå’Œblockä¸€æ ·æ˜¯ä¸€å¯¹ä¸€ï¼Œæˆ‘ä»¬ä½¿ç”¨æ—¶è¦å…ˆè¿›è¡Œåè®®æ–¹æ³•ç„¶åå®ç°åè®®ä»£ç†ï¼Œå¦‚æœéœ€è¦é€šä¿¡å°±éœ€è¦å®ç°ä»£ç†ã€‚<br>NSNotificationï¼šåœ¨è¿›è¡Œæ³¨å†Œç›‘å¬æ—¶ï¼Œå¯ä»¥è¿›è¡Œä¸€å¯¹å¤šçš„æƒ…å†µï¼Œä¸€ä¸ªè¿›è¡Œæ³¨å†Œå¯ä»¥å¤šç§æƒ…å†µä¸‹è¿›è¡Œç›‘å¬ã€‚<br>KVOï¼šå°±æ˜¯æˆ‘ä»¬æ‰€è¯´çš„é”®å€¼ç›‘å¬æ¨¡å¼ï¼Œå…¶ä¸»è¦æ˜¯åœ¨KVCåŸºç¡€ä¸Šå®Œåæ‰èƒ½ã€‚</p>
<p>ä»¥å‰è¯»è¿‡ä¸€ä¸ªç æŸ´çš„æ•…äº‹ï¼Œå¦‚æœæˆ‘ä»¬æƒ³è¦è¿½æ±‚æå¾—æ•ˆç‡å°±è¦å¯¹æ‰€ç”¨åˆ°çš„å·¥å…·äº†è§£ï¼Œä¸‹é¢æˆ‘ä»¬å°±å¼€å§‹ç£¨æˆ‘ä»¬æœä¸­çš„åˆ€ã€‚ </p>
<h3 id="blockçš„æ¥é¾™å»è„‰ï¼š"><a href="#blockçš„æ¥é¾™å»è„‰ï¼š" class="headerlink" title="blockçš„æ¥é¾™å»è„‰ï¼š"></a>blockçš„æ¥é¾™å»è„‰ï¼š</h3><p>blockæ˜¯IOS SDK 4.0ä¸­å¼•å…¥çš„ï¼Œblockåœ¨IOSä¸­å®é™…å°±æ˜¯ä¸€ä¸ªä»£ç å—ï¼Œæœ‰ç‚¹åƒC++ä¸­å†…è”å‡½æ•°inlineæœ‰ç‚¹ç›¸ä¼¼ï¼Œæœ€è®©äººæƒŠå¥‡çš„æ˜¯æˆ‘ä»¬è¿˜å¯ä»¥å‘å…¶ä¼ é€’å‚æ•°ã€‚é—²æ¥æ²¡äº‹æƒ³è¦çŸ¥é“blockåœ¨C++ä¸­çš„å…·ä½“å®ç°å°±æ˜¯ç”¨Clangç¼–è¾‘^{printfâ€Hello, World!â€}()ï¼Œæ­¤æ—¶æˆ‘ä»¬åœ¨blockä»…ä»…æ˜¯è¾“å‡ºä¸€ä¸ªè¯­å¥ã€‚<br>//hello.cæ˜¯æˆ‘ä»¬æŠŠæƒ³è¦ç¼–è¾‘çš„å†…å®¹æ”¾ç½®çš„æ–‡ä»¶åç§°</p>
<h3 id="blockåœ¨æ²¡æœ‰ä¼ å…¥å‚æ•°æƒ…å†µ"><a href="#blockåœ¨æ²¡æœ‰ä¼ å…¥å‚æ•°æƒ…å†µ" class="headerlink" title="blockåœ¨æ²¡æœ‰ä¼ å…¥å‚æ•°æƒ…å†µ"></a>blockåœ¨æ²¡æœ‰ä¼ å…¥å‚æ•°æƒ…å†µ</h3><blockquote>
<p>$ clang -rewrite-objc hello.c </p>
</blockquote>
<p></p><p>åœ¨ç¼–è¯‘åå†æ–‡ä»¶åä¼šç”Ÿæˆ hello.cppæ–‡ä»¶</p><br><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">struct</span> __mian_block_impl_0 </span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">struct</span> __block_impl impl;</span><br><span class="line">  <span class="keyword">struct</span> __mian_block_desc_0* Desc;</span><br><span class="line"> __mian_block_impl_0(<span class="keyword">void</span> *fp, <span class="keyword">struct</span> __mian_block_desc_0 *desc, <span class="keyword">int</span> flags=<span class="number">0</span>)</span><br><span class="line"> &#123;    impl.isa = &amp;_NSConcreteStackBlock;</span><br><span class="line">          impl.Flags = flags;</span><br><span class="line">          impl.FuncPtr = fp;</span><br><span class="line">          Desc = desc;</span><br><span class="line"> &#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">static</span> <span class="keyword">void</span> __mian_block_func_0(<span class="keyword">struct</span> __mian_block_impl_0 *__cself) </span><br><span class="line">&#123;</span><br><span class="line">     printf(<span class="string">"Hello, World!\n"</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">static</span> <span class="keyword">struct</span> __mian_block_desc_0 &#123;</span><br><span class="line">  size_t reserved;</span><br><span class="line">  size_t Block_size;</span><br><span class="line">&#125; </span><br><span class="line">__mian_block_desc_0_DATA = &#123; <span class="number">0</span>, <span class="keyword">sizeof</span>(<span class="keyword">struct</span> __mian_block_impl_0)</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">int</span> mian()&#123;</span><br><span class="line">     ((<span class="keyword">void</span> (*)())&amp;__mian_block_impl_0((<span class="keyword">void</span> *)</span><br><span class="line">__mian_block_func_0, &amp;__mian_block_desc_0_DATA)) ();</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">static</span> <span class="keyword">struct</span> IMAGE_INFO </span><br><span class="line">&#123; <span class="keyword">unsigned</span> version; <span class="keyword">unsigned</span> flag; &#125; </span><br><span class="line">_OBJC_IMAGE_INFO = &#123; <span class="number">0</span>, <span class="number">2</span> &#125;;</span><br></pre></td></tr></table></figure><p></p>
<p>ä¸Šé¢çš„ä»£ç æ—¢æ˜¯æˆ‘ä»¬é€šè¿‡ç¼–è¯‘æˆªå–çš„hello.cppçš„å…·ä½“ä»£ç ï¼Œæ ¹æ®ä¸Šé¢ä»£ç æˆ‘ä»¬å¯ä»¥çœ‹åˆ°blockå®é™…æ˜¯structç»“æ„ã€‚çœ‹å‡º_mian_block_impl_0 å…¶ä¸­ä¼ å…¥å…¶ä¸­ä¹Ÿæ˜¯block_impl&amp;mian_block_desc_0ä¸¤ä¸ªblockï¼Œä¸‹é¢æ˜¯_mian_block_impl_0çš„æ„é€ å‡½æ•°ã€‚</p>
<h3 id="blockåœ¨æœ‰ä¼ å…¥å‚æ•°æƒ…å†µ"><a href="#blockåœ¨æœ‰ä¼ å…¥å‚æ•°æƒ…å†µ" class="headerlink" title="blockåœ¨æœ‰ä¼ å…¥å‚æ•°æƒ…å†µ"></a>blockåœ¨æœ‰ä¼ å…¥å‚æ•°æƒ…å†µ</h3><blockquote>
<p>clang -rewrite-objc hello1.c</p>
</blockquote>
<p>åŒæ ·åœ¨æˆ‘ä»¬ç¼–è¯‘è¿‡åä¼šç”Ÿæˆhello.cpp</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">struct</span> __mian_block_impl_0 &#123;</span><br><span class="line">  <span class="keyword">struct</span> __block_impl impl;</span><br><span class="line">  <span class="keyword">struct</span> __mian_block_desc_0* Desc;</span><br><span class="line">  <span class="keyword">float</span> perperson;</span><br><span class="line">  __mian_block_impl_0(<span class="keyword">void</span> *fp, <span class="keyword">struct</span> __mian_block_desc_0 </span><br><span class="line">*desc, <span class="keyword">float</span> _perperson, <span class="keyword">int</span> flags=<span class="number">0</span>) : perperson(_perperson)</span><br><span class="line"> &#123;</span><br><span class="line">    impl.isa = &amp;_NSConcreteStackBlock;</span><br><span class="line">    impl.Flags = flags;</span><br><span class="line">    impl.FuncPtr = fp;</span><br><span class="line">    Desc = desc;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">static</span> <span class="keyword">float</span> __mian_block_func_0(<span class="keyword">struct</span> __mian_block_impl_0 *__cself, </span><br><span class="line"><span class="keyword">int</span> totalNum) &#123;</span><br><span class="line">  <span class="keyword">float</span> perperson = __cself-&gt;perperson; <span class="comment">// bound by copy</span></span><br><span class="line">        <span class="keyword">return</span> perperson * totalNum;</span><br><span class="line">    &#125;</span><br><span class="line"><span class="keyword">static</span> <span class="keyword">struct</span> __mian_block_desc_0 &#123;</span><br><span class="line">  size_t reserved;</span><br><span class="line">  size_t Block_size;</span><br><span class="line">&#125;</span><br><span class="line"> __mian_block_desc_0_DATA = &#123; <span class="number">0</span>, <span class="keyword">sizeof</span>(<span class="keyword">struct</span> __mian_block_impl_0)&#125;;</span><br><span class="line"><span class="keyword">int</span> mian()&#123;</span><br><span class="line">    <span class="keyword">float</span> perperson = <span class="number">34.5</span>;</span><br><span class="line">    <span class="keyword">float</span> (*sunClassFee)(<span class="keyword">int</span>) = ((<span class="keyword">float</span> (*)(<span class="keyword">int</span>))</span><br><span class="line">&amp;__mian_block_impl_0((<span class="keyword">void</span> *)__mian_block_func_0, &amp;__mian_block_desc_0_DATA, </span><br><span class="line">perperson));</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">static</span> <span class="keyword">struct</span> IMAGE_INFO &#123; <span class="keyword">unsigned</span> version; <span class="keyword">unsigned</span> flag; &#125; </span><br><span class="line">_OBJC_IMAGE_INFO = &#123; <span class="number">0</span>, <span class="number">2</span> &#125;;</span><br></pre></td></tr></table></figure>
<p>å¯ä»¥çœ‹å‡ºåœ¨blockä¸­ä½¿ç”¨å¤–éƒ¨å˜é‡perpersonæ—¶ï¼Œblockåˆå§‹åŒ–æ—¶è¿™æ ·çš„ï¼š<br><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">æ˜¯åœ¨__mian_block_impl_0è¿›è¡Œåˆå§‹åŒ–perpersonï¼Œåœ¨blockæ„é€ æ—¶ä½œä¸ºblockçš„å…¶ä¸­</span><br><span class="line">ä¸€ä¸ªæˆå‘˜åˆå§‹ã€‚åœ¨è®¿é—®æ—¶é€šè¿‡__cself-&gt;perpersonæŒ‡é’ˆè¿›è¡Œè®¿é—®ã€‚</span><br></pre></td></tr></table></figure></p>
<h3 id="blockåœ¨æœ‰ä¼ å…¥å‚æ•°æƒ…å†µ-1"><a href="#blockåœ¨æœ‰ä¼ å…¥å‚æ•°æƒ…å†µ-1" class="headerlink" title="blockåœ¨æœ‰ä¼ å…¥å‚æ•°æƒ…å†µ"></a>blockåœ¨æœ‰ä¼ å…¥å‚æ•°æƒ…å†µ</h3><blockquote>
<p>clang -rewrite-objc hello2.c</p>
</blockquote>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">struct</span> __Block_byref_perperson_0 &#123;</span><br><span class="line">  <span class="keyword">void</span> *__isa;   </span><br><span class="line"> __Block_byref_perperson_0 *__forwarding;</span><br><span class="line">  <span class="keyword">int</span> __flags;</span><br><span class="line"> <span class="keyword">int</span> __size;</span><br><span class="line"> <span class="keyword">float</span> perperson;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">struct</span> __mian_block_impl_0 &#123;</span><br><span class="line">  <span class="keyword">struct</span> __block_impl impl;</span><br><span class="line">  <span class="keyword">struct</span> __mian_block_desc_0* Desc;</span><br><span class="line">  __Block_byref_perperson_0 *perperson; <span class="comment">// by ref</span></span><br><span class="line">  __mian_block_impl_0(<span class="keyword">void</span> *fp, <span class="keyword">struct</span> __mian_block_desc_0 *desc, </span><br><span class="line"> __Block_byref_perperson_0 *_perperson, <span class="keyword">int</span> flags=<span class="number">0</span>) : </span><br><span class="line">perperson(_perperson-&gt;__forwarding) &#123;</span><br><span class="line">    impl.isa = &amp;_NSConcreteStackBlock;</span><br><span class="line">    impl.Flags = flags;</span><br><span class="line">    impl.FuncPtr = fp;</span><br><span class="line">    Desc = desc;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">static</span> <span class="keyword">float</span> __mian_block_func_0(<span class="keyword">struct</span> __mian_block_impl_0 *__cself,</span><br><span class="line"> <span class="keyword">int</span> totalNum) &#123;</span><br><span class="line">    __Block_byref_perperson_0 *perperson = __cself-&gt;perperson; <span class="comment">// bound by ref</span></span><br><span class="line">     (perperson-&gt;__forwarding-&gt;perperson) = (perperson-&gt;__forwarding-</span><br><span class="line">perperson) + <span class="number">6</span>;</span><br><span class="line">        <span class="keyword">return</span> (perperson-&gt;__forwarding-&gt;perperson) * totalNum;</span><br><span class="line">    &#125;</span><br><span class="line"><span class="keyword">static</span> <span class="keyword">void</span> __mian_block_copy_0(<span class="keyword">struct</span> __mian_block_impl_0*dst, </span><br><span class="line"><span class="keyword">struct</span> __mian_block_impl_0*src) </span><br><span class="line">&#123;_Block_object_assign((<span class="keyword">void</span>*)&amp;dst-&gt;perperson, </span><br><span class="line">(<span class="keyword">void</span>*)src-&gt;perperson, <span class="number">8</span><span class="comment">/*BLOCK_FIELD_IS_BYREF*/</span>);&#125;</span><br><span class="line"><span class="keyword">static</span> <span class="keyword">void</span> __mian_block_dispose_0(<span class="keyword">struct</span> __mian_block_impl_0*src) &#123;</span><br><span class="line">_Block_object_dispose((<span class="keyword">void</span>*)src-&gt;perperson, <span class="number">8</span><span class="comment">/*BLOCK_FIELD_IS_BYREF*/</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">static</span> <span class="keyword">struct</span> __mian_block_desc_0 &#123;</span><br><span class="line">  size_t reserved;</span><br><span class="line">  size_t Block_size;</span><br><span class="line">  <span class="keyword">void</span> (*<span class="keyword">copy</span>)(<span class="keyword">struct</span> __mian_block_impl_0*, <span class="keyword">struct</span> __mian_block_impl_0*);</span><br><span class="line">  <span class="keyword">void</span> (*dispose)(<span class="keyword">struct</span> __mian_block_impl_0*);</span><br><span class="line">&#125; __mian_block_desc_0_DATA = &#123; </span><br><span class="line"><span class="number">0</span>, <span class="keyword">sizeof</span>(<span class="keyword">struct</span> __mian_block_impl_0), __mian_block_copy_0, </span><br><span class="line">__mian_block_dispose_0&#125;;</span><br><span class="line"><span class="keyword">int</span> mian()&#123;</span><br><span class="line">    __attribute__((__blocks__(<span class="keyword">byref</span>))) __Block_byref_perperson_0 perperson = &#123;</span><br><span class="line">(<span class="keyword">void</span>*)<span class="number">0</span>,(__Block_byref_perperson_0 *)&amp;perperson, <span class="number">0</span>, </span><br><span class="line"><span class="keyword">sizeof</span>(__Block_byref_perperson_0), <span class="number">34.5</span></span><br><span class="line">&#125;;</span><br><span class="line">    <span class="keyword">float</span> (*sunClassFee)(<span class="keyword">int</span>) = ((<span class="keyword">float</span> (*)(<span class="keyword">int</span>))&amp;__mian_block_impl_0((<span class="keyword">void</span> *)</span><br><span class="line">__mian_block_func_0, &amp;__mian_block_desc_0_DATA, </span><br><span class="line">(__Block_byref_perperson_0 *)&amp;perperson, <span class="number">570425344</span>));</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">static</span> <span class="keyword">struct</span> IMAGE_INFO &#123; <span class="keyword">unsigned</span> version; <span class="keyword">unsigned</span> flag; &#125; </span><br><span class="line">_OBJC_IMAGE_INFO = &#123; <span class="number">0</span>, <span class="number">2</span> &#125;;</span><br></pre></td></tr></table></figure>
<p>æˆ‘ä»¬åœ¨å¯¹äºblockå¤–çš„perpersonè®¡ç®—é‡æ–°å¤åˆ¶ï¼Œå’Œä¸Šé¢åœ¨blockä»…ä»…åœ¨blockä¸­ä½¿ç”¨å¤–é¢çš„å‚æ•°ã€‚ä¸¤è€…ç»è¿‡å¯¹æ¯”å¯ä»¥çœ‹å‡ºï¼šåœ¨blockä¸­å¯¹äºå¤–éƒ¨å€¼è¿›è¡Œå¤åˆ¶ï¼Œä¼šå‡ºç°ä¸‹é¢çš„æƒ…å†µã€‚ä½¿ç”¨clangå¯¹äºblockè¿›è¡Œç¼–ç ï¼Œå¯ä»¥çœ‹ä¹¦å¯¹äºperpersonè¿›è¡Œ_blockçš„ä¿®é¥°åç¼–ç ç”ŸæˆBlock_byref_perperson_0çš„structç»“æ„ä½“ï¼Œå…¶ä¸­__Block_byref_perperson_0çš„æŒ‡é’ˆæŒ‡å‘åœ¨blockä¸­perpersonçš„åœ°å€ã€‚</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">struct</span> __Block_byref_perperson_0 &#123;</span><br><span class="line">  <span class="keyword">void</span> *__isa;</span><br><span class="line"> __Block_byref_perperson_0 *__forwarding;  <span class="keyword">int</span> __flags;</span><br><span class="line"> <span class="keyword">int</span> __size; <span class="keyword">float</span> perperson;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h3 id="blockçš„ä½¿ç”¨æ–¹æ³•-ä¼ å…¥å‚æ•°ï¼š"><a href="#blockçš„ä½¿ç”¨æ–¹æ³•-ä¼ å…¥å‚æ•°ï¼š" class="headerlink" title="blockçš„ä½¿ç”¨æ–¹æ³•~ä¼ å…¥å‚æ•°ï¼š"></a>blockçš„ä½¿ç”¨æ–¹æ³•~ä¼ å…¥å‚æ•°ï¼š</h3><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"> <span class="keyword">int</span> (^isInputEven)(<span class="keyword">int</span>) = ^(<span class="keyword">int</span> n)&#123;</span><br><span class="line"></span><br><span class="line">       <span class="keyword">if</span> (n&gt;<span class="number">1</span>) &#123;</span><br><span class="line">              <span class="keyword">return</span> n*isInputEven(n<span class="number">-1</span>);</span><br><span class="line">           &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">              <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">         &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p>ä¸Šé¢æˆ‘ä»¬å®šä¹‰ä¸€ä¸ªblockä»£ç æ®µï¼Œä»£ç çš„å®ç°åŠŸèƒ½æ˜¯åˆ©ç”¨é€’å½’è®¡ç®—nçš„åŸºä¹˜ã€‚ä»£ç å¯ä»¥ä½œä¸ºæ•´ä¸ªä»£ç å—è¿›è¡Œè°ƒç”¨ï¼Œè€Œä¸”åœ¨è°ƒç”¨è¿‡ç¨‹ä¸­æˆ‘ä»¬åªéœ€isInputEvenï¼ˆï¼‰å‡½æ•°åå’Œä¼ å…¥å‚æ•°å³å¯å®ç°ã€‚</p>
<h3 id="blockçš„ä½¿ç”¨æ–¹æ³•-ä½¿ç”¨å¤–éƒ¨å‚æ•°å‚æ•°ï¼š"><a href="#blockçš„ä½¿ç”¨æ–¹æ³•-ä½¿ç”¨å¤–éƒ¨å‚æ•°å‚æ•°ï¼š" class="headerlink" title="blockçš„ä½¿ç”¨æ–¹æ³•~ä½¿ç”¨å¤–éƒ¨å‚æ•°å‚æ•°ï¼š"></a>blockçš„ä½¿ç”¨æ–¹æ³•~ä½¿ç”¨å¤–éƒ¨å‚æ•°å‚æ•°ï¼š</h3><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">float</span> perperson = <span class="number">34.5</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">float</span> (^sunClassFee)(<span class="keyword">int</span>) = ^(<span class="keyword">int</span> totalNum)&#123;</span><br><span class="line">        <span class="keyword">return</span> perperson * totalNum;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p>ä½¿ç”¨å¤–éƒ¨å‚æ•°perpersonï¼Œè®©æˆ‘ä»¬æ„Ÿè§‰blockå¯ä»¥æƒ³ä¸€ä¸ªç±»ä¸€æ ·ä½¿ç”¨socpeé‡Œé¢çš„å˜é‡ç›®å‰æ— æ³•åšåˆ°ã€‚<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ä¸»è¦åŸå› æ˜¯å› ä¸ºï¼šåœ¨blockçš„ç¼–è¯‘è¿‡ç¨‹ä¸­æˆ‘ä»¬çœ‹åˆ°ï¼Œåœ¨blockä¸­è¿›è¡Œè®¿é—®å…¶ä¸­å…ƒç´ æ—¶éœ€è¦æ˜¯</span><br><span class="line">blocké»˜è®¤æ„é€ å‡½æ•°å¯¹äºblockå…¶ä¸­çš„å…ƒç´ è®¿é—®ã€‚</span><br></pre></td></tr></table></figure></p>
<h3 id="blockçš„ä½¿ç”¨æ–¹æ³•-ä½¿ç”¨å¤–éƒ¨å‚æ•°å‚æ•°ï¼š-1"><a href="#blockçš„ä½¿ç”¨æ–¹æ³•-ä½¿ç”¨å¤–éƒ¨å‚æ•°å‚æ•°ï¼š-1" class="headerlink" title="blockçš„ä½¿ç”¨æ–¹æ³•~ä½¿ç”¨å¤–éƒ¨å‚æ•°å‚æ•°ï¼š"></a>blockçš„ä½¿ç”¨æ–¹æ³•~ä½¿ç”¨å¤–éƒ¨å‚æ•°å‚æ•°ï¼š</h3><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">__block <span class="keyword">float</span> perperson = <span class="number">34.5</span>;</span><br><span class="line">    <span class="keyword">float</span> (^sunClassFee)(<span class="keyword">int</span>) = ^(<span class="keyword">int</span> totalNum)&#123;</span><br><span class="line">        perperson = perperson + <span class="number">6</span>;</span><br><span class="line">        <span class="keyword">return</span> perperson * totalNum;</span><br><span class="line"> &#125;;</span><br></pre></td></tr></table></figure>
<h3 id="blockçš„ä½¿ç”¨æ–¹æ³•-åœ¨ï¼ˆUIViewï¼‰çš„åŠ¨ç”»ä¸­ä½¿ç”¨ï¼š"><a href="#blockçš„ä½¿ç”¨æ–¹æ³•-åœ¨ï¼ˆUIViewï¼‰çš„åŠ¨ç”»ä¸­ä½¿ç”¨ï¼š" class="headerlink" title="blockçš„ä½¿ç”¨æ–¹æ³•~åœ¨ï¼ˆUIViewï¼‰çš„åŠ¨ç”»ä¸­ä½¿ç”¨ï¼š"></a>blockçš„ä½¿ç”¨æ–¹æ³•~åœ¨ï¼ˆUIViewï¼‰çš„åŠ¨ç”»ä¸­ä½¿ç”¨ï¼š</h3><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[<span class="built_in">UIView</span> animateWithDuration:<span class="number">3.0</span>f animations:^&#123;</span><br><span class="line"></span><br><span class="line">        view.alpha = <span class="number">0</span>;</span><br><span class="line"> &#125;];</span><br></pre></td></tr></table></figure>
<p>IOSçš„å¼€å‘åˆ°ä»Šå¤©å·®ä¸å¤šå·²ç»æœ‰7å¹´ä¹‹ä¹…ï¼Œblockåœ¨å¼€å‘ä¸­ä½¿ç”¨å¹¿åº¦è¶Šæ¥è¶Šå¹¿æ³›ï¼š</p>
<p><ul></ul></p>
<p><li>æšä¸¾â€“æ¥è¿‡å»å¯¹è±¡ã€‚ä¾‹å¦‚ï¼šNSDictionaryçš„æšä¸¾è¿‡ç¨‹</li></p>
<p><li>UIViewâ€“å¯¹äºUIViewçš„åŠ¨ç”»è®¾ç½®ï¼Œåé¢æœ‰æœºä¼šä¼šå¯¹åŠ¨ç”»ä¸“é—¨è®²è¿°â€¦</li></p>
<p><li>é€šçŸ¥â€“åœ¨æœ¬æ–‡è®²è¿°çš„å°±æ˜¯åœ¨è°ƒç”¨è¿‡ç¨‹ä¸­ä¸å…¶ä»–é€šçŸ¥ä¸åŒç‚¹æ‰€åœ¨</li></p>
<p><li>å®Œæˆå¤„ç†â€“åœ¨ç›¸åº”ç¨‹åºç»“æŸåï¼Œéœ€è¦å¯¹äºç¨‹åºç»“æœçš„å¤„ç†ã€‚ä¾‹å¦‚ï¼šAFNetWorkåœ¨è®¿é—®ç½‘ç»œåï¼Œå¯¹äºæˆåŠŸå’Œå¤±è´¥è¿›è¡Œå¤„ç†</li></p>
<p><li>GCDâ€“åœ¨GCDçš„è¿‡ç¨‹ä¸­éƒ½æ˜¯å«æœ‰blockä½¿ç”¨çš„æ–¹æ³•</li></p>
<p><li>æ’åºâ€“å¹³æ—¶æˆ‘ä»¬ä½¿ç”¨çš„ä¸€äº›ç®€å•ç®—æ³•å‡å¯ä»¥blockè¿›è¡Œç›¸å…³å¤„ç†</li><br></p>
<h3 id="å§”æ‰˜ä»£ç†è¯¦è§£"><a href="#å§”æ‰˜ä»£ç†è¯¦è§£" class="headerlink" title="å§”æ‰˜ä»£ç†è¯¦è§£"></a>å§”æ‰˜ä»£ç†è¯¦è§£</h3><p>åœ¨å‘C++è¿‡ç¨‹ä¸­ç»å¸¸è§åˆ°å¤šç»„ç»§æ‰¿ï¼Œä½†æ˜¯åœ¨IOSå¼€å‘è¿‡ç¨‹ä¸­åªèƒ½è¿›è¡Œå•ç»§æ‰¿ï¼Œå¾ˆå¤šæ–¹æ³•æˆ‘ä»¬éœ€è¦å®ç°æ¥å£çš„å½¢å¼ã€‚æ­£å¦‚æˆ‘ä»¬åœ¨ä½¿ç”¨UITableViewæ—¶ï¼Œç»å¸¸ä¼šç”¨åˆ°UITableViewDataSourceå’ŒUITableViewDelegateã€‚<br>å¦‚æœè¦ä½¿ç”¨ä½¿ç”¨å§”æ‰˜ä»£ç†ï¼Œéœ€è¦çŸ¥é“åè®®å’Œå§”æ‰˜ä¸¤è€…å…³ç³»ã€‚</p>
<h3 id="åè®®"><a href="#åè®®" class="headerlink" title="åè®®"></a>åè®®</h3><p>åè®®ä¸€èˆ¬åˆ†ä¸ºä¸¤ç§ï¼š</p>
<blockquote>
<p>@ required:        //æ˜¯æˆ‘ä»¬åœ¨ç»§æ‰¿è¿‡ç¨‹ä¸­å¿…é¡»å®ç°çš„<br>   @optional :        //åœ¨å®ç°æ¥å£ä¸­éœ€è¦è¿›è¡Œé€‰æ‹©æ€§å®ç°çš„æ–¹å¼</p>
</blockquote>
<h3 id="å§”æ‰˜"><a href="#å§”æ‰˜" class="headerlink" title="å§”æ‰˜"></a>å§”æ‰˜</h3><p>å¸¸è§çš„ä¸€ç§è®¾è®¡æ¨¡å¼ï¼Œèº«ä¸ºè€æ¿ä¸€èˆ¬è´Ÿè´£ç®¡ç†å‘˜å·¥ã€æ‰“ç”µè¯ã€å‘è–ªæ°´ï¼Œè¿™æ ·ç”±äºå…¬å¸ä¸šåŠ¡å‘å±•å°±è¯·ä¸€ä¸ªç§˜ä¹¦è´Ÿè´£ï¼šæ‰“ç”µè¯å’Œå‘è–ªæ°´ã€‚</p>
<blockquote>
<p>é¦–å…ˆè¿›è¡Œåè®®æå–ï¼ˆéœ€è¦å‘˜å·¥æ‰€å¾—äº‹æƒ…ï¼‰ï¼š(boss.hæ–‡ä»¶ä¸­å£°æ˜)</p>
</blockquote>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">@protocol</span> <span class="title">protocol</span> &lt;<span class="title">NSObject</span>&gt;</span></span><br><span class="line">-(<span class="keyword">void</span>)payoff;</span><br><span class="line">-(<span class="keyword">void</span>)tel;</span><br><span class="line"><span class="keyword">@end</span></span><br><span class="line"><span class="class"><span class="keyword">@interface</span> <span class="title">boss</span> : <span class="title">NSObject</span></span></span><br><span class="line"><span class="keyword">@property</span>(<span class="keyword">nonatomic</span>,<span class="keyword">strong</span>) <span class="keyword">id</span>&lt;protocol&gt; delegate;</span><br><span class="line">-(<span class="keyword">void</span>)manage;</span><br><span class="line">-(<span class="keyword">void</span>)payoff;</span><br><span class="line">-(<span class="keyword">void</span>)tel;</span><br><span class="line"><span class="keyword">@end</span></span><br></pre></td></tr></table></figure>
<blockquote>
<p>å¯¹äºè€æ¿åœ¨å…·ä½“å·¥ä½œçš„å®ç°ï¼š(boss.mæ–‡ä»¶ä¸­å®ç°)</p>
</blockquote>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">@implementation</span> <span class="title">boss</span></span></span><br><span class="line">-(<span class="keyword">void</span>)manage&#123;</span><br><span class="line">    <span class="built_in">NSLog</span>(<span class="string">@"boss--&gt;manage"</span>);</span><br><span class="line">&#125;</span><br><span class="line">-(<span class="keyword">void</span>)payoff&#123;</span><br><span class="line">    [<span class="keyword">self</span>.delegate payoff];</span><br><span class="line">&#125;</span><br><span class="line">-(<span class="keyword">void</span>)tel&#123;</span><br><span class="line">    [<span class="keyword">self</span>.delegate tel];</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">@end</span></span><br></pre></td></tr></table></figure>
<blockquote>
<p>å§”æ‰˜ç§˜ä¹¦æ‰€è¦åšçš„äº‹ç‰©ï¼šï¼ˆåœ¨sec.mçš„æ–‡ä»¶ä¸­å®ç°å®Œæˆbossçš„ä»£ç†ï¼‰</p>
</blockquote>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">@interface</span> <span class="title">Sec</span> ()&lt;<span class="title">protocol</span>&gt;</span></span><br><span class="line"><span class="keyword">@end</span></span><br><span class="line"><span class="class"><span class="keyword">@implementation</span> <span class="title">Sec</span></span></span><br><span class="line">-(<span class="keyword">void</span>)payoff&#123;</span><br><span class="line">    <span class="built_in">NSLog</span>(<span class="string">@"sec--&gt;payoff"</span>);</span><br><span class="line">&#125;</span><br><span class="line">-(<span class="keyword">void</span>)tel&#123;</span><br><span class="line">    <span class="built_in">NSLog</span>(<span class="string">@"sec--&gt;tel"</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="æ³¨å†Œç›‘å¬å°è¯•"><a href="#æ³¨å†Œç›‘å¬å°è¯•" class="headerlink" title="æ³¨å†Œç›‘å¬å°è¯•"></a>æ³¨å†Œç›‘å¬å°è¯•</h3><p>NSNotificationCenterå°±ç›¸å½“äºå¹¿æ’­ä¸€æ ·ï¼Œå¯ä»¥å¯¹å¯¹è±¡è¿›è¡Œä¸€æ¬¡æ³¨å†Œç„¶åæœ‰å¤šä¸ªç›‘å¬ã€‚å°±åƒæˆ‘ä»¬çŸ¥é“å¦‚æœæœ‰æ³¨å†Œçš„è¯ï¼Œå°±éœ€è¦æˆ‘ä»¬å¯¹äºå¯¹è±¡è¿›è¡Œé‡Šæ”¾ï¼ˆremoveï¼‰ã€‚</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[[<span class="built_in">NSNotificationCenter</span> defaultCenter] postNotificationName:<span class="string">@"clickbt"</span> object:<span class="literal">nil</span>];</span><br><span class="line">[[<span class="built_in">NSNotificationCenter</span> defaultCenter] addObserver:<span class="keyword">self</span> selector:<span class="keyword">@selector</span>(click) name:<span class="string">@"clickbt"</span> object:<span class="literal">nil</span>];</span><br></pre></td></tr></table></figure>
<p>åœ¨ä¸Šé¢çš„ä»£ç å¯ä»¥çœ‹å‡ºæˆ‘ä»¬åœ¨ä½¿ç”¨æ³¨å†Œç›‘å¬æ—¶å¯ä»¥è¿›è¡Œç›¸å…³å†…å®¹ä¼ é€’ï¼Œéœ€è¦ä¼ é€’çš„å†…å®¹æ”¾åœ¨objectï¼ˆä¸ºidç±»å‹ï¼‰ã€‚<br>åœ¨removeç›‘å¬çš„æ–¹æ³•ï¼Œç»è¿‡æŸ¥æ‰¾èµ„æ–™ï¼š<br><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"> -(<span class="keyword">void</span>)viewWillAppear:(<span class="built_in">BOOL</span>)animated</span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line">   [<span class="keyword">super</span> viewWillAppear:animated];</span><br><span class="line"></span><br><span class="line">   [[<span class="built_in">NSNotificationCenter</span> defaultCenter] addObserver:<span class="keyword">self</span> selector:<span class="keyword">@selector</span>(test) name:<span class="string">@"clickbt"</span> object:<span class="literal">nil</span>];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">-(<span class="keyword">void</span>)viewWillDisappear:(<span class="built_in">BOOL</span>)animated</span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line">   [<span class="keyword">super</span> viewWillDisappear:animated];</span><br><span class="line"></span><br><span class="line">   [[<span class="built_in">NSNotificationCenter</span> defaultCenter] removeObserver:<span class="keyword">self</span> name:<span class="string">@"clickbt"</span> object:<span class="literal">nil</span>];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h3 id="KVOç®€å²"><a href="#KVOç®€å²" class="headerlink" title="KVOç®€å²"></a>KVOç®€å²</h3><p>å½“æˆ‘ä»¬è¯´èµ·KVO(key-value-observe)æ—¶ä¸å…æƒ³èµ·ä»–çš„å­ªç”Ÿå¤§å“¥KVCï¼ˆkey-value-codingï¼‰ã€‚KVOæ˜¯è§‚å¯Ÿè€…æ¨¡å¼çš„ç»§æ‰¿è€…ï¼ŒåŸºäºé”®å€¼å˜åŒ–ç›‘å¬è€…ï¼ŒåŸºäºKVCåŸºç¡€å®Œæˆä¹‹ä¸€ã€‚</p>
<blockquote>
<p>ä¸‹åˆ—å¯¹äºç•Œé¢çš„UILabelè¿›è¡Œç›‘å¬ï¼š</p>
</blockquote>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[<span class="keyword">self</span>.labelÂ addObserver:<span class="keyword">self</span>Â forKeyPath:<span class="string">@"narcotics"</span>Â options:</span><br><span class="line"><span class="built_in">NSKeyValueObservingOptionNew</span>Â |<span class="built_in">NSKeyValueObservingOptionOld</span>Â context:<span class="literal">nil</span>];</span><br></pre></td></tr></table></figure>
<blockquote>
<p>ä¸€æ—¦UILabelå‘ç”Ÿå˜åŒ–å°±ä¼šè°ƒç”¨æ–¹æ³•ï¼š</p>
</blockquote>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">-(<span class="keyword">void</span>)observeValueForKeyPath:(<span class="built_in">NSString</span> *)keyPath ofObject:(<span class="keyword">id</span>)object </span><br><span class="line">change:(<span class="built_in">NSDictionary</span> *)change context:(<span class="keyword">void</span> *)context&#123;</span><br><span class="line">     <span class="comment">//ä¸€æ—¦æœ‰æ‰€å˜åŒ–è°ƒç”¨æ–¹æ³•</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>é™„å¸¦ï¼š</p>
<blockquote>
<p>KVCï¼šé€šè¿‡è®¾ç½®keyå€¼ï¼Œè¿›è¡Œæ ‡è®°ã€‚ç„¶åé€šè¿‡keyå€¼æ‰¾åˆ°è¿›è¡Œé‡æ–°è®¾ç½®ï¼Œè¯´çš„é€šä¿—ç‚¹ç‚¹å°±æ˜¯é”®å€¼å¯¹ã€‚ç±»ä¼¼NSDictionaryç›¸ä¼¼ã€‚</p>
</blockquote>
<p>ä»¥å‰ç»å¸¸çœ‹äº›å¤§ç‰›å†™çš„åšå®¢ï¼Œåœ¨çœ‹åšå®¢è¿‡ç¨‹ä¸­ä¹Ÿå­¦åˆ°å¾ˆå¤šçŸ¥è¯†ã€‚å¿ƒå‘å¾€ä¹‹ï¼Œå¼€å§‹åŠ¨æ‰‹å†™å…³äºè‡ªå·±åœ¨IOSæˆé•¿è·¯ä¸Šè§è¯ã€‚</p>
<h3 id="ç®€è¿°blockå’Œdelegationä½¿ç”¨åœºæ™¯çš„æ¯”è¾ƒ"><a href="#ç®€è¿°blockå’Œdelegationä½¿ç”¨åœºæ™¯çš„æ¯”è¾ƒ" class="headerlink" title="ç®€è¿°blockå’Œdelegationä½¿ç”¨åœºæ™¯çš„æ¯”è¾ƒ"></a>ç®€è¿°blockå’Œdelegationä½¿ç”¨åœºæ™¯çš„æ¯”è¾ƒ</h3><p>æˆ‘ä»¬çŸ¥é“<code>block</code>å’Œ<code>delegation</code>æ˜¯å…³äºé€šä¿¡æ–¹é¢ï¼Œåœ¨å¼€å‘çš„è¿‡ç¨‹ä¸­æˆ‘ä»¬ä¹Ÿç»å¸¸ä¼šä½¿ç”¨ä¸¤è€…ã€‚é¢å¯¹å…·ä½“æƒ…å†µæˆ‘ä»¬éœ€è¦æ€ä¹ˆæ ·åšå‡ºé€‰ç€å‘¢ï¼Ÿ</p>
<h3 id="1-å½“åœ¨ä¸€ä¸ªæ–¹æ³•çš„å‚æ•°ä¸­éœ€è¦å¤šä¸ªå¯¹è±¡æ—¶ä½¿ç”¨delegation"><a href="#1-å½“åœ¨ä¸€ä¸ªæ–¹æ³•çš„å‚æ•°ä¸­éœ€è¦å¤šä¸ªå¯¹è±¡æ—¶ä½¿ç”¨delegation" class="headerlink" title="1.å½“åœ¨ä¸€ä¸ªæ–¹æ³•çš„å‚æ•°ä¸­éœ€è¦å¤šä¸ªå¯¹è±¡æ—¶ä½¿ç”¨delegation"></a>1.å½“åœ¨ä¸€ä¸ªæ–¹æ³•çš„å‚æ•°ä¸­éœ€è¦å¤šä¸ªå¯¹è±¡æ—¶ä½¿ç”¨delegation</h3><p>æˆ‘ä»¬åœ¨å¼€å‘è¿‡ç¨‹ä¸­ç»å¸¸ä½¿ç”¨<code>UITableView</code>ï¼Œè¿™æ—¶æˆ‘ä»¬å°±è¦å®ç°æ¥å£åè®®<code>UITableViewDataSource</code>, <code>UITableViewDelegate</code>ä¸¤è€…æ˜¯æˆ‘ä»¬åœ¨ä½¿ç”¨<code>UITableView</code>çš„ç›¸å…³æ•°æ®åè®®å’Œç›¸å…³åè®®ã€‚ä»tableViewè§’åº¦å‡ºå‘ï¼šå®ç°å±•ç¤ºéœ€è¦æ•°æ®ã€å¯¹ä¸€äº›å±•ç¤ºè¿‡ç¨‹çš„æ§åˆ¶ç­‰ï¼Œè¿™äº›å¯ä»¥ä½¿ç”¨<code>block</code>æ¥è¿›è¡Œå®ç°ã€‚</p>
<blockquote>
<p>void (^ showTableView)(NSData *data, NSInteger number, CGFloat heightForRowAtIndexPath);</p>
</blockquote>
<p>ä¸Šé¢æˆ‘ä»¬å®šä¹‰å‘Šè¯‰è¿‡ç¨‹éœ€è¦å‚æ•°åœ¨<code>NSIndexPath</code>,æ‰€ä»¥ç¬¬ä¸‰ä¸ªå‚æ•°åº”è¯¥æ˜¯ <code>block</code>å½¢å¼ã€‚æˆ‘ä»¬ä¸Šé¢çŸ¥é“blockåœ¨ç¼–è¯‘è¿‡ç¨‹ä¼šè¢«ç¼–è¯‘ä¸º<strong>struct</strong>ç»“æ„ï¼Œåœ¨ç›¸äº’åµŒå¥—è¿‡ç¨‹ä¸­ä½¿ç”¨<code>delegation</code>æ›´åŠ æ–¹ä¾¿ã€‚</p>
<h3 id="2-ä¸€ä¸ªå¯¹è±¡åªèƒ½æœ‰ä¸€ä¸ªdelegation"><a href="#2-ä¸€ä¸ªå¯¹è±¡åªèƒ½æœ‰ä¸€ä¸ªdelegation" class="headerlink" title="2. ä¸€ä¸ªå¯¹è±¡åªèƒ½æœ‰ä¸€ä¸ªdelegation"></a>2. ä¸€ä¸ªå¯¹è±¡åªèƒ½æœ‰ä¸€ä¸ªdelegation</h3><p>ç”±äºä¸€ä¸ªå¯¹è±¡åªèƒ½æœ‰ä¸€ä¸ªdelegateï¼Œè€Œä¸”å®ƒåªèƒ½ä¸è¿™ä¸ªdelegateé€šä¿¡ã€‚è®©æˆ‘ä»¬çœ‹çœ‹CLLocationManager è¿™ä¸ªç±»ï¼Œå½“å‘ç°åœ°ç†ä½ç½®åï¼Œlocation manager åªä¼šé€šçŸ¥ä¸€ä¸ªå¯¹è±¡ï¼ˆæœ‰ä¸”åªæœ‰ä¸€ä¸ªï¼‰ã€‚å½“ç„¶ï¼Œå¦‚æœæˆ‘ä»¬éœ€è¦æ›´å¤šçš„å¯¹è±¡å»çŸ¥é“è¿™ä¸ªæ›´æ–°ï¼Œæˆ‘ä»¬æœ€å¥½åˆ›å»ºå…¶ä»–çš„location managerã€‚</p>
<p>è¿™é‡Œæœ‰çš„äººå¯èƒ½æƒ³åˆ°ï¼Œå¦‚æœCLLocationManageræ˜¯ä¸ªå•ä¾‹å‘¢ï¼Ÿå¦‚æœæˆ‘ä»¬ä¸èƒ½åˆ›å»ºCLLocationManagerçš„å…¶ä»–å®ä¾‹ï¼Œå°±å¿…é¡»ä¸æ–­åœ°åˆ‡æ¢delegateæŒ‡é’ˆåˆ°éœ€è¦åœ°ç†æ•°æ®çš„å¯¹è±¡ä¸Šï¼ˆæˆ–è€…åˆ›å»ºä¸€ä¸ªåªæœ‰ä½ ç†è§£çš„ç²¾å¯†çš„å¹¿æ’­ç³»ç»Ÿï¼‰ã€‚å› æ­¤ï¼Œè¿™æ ·çœ‹èµ·æ¥ï¼Œdelegatetionåœ¨å•ä¾‹ä¸Šæ²¡æœ‰å¤šå¤§æ„ä¹‰ã€‚</p>
<p>å…³äºè¿™ç‚¹ï¼Œæœ€å¥½çš„å°è¯ä¾‹å­å°±æ˜¯UIAccelerometerã€‚åœ¨æ—©æœŸç‰ˆæœ¬çš„iOSä¸­ï¼Œå•ä¾‹çš„ accelerometer å®ä¾‹æœ‰ä¸€ä¸ªdelegateï¼Œå¯¼è‡´æˆ‘ä»¬å¿…é¡»å¶å°”åˆ‡æ¢ä¸€ä¸‹ã€‚è¿™ä¸ªæ„šè ¢çš„é—®é¢˜åœ¨ä¹‹åçš„IOSç‰ˆæœ¬è¢«ä¿®æ”¹äº†ï¼Œç°åœ¨ï¼Œä»»æ„ä¸€ä¸ªå¯¹è±¡éƒ½å¯ä»¥è®¿é—®CMMotionManager blockï¼Œè€Œä¸éœ€è¦é˜»æ­¢å…¶ä»–çš„å¯¹è±¡æ¥æ¥æ”¶æ›´æ–°ã€‚</p>
<p>å› æ­¤ï¼Œæˆ‘ä»¬å¯ä»¥å¾—å‡ºå¦ä¸€ä¸ªç»“è®ºï¼šâ€œå¦‚æœä¸€ä¸ªå¯¹è±¡æ˜¯å•ä¾‹ï¼Œä¸è¦ä½¿ç”¨delegationâ€ã€‚</p>
<h3 id="3-ä¸€èˆ¬delegationéƒ½æœ‰è‡ªå·±çš„è€Œè¿”å›å€¼"><a href="#3-ä¸€èˆ¬delegationéƒ½æœ‰è‡ªå·±çš„è€Œè¿”å›å€¼" class="headerlink" title="3. ä¸€èˆ¬delegationéƒ½æœ‰è‡ªå·±çš„è€Œè¿”å›å€¼"></a>3. ä¸€èˆ¬delegationéƒ½æœ‰è‡ªå·±çš„è€Œè¿”å›å€¼</h3><p>è¿˜æ˜¯æ‹¿ä¸Šé¢çš„ä¾‹å­è¯´æ˜ï¼š<br><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">- (<span class="built_in">NSInteger</span>)tableView:(<span class="built_in">UITableView</span> *)tableView numberOfRowsInSection:(<span class="built_in">NSInteger</span>)section;</span><br><span class="line"></span><br><span class="line">-(<span class="built_in">UITableViewCell</span> *)tableView:(<span class="built_in">UITableView</span> *)tableView cellForRowAtIndexPath:(<span class="built_in">NSIndexPath</span> *)indexPath;</span><br></pre></td></tr></table></figure></p>
<p>ä¸Šé¢æ˜¯<code>UITableViewDataSource</code>åè®®ä¸­å¿…é¡»å®ç°åè®®ï¼Œå¯çœ‹å‡ºæ˜¯ä½¿ç”¨è¿”å›å€¼ã€‚è€Œæˆ‘ä»¬ä¹Ÿå¯ä»¥çœ‹å…¶ä»–çš„ä¸€äº›åè®®è¡¨ç¤ºæƒ…å†µï¼Œä¸€èˆ¬å‡æ˜¯éœ€è¦è¿”å›å€¼çš„ã€‚</p>
<h3 id="4-delegationåå‘äºä½¿ç”¨çš„è¿‡ç¨‹-VS-blockåå‘äºä½¿ç”¨ç»“æœ"><a href="#4-delegationåå‘äºä½¿ç”¨çš„è¿‡ç¨‹-VS-blockåå‘äºä½¿ç”¨ç»“æœ" class="headerlink" title="4.delegationåå‘äºä½¿ç”¨çš„è¿‡ç¨‹ VS blockåå‘äºä½¿ç”¨ç»“æœ"></a>4.delegationåå‘äºä½¿ç”¨çš„è¿‡ç¨‹ VS blockåå‘äºä½¿ç”¨ç»“æœ</h3><p>å¦‚æœæŸ¥çœ‹<code>NSURLConnectionDelegate</code> ä»¥åŠ <code>NSURLConnectionDataDelegate</code>ï¼Œæˆ‘ä»¬åœ¨å¯ä»¥<strong>protocol</strong>ä¸­çœ‹åˆ°è¿™æ ·çš„æ¶ˆæ¯ï¼šæˆ‘å°†è¦åšä»€ä¹ˆï¼ˆå¦‚ï¼š <strong>willSendRequest</strong>ï¼Œå°†è¦å‘é€è¯·æ±‚ï¼‰ã€åˆ°ç›®å‰ä¸ºæ­¢æˆ‘çŸ¥é“çš„ä¿¡æ¯ï¼ˆå¦‚ï¼š<code>canAuthenticateAgainstProtectionSpace</code>ï¼‰ã€æˆ‘å·²ç»å®Œæˆè¿™äº›å•¦ï¼ˆ <strong>didReceiveResponse</strong>ï¼Œæ”¶åˆ°è¯·æ±‚çš„å›å¤ï¼Œå³å®Œæˆè¯·æ±‚ï¼‰ã€‚è¿™äº›æ¶ˆæ¯ç»„æˆä¸€ä¸ªæµç¨‹ï¼Œè€Œé‚£äº›å¯¹æµç¨‹æ„Ÿå…´è¶£çš„<strong>delegate</strong>å°†ä¼šåœ¨æ¯ä¸€æ­¥å¾—åˆ°ç›¸åº”çš„é€šçŸ¥ã€‚</p>
<p>å½“æˆ‘ä»¬è§‚å¯Ÿ<strong>handler</strong>å’Œå®Œæ•´çš„æ–¹æ³•æ—¶ï¼Œæˆ‘ä»¬å‘ç°ä¸€ä¸ª<strong>block</strong>åŒ…å«ä¸€ä¸ªå“åº”å¯¹è±¡å’Œä¸€ä¸ªé”™è¯¯å¯¹è±¡ã€‚æ˜¾ç„¶è¿™é‡Œæ²¡æœ‰ä»»ä½•æœ‰å…³â€œæˆ‘åœ¨å“ªé‡Œï¼Œæˆ‘æ­£åœ¨åšä»€ä¹ˆçš„â€çš„äº¤äº’ã€‚</p>
<p>å› æ­¤æˆ‘ä»¬å¯ä»¥è¿™æ ·è®¤ä¸ºï¼Œ<strong>delegate</strong>çš„å›è°ƒæ›´å¤šçš„é¢å‘è¿‡ç¨‹ï¼Œè€Œ<strong>block</strong>åˆ™æ˜¯é¢å‘ç»“æœçš„ã€‚å¦‚æœä½ éœ€è¦å¾—åˆ°ä¸€æ¡å¤šæ­¥è¿›ç¨‹çš„é€šçŸ¥ï¼Œä½ åº”è¯¥ä½¿ç”¨<strong>delegation</strong>ã€‚è€Œå½“ä½ åªæ˜¯å¸Œæœ›å¾—åˆ°ä½ è¯·æ±‚çš„ä¿¡æ¯ï¼ˆæˆ–è€…è·å–ä¿¡æ¯æ—¶çš„é”™è¯¯æç¤ºï¼‰ï¼Œä½ åº”è¯¥ä½¿ç”¨<strong>block</strong>ã€‚ï¼ˆå¦‚æœä½ ç»“åˆä¹‹å‰çš„3ä¸ªç»“è®ºï¼Œä½ ä¼šå‘ç°<strong>delegate</strong>å¯ä»¥åœ¨æ‰€æœ‰äº‹ä»¶ä¸­ç»´æŒ<strong>state</strong>ï¼Œè€Œå¤šä¸ªç‹¬ç«‹çš„<strong>block</strong>ç¡®ä¸èƒ½ï¼‰ã€‚<br><br></p>
<h3 id="å‚è€ƒï¼š"><a href="#å‚è€ƒï¼š" class="headerlink" title="å‚è€ƒï¼š"></a>å‚è€ƒï¼š</h3><p><a herf="http://www.cocoachina.com/ios/20150925/13525.html">å¼€å‘è¯¥é€‰æ‹©Blocksè¿˜æ˜¯Delegates</a></p>

      

      
    </div>
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<i class="icon-price-tags icon"></i>
		<ul class="article-tag-list">
			 
        		<li class="article-tag-list-item">
        			<a href="javascript:void(0)" class="js-tag article-tag-list-link color4">IOS</a>
        		</li>
      		
		</ul>
	</div>

      
	<div class="article-category tagcloud">
		<i class="icon-book icon"></i>
		<ul class="article-tag-list">
			 
        		<li class="article-tag-list-item">
        			<a href="/categories/IOS/" class="article-tag-list-link color4">IOS</a>
        		</li>
      		
		</ul>
	</div>


      
        <p class="article-more-link">
          <a class="article-more-a" href="/2016/05/29/blockï¼Œæ³¨å†Œç›‘å¬ï¼Œå§”æ‰˜åè®®å’ŒKVO/">å±•å¼€å…¨æ–‡ >></a>
        </p>
      

      
      <div class="clearfix"></div>
    </div>
  </div>
</article>





  
    <article id="post-ä»å®å®CTOé‡‡è®¿æ¼”è®²éšç¬”" class="article article-type-post  article-index" itemscope itemprop="blogPost">
  <div class="article-inner">
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/05/29/ä»å®å®CTOé‡‡è®¿æ¼”è®²éšç¬”/">ä»å®å®CTOé‡‡è®¿æ¼”è®²éšç¬”</a>
    </h1>
  

        
        <a href="/2016/05/29/ä»å®å®CTOé‡‡è®¿æ¼”è®²éšç¬”/" class="archive-article-date">
  	<time datetime="2016-05-29T04:09:11.000Z" itemprop="datePublished"><i class="icon-calendar icon"></i>2016-05-29</time>
</a>
        
      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>ä»Šå¤©åœ¨çœ‹Oneâ€™s Catå¤§ç¥çš„åšå®¢æ—¶è®²åˆ°å¦‚ä½•åˆ›å»ºæˆ‘ä»¬ä¸ªäººçš„å¼€æºæ¡†æ¶ï¼Œå°±æ¶‰åŠåˆ°fastlaneå°±æ‰¾æ¥çœ‹ä¸‹ï¼Œæ— æ„ä¸­çœ‹åˆ°å®å®çš„CTOæœ±é¸¿å¤§ç¥ï¼ˆåˆä¸€å°Šå¤§ç¥ï¼‰è®²è¿°è‡ªå·±çš„äº§å“ã€‚çŸ­çŸ­22ï¼š05çš„è§†é¢‘è®©è‡ªå·±æ„Ÿè§¦å¾ˆå¤§ï¼Œå†™è¿™ç¯‡æ–‡ç« ä¹Ÿå°±æ˜¯æ— èŠè¯´ä¸‹è‡ªå·±æ‰€å­¦çŸ¥è¯†å§ã€‚</p>
<h3 id="æ€»çš„æ¥è¯´ä»¥æŠ€æœ¯æ¥ç®€åŒ–æˆ‘ä»¬ç”Ÿæ´»ï¼Œç›®å‰æ¯”æƒ³è±¡ä¸­è¦éš¾ã€‚"><a href="#æ€»çš„æ¥è¯´ä»¥æŠ€æœ¯æ¥ç®€åŒ–æˆ‘ä»¬ç”Ÿæ´»ï¼Œç›®å‰æ¯”æƒ³è±¡ä¸­è¦éš¾ã€‚" class="headerlink" title="æ€»çš„æ¥è¯´ä»¥æŠ€æœ¯æ¥ç®€åŒ–æˆ‘ä»¬ç”Ÿæ´»ï¼Œç›®å‰æ¯”æƒ³è±¡ä¸­è¦éš¾ã€‚"></a>æ€»çš„æ¥è¯´ä»¥æŠ€æœ¯æ¥ç®€åŒ–æˆ‘ä»¬ç”Ÿæ´»ï¼Œç›®å‰æ¯”æƒ³è±¡ä¸­è¦éš¾ã€‚</h3><h3 id="äººå‘˜é…ç½®æ–¹é¢"><a href="#äººå‘˜é…ç½®æ–¹é¢" class="headerlink" title="äººå‘˜é…ç½®æ–¹é¢"></a>äººå‘˜é…ç½®æ–¹é¢</h3><p>é¦–å…ˆæœ±å¤§ç¥è®²è¿°å›¢é˜Ÿäººæ•°æœ‰120äººï¼Œè€Œåœ¨å®¢æˆ·ç«¯å’Œåç«¯æ¯”ä¾‹2ï¼š1ä¼°è®¡è¿™æ ·çš„æ ‡é…ä¹Ÿåªæœ‰åƒé˜¿é‡Œè¿™æ ·æƒ³è¦åœ¨ç§»åŠ¨ç«¯å°¤å…¶ç¤¾äº¤è¿™å—ç«™ä½ä¸€å®šåœ°ä½å¼ºæ‚æ ‡é…ã€‚</p>
<h3 id="è¸©è¿‡çš„å¤§å‘"><a href="#è¸©è¿‡çš„å¤§å‘" class="headerlink" title="è¸©è¿‡çš„å¤§å‘"></a>è¸©è¿‡çš„å¤§å‘</h3><p>æœ±å¤§ç¥è®²è¿°åœ¨æ•°æ®è§£ææ–¹ä¾¿æ›¾ç»è¸©è¿‡ä¸€ä¸ªå¤§å‘ï¼Œæ‰€è°“å¤§å‘å°±æ˜¯åœ¨IOS&amp;Androidä¸¤ä¸ªå®¢æˆ·ç«¯å¯¹äºæ•°æ®è§£ææœ‰æ‰€ä¸åŒã€‚å°±æ˜¯åœ¨äºåŸºæœ¬æ•°æ®ç±»å‹æ–¹é¢å¯¹äºæ•°æ®è§£æäº§ç”Ÿä¸åŒçš„ç»“æœï¼Œä¼°è®¡æ˜¯ä½¿ç”¨åŠ å¯†æ–¹å¼åœ¨æœåŠ¡å™¨å¾—åˆ°æ•°æ®è§£ææœ‰ä¸€å®šä¹±ç æƒ³è±¡åªæ˜¯ä¸çŸ¥é“æ˜¯Jsonè¿˜æ˜¯Xmlå¾—è§£æï¼ˆå°ç¼–è‡ªå·±çŒœæµ‹ï¼‰ã€‚</p>
<h3 id="ä¼ä¸šç”µè¯æ–¹é¢"><a href="#ä¼ä¸šç”µè¯æ–¹é¢" class="headerlink" title="ä¼ä¸šç”µè¯æ–¹é¢"></a>ä¼ä¸šç”µè¯æ–¹é¢</h3><p>å¤§ç¥è¯´å‡ºç›®å‰æˆ‘ä»¬ç§»åŠ¨çš„ç«¯æ‰€åœ¨2Gç”¨æˆ·æ¯”é‡æŒºå¤§ï¼Œé‡‡ç”¨èåˆé€šä¿¡æ–¹å‘æœŸé—´è¿˜æ˜¯ç”¨é˜¿é‡Œçš„çº¿è·¯ã€‚å…³äºåœ¨WiFiæƒ…å†µä¸‹æµ‹è¯•ä½¿ç”¨OAé€šä¿¡æ–¹å¼ï¼Œéšä¾¿è®²è¿°åœ¨æ‰‹æœºç½‘ç»œæä¾›å•†ä¸åŒçš„æƒ…å†µä¸‹å…·ä½“æƒ…å†µï¼ˆè”é€šç½‘ç»œé€šä¿¡ä¸€æ—¦æ‰“å¼€ç½‘ç»œå°±ä¼šå ç”¨ä¸€æ¡ä¿¡é“è¿›è¡Œé€šä¿¡ï¼Œæ‰€ä»¥åœ¨æ•°æ®è¾ƒå¤§æ—¶å¸¦å®½å°±æ˜¯å ç”¨è¾ƒå¤§é—®é¢˜~å°å¿ƒè„ä½œä¸ºå®¢æˆ·ç«¯å¼€å‘çš„å°ç¼–ä¹‹å‰ç«Ÿæ²¡æœ‰å¬è¯´è¿‡ï¼‰ã€‚</p>
<h3 id="å‘å¸ƒæœºåˆ¶å’Œå›¢é˜Ÿæ„æ€"><a href="#å‘å¸ƒæœºåˆ¶å’Œå›¢é˜Ÿæ„æ€" class="headerlink" title="å‘å¸ƒæœºåˆ¶å’Œå›¢é˜Ÿæ„æ€"></a>å‘å¸ƒæœºåˆ¶å’Œå›¢é˜Ÿæ„æ€</h3><p>ç”±äºå®å®æ˜¯åŸºäºä¼ä¸šé€šä¿¡æœåŠ¡çš„è¡Œä¸šåº”ç”¨æ€§èƒ½æ–¹ä¾¿çœŸæ˜¯ä¸ªå¤§é—®é¢˜ã€‚<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"> å—¨ï¼Œè®°å¾—å»å¹´çš„æš‘å‡åœ¨å‚åŠ æ·±åœ³ä¸€ä¸ªæ´»åŠ¨æ—¶ï¼Œé»„è€å¤§å¥”å»æ·±åœ³åˆ›ä¸š~é‚£æ—¶æˆ‘ä»¬ä½åœ¨æ—…ç¤¾</span><br><span class="line">ä»–è¯´è¦åšä¼ä¸šOAï¼Œæˆ‘éšå£è¯´ç°åœ¨åˆ›ä¸šé‚£ä¹ˆç«è¦ä¸åšä¸€ä¸ªç»™åˆ›ä¸šè€…åšä¸ªæœåŠ¡å‹çš„åº”ç”¨æé«˜æ•ˆç‡ã€‚çœ‹åˆ°è¿™ä¸ªæ„Ÿè§‰</span><br><span class="line">äº‹æƒ…çœŸçš„ä¸æƒ³æˆ‘ä»¬æƒ³è±¡çš„é‚£ä¹ˆç®€å•ï¼</span><br></pre></td></tr></table></figure></p>
<p>ä½œä¸ºå¼€å‘äººå‘˜æˆ‘ä»¬éƒ½çŸ¥é“å¦‚ä½•åšåˆ°æµç•…æ»šåŠ¨ç•Œé¢å’Œé€šä¿¡æ–¹é¢åŠæ—¶ï¼Œè¿™ä¸ªæ˜¯å¾ˆå¤§çš„æŒ‘æˆ˜ã€‚è¿™ä¸ªåé¢æœ‰æ‰€æ¶‰åŠå¤§å®¶è¿˜æ˜¯è€å¿ƒçœ‹ä¸‹å»ã€‚<br>å…¶å®çœŸæ­£è§¦åŠ¨ğŸ’˜é¡¹ç›®ç»„æŠ€æœ¯ã€äº§å“å’Œè¿è¥æ‹†åˆ†ä¸º7ä¸ªteamï¼Œå®è¡Œç«äº‰ä¼°è®¡æœºåˆ¶ã€‚äº§å“ç»ç†å¯¹äºè‡ªå·±teamè´Ÿè´£çš„åŠŸèƒ½è¿›è¡Œè·Ÿè¿›ï¼ŒæŠ€æœ¯å’Œè¿è¥è´Ÿè´£ç›¸å…³æŠ€æœ¯å¼€å‘ã€‚è¿™æ ·å®Œæˆæ¯å¤©éƒ½å¯ä»¥è¿›è¡Œä¸€ä¸ªbateçš„æäº¤ï¼Œä¸‰å‘¨è¿›è¡Œäº§å“çš„ä¸€æ¬¡è¿­ä»£ã€‚é¡¹ç›®å¼€å‘ä¹‹å¿«ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"> æœ€è®©å°ç¼–ç–‘æƒ‘çš„æ˜¯äº§å“ä¹‹é—´åŠŸèƒ½å¯ä»¥è¿›è¡Œæ¨¡å—å¼€å‘~åŸºäºé¢å‘å¯¹è±¡æœ‰ç‚¹ï¼ˆé’ˆå¯¹åŠŸèƒ½å®ç°</span><br><span class="line">å¯ä»¥è¿›è¡Œæ¨¡å—åˆ’åˆ†ï¼‰ï¼Œä½†æ˜¯è¿è¥æ˜¯æ€ä¹ˆåœ¨ä¸€ä¸ªå¤§çš„teamç„¶å7ä¸ªå°å›¢é˜Ÿä¹‹é—´å®ç°ğŸ˜‚</span><br></pre></td></tr></table></figure>
<p>è®°å¾—ä¸ä¹…å‰æœ‰ä¸ªæ ‡é¢˜å…šï¼šBATæœªæ¥è¿˜ä¼šå­˜åœ¨å—ï¼Ÿä¸­é—´å°±æ˜¯åˆ©ç”¨â€œäºŒå…«æ³•åˆ™â€æ¥è®²è¿°å¤§ä¼ä¸šé¢å¯¹ç§‘æŠ€ä»€ä¹ˆé¬¼çªå˜æ—¶éš¾ä»¥è¿›è¡Œæ”¹é©ï¼Œå°ä¼ä¸šæ›´æœ‰æ´»åŠ›ã€‚æ¥è¾©è¯è®²è¿°è‡ªå·±çš„è§‚ç‚¹ï¼Œçœ‹å°ç¼–å¾®å¾®ä¸€ç¬‘å°±å–ä¸‹æ°´å¹³é™å¹³é™ã€‚<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"> ä¸è¿‡ç›®å‰çœ‹æ¥è¿™ä¸ªå®šç†ä¼°è®¡æ˜¯æœ‰è‡ªå·±ä»·å€¼ï¼Œä»¥åå¦‚æœæ˜¯è‡ªå·±å‡ºæ¥å°è¯•å°±å¯ä»¥è¯•éªŒä¸‹ï¼Œæ­¤</span><br><span class="line">å¤„å¯ä»¥hulue</span><br></pre></td></tr></table></figure></p>
<h3 id="ç°åº¦ç”¨æˆ·"><a href="#ç°åº¦ç”¨æˆ·" class="headerlink" title="ç°åº¦ç”¨æˆ·"></a>ç°åº¦ç”¨æˆ·</h3><p>å¬åˆ°çš„ç¬¬ä¸€æ„Ÿè§‰å°±æ˜¯â€œæ©ï¼Ÿâ€è¯·é—®å’Œ37åº¦ç°æœ‰å…³ç³»ä¸ã€‚æˆ‘å¯æ˜¯çª¦æ–‡æ¶›çš„ç²‰ä¸å•Šï¼Œéš¾é“æ˜¯è‡ªå·±è§è¯†å¤ªå°‘ã€‚è®¤è®¤çœŸ<br>çœŸç™¾åº¦ä¸€ä¸‹å…³äºç°åº¦çš„é—®é¢˜ï¼Œæ‰€è¯´æ²¡æœ‰æ‰¾åˆ°ç°åº¦ç”¨æˆ·è¯´æ³•ä½†æ˜¯å´çœ‹åˆ°å…³äºQQä¼ æˆç°åº¦æ³•åˆ™ï¼šéœ€æ±‚åº¦ã€é€Ÿåº¦ã€çµæ´»åº¦ã€å†—ä½™åº¦ã€å¼€æ”¾åä½œåº¦ã€åˆ›æ–°åº¦å’Œè¿›åŒ–åº¦ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">å°ç¼–ä¸‹é¢å°±ä¸ºå¤§å®¶è®²è¿°ä¸‹ï¼š</span><br><span class="line">éœ€æ±‚åº¦ï¼šç”¨æˆ·éœ€æ±‚å°±æ˜¯ä½¿ç”¨è€…æœ€æƒ³è¦ã€‚ä¾‹å¦‚ï¼šåªä»å»å¹´å›½å®¶æ”¾å¼€äºŒèƒæ”¿ç­–ï¼Œæˆ‘ä»¬å°±ä¼šçœ‹åˆ°ä»Šå¹´æ¯å©´è¡Œä¸šå¤©å¤©</span><br><span class="line">ç«çˆ†çš„è¡Œä¸šï¼Œæ¯•ç«Ÿ70ï¼Œ80åå¤§å”å’Œé˜¿å§¨ä¼°è®¡ä»é‚£å¤©å°±å¼€å§‹äººç±»ä¼Ÿå¤§çš„ä¼ æ‰¿å¥‹æ–—å•¦ğŸ˜›</span><br><span class="line">é€Ÿåº¦ï¼šè¿™ä¸ªä¼°è®¡å¤§å®¶éƒ½çŸ¥é“ï¼Œåˆ˜ç¿”110è·¨æ æˆä¸ºäºšæ´²é£äººçš„ç§°å·ã€‚å¯¹äºäº’è”ç½‘è€Œè¨€é€Ÿåº¦å°±æ›´éš¾èƒ½å¯è´µçš„ï¼Œä¼°</span><br><span class="line">è®¡è¿™ä¹Ÿæ˜¯é¢å¯¹å¾®ä¿¡çš„å®å®ä¸‰å‘¨ä¸€ä¸ªç‰ˆæœ¬æ›´æ–°å…·ä½“ä½“ç°å§ã€‚</span><br><span class="line">çµæ´»åº¦ï¼šé¢å¯¹å½“å‰å±€åŠ¿æœ‰æ‰€åˆ¤æ–­å’Œå¯¹æœªçŸ¥çš„é¢„è§ï¼Œå°±åƒç¥é›•ä¾ ä¾£é‡Œçš„æ®µèª‰ï¼Œé¢å¯¹å¼ºå¤§æ¶è€ä¸‰ï¼ˆä¸€ç›´éƒ½è‡ªç§°è€</span><br><span class="line">äºŒæ¥ç€ï¼‰è™½è¯´æ­¦æœ¯å“¥ä¸è¡Œã€‚ä½†æ˜¯å¥½åœ¨å‡Œæ³¢å¾®æ­¥ï¼Œç…§æ ·åœ¨æ‰“èµŒä¸­æˆä¸ºä½ å°å­çš„å¸ˆå‚…ä¸æ˜¯ã€‚</span><br><span class="line">å†—ä½™åº¦ï¼šçœ‹åˆ°è¿™å¿ƒé‡Œå‡‰æŠŠæŠŠçš„ï¼ŒQQè€å¤§ä½ ä¹Ÿæ˜¯ç¨‹åºå‘˜å¼€å§‹çš„ï¼Œå†—ä½™åº¦æ˜¯åœ¨ç¨‹åºå¼€å‘è¿‡ç¨‹ä¸­æˆ‘ä»¬æƒ³æ³•è®¾æ³•è§£</span><br><span class="line">å†³ã€‚åæ¥å®šç›ä¸€çœ‹ï¼Œå“¦ï¼ŒåŸæ¥æ˜¯æ˜¯è¯•é”™å•Šï¼Œå¥½å§å¥‰ä¸Šæˆ‘çš„è†ç›–ğŸ‘ğŸ»ã€‚</span><br><span class="line">å¼€æ”¾åä½œåº¦ï¼šåœ¨äº’è”ç½‘ä¸­æŠŠè‡ªå®¶çš„èµ„æºæ‹¿æ¥å…±äº«åˆä½œï¼Œå¤§å®¶éƒ½çŸ¥é“èœœèœ‚ä¸€èˆ¬èœ‚å·¢ä¸­åªæœ‰ä¸€ä¸ªèœ‚åæ— æ•°å·¥èœ‚ï¼Œ</span><br><span class="line">èœ‚åå‘å·¥èœ‚æä¾›ç”Ÿå‘½å·¥èœ‚è´Ÿè´£å…·ä½“äº‹åŠ¡ã€‚ä¹‹åå¤§å®¶åœ¨ä¸€ä¸ªé›†ä½“é‡ŒæŠŠè‡ªå·±è¶Šåšè¶Šå¤§ï¼Œèœ‚ååæœŸå‡ ä¹å¯ä»¥ç‹¬èµ„ã€‚</span><br><span class="line">åˆ›æ–°åº¦ï¼šåªè®°å¾—å»å¹´å…‹å¼ºå¤§å¤§æ‰€å¾—ä¸‡ä¼—åˆ›æ–°ï¼Œå¤§ä¼—åˆ›ä¸šã€‚åé¢èº«è¾¹å¾ˆå¤šäººå°±å»å•¦ï¼Œä¸€è·¯å¥½èµ°ğŸŒµ</span><br><span class="line">è¿›åŒ–åº¦ï¼šQQå¤§ä½¬è¯´6ä¸ªå¦‚æœåšåˆ°çš„è¯ï¼Œè¿™ä¸ªä¼šè‡ªåŠ¨å®Œæˆã€‚æœ‰ç‚¹ç”Ÿç‰©è¿›åŒ–çš„å‘³é“ï¼Œä½†æ˜¯ç¼ºå°‘ç‰©ç«å¤©æ‹©ã€‚</span><br></pre></td></tr></table></figure>
<h3 id="é—®é¢˜è°ƒè¯•"><a href="#é—®é¢˜è°ƒè¯•" class="headerlink" title="é—®é¢˜è°ƒè¯•"></a>é—®é¢˜è°ƒè¯•</h3><blockquote><p>è¿™é‡Œä¹‹æ‰€ä½¿ç”¨ä»£ç æ ¼å¼æ˜¯çœŸçš„æœ‰é‡è¦ï¼Œä»…å¯¹äºç å†œæ¥è¯´ï¼Œæ¯”æ–¹è¯´æœ¬äººã€‚<br>è¿˜åƒæ˜¯Androidæ®µå¯ä»¥è¿›è¡Œfixåå°è‡ªåŠ¨ä¿®å¤åŠŸèƒ½ï¼ŒIOSå®¢æˆ·ç«¯æ˜¯åœ¨IOSç«¯ç›´æ¥è¿›è¡Œä¿®æ”¹ã€‚</p>
</blockquote>
<h3 id="æ€§èƒ½ä¼˜åŒ–è¦æ±‚"><a href="#æ€§èƒ½ä¼˜åŒ–è¦æ±‚" class="headerlink" title="æ€§èƒ½ä¼˜åŒ–è¦æ±‚"></a>æ€§èƒ½ä¼˜åŒ–è¦æ±‚</h3><p>çœç”µå’Œé¡ºæ»‘ï¼Œå…·ä½“æ€ä¹ˆå®Œæˆå’Œå®ç°ï¼Œæœ±å¤§ç¥å¾®å¾®ğŸ˜ƒã€‚å½“è®²åˆ°åœ¨å›¾ç‰‡ä¸‹è½½å¤„ç†æ—¶ä¸»è¦å°†æµ·å¤–ï¼Œæœ±å¤§ç¥è¯´æˆ‘ä»¬åœ¨æµ·å¤–æœ‰ç®€å†æœåŠ¡å™¨ç„¶åè·Ÿå…·ä½“çš„è·¯ç”±ä¼˜åŒ–é€‰æ‹©å¯ä»¥å¯¹å›¾ç‰‡ä¸‹è½½åŠ å¿«é€Ÿåº¦ã€‚</p>
<h3 id="ä¼ä¸šç¾¤èŠå¤„ç†"><a href="#ä¼ä¸šç¾¤èŠå¤„ç†" class="headerlink" title="ä¼ä¸šç¾¤èŠå¤„ç†"></a>ä¼ä¸šç¾¤èŠå¤„ç†</h3><p>å‡è®¾ä¸€ç§æƒ…å†µï¼šå½“å¾ˆå¤šåœ¨ä¸€ä¸ªç¾¤ç»„ä¸­ä¸€èµ·èŠå¤©ï¼Œä¸€ç§’å¯ä»¥è®©æ•°æ®è¾¾åˆ°å‡ åƒæ¡ã€‚è¯·é—®ä½ æ€ä¹ˆè§£å†³ï¼Ÿ<br>æœ±å¤§ç¥è§£å†³æ–¹å¼ï¼šä¸€èµ·æŠŠæ•°æ®ä¸‹è½½ä¸‹æ¥ï¼Œä¿å­˜ä¸è‡³äºä¸¢å¤±ã€‚ä½†æ˜¯æœ€åæ˜¾ç¤ºçš„æ•°æ®å¤§å¤šæ˜¯æœ€ååå‡ äºŒåå‡ æ¡ã€‚è¿™æ ·å¯ä»¥å‡å°‘å±å¹•çš„åˆ·å±ç‡ï¼Œä¼˜åŒ–æ€§èƒ½ã€‚è‡³å°‘åœ¨GPUæ¸²æŸ“æ˜¾ç¤ºæ–¹é¢è‚¯å®šæœ‰æ‰€ä¼˜åŒ–ğŸ™…ğŸ»</p>
<blockquote><p>ä¹‹æ‰€ä»¥å†™è¿™äº›éšç¬”ï¼Œæ˜¯æƒ³è®©è‡ªå·±è®°ä½è‡ªå·±çœ‹è¿‡çŸ¥è¯†ã€‚æ¯•ç«Ÿå¥½è®°æ€§æ˜¯åœ¨ä¸å¦‚ä¸€ä¸ªçƒ‚ç¬”å¤´ï¼Œå†™çš„è¿‡ç¨‹ä¹Ÿæ˜¯åœ¨è®°å¿†<br>ä¸­é‡æ–°æ€è€ƒçš„è¿‡ç¨‹ã€‚</p>
</blockquote>
      

      
    </div>
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<i class="icon-price-tags icon"></i>
		<ul class="article-tag-list">
			 
        		<li class="article-tag-list-item">
        			<a href="javascript:void(0)" class="js-tag article-tag-list-link color5">è§†é¢‘å¿ƒå¾—</a>
        		</li>
      		
		</ul>
	</div>

      
	<div class="article-category tagcloud">
		<i class="icon-book icon"></i>
		<ul class="article-tag-list">
			 
        		<li class="article-tag-list-item">
        			<a href="/categories/éšç¬”/" class="article-tag-list-link color3">éšç¬”</a>
        		</li>
      		
		</ul>
	</div>


      
        <p class="article-more-link">
          <a class="article-more-a" href="/2016/05/29/ä»å®å®CTOé‡‡è®¿æ¼”è®²éšç¬”/">å±•å¼€å…¨æ–‡ >></a>
        </p>
      

      
      <div class="clearfix"></div>
    </div>
  </div>
</article>





  
    <article id="post-åšå®¢å¼€å¯" class="article article-type-post  article-index" itemscope itemprop="blogPost">
  <div class="article-inner">
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/05/28/åšå®¢å¼€å¯/">åšå®¢æ¬å®¶æ„Ÿè§‰</a>
    </h1>
  

        
        <a href="/2016/05/28/åšå®¢å¼€å¯/" class="archive-article-date">
  	<time datetime="2016-05-28T13:44:27.000Z" itemprop="datePublished"><i class="icon-calendar icon"></i>2016-05-28</time>
</a>
        
      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p> <br><br> <br> </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">åšå®¢åœ°å€æœ‰ç»å¸¸ä½¿pç”¨çš„åšå®¢å›­æ¬è‡³ç®€ä¹¦ï¼Œä»ç®€ä¹¦æ¬åˆ°Hexoå»ºç«‹çš„Githubä¸Šé¢ã€‚ä»æ­¤å¼€å¯è‡ªå·±åœ¨è·Ÿäººåšå®¢å­¦</span><br><span class="line"></span><br><span class="line">ä¹ å’Œåˆ†äº«å¾ç¨‹ï¼Œè¦æ˜¯è¯´å†™è¿™äº›å¯¹æˆ‘æœ€å¤§é©±åŠ¨åŠ›æ˜¯ä¸€æ¡è‡ªå·±ä¸€ç›´å¯¹æŠ€æœ¯å–œçˆ±å’Œå®Œæˆè‡ªå·±èœ•å˜ä¹‹è·¯ã€‚ </span><br></pre></td></tr></table></figure>
<p><br><br><br></p>
<hr>
<p>æ˜¨å¤©æŠŠåšå®¢æ¬è‡³è‡ªå·±çš„åšå®¢ï¼Œè™½è¯´èŠ±è´¹çš„æ—¶é—´æœ‰ç‚¹å¤šï¼Œä½†æ˜¯çœ‹ç€è‡ªå·±èŠ±è´¹çš„æ—¶é—´æœ‰æ‰€æ”¶è·è¿˜æ˜¯å¾ˆå¼€å¿ƒ</p>
<hr>
<p>çš„ã€‚è€Œä¸”è‡ªå·±ä¹Ÿå°†è¦ç¦»å¼€ç”Ÿæ´»å››å¹´å¤´å¤§å¼€å§‹æ–°çš„å¾ç¨‹ï¼Œæœ‰çš„åŒå­¦è¯´è‡ªå·±ä¸Šå¤§å­¦ä¼˜åŠ£ï¼Œä¸è¿‡æˆ‘æ˜¯çœŸå¿ƒæ„Ÿ</p>
<hr>
<p>è°¢å¤´å¤§ã€‚åœ¨å››å¹´é—´è‡ªå·±åšè¿‡å¾ˆå¤šäº‹æƒ…ï¼Œä¹Ÿæ”¶è·å¾ˆå¤šã€‚å…¶å®æœ€å¤§çš„æ”¶è·æ˜¯æœ‰ä¸€ä»¶äº‹å€¼å¾—è‡ªå·±ä¸€ç›´å»ç­‰å¾…</p>
<hr>
<p>è¿™ä¹Ÿéœ€æ˜¯è‡ªå·±åœ¨å¤§å­¦æœ€å¤§çš„æ”¶è·ï¼Œä¹Ÿæ˜¯åœ¨å¤§å­¦æœ€å¼€å¿ƒå¤§ä¸‰ä¸‹åŠå­¦æœŸâ•®(â•¯â–½â•°)â•­ã€‚</p>
<hr>
<p><br><br><br></p>
<p style="text-align:right;"><br>    â€“ <a href="https://github.com/boilWater/boilWater.github.io" target="_blank" rel="external"> åé¢ä¼šé™„ä¸Šè‡ªå·±ç®€å†ç‹¬è‡ªä»‹ç»ğŸ˜˜</a><br></p>



      

      
    </div>
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<i class="icon-price-tags icon"></i>
		<ul class="article-tag-list">
			 
        		<li class="article-tag-list-item">
        			<a href="javascript:void(0)" class="js-tag article-tag-list-link color5">åšå®¢ä¹‹åˆ</a>
        		</li>
      		
		</ul>
	</div>

      
	<div class="article-category tagcloud">
		<i class="icon-book icon"></i>
		<ul class="article-tag-list">
			 
        		<li class="article-tag-list-item">
        			<a href="/categories/éšç¬”/" class="article-tag-list-link color3">éšç¬”</a>
        		</li>
      		
		</ul>
	</div>


      
        <p class="article-more-link">
          <a class="article-more-a" href="/2016/05/28/åšå®¢å¼€å¯/">å±•å¼€å…¨æ–‡ >></a>
        </p>
      

      
      <div class="clearfix"></div>
    </div>
  </div>
</article>





  
  


          </div>
        </div>
      </div>
      <footer id="footer">
  <div class="outer">
    <div id="footer-info">
    	<div class="footer-left">
    		&copy; 2017 JackJin
    	</div>
      	<div class="footer-right">
      		<a href="http://hexo.io/" target="_blank">Hexo</a>  Theme <a href="https://github.com/litten/hexo-theme-yilia" target="_blank">Yilia</a> by Litten
      	</div>
    </div>
  </div>
</footer>
    </div>
    <script>
	var yiliaConfig = {
		mathjax: false,
		isHome: true,
		isPost: false,
		isArchive: false,
		isTag: false,
		isCategory: false,
		open_in_new: false,
		root: "/",
		innerArchive: true,
		showTags: false
	}
</script>

<script>!function(t){function n(e){if(r[e])return r[e].exports;var i=r[e]={exports:{},id:e,loaded:!1};return t[e].call(i.exports,i,i.exports,n),i.loaded=!0,i.exports}var r={};n.m=t,n.c=r,n.p="./",n(0)}([function(t,n,r){r(194),t.exports=r(190)},function(t,n,r){var e=r(3),i=r(52),o=r(27),u=r(28),c=r(53),f="prototype",a=function(t,n,r){var s,l,h,v,p=t&a.F,d=t&a.G,y=t&a.S,g=t&a.P,b=t&a.B,m=d?e:y?e[n]||(e[n]={}):(e[n]||{})[f],x=d?i:i[n]||(i[n]={}),w=x[f]||(x[f]={});d&&(r=n);for(s in r)l=!p&&m&&void 0!==m[s],h=(l?m:r)[s],v=b&&l?c(h,e):g&&"function"==typeof h?c(Function.call,h):h,m&&u(m,s,h,t&a.U),x[s]!=h&&o(x,s,v),g&&w[s]!=h&&(w[s]=h)};e.core=i,a.F=1,a.G=2,a.S=4,a.P=8,a.B=16,a.W=32,a.U=64,a.R=128,t.exports=a},function(t,n,r){var e=r(6);t.exports=function(t){if(!e(t))throw TypeError(t+" is not an object!");return t}},function(t,n){var r=t.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=r)},function(t,n){t.exports=function(t){try{return!!t()}catch(t){return!0}}},function(t,n){var r=t.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=r)},function(t,n){t.exports=function(t){return"object"==typeof t?null!==t:"function"==typeof t}},function(t,n,r){var e=r(126)("wks"),i=r(76),o=r(3).Symbol,u="function"==typeof o;(t.exports=function(t){return e[t]||(e[t]=u&&o[t]||(u?o:i)("Symbol."+t))}).store=e},function(t,n){var r={}.hasOwnProperty;t.exports=function(t,n){return r.call(t,n)}},function(t,n,r){var e=r(94),i=r(33);t.exports=function(t){return e(i(t))}},function(t,n,r){t.exports=!r(4)(function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a})},function(t,n,r){var e=r(2),i=r(167),o=r(50),u=Object.defineProperty;n.f=r(10)?Object.defineProperty:function(t,n,r){if(e(t),n=o(n,!0),e(r),i)try{return u(t,n,r)}catch(t){}if("get"in r||"set"in r)throw TypeError("Accessors not supported!");return"value"in r&&(t[n]=r.value),t}},function(t,n,r){t.exports=!r(18)(function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a})},function(t,n,r){var e=r(14),i=r(22);t.exports=r(12)?function(t,n,r){return e.f(t,n,i(1,r))}:function(t,n,r){return t[n]=r,t}},function(t,n,r){var e=r(20),i=r(58),o=r(42),u=Object.defineProperty;n.f=r(12)?Object.defineProperty:function(t,n,r){if(e(t),n=o(n,!0),e(r),i)try{return u(t,n,r)}catch(t){}if("get"in r||"set"in r)throw TypeError("Accessors not supported!");return"value"in r&&(t[n]=r.value),t}},function(t,n,r){var e=r(40)("wks"),i=r(23),o=r(5).Symbol,u="function"==typeof o;(t.exports=function(t){return e[t]||(e[t]=u&&o[t]||(u?o:i)("Symbol."+t))}).store=e},function(t,n,r){var e=r(67),i=Math.min;t.exports=function(t){return t>0?i(e(t),9007199254740991):0}},function(t,n,r){var e=r(46);t.exports=function(t){return Object(e(t))}},function(t,n){t.exports=function(t){try{return!!t()}catch(t){return!0}}},function(t,n,r){var e=r(63),i=r(34);t.exports=Object.keys||function(t){return e(t,i)}},function(t,n,r){var e=r(21);t.exports=function(t){if(!e(t))throw TypeError(t+" is not an object!");return t}},function(t,n){t.exports=function(t){return"object"==typeof t?null!==t:"function"==typeof t}},function(t,n){t.exports=function(t,n){return{enumerable:!(1&t),configurable:!(2&t),writable:!(4&t),value:n}}},function(t,n){var r=0,e=Math.random();t.exports=function(t){return"Symbol(".concat(void 0===t?"":t,")_",(++r+e).toString(36))}},function(t,n){var r={}.hasOwnProperty;t.exports=function(t,n){return r.call(t,n)}},function(t,n){var r=t.exports={version:"2.4.0"};"number"==typeof __e&&(__e=r)},function(t,n){t.exports=function(t){if("function"!=typeof t)throw TypeError(t+" is not a function!");return t}},function(t,n,r){var e=r(11),i=r(66);t.exports=r(10)?function(t,n,r){return e.f(t,n,i(1,r))}:function(t,n,r){return t[n]=r,t}},function(t,n,r){var e=r(3),i=r(27),o=r(24),u=r(76)("src"),c="toString",f=Function[c],a=(""+f).split(c);r(52).inspectSource=function(t){return f.call(t)},(t.exports=function(t,n,r,c){var f="function"==typeof r;f&&(o(r,"name")||i(r,"name",n)),t[n]!==r&&(f&&(o(r,u)||i(r,u,t[n]?""+t[n]:a.join(String(n)))),t===e?t[n]=r:c?t[n]?t[n]=r:i(t,n,r):(delete t[n],i(t,n,r)))})(Function.prototype,c,function(){return"function"==typeof this&&this[u]||f.call(this)})},function(t,n,r){var e=r(1),i=r(4),o=r(46),u=function(t,n,r,e){var i=String(o(t)),u="<"+n;return""!==r&&(u+=" "+r+'="'+String(e).replace(/"/g,"&quot;")+'"'),u+">"+i+"</"+n+">"};t.exports=function(t,n){var r={};r[t]=n(u),e(e.P+e.F*i(function(){var n=""[t]('"');return n!==n.toLowerCase()||n.split('"').length>3}),"String",r)}},function(t,n,r){var e=r(115),i=r(46);t.exports=function(t){return e(i(t))}},function(t,n,r){var e=r(116),i=r(66),o=r(30),u=r(50),c=r(24),f=r(167),a=Object.getOwnPropertyDescriptor;n.f=r(10)?a:function(t,n){if(t=o(t),n=u(n,!0),f)try{return a(t,n)}catch(t){}if(c(t,n))return i(!e.f.call(t,n),t[n])}},function(t,n,r){var e=r(24),i=r(17),o=r(145)("IE_PROTO"),u=Object.prototype;t.exports=Object.getPrototypeOf||function(t){return t=i(t),e(t,o)?t[o]:"function"==typeof t.constructor&&t instanceof t.constructor?t.constructor.prototype:t instanceof Object?u:null}},function(t,n){t.exports=function(t){if(void 0==t)throw TypeError("Can't call method on  "+t);return t}},function(t,n){t.exports="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(",")},function(t,n){t.exports={}},function(t,n){t.exports=!0},function(t,n){n.f={}.propertyIsEnumerable},function(t,n,r){var e=r(14).f,i=r(8),o=r(15)("toStringTag");t.exports=function(t,n,r){t&&!i(t=r?t:t.prototype,o)&&e(t,o,{configurable:!0,value:n})}},function(t,n,r){var e=r(40)("keys"),i=r(23);t.exports=function(t){return e[t]||(e[t]=i(t))}},function(t,n,r){var e=r(5),i="__core-js_shared__",o=e[i]||(e[i]={});t.exports=function(t){return o[t]||(o[t]={})}},function(t,n){var r=Math.ceil,e=Math.floor;t.exports=function(t){return isNaN(t=+t)?0:(t>0?e:r)(t)}},function(t,n,r){var e=r(21);t.exports=function(t,n){if(!e(t))return t;var r,i;if(n&&"function"==typeof(r=t.toString)&&!e(i=r.call(t)))return i;if("function"==typeof(r=t.valueOf)&&!e(i=r.call(t)))return i;if(!n&&"function"==typeof(r=t.toString)&&!e(i=r.call(t)))return i;throw TypeError("Can't convert object to primitive value")}},function(t,n,r){var e=r(5),i=r(25),o=r(36),u=r(44),c=r(14).f;t.exports=function(t){var n=i.Symbol||(i.Symbol=o?{}:e.Symbol||{});"_"==t.charAt(0)||t in n||c(n,t,{value:u.f(t)})}},function(t,n,r){n.f=r(15)},function(t,n){var r={}.toString;t.exports=function(t){return r.call(t).slice(8,-1)}},function(t,n){t.exports=function(t){if(void 0==t)throw TypeError("Can't call method on  "+t);return t}},function(t,n,r){var e=r(4);t.exports=function(t,n){return!!t&&e(function(){n?t.call(null,function(){},1):t.call(null)})}},function(t,n,r){var e=r(53),i=r(115),o=r(17),u=r(16),c=r(202);t.exports=function(t,n){var r=1==t,f=2==t,a=3==t,s=4==t,l=6==t,h=5==t||l,v=n||c;return function(n,c,p){for(var d,y,g=o(n),b=i(g),m=e(c,p,3),x=u(b.length),w=0,S=r?v(n,x):f?v(n,0):void 0;x>w;w++)if((h||w in b)&&(d=b[w],y=m(d,w,g),t))if(r)S[w]=y;else if(y)switch(t){case 3:return!0;case 5:return d;case 6:return w;case 2:S.push(d)}else if(s)return!1;return l?-1:a||s?s:S}}},function(t,n,r){var e=r(1),i=r(52),o=r(4);t.exports=function(t,n){var r=(i.Object||{})[t]||Object[t],u={};u[t]=n(r),e(e.S+e.F*o(function(){r(1)}),"Object",u)}},function(t,n,r){var e=r(6);t.exports=function(t,n){if(!e(t))return t;var r,i;if(n&&"function"==typeof(r=t.toString)&&!e(i=r.call(t)))return i;if("function"==typeof(r=t.valueOf)&&!e(i=r.call(t)))return i;if(!n&&"function"==typeof(r=t.toString)&&!e(i=r.call(t)))return i;throw TypeError("Can't convert object to primitive value")}},function(t,n,r){var e=r(5),i=r(25),o=r(91),u=r(13),c="prototype",f=function(t,n,r){var a,s,l,h=t&f.F,v=t&f.G,p=t&f.S,d=t&f.P,y=t&f.B,g=t&f.W,b=v?i:i[n]||(i[n]={}),m=b[c],x=v?e:p?e[n]:(e[n]||{})[c];v&&(r=n);for(a in r)(s=!h&&x&&void 0!==x[a])&&a in b||(l=s?x[a]:r[a],b[a]=v&&"function"!=typeof x[a]?r[a]:y&&s?o(l,e):g&&x[a]==l?function(t){var n=function(n,r,e){if(this instanceof t){switch(arguments.length){case 0:return new t;case 1:return new t(n);case 2:return new t(n,r)}return new t(n,r,e)}return t.apply(this,arguments)};return n[c]=t[c],n}(l):d&&"function"==typeof l?o(Function.call,l):l,d&&((b.virtual||(b.virtual={}))[a]=l,t&f.R&&m&&!m[a]&&u(m,a,l)))};f.F=1,f.G=2,f.S=4,f.P=8,f.B=16,f.W=32,f.U=64,f.R=128,t.exports=f},function(t,n){var r=t.exports={version:"2.4.0"};"number"==typeof __e&&(__e=r)},function(t,n,r){var e=r(26);t.exports=function(t,n,r){if(e(t),void 0===n)return t;switch(r){case 1:return function(r){return t.call(n,r)};case 2:return function(r,e){return t.call(n,r,e)};case 3:return function(r,e,i){return t.call(n,r,e,i)}}return function(){return t.apply(n,arguments)}}},function(t,n,r){var e=r(183),i=r(1),o=r(126)("metadata"),u=o.store||(o.store=new(r(186))),c=function(t,n,r){var i=u.get(t);if(!i){if(!r)return;u.set(t,i=new e)}var o=i.get(n);if(!o){if(!r)return;i.set(n,o=new e)}return o},f=function(t,n,r){var e=c(n,r,!1);return void 0!==e&&e.has(t)},a=function(t,n,r){var e=c(n,r,!1);return void 0===e?void 0:e.get(t)},s=function(t,n,r,e){c(r,e,!0).set(t,n)},l=function(t,n){var r=c(t,n,!1),e=[];return r&&r.forEach(function(t,n){e.push(n)}),e},h=function(t){return void 0===t||"symbol"==typeof t?t:String(t)},v=function(t){i(i.S,"Reflect",t)};t.exports={store:u,map:c,has:f,get:a,set:s,keys:l,key:h,exp:v}},function(t,n,r){"use strict";if(r(10)){var e=r(69),i=r(3),o=r(4),u=r(1),c=r(127),f=r(152),a=r(53),s=r(68),l=r(66),h=r(27),v=r(73),p=r(67),d=r(16),y=r(75),g=r(50),b=r(24),m=r(180),x=r(114),w=r(6),S=r(17),_=r(137),O=r(70),E=r(32),P=r(71).f,j=r(154),F=r(76),M=r(7),A=r(48),N=r(117),T=r(146),I=r(155),k=r(80),L=r(123),R=r(74),C=r(130),D=r(160),U=r(11),W=r(31),G=U.f,B=W.f,V=i.RangeError,z=i.TypeError,q=i.Uint8Array,K="ArrayBuffer",J="Shared"+K,Y="BYTES_PER_ELEMENT",H="prototype",$=Array[H],X=f.ArrayBuffer,Q=f.DataView,Z=A(0),tt=A(2),nt=A(3),rt=A(4),et=A(5),it=A(6),ot=N(!0),ut=N(!1),ct=I.values,ft=I.keys,at=I.entries,st=$.lastIndexOf,lt=$.reduce,ht=$.reduceRight,vt=$.join,pt=$.sort,dt=$.slice,yt=$.toString,gt=$.toLocaleString,bt=M("iterator"),mt=M("toStringTag"),xt=F("typed_constructor"),wt=F("def_constructor"),St=c.CONSTR,_t=c.TYPED,Ot=c.VIEW,Et="Wrong length!",Pt=A(1,function(t,n){return Tt(T(t,t[wt]),n)}),jt=o(function(){return 1===new q(new Uint16Array([1]).buffer)[0]}),Ft=!!q&&!!q[H].set&&o(function(){new q(1).set({})}),Mt=function(t,n){if(void 0===t)throw z(Et);var r=+t,e=d(t);if(n&&!m(r,e))throw V(Et);return e},At=function(t,n){var r=p(t);if(r<0||r%n)throw V("Wrong offset!");return r},Nt=function(t){if(w(t)&&_t in t)return t;throw z(t+" is not a typed array!")},Tt=function(t,n){if(!(w(t)&&xt in t))throw z("It is not a typed array constructor!");return new t(n)},It=function(t,n){return kt(T(t,t[wt]),n)},kt=function(t,n){for(var r=0,e=n.length,i=Tt(t,e);e>r;)i[r]=n[r++];return i},Lt=function(t,n,r){G(t,n,{get:function(){return this._d[r]}})},Rt=function(t){var n,r,e,i,o,u,c=S(t),f=arguments.length,s=f>1?arguments[1]:void 0,l=void 0!==s,h=j(c);if(void 0!=h&&!_(h)){for(u=h.call(c),e=[],n=0;!(o=u.next()).done;n++)e.push(o.value);c=e}for(l&&f>2&&(s=a(s,arguments[2],2)),n=0,r=d(c.length),i=Tt(this,r);r>n;n++)i[n]=l?s(c[n],n):c[n];return i},Ct=function(){for(var t=0,n=arguments.length,r=Tt(this,n);n>t;)r[t]=arguments[t++];return r},Dt=!!q&&o(function(){gt.call(new q(1))}),Ut=function(){return gt.apply(Dt?dt.call(Nt(this)):Nt(this),arguments)},Wt={copyWithin:function(t,n){return D.call(Nt(this),t,n,arguments.length>2?arguments[2]:void 0)},every:function(t){return rt(Nt(this),t,arguments.length>1?arguments[1]:void 0)},fill:function(t){return C.apply(Nt(this),arguments)},filter:function(t){return It(this,tt(Nt(this),t,arguments.length>1?arguments[1]:void 0))},find:function(t){return et(Nt(this),t,arguments.length>1?arguments[1]:void 0)},findIndex:function(t){return it(Nt(this),t,arguments.length>1?arguments[1]:void 0)},forEach:function(t){Z(Nt(this),t,arguments.length>1?arguments[1]:void 0)},indexOf:function(t){return ut(Nt(this),t,arguments.length>1?arguments[1]:void 0)},includes:function(t){return ot(Nt(this),t,arguments.length>1?arguments[1]:void 0)},join:function(t){return vt.apply(Nt(this),arguments)},lastIndexOf:function(t){return st.apply(Nt(this),arguments)},map:function(t){return Pt(Nt(this),t,arguments.length>1?arguments[1]:void 0)},reduce:function(t){return lt.apply(Nt(this),arguments)},reduceRight:function(t){return ht.apply(Nt(this),arguments)},reverse:function(){for(var t,n=this,r=Nt(n).length,e=Math.floor(r/2),i=0;i<e;)t=n[i],n[i++]=n[--r],n[r]=t;return n},some:function(t){return nt(Nt(this),t,arguments.length>1?arguments[1]:void 0)},sort:function(t){return pt.call(Nt(this),t)},subarray:function(t,n){var r=Nt(this),e=r.length,i=y(t,e);return new(T(r,r[wt]))(r.buffer,r.byteOffset+i*r.BYTES_PER_ELEMENT,d((void 0===n?e:y(n,e))-i))}},Gt=function(t,n){return It(this,dt.call(Nt(this),t,n))},Bt=function(t){Nt(this);var n=At(arguments[1],1),r=this.length,e=S(t),i=d(e.length),o=0;if(i+n>r)throw V(Et);for(;o<i;)this[n+o]=e[o++]},Vt={entries:function(){return at.call(Nt(this))},keys:function(){return ft.call(Nt(this))},values:function(){return ct.call(Nt(this))}},zt=function(t,n){return w(t)&&t[_t]&&"symbol"!=typeof n&&n in t&&String(+n)==String(n)},qt=function(t,n){return zt(t,n=g(n,!0))?l(2,t[n]):B(t,n)},Kt=function(t,n,r){return!(zt(t,n=g(n,!0))&&w(r)&&b(r,"value"))||b(r,"get")||b(r,"set")||r.configurable||b(r,"writable")&&!r.writable||b(r,"enumerable")&&!r.enumerable?G(t,n,r):(t[n]=r.value,t)};St||(W.f=qt,U.f=Kt),u(u.S+u.F*!St,"Object",{getOwnPropertyDescriptor:qt,defineProperty:Kt}),o(function(){yt.call({})})&&(yt=gt=function(){return vt.call(this)});var Jt=v({},Wt);v(Jt,Vt),h(Jt,bt,Vt.values),v(Jt,{slice:Gt,set:Bt,constructor:function(){},toString:yt,toLocaleString:Ut}),Lt(Jt,"buffer","b"),Lt(Jt,"byteOffset","o"),Lt(Jt,"byteLength","l"),Lt(Jt,"length","e"),G(Jt,mt,{get:function(){return this[_t]}}),t.exports=function(t,n,r,f){f=!!f;var a=t+(f?"Clamped":"")+"Array",l="Uint8Array"!=a,v="get"+t,p="set"+t,y=i[a],g=y||{},b=y&&E(y),m=!y||!c.ABV,S={},_=y&&y[H],j=function(t,r){var e=t._d;return e.v[v](r*n+e.o,jt)},F=function(t,r,e){var i=t._d;f&&(e=(e=Math.round(e))<0?0:e>255?255:255&e),i.v[p](r*n+i.o,e,jt)},M=function(t,n){G(t,n,{get:function(){return j(this,n)},set:function(t){return F(this,n,t)},enumerable:!0})};m?(y=r(function(t,r,e,i){s(t,y,a,"_d");var o,u,c,f,l=0,v=0;if(w(r)){if(!(r instanceof X||(f=x(r))==K||f==J))return _t in r?kt(y,r):Rt.call(y,r);o=r,v=At(e,n);var p=r.byteLength;if(void 0===i){if(p%n)throw V(Et);if((u=p-v)<0)throw V(Et)}else if((u=d(i)*n)+v>p)throw V(Et);c=u/n}else c=Mt(r,!0),u=c*n,o=new X(u);for(h(t,"_d",{b:o,o:v,l:u,e:c,v:new Q(o)});l<c;)M(t,l++)}),_=y[H]=O(Jt),h(_,"constructor",y)):L(function(t){new y(null),new y(t)},!0)||(y=r(function(t,r,e,i){s(t,y,a);var o;return w(r)?r instanceof X||(o=x(r))==K||o==J?void 0!==i?new g(r,At(e,n),i):void 0!==e?new g(r,At(e,n)):new g(r):_t in r?kt(y,r):Rt.call(y,r):new g(Mt(r,l))}),Z(b!==Function.prototype?P(g).concat(P(b)):P(g),function(t){t in y||h(y,t,g[t])}),y[H]=_,e||(_.constructor=y));var A=_[bt],N=!!A&&("values"==A.name||void 0==A.name),T=Vt.values;h(y,xt,!0),h(_,_t,a),h(_,Ot,!0),h(_,wt,y),(f?new y(1)[mt]==a:mt in _)||G(_,mt,{get:function(){return a}}),S[a]=y,u(u.G+u.W+u.F*(y!=g),S),u(u.S,a,{BYTES_PER_ELEMENT:n,from:Rt,of:Ct}),Y in _||h(_,Y,n),u(u.P,a,Wt),R(a),u(u.P+u.F*Ft,a,{set:Bt}),u(u.P+u.F*!N,a,Vt),u(u.P+u.F*(_.toString!=yt),a,{toString:yt}),u(u.P+u.F*o(function(){new y(1).slice()}),a,{slice:Gt}),u(u.P+u.F*(o(function(){return[1,2].toLocaleString()!=new y([1,2]).toLocaleString()})||!o(function(){_.toLocaleString.call([1,2])})),a,{toLocaleString:Ut}),k[a]=N?A:T,e||N||h(_,bt,T)}}else t.exports=function(){}},function(t,n){var r={}.toString;t.exports=function(t){return r.call(t).slice(8,-1)}},function(t,n,r){var e=r(21),i=r(5).document,o=e(i)&&e(i.createElement);t.exports=function(t){return o?i.createElement(t):{}}},function(t,n,r){t.exports=!r(12)&&!r(18)(function(){return 7!=Object.defineProperty(r(57)("div"),"a",{get:function(){return 7}}).a})},function(t,n,r){"use strict";var e=r(36),i=r(51),o=r(64),u=r(13),c=r(8),f=r(35),a=r(96),s=r(38),l=r(103),h=r(15)("iterator"),v=!([].keys&&"next"in[].keys()),p="keys",d="values",y=function(){return this};t.exports=function(t,n,r,g,b,m,x){a(r,n,g);var w,S,_,O=function(t){if(!v&&t in F)return F[t];switch(t){case p:case d:return function(){return new r(this,t)}}return function(){return new r(this,t)}},E=n+" Iterator",P=b==d,j=!1,F=t.prototype,M=F[h]||F["@@iterator"]||b&&F[b],A=M||O(b),N=b?P?O("entries"):A:void 0,T="Array"==n?F.entries||M:M;if(T&&(_=l(T.call(new t)))!==Object.prototype&&(s(_,E,!0),e||c(_,h)||u(_,h,y)),P&&M&&M.name!==d&&(j=!0,A=function(){return M.call(this)}),e&&!x||!v&&!j&&F[h]||u(F,h,A),f[n]=A,f[E]=y,b)if(w={values:P?A:O(d),keys:m?A:O(p),entries:N},x)for(S in w)S in F||o(F,S,w[S]);else i(i.P+i.F*(v||j),n,w);return w}},function(t,n,r){var e=r(20),i=r(100),o=r(34),u=r(39)("IE_PROTO"),c=function(){},f="prototype",a=function(){var t,n=r(57)("iframe"),e=o.length;for(n.style.display="none",r(93).appendChild(n),n.src="javascript:",t=n.contentWindow.document,t.open(),t.write("<script>document.F=Object<\/script>"),t.close(),a=t.F;e--;)delete a[f][o[e]];return a()};t.exports=Object.create||function(t,n){var r;return null!==t?(c[f]=e(t),r=new c,c[f]=null,r[u]=t):r=a(),void 0===n?r:i(r,n)}},function(t,n,r){var e=r(63),i=r(34).concat("length","prototype");n.f=Object.getOwnPropertyNames||function(t){return e(t,i)}},function(t,n){n.f=Object.getOwnPropertySymbols},function(t,n,r){var e=r(8),i=r(9),o=r(90)(!1),u=r(39)("IE_PROTO");t.exports=function(t,n){var r,c=i(t),f=0,a=[];for(r in c)r!=u&&e(c,r)&&a.push(r);for(;n.length>f;)e(c,r=n[f++])&&(~o(a,r)||a.push(r));return a}},function(t,n,r){t.exports=r(13)},function(t,n,r){var e=r(76)("meta"),i=r(6),o=r(24),u=r(11).f,c=0,f=Object.isExtensible||function(){return!0},a=!r(4)(function(){return f(Object.preventExtensions({}))}),s=function(t){u(t,e,{value:{i:"O"+ ++c,w:{}}})},l=function(t,n){if(!i(t))return"symbol"==typeof t?t:("string"==typeof t?"S":"P")+t;if(!o(t,e)){if(!f(t))return"F";if(!n)return"E";s(t)}return t[e].i},h=function(t,n){if(!o(t,e)){if(!f(t))return!0;if(!n)return!1;s(t)}return t[e].w},v=function(t){return a&&p.NEED&&f(t)&&!o(t,e)&&s(t),t},p=t.exports={KEY:e,NEED:!1,fastKey:l,getWeak:h,onFreeze:v}},function(t,n){t.exports=function(t,n){return{enumerable:!(1&t),configurable:!(2&t),writable:!(4&t),value:n}}},function(t,n){var r=Math.ceil,e=Math.floor;t.exports=function(t){return isNaN(t=+t)?0:(t>0?e:r)(t)}},function(t,n){t.exports=function(t,n,r,e){if(!(t instanceof n)||void 0!==e&&e in t)throw TypeError(r+": incorrect invocation!");return t}},function(t,n){t.exports=!1},function(t,n,r){var e=r(2),i=r(173),o=r(133),u=r(145)("IE_PROTO"),c=function(){},f="prototype",a=function(){var t,n=r(132)("iframe"),e=o.length;for(n.style.display="none",r(135).appendChild(n),n.src="javascript:",t=n.contentWindow.document,t.open(),t.write("<script>document.F=Object<\/script>"),t.close(),a=t.F;e--;)delete a[f][o[e]];return a()};t.exports=Object.create||function(t,n){var r;return null!==t?(c[f]=e(t),r=new c,c[f]=null,r[u]=t):r=a(),void 0===n?r:i(r,n)}},function(t,n,r){var e=r(175),i=r(133).concat("length","prototype");n.f=Object.getOwnPropertyNames||function(t){return e(t,i)}},function(t,n,r){var e=r(175),i=r(133);t.exports=Object.keys||function(t){return e(t,i)}},function(t,n,r){var e=r(28);t.exports=function(t,n,r){for(var i in n)e(t,i,n[i],r);return t}},function(t,n,r){"use strict";var e=r(3),i=r(11),o=r(10),u=r(7)("species");t.exports=function(t){var n=e[t];o&&n&&!n[u]&&i.f(n,u,{configurable:!0,get:function(){return this}})}},function(t,n,r){var e=r(67),i=Math.max,o=Math.min;t.exports=function(t,n){return t=e(t),t<0?i(t+n,0):o(t,n)}},function(t,n){var r=0,e=Math.random();t.exports=function(t){return"Symbol(".concat(void 0===t?"":t,")_",(++r+e).toString(36))}},function(t,n,r){var e=r(33);t.exports=function(t){return Object(e(t))}},function(t,n,r){var e=r(7)("unscopables"),i=Array.prototype;void 0==i[e]&&r(27)(i,e,{}),t.exports=function(t){i[e][t]=!0}},function(t,n,r){var e=r(53),i=r(169),o=r(137),u=r(2),c=r(16),f=r(154),a={},s={},n=t.exports=function(t,n,r,l,h){var v,p,d,y,g=h?function(){return t}:f(t),b=e(r,l,n?2:1),m=0;if("function"!=typeof g)throw TypeError(t+" is not iterable!");if(o(g)){for(v=c(t.length);v>m;m++)if((y=n?b(u(p=t[m])[0],p[1]):b(t[m]))===a||y===s)return y}else for(d=g.call(t);!(p=d.next()).done;)if((y=i(d,b,p.value,n))===a||y===s)return y};n.BREAK=a,n.RETURN=s},function(t,n){t.exports={}},function(t,n,r){var e=r(11).f,i=r(24),o=r(7)("toStringTag");t.exports=function(t,n,r){t&&!i(t=r?t:t.prototype,o)&&e(t,o,{configurable:!0,value:n})}},function(t,n,r){var e=r(1),i=r(46),o=r(4),u=r(150),c="["+u+"]",f="â€‹Â…",a=RegExp("^"+c+c+"*"),s=RegExp(c+c+"*$"),l=function(t,n,r){var i={},c=o(function(){return!!u[t]()||f[t]()!=f}),a=i[t]=c?n(h):u[t];r&&(i[r]=a),e(e.P+e.F*c,"String",i)},h=l.trim=function(t,n){return t=String(i(t)),1&n&&(t=t.replace(a,"")),2&n&&(t=t.replace(s,"")),t};t.exports=l},function(t,n,r){t.exports={default:r(86),__esModule:!0}},function(t,n,r){t.exports={default:r(87),__esModule:!0}},function(t,n,r){"use strict";function e(t){return t&&t.__esModule?t:{default:t}}n.__esModule=!0;var i=r(84),o=e(i),u=r(83),c=e(u),f="function"==typeof c.default&&"symbol"==typeof o.default?function(t){return typeof t}:function(t){return t&&"function"==typeof c.default&&t.constructor===c.default&&t!==c.default.prototype?"symbol":typeof t};n.default="function"==typeof c.default&&"symbol"===f(o.default)?function(t){return void 0===t?"undefined":f(t)}:function(t){return t&&"function"==typeof c.default&&t.constructor===c.default&&t!==c.default.prototype?"symbol":void 0===t?"undefined":f(t)}},function(t,n,r){r(110),r(108),r(111),r(112),t.exports=r(25).Symbol},function(t,n,r){r(109),r(113),t.exports=r(44).f("iterator")},function(t,n){t.exports=function(t){if("function"!=typeof t)throw TypeError(t+" is not a function!");return t}},function(t,n){t.exports=function(){}},function(t,n,r){var e=r(9),i=r(106),o=r(105);t.exports=function(t){return function(n,r,u){var c,f=e(n),a=i(f.length),s=o(u,a);if(t&&r!=r){for(;a>s;)if((c=f[s++])!=c)return!0}else for(;a>s;s++)if((t||s in f)&&f[s]===r)return t||s||0;return!t&&-1}}},function(t,n,r){var e=r(88);t.exports=function(t,n,r){if(e(t),void 0===n)return t;switch(r){case 1:return function(r){return t.call(n,r)};case 2:return function(r,e){return t.call(n,r,e)};case 3:return function(r,e,i){return t.call(n,r,e,i)}}return function(){return t.apply(n,arguments)}}},function(t,n,r){var e=r(19),i=r(62),o=r(37);t.exports=function(t){var n=e(t),r=i.f;if(r)for(var u,c=r(t),f=o.f,a=0;c.length>a;)f.call(t,u=c[a++])&&n.push(u);return n}},function(t,n,r){t.exports=r(5).document&&document.documentElement},function(t,n,r){var e=r(56);t.exports=Object("z").propertyIsEnumerable(0)?Object:function(t){return"String"==e(t)?t.split(""):Object(t)}},function(t,n,r){var e=r(56);t.exports=Array.isArray||function(t){return"Array"==e(t)}},function(t,n,r){"use strict";var e=r(60),i=r(22),o=r(38),u={};r(13)(u,r(15)("iterator"),function(){return this}),t.exports=function(t,n,r){t.prototype=e(u,{next:i(1,r)}),o(t,n+" Iterator")}},function(t,n){t.exports=function(t,n){return{value:n,done:!!t}}},function(t,n,r){var e=r(19),i=r(9);t.exports=function(t,n){for(var r,o=i(t),u=e(o),c=u.length,f=0;c>f;)if(o[r=u[f++]]===n)return r}},function(t,n,r){var e=r(23)("meta"),i=r(21),o=r(8),u=r(14).f,c=0,f=Object.isExtensible||function(){return!0},a=!r(18)(function(){return f(Object.preventExtensions({}))}),s=function(t){u(t,e,{value:{i:"O"+ ++c,w:{}}})},l=function(t,n){if(!i(t))return"symbol"==typeof t?t:("string"==typeof t?"S":"P")+t;if(!o(t,e)){if(!f(t))return"F";if(!n)return"E";s(t)}return t[e].i},h=function(t,n){if(!o(t,e)){if(!f(t))return!0;if(!n)return!1;s(t)}return t[e].w},v=function(t){return a&&p.NEED&&f(t)&&!o(t,e)&&s(t),t},p=t.exports={KEY:e,NEED:!1,fastKey:l,getWeak:h,onFreeze:v}},function(t,n,r){var e=r(14),i=r(20),o=r(19);t.exports=r(12)?Object.defineProperties:function(t,n){i(t);for(var r,u=o(n),c=u.length,f=0;c>f;)e.f(t,r=u[f++],n[r]);return t}},function(t,n,r){var e=r(37),i=r(22),o=r(9),u=r(42),c=r(8),f=r(58),a=Object.getOwnPropertyDescriptor;n.f=r(12)?a:function(t,n){if(t=o(t),n=u(n,!0),f)try{return a(t,n)}catch(t){}if(c(t,n))return i(!e.f.call(t,n),t[n])}},function(t,n,r){var e=r(9),i=r(61).f,o={}.toString,u="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[],c=function(t){try{return i(t)}catch(t){return u.slice()}};t.exports.f=function(t){return u&&"[object Window]"==o.call(t)?c(t):i(e(t))}},function(t,n,r){var e=r(8),i=r(77),o=r(39)("IE_PROTO"),u=Object.prototype;t.exports=Object.getPrototypeOf||function(t){return t=i(t),e(t,o)?t[o]:"function"==typeof t.constructor&&t instanceof t.constructor?t.constructor.prototype:t instanceof Object?u:null}},function(t,n,r){var e=r(41),i=r(33);t.exports=function(t){return function(n,r){var o,u,c=String(i(n)),f=e(r),a=c.length;return f<0||f>=a?t?"":void 0:(o=c.charCodeAt(f),o<55296||o>56319||f+1===a||(u=c.charCodeAt(f+1))<56320||u>57343?t?c.charAt(f):o:t?c.slice(f,f+2):u-56320+(o-55296<<10)+65536)}}},function(t,n,r){var e=r(41),i=Math.max,o=Math.min;t.exports=function(t,n){return t=e(t),t<0?i(t+n,0):o(t,n)}},function(t,n,r){var e=r(41),i=Math.min;t.exports=function(t){return t>0?i(e(t),9007199254740991):0}},function(t,n,r){"use strict";var e=r(89),i=r(97),o=r(35),u=r(9);t.exports=r(59)(Array,"Array",function(t,n){this._t=u(t),this._i=0,this._k=n},function(){var t=this._t,n=this._k,r=this._i++;return!t||r>=t.length?(this._t=void 0,i(1)):"keys"==n?i(0,r):"values"==n?i(0,t[r]):i(0,[r,t[r]])},"values"),o.Arguments=o.Array,e("keys"),e("values"),e("entries")},function(t,n){},function(t,n,r){"use strict";var e=r(104)(!0);r(59)(String,"String",function(t){this._t=String(t),this._i=0},function(){var t,n=this._t,r=this._i;return r>=n.length?{value:void 0,done:!0}:(t=e(n,r),this._i+=t.length,{value:t,done:!1})})},function(t,n,r){"use strict";var e=r(5),i=r(8),o=r(12),u=r(51),c=r(64),f=r(99).KEY,a=r(18),s=r(40),l=r(38),h=r(23),v=r(15),p=r(44),d=r(43),y=r(98),g=r(92),b=r(95),m=r(20),x=r(9),w=r(42),S=r(22),_=r(60),O=r(102),E=r(101),P=r(14),j=r(19),F=E.f,M=P.f,A=O.f,N=e.Symbol,T=e.JSON,I=T&&T.stringify,k="prototype",L=v("_hidden"),R=v("toPrimitive"),C={}.propertyIsEnumerable,D=s("symbol-registry"),U=s("symbols"),W=s("op-symbols"),G=Object[k],B="function"==typeof N,V=e.QObject,z=!V||!V[k]||!V[k].findChild,q=o&&a(function(){return 7!=_(M({},"a",{get:function(){return M(this,"a",{value:7}).a}})).a})?function(t,n,r){var e=F(G,n);e&&delete G[n],M(t,n,r),e&&t!==G&&M(G,n,e)}:M,K=function(t){var n=U[t]=_(N[k]);return n._k=t,n},J=B&&"symbol"==typeof N.iterator?function(t){return"symbol"==typeof t}:function(t){return t instanceof N},Y=function(t,n,r){return t===G&&Y(W,n,r),m(t),n=w(n,!0),m(r),i(U,n)?(r.enumerable?(i(t,L)&&t[L][n]&&(t[L][n]=!1),r=_(r,{enumerable:S(0,!1)})):(i(t,L)||M(t,L,S(1,{})),t[L][n]=!0),q(t,n,r)):M(t,n,r)},H=function(t,n){m(t);for(var r,e=g(n=x(n)),i=0,o=e.length;o>i;)Y(t,r=e[i++],n[r]);return t},$=function(t,n){return void 0===n?_(t):H(_(t),n)},X=function(t){var n=C.call(this,t=w(t,!0));return!(this===G&&i(U,t)&&!i(W,t))&&(!(n||!i(this,t)||!i(U,t)||i(this,L)&&this[L][t])||n)},Q=function(t,n){if(t=x(t),n=w(n,!0),t!==G||!i(U,n)||i(W,n)){var r=F(t,n);return!r||!i(U,n)||i(t,L)&&t[L][n]||(r.enumerable=!0),r}},Z=function(t){for(var n,r=A(x(t)),e=[],o=0;r.length>o;)i(U,n=r[o++])||n==L||n==f||e.push(n);return e},tt=function(t){for(var n,r=t===G,e=A(r?W:x(t)),o=[],u=0;e.length>u;)!i(U,n=e[u++])||r&&!i(G,n)||o.push(U[n]);return o};B||(N=function(){if(this instanceof N)throw TypeError("Symbol is not a constructor!");var t=h(arguments.length>0?arguments[0]:void 0),n=function(r){this===G&&n.call(W,r),i(this,L)&&i(this[L],t)&&(this[L][t]=!1),q(this,t,S(1,r))};return o&&z&&q(G,t,{configurable:!0,set:n}),K(t)},c(N[k],"toString",function(){return this._k}),E.f=Q,P.f=Y,r(61).f=O.f=Z,r(37).f=X,r(62).f=tt,o&&!r(36)&&c(G,"propertyIsEnumerable",X,!0),p.f=function(t){return K(v(t))}),u(u.G+u.W+u.F*!B,{Symbol:N});for(var nt="hasInstance,isConcatSpreadable,iterator,match,replace,search,species,split,toPrimitive,toStringTag,unscopables".split(","),rt=0;nt.length>rt;)v(nt[rt++]);for(var nt=j(v.store),rt=0;nt.length>rt;)d(nt[rt++]);u(u.S+u.F*!B,"Symbol",{for:function(t){return i(D,t+="")?D[t]:D[t]=N(t)},keyFor:function(t){if(J(t))return y(D,t);throw TypeError(t+" is not a symbol!")},useSetter:function(){z=!0},useSimple:function(){z=!1}}),u(u.S+u.F*!B,"Object",{create:$,defineProperty:Y,defineProperties:H,getOwnPropertyDescriptor:Q,getOwnPropertyNames:Z,getOwnPropertySymbols:tt}),T&&u(u.S+u.F*(!B||a(function(){var t=N();return"[null]"!=I([t])||"{}"!=I({a:t})||"{}"!=I(Object(t))})),"JSON",{stringify:function(t){if(void 0!==t&&!J(t)){for(var n,r,e=[t],i=1;arguments.length>i;)e.push(arguments[i++]);return n=e[1],"function"==typeof n&&(r=n),!r&&b(n)||(n=function(t,n){if(r&&(n=r.call(this,t,n)),!J(n))return n}),e[1]=n,I.apply(T,e)}}}),N[k][R]||r(13)(N[k],R,N[k].valueOf),l(N,"Symbol"),l(Math,"Math",!0),l(e.JSON,"JSON",!0)},function(t,n,r){r(43)("asyncIterator")},function(t,n,r){r(43)("observable")},function(t,n,r){r(107);for(var e=r(5),i=r(13),o=r(35),u=r(15)("toStringTag"),c=["NodeList","DOMTokenList","MediaList","StyleSheetList","CSSRuleList"],f=0;f<5;f++){var a=c[f],s=e[a],l=s&&s.prototype;l&&!l[u]&&i(l,u,a),o[a]=o.Array}},function(t,n,r){var e=r(45),i=r(7)("toStringTag"),o="Arguments"==e(function(){return arguments}()),u=function(t,n){try{return t[n]}catch(t){}};t.exports=function(t){var n,r,c;return void 0===t?"Undefined":null===t?"Null":"string"==typeof(r=u(n=Object(t),i))?r:o?e(n):"Object"==(c=e(n))&&"function"==typeof n.callee?"Arguments":c}},function(t,n,r){var e=r(45);t.exports=Object("z").propertyIsEnumerable(0)?Object:function(t){return"String"==e(t)?t.split(""):Object(t)}},function(t,n){n.f={}.propertyIsEnumerable},function(t,n,r){var e=r(30),i=r(16),o=r(75);t.exports=function(t){return function(n,r,u){var c,f=e(n),a=i(f.length),s=o(u,a);if(t&&r!=r){for(;a>s;)if((c=f[s++])!=c)return!0}else for(;a>s;s++)if((t||s in f)&&f[s]===r)return t||s||0;return!t&&-1}}},function(t,n,r){"use strict";var e=r(3),i=r(1),o=r(28),u=r(73),c=r(65),f=r(79),a=r(68),s=r(6),l=r(4),h=r(123),v=r(81),p=r(136);t.exports=function(t,n,r,d,y,g){var b=e[t],m=b,x=y?"set":"add",w=m&&m.prototype,S={},_=function(t){var n=w[t];o(w,t,"delete"==t?function(t){return!(g&&!s(t))&&n.call(this,0===t?0:t)}:"has"==t?function(t){return!(g&&!s(t))&&n.call(this,0===t?0:t)}:"get"==t?function(t){return g&&!s(t)?void 0:n.call(this,0===t?0:t)}:"add"==t?function(t){return n.call(this,0===t?0:t),this}:function(t,r){return n.call(this,0===t?0:t,r),this})};if("function"==typeof m&&(g||w.forEach&&!l(function(){(new m).entries().next()}))){var O=new m,E=O[x](g?{}:-0,1)!=O,P=l(function(){O.has(1)}),j=h(function(t){new m(t)}),F=!g&&l(function(){for(var t=new m,n=5;n--;)t[x](n,n);return!t.has(-0)});j||(m=n(function(n,r){a(n,m,t);var e=p(new b,n,m);return void 0!=r&&f(r,y,e[x],e),e}),m.prototype=w,w.constructor=m),(P||F)&&(_("delete"),_("has"),y&&_("get")),(F||E)&&_(x),g&&w.clear&&delete w.clear}else m=d.getConstructor(n,t,y,x),u(m.prototype,r),c.NEED=!0;return v(m,t),S[t]=m,i(i.G+i.W+i.F*(m!=b),S),g||d.setStrong(m,t,y),m}},function(t,n,r){"use strict";var e=r(27),i=r(28),o=r(4),u=r(46),c=r(7);t.exports=function(t,n,r){var f=c(t),a=r(u,f,""[t]),s=a[0],l=a[1];o(function(){var n={};return n[f]=function(){return 7},7!=""[t](n)})&&(i(String.prototype,t,s),e(RegExp.prototype,f,2==n?function(t,n){return l.call(t,this,n)}:function(t){return l.call(t,this)}))}
},function(t,n,r){"use strict";var e=r(2);t.exports=function(){var t=e(this),n="";return t.global&&(n+="g"),t.ignoreCase&&(n+="i"),t.multiline&&(n+="m"),t.unicode&&(n+="u"),t.sticky&&(n+="y"),n}},function(t,n){t.exports=function(t,n,r){var e=void 0===r;switch(n.length){case 0:return e?t():t.call(r);case 1:return e?t(n[0]):t.call(r,n[0]);case 2:return e?t(n[0],n[1]):t.call(r,n[0],n[1]);case 3:return e?t(n[0],n[1],n[2]):t.call(r,n[0],n[1],n[2]);case 4:return e?t(n[0],n[1],n[2],n[3]):t.call(r,n[0],n[1],n[2],n[3])}return t.apply(r,n)}},function(t,n,r){var e=r(6),i=r(45),o=r(7)("match");t.exports=function(t){var n;return e(t)&&(void 0!==(n=t[o])?!!n:"RegExp"==i(t))}},function(t,n,r){var e=r(7)("iterator"),i=!1;try{var o=[7][e]();o.return=function(){i=!0},Array.from(o,function(){throw 2})}catch(t){}t.exports=function(t,n){if(!n&&!i)return!1;var r=!1;try{var o=[7],u=o[e]();u.next=function(){return{done:r=!0}},o[e]=function(){return u},t(o)}catch(t){}return r}},function(t,n,r){t.exports=r(69)||!r(4)(function(){var t=Math.random();__defineSetter__.call(null,t,function(){}),delete r(3)[t]})},function(t,n){n.f=Object.getOwnPropertySymbols},function(t,n,r){var e=r(3),i="__core-js_shared__",o=e[i]||(e[i]={});t.exports=function(t){return o[t]||(o[t]={})}},function(t,n,r){for(var e,i=r(3),o=r(27),u=r(76),c=u("typed_array"),f=u("view"),a=!(!i.ArrayBuffer||!i.DataView),s=a,l=0,h="Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array".split(",");l<9;)(e=i[h[l++]])?(o(e.prototype,c,!0),o(e.prototype,f,!0)):s=!1;t.exports={ABV:a,CONSTR:s,TYPED:c,VIEW:f}},function(t,n){"use strict";var r={versions:function(){var t=window.navigator.userAgent;return{trident:t.indexOf("Trident")>-1,presto:t.indexOf("Presto")>-1,webKit:t.indexOf("AppleWebKit")>-1,gecko:t.indexOf("Gecko")>-1&&-1==t.indexOf("KHTML"),mobile:!!t.match(/AppleWebKit.*Mobile.*/),ios:!!t.match(/\(i[^;]+;( U;)? CPU.+Mac OS X/),android:t.indexOf("Android")>-1||t.indexOf("Linux")>-1,iPhone:t.indexOf("iPhone")>-1||t.indexOf("Mac")>-1,iPad:t.indexOf("iPad")>-1,webApp:-1==t.indexOf("Safari"),weixin:-1==t.indexOf("MicroMessenger")}}()};t.exports=r},function(t,n,r){"use strict";var e=r(85),i=function(t){return t&&t.__esModule?t:{default:t}}(e),o=function(){function t(t,n,e){return n||e?String.fromCharCode(n||e):r[t]||t}function n(t){return e[t]}var r={"&quot;":'"',"&lt;":"<","&gt;":">","&amp;":"&","&nbsp;":" "},e={};for(var u in r)e[r[u]]=u;return r["&apos;"]="'",e["'"]="&#39;",{encode:function(t){return t?(""+t).replace(/['<> "&]/g,n).replace(/\r?\n/g,"<br/>").replace(/\s/g,"&nbsp;"):""},decode:function(n){return n?(""+n).replace(/<br\s*\/?>/gi,"\n").replace(/&quot;|&lt;|&gt;|&amp;|&nbsp;|&apos;|&#(\d+);|&#(\d+)/g,t).replace(/\u00a0/g," "):""},encodeBase16:function(t){if(!t)return t;t+="";for(var n=[],r=0,e=t.length;e>r;r++)n.push(t.charCodeAt(r).toString(16).toUpperCase());return n.join("")},encodeBase16forJSON:function(t){if(!t)return t;t=t.replace(/[\u4E00-\u9FBF]/gi,function(t){return escape(t).replace("%u","\\u")});for(var n=[],r=0,e=t.length;e>r;r++)n.push(t.charCodeAt(r).toString(16).toUpperCase());return n.join("")},decodeBase16:function(t){if(!t)return t;t+="";for(var n=[],r=0,e=t.length;e>r;r+=2)n.push(String.fromCharCode("0x"+t.slice(r,r+2)));return n.join("")},encodeObject:function(t){if(t instanceof Array)for(var n=0,r=t.length;r>n;n++)t[n]=o.encodeObject(t[n]);else if("object"==(void 0===t?"undefined":(0,i.default)(t)))for(var e in t)t[e]=o.encodeObject(t[e]);else if("string"==typeof t)return o.encode(t);return t},loadScript:function(t){var n=document.createElement("script");document.getElementsByTagName("body")[0].appendChild(n),n.setAttribute("src",t)},addLoadEvent:function(t){var n=window.onload;"function"!=typeof window.onload?window.onload=t:window.onload=function(){n(),t()}}}}();t.exports=o},function(t,n,r){"use strict";var e=r(17),i=r(75),o=r(16);t.exports=function(t){for(var n=e(this),r=o(n.length),u=arguments.length,c=i(u>1?arguments[1]:void 0,r),f=u>2?arguments[2]:void 0,a=void 0===f?r:i(f,r);a>c;)n[c++]=t;return n}},function(t,n,r){"use strict";var e=r(11),i=r(66);t.exports=function(t,n,r){n in t?e.f(t,n,i(0,r)):t[n]=r}},function(t,n,r){var e=r(6),i=r(3).document,o=e(i)&&e(i.createElement);t.exports=function(t){return o?i.createElement(t):{}}},function(t,n){t.exports="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(",")},function(t,n,r){var e=r(7)("match");t.exports=function(t){var n=/./;try{"/./"[t](n)}catch(r){try{return n[e]=!1,!"/./"[t](n)}catch(t){}}return!0}},function(t,n,r){t.exports=r(3).document&&document.documentElement},function(t,n,r){var e=r(6),i=r(144).set;t.exports=function(t,n,r){var o,u=n.constructor;return u!==r&&"function"==typeof u&&(o=u.prototype)!==r.prototype&&e(o)&&i&&i(t,o),t}},function(t,n,r){var e=r(80),i=r(7)("iterator"),o=Array.prototype;t.exports=function(t){return void 0!==t&&(e.Array===t||o[i]===t)}},function(t,n,r){var e=r(45);t.exports=Array.isArray||function(t){return"Array"==e(t)}},function(t,n,r){"use strict";var e=r(70),i=r(66),o=r(81),u={};r(27)(u,r(7)("iterator"),function(){return this}),t.exports=function(t,n,r){t.prototype=e(u,{next:i(1,r)}),o(t,n+" Iterator")}},function(t,n,r){"use strict";var e=r(69),i=r(1),o=r(28),u=r(27),c=r(24),f=r(80),a=r(139),s=r(81),l=r(32),h=r(7)("iterator"),v=!([].keys&&"next"in[].keys()),p="keys",d="values",y=function(){return this};t.exports=function(t,n,r,g,b,m,x){a(r,n,g);var w,S,_,O=function(t){if(!v&&t in F)return F[t];switch(t){case p:case d:return function(){return new r(this,t)}}return function(){return new r(this,t)}},E=n+" Iterator",P=b==d,j=!1,F=t.prototype,M=F[h]||F["@@iterator"]||b&&F[b],A=M||O(b),N=b?P?O("entries"):A:void 0,T="Array"==n?F.entries||M:M;if(T&&(_=l(T.call(new t)))!==Object.prototype&&(s(_,E,!0),e||c(_,h)||u(_,h,y)),P&&M&&M.name!==d&&(j=!0,A=function(){return M.call(this)}),e&&!x||!v&&!j&&F[h]||u(F,h,A),f[n]=A,f[E]=y,b)if(w={values:P?A:O(d),keys:m?A:O(p),entries:N},x)for(S in w)S in F||o(F,S,w[S]);else i(i.P+i.F*(v||j),n,w);return w}},function(t,n){var r=Math.expm1;t.exports=!r||r(10)>22025.465794806718||r(10)<22025.465794806718||-2e-17!=r(-2e-17)?function(t){return 0==(t=+t)?t:t>-1e-6&&t<1e-6?t+t*t/2:Math.exp(t)-1}:r},function(t,n){t.exports=Math.sign||function(t){return 0==(t=+t)||t!=t?t:t<0?-1:1}},function(t,n,r){var e=r(3),i=r(151).set,o=e.MutationObserver||e.WebKitMutationObserver,u=e.process,c=e.Promise,f="process"==r(45)(u);t.exports=function(){var t,n,r,a=function(){var e,i;for(f&&(e=u.domain)&&e.exit();t;){i=t.fn,t=t.next;try{i()}catch(e){throw t?r():n=void 0,e}}n=void 0,e&&e.enter()};if(f)r=function(){u.nextTick(a)};else if(o){var s=!0,l=document.createTextNode("");new o(a).observe(l,{characterData:!0}),r=function(){l.data=s=!s}}else if(c&&c.resolve){var h=c.resolve();r=function(){h.then(a)}}else r=function(){i.call(e,a)};return function(e){var i={fn:e,next:void 0};n&&(n.next=i),t||(t=i,r()),n=i}}},function(t,n,r){var e=r(6),i=r(2),o=function(t,n){if(i(t),!e(n)&&null!==n)throw TypeError(n+": can't set as prototype!")};t.exports={set:Object.setPrototypeOf||("__proto__"in{}?function(t,n,e){try{e=r(53)(Function.call,r(31).f(Object.prototype,"__proto__").set,2),e(t,[]),n=!(t instanceof Array)}catch(t){n=!0}return function(t,r){return o(t,r),n?t.__proto__=r:e(t,r),t}}({},!1):void 0),check:o}},function(t,n,r){var e=r(126)("keys"),i=r(76);t.exports=function(t){return e[t]||(e[t]=i(t))}},function(t,n,r){var e=r(2),i=r(26),o=r(7)("species");t.exports=function(t,n){var r,u=e(t).constructor;return void 0===u||void 0==(r=e(u)[o])?n:i(r)}},function(t,n,r){var e=r(67),i=r(46);t.exports=function(t){return function(n,r){var o,u,c=String(i(n)),f=e(r),a=c.length;return f<0||f>=a?t?"":void 0:(o=c.charCodeAt(f),o<55296||o>56319||f+1===a||(u=c.charCodeAt(f+1))<56320||u>57343?t?c.charAt(f):o:t?c.slice(f,f+2):u-56320+(o-55296<<10)+65536)}}},function(t,n,r){var e=r(122),i=r(46);t.exports=function(t,n,r){if(e(n))throw TypeError("String#"+r+" doesn't accept regex!");return String(i(t))}},function(t,n,r){"use strict";var e=r(67),i=r(46);t.exports=function(t){var n=String(i(this)),r="",o=e(t);if(o<0||o==1/0)throw RangeError("Count can't be negative");for(;o>0;(o>>>=1)&&(n+=n))1&o&&(r+=n);return r}},function(t,n){t.exports="\t\n\v\f\r Â áš€á â€€â€â€‚â€ƒâ€„â€…â€†â€‡â€ˆâ€‰â€Šâ€¯âŸã€€\u2028\u2029\ufeff"},function(t,n,r){var e,i,o,u=r(53),c=r(121),f=r(135),a=r(132),s=r(3),l=s.process,h=s.setImmediate,v=s.clearImmediate,p=s.MessageChannel,d=0,y={},g="onreadystatechange",b=function(){var t=+this;if(y.hasOwnProperty(t)){var n=y[t];delete y[t],n()}},m=function(t){b.call(t.data)};h&&v||(h=function(t){for(var n=[],r=1;arguments.length>r;)n.push(arguments[r++]);return y[++d]=function(){c("function"==typeof t?t:Function(t),n)},e(d),d},v=function(t){delete y[t]},"process"==r(45)(l)?e=function(t){l.nextTick(u(b,t,1))}:p?(i=new p,o=i.port2,i.port1.onmessage=m,e=u(o.postMessage,o,1)):s.addEventListener&&"function"==typeof postMessage&&!s.importScripts?(e=function(t){s.postMessage(t+"","*")},s.addEventListener("message",m,!1)):e=g in a("script")?function(t){f.appendChild(a("script"))[g]=function(){f.removeChild(this),b.call(t)}}:function(t){setTimeout(u(b,t,1),0)}),t.exports={set:h,clear:v}},function(t,n,r){"use strict";var e=r(3),i=r(10),o=r(69),u=r(127),c=r(27),f=r(73),a=r(4),s=r(68),l=r(67),h=r(16),v=r(71).f,p=r(11).f,d=r(130),y=r(81),g="ArrayBuffer",b="DataView",m="prototype",x="Wrong length!",w="Wrong index!",S=e[g],_=e[b],O=e.Math,E=e.RangeError,P=e.Infinity,j=S,F=O.abs,M=O.pow,A=O.floor,N=O.log,T=O.LN2,I="buffer",k="byteLength",L="byteOffset",R=i?"_b":I,C=i?"_l":k,D=i?"_o":L,U=function(t,n,r){var e,i,o,u=Array(r),c=8*r-n-1,f=(1<<c)-1,a=f>>1,s=23===n?M(2,-24)-M(2,-77):0,l=0,h=t<0||0===t&&1/t<0?1:0;for(t=F(t),t!=t||t===P?(i=t!=t?1:0,e=f):(e=A(N(t)/T),t*(o=M(2,-e))<1&&(e--,o*=2),t+=e+a>=1?s/o:s*M(2,1-a),t*o>=2&&(e++,o/=2),e+a>=f?(i=0,e=f):e+a>=1?(i=(t*o-1)*M(2,n),e+=a):(i=t*M(2,a-1)*M(2,n),e=0));n>=8;u[l++]=255&i,i/=256,n-=8);for(e=e<<n|i,c+=n;c>0;u[l++]=255&e,e/=256,c-=8);return u[--l]|=128*h,u},W=function(t,n,r){var e,i=8*r-n-1,o=(1<<i)-1,u=o>>1,c=i-7,f=r-1,a=t[f--],s=127&a;for(a>>=7;c>0;s=256*s+t[f],f--,c-=8);for(e=s&(1<<-c)-1,s>>=-c,c+=n;c>0;e=256*e+t[f],f--,c-=8);if(0===s)s=1-u;else{if(s===o)return e?NaN:a?-P:P;e+=M(2,n),s-=u}return(a?-1:1)*e*M(2,s-n)},G=function(t){return t[3]<<24|t[2]<<16|t[1]<<8|t[0]},B=function(t){return[255&t]},V=function(t){return[255&t,t>>8&255]},z=function(t){return[255&t,t>>8&255,t>>16&255,t>>24&255]},q=function(t){return U(t,52,8)},K=function(t){return U(t,23,4)},J=function(t,n,r){p(t[m],n,{get:function(){return this[r]}})},Y=function(t,n,r,e){var i=+r,o=l(i);if(i!=o||o<0||o+n>t[C])throw E(w);var u=t[R]._b,c=o+t[D],f=u.slice(c,c+n);return e?f:f.reverse()},H=function(t,n,r,e,i,o){var u=+r,c=l(u);if(u!=c||c<0||c+n>t[C])throw E(w);for(var f=t[R]._b,a=c+t[D],s=e(+i),h=0;h<n;h++)f[a+h]=s[o?h:n-h-1]},$=function(t,n){s(t,S,g);var r=+n,e=h(r);if(r!=e)throw E(x);return e};if(u.ABV){if(!a(function(){new S})||!a(function(){new S(.5)})){S=function(t){return new j($(this,t))};for(var X,Q=S[m]=j[m],Z=v(j),tt=0;Z.length>tt;)(X=Z[tt++])in S||c(S,X,j[X]);o||(Q.constructor=S)}var nt=new _(new S(2)),rt=_[m].setInt8;nt.setInt8(0,2147483648),nt.setInt8(1,2147483649),!nt.getInt8(0)&&nt.getInt8(1)||f(_[m],{setInt8:function(t,n){rt.call(this,t,n<<24>>24)},setUint8:function(t,n){rt.call(this,t,n<<24>>24)}},!0)}else S=function(t){var n=$(this,t);this._b=d.call(Array(n),0),this[C]=n},_=function(t,n,r){s(this,_,b),s(t,S,b);var e=t[C],i=l(n);if(i<0||i>e)throw E("Wrong offset!");if(r=void 0===r?e-i:h(r),i+r>e)throw E(x);this[R]=t,this[D]=i,this[C]=r},i&&(J(S,k,"_l"),J(_,I,"_b"),J(_,k,"_l"),J(_,L,"_o")),f(_[m],{getInt8:function(t){return Y(this,1,t)[0]<<24>>24},getUint8:function(t){return Y(this,1,t)[0]},getInt16:function(t){var n=Y(this,2,t,arguments[1]);return(n[1]<<8|n[0])<<16>>16},getUint16:function(t){var n=Y(this,2,t,arguments[1]);return n[1]<<8|n[0]},getInt32:function(t){return G(Y(this,4,t,arguments[1]))},getUint32:function(t){return G(Y(this,4,t,arguments[1]))>>>0},getFloat32:function(t){return W(Y(this,4,t,arguments[1]),23,4)},getFloat64:function(t){return W(Y(this,8,t,arguments[1]),52,8)},setInt8:function(t,n){H(this,1,t,B,n)},setUint8:function(t,n){H(this,1,t,B,n)},setInt16:function(t,n){H(this,2,t,V,n,arguments[2])},setUint16:function(t,n){H(this,2,t,V,n,arguments[2])},setInt32:function(t,n){H(this,4,t,z,n,arguments[2])},setUint32:function(t,n){H(this,4,t,z,n,arguments[2])},setFloat32:function(t,n){H(this,4,t,K,n,arguments[2])},setFloat64:function(t,n){H(this,8,t,q,n,arguments[2])}});y(S,g),y(_,b),c(_[m],u.VIEW,!0),n[g]=S,n[b]=_},function(t,n,r){var e=r(3),i=r(52),o=r(69),u=r(182),c=r(11).f;t.exports=function(t){var n=i.Symbol||(i.Symbol=o?{}:e.Symbol||{});"_"==t.charAt(0)||t in n||c(n,t,{value:u.f(t)})}},function(t,n,r){var e=r(114),i=r(7)("iterator"),o=r(80);t.exports=r(52).getIteratorMethod=function(t){if(void 0!=t)return t[i]||t["@@iterator"]||o[e(t)]}},function(t,n,r){"use strict";var e=r(78),i=r(170),o=r(80),u=r(30);t.exports=r(140)(Array,"Array",function(t,n){this._t=u(t),this._i=0,this._k=n},function(){var t=this._t,n=this._k,r=this._i++;return!t||r>=t.length?(this._t=void 0,i(1)):"keys"==n?i(0,r):"values"==n?i(0,t[r]):i(0,[r,t[r]])},"values"),o.Arguments=o.Array,e("keys"),e("values"),e("entries")},function(t,n){function r(t,n){t.classList?t.classList.add(n):t.className+=" "+n}t.exports=r},function(t,n){function r(t,n){if(t.classList)t.classList.remove(n);else{var r=new RegExp("(^|\\b)"+n.split(" ").join("|")+"(\\b|$)","gi");t.className=t.className.replace(r," ")}}t.exports=r},function(t,n){function r(){throw new Error("setTimeout has not been defined")}function e(){throw new Error("clearTimeout has not been defined")}function i(t){if(s===setTimeout)return setTimeout(t,0);if((s===r||!s)&&setTimeout)return s=setTimeout,setTimeout(t,0);try{return s(t,0)}catch(n){try{return s.call(null,t,0)}catch(n){return s.call(this,t,0)}}}function o(t){if(l===clearTimeout)return clearTimeout(t);if((l===e||!l)&&clearTimeout)return l=clearTimeout,clearTimeout(t);try{return l(t)}catch(n){try{return l.call(null,t)}catch(n){return l.call(this,t)}}}function u(){d&&v&&(d=!1,v.length?p=v.concat(p):y=-1,p.length&&c())}function c(){if(!d){var t=i(u);d=!0;for(var n=p.length;n;){for(v=p,p=[];++y<n;)v&&v[y].run();y=-1,n=p.length}v=null,d=!1,o(t)}}function f(t,n){this.fun=t,this.array=n}function a(){}var s,l,h=t.exports={};!function(){try{s="function"==typeof setTimeout?setTimeout:r}catch(t){s=r}try{l="function"==typeof clearTimeout?clearTimeout:e}catch(t){l=e}}();var v,p=[],d=!1,y=-1;h.nextTick=function(t){var n=new Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)n[r-1]=arguments[r];p.push(new f(t,n)),1!==p.length||d||i(c)},f.prototype.run=function(){this.fun.apply(null,this.array)},h.title="browser",h.browser=!0,h.env={},h.argv=[],h.version="",h.versions={},h.on=a,h.addListener=a,h.once=a,h.off=a,h.removeListener=a,h.removeAllListeners=a,h.emit=a,h.prependListener=a,h.prependOnceListener=a,h.listeners=function(t){return[]},h.binding=function(t){throw new Error("process.binding is not supported")},h.cwd=function(){return"/"},h.chdir=function(t){throw new Error("process.chdir is not supported")},h.umask=function(){return 0}},function(t,n,r){var e=r(45);t.exports=function(t,n){if("number"!=typeof t&&"Number"!=e(t))throw TypeError(n);return+t}},function(t,n,r){"use strict";var e=r(17),i=r(75),o=r(16);t.exports=[].copyWithin||function(t,n){var r=e(this),u=o(r.length),c=i(t,u),f=i(n,u),a=arguments.length>2?arguments[2]:void 0,s=Math.min((void 0===a?u:i(a,u))-f,u-c),l=1;for(f<c&&c<f+s&&(l=-1,f+=s-1,c+=s-1);s-- >0;)f in r?r[c]=r[f]:delete r[c],c+=l,f+=l;return r}},function(t,n,r){var e=r(79);t.exports=function(t,n){var r=[];return e(t,!1,r.push,r,n),r}},function(t,n,r){var e=r(26),i=r(17),o=r(115),u=r(16);t.exports=function(t,n,r,c,f){e(n);var a=i(t),s=o(a),l=u(a.length),h=f?l-1:0,v=f?-1:1;if(r<2)for(;;){if(h in s){c=s[h],h+=v;break}if(h+=v,f?h<0:l<=h)throw TypeError("Reduce of empty array with no initial value")}for(;f?h>=0:l>h;h+=v)h in s&&(c=n(c,s[h],h,a));return c}},function(t,n,r){"use strict";var e=r(26),i=r(6),o=r(121),u=[].slice,c={},f=function(t,n,r){if(!(n in c)){for(var e=[],i=0;i<n;i++)e[i]="a["+i+"]";c[n]=Function("F,a","return new F("+e.join(",")+")")}return c[n](t,r)};t.exports=Function.bind||function(t){var n=e(this),r=u.call(arguments,1),c=function(){var e=r.concat(u.call(arguments));return this instanceof c?f(n,e.length,e):o(n,e,t)};return i(n.prototype)&&(c.prototype=n.prototype),c}},function(t,n,r){"use strict";var e=r(11).f,i=r(70),o=r(73),u=r(53),c=r(68),f=r(46),a=r(79),s=r(140),l=r(170),h=r(74),v=r(10),p=r(65).fastKey,d=v?"_s":"size",y=function(t,n){var r,e=p(n);if("F"!==e)return t._i[e];for(r=t._f;r;r=r.n)if(r.k==n)return r};t.exports={getConstructor:function(t,n,r,s){var l=t(function(t,e){c(t,l,n,"_i"),t._i=i(null),t._f=void 0,t._l=void 0,t[d]=0,void 0!=e&&a(e,r,t[s],t)});return o(l.prototype,{clear:function(){for(var t=this,n=t._i,r=t._f;r;r=r.n)r.r=!0,r.p&&(r.p=r.p.n=void 0),delete n[r.i];t._f=t._l=void 0,t[d]=0},delete:function(t){var n=this,r=y(n,t);if(r){var e=r.n,i=r.p;delete n._i[r.i],r.r=!0,i&&(i.n=e),e&&(e.p=i),n._f==r&&(n._f=e),n._l==r&&(n._l=i),n[d]--}return!!r},forEach:function(t){c(this,l,"forEach");for(var n,r=u(t,arguments.length>1?arguments[1]:void 0,3);n=n?n.n:this._f;)for(r(n.v,n.k,this);n&&n.r;)n=n.p},has:function(t){return!!y(this,t)}}),v&&e(l.prototype,"size",{get:function(){return f(this[d])}}),l},def:function(t,n,r){var e,i,o=y(t,n);return o?o.v=r:(t._l=o={i:i=p(n,!0),k:n,v:r,p:e=t._l,n:void 0,r:!1},t._f||(t._f=o),e&&(e.n=o),t[d]++,"F"!==i&&(t._i[i]=o)),t},getEntry:y,setStrong:function(t,n,r){s(t,n,function(t,n){this._t=t,this._k=n,this._l=void 0},function(){for(var t=this,n=t._k,r=t._l;r&&r.r;)r=r.p;return t._t&&(t._l=r=r?r.n:t._t._f)?"keys"==n?l(0,r.k):"values"==n?l(0,r.v):l(0,[r.k,r.v]):(t._t=void 0,l(1))},r?"entries":"values",!r,!0),h(n)}}},function(t,n,r){var e=r(114),i=r(161);t.exports=function(t){return function(){if(e(this)!=t)throw TypeError(t+"#toJSON isn't generic");return i(this)}}},function(t,n,r){"use strict";var e=r(73),i=r(65).getWeak,o=r(2),u=r(6),c=r(68),f=r(79),a=r(48),s=r(24),l=a(5),h=a(6),v=0,p=function(t){return t._l||(t._l=new d)},d=function(){this.a=[]},y=function(t,n){return l(t.a,function(t){return t[0]===n})};d.prototype={get:function(t){var n=y(this,t);if(n)return n[1]},has:function(t){return!!y(this,t)},set:function(t,n){var r=y(this,t);r?r[1]=n:this.a.push([t,n])},delete:function(t){var n=h(this.a,function(n){return n[0]===t});return~n&&this.a.splice(n,1),!!~n}},t.exports={getConstructor:function(t,n,r,o){var a=t(function(t,e){c(t,a,n,"_i"),t._i=v++,t._l=void 0,void 0!=e&&f(e,r,t[o],t)});return e(a.prototype,{delete:function(t){if(!u(t))return!1;var n=i(t);return!0===n?p(this).delete(t):n&&s(n,this._i)&&delete n[this._i]},has:function(t){if(!u(t))return!1;var n=i(t);return!0===n?p(this).has(t):n&&s(n,this._i)}}),a},def:function(t,n,r){var e=i(o(n),!0);return!0===e?p(t).set(n,r):e[t._i]=r,t},ufstore:p}},function(t,n,r){t.exports=!r(10)&&!r(4)(function(){return 7!=Object.defineProperty(r(132)("div"),"a",{get:function(){return 7}}).a})},function(t,n,r){var e=r(6),i=Math.floor;t.exports=function(t){return!e(t)&&isFinite(t)&&i(t)===t}},function(t,n,r){var e=r(2);t.exports=function(t,n,r,i){try{return i?n(e(r)[0],r[1]):n(r)}catch(n){var o=t.return;throw void 0!==o&&e(o.call(t)),n}}},function(t,n){t.exports=function(t,n){return{value:n,done:!!t}}},function(t,n){t.exports=Math.log1p||function(t){return(t=+t)>-1e-8&&t<1e-8?t-t*t/2:Math.log(1+t)}},function(t,n,r){"use strict";var e=r(72),i=r(125),o=r(116),u=r(17),c=r(115),f=Object.assign;t.exports=!f||r(4)(function(){var t={},n={},r=Symbol(),e="abcdefghijklmnopqrst";return t[r]=7,e.split("").forEach(function(t){n[t]=t}),7!=f({},t)[r]||Object.keys(f({},n)).join("")!=e})?function(t,n){for(var r=u(t),f=arguments.length,a=1,s=i.f,l=o.f;f>a;)for(var h,v=c(arguments[a++]),p=s?e(v).concat(s(v)):e(v),d=p.length,y=0;d>y;)l.call(v,h=p[y++])&&(r[h]=v[h]);return r}:f},function(t,n,r){var e=r(11),i=r(2),o=r(72);t.exports=r(10)?Object.defineProperties:function(t,n){i(t);for(var r,u=o(n),c=u.length,f=0;c>f;)e.f(t,r=u[f++],n[r]);return t}},function(t,n,r){var e=r(30),i=r(71).f,o={}.toString,u="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[],c=function(t){try{return i(t)}catch(t){return u.slice()}};t.exports.f=function(t){return u&&"[object Window]"==o.call(t)?c(t):i(e(t))}},function(t,n,r){var e=r(24),i=r(30),o=r(117)(!1),u=r(145)("IE_PROTO");t.exports=function(t,n){var r,c=i(t),f=0,a=[];for(r in c)r!=u&&e(c,r)&&a.push(r);for(;n.length>f;)e(c,r=n[f++])&&(~o(a,r)||a.push(r));return a}},function(t,n,r){var e=r(72),i=r(30),o=r(116).f;t.exports=function(t){return function(n){for(var r,u=i(n),c=e(u),f=c.length,a=0,s=[];f>a;)o.call(u,r=c[a++])&&s.push(t?[r,u[r]]:u[r]);return s}}},function(t,n,r){var e=r(71),i=r(125),o=r(2),u=r(3).Reflect;t.exports=u&&u.ownKeys||function(t){var n=e.f(o(t)),r=i.f;return r?n.concat(r(t)):n}},function(t,n,r){var e=r(3).parseFloat,i=r(82).trim;t.exports=1/e(r(150)+"-0")!=-1/0?function(t){var n=i(String(t),3),r=e(n);return 0===r&&"-"==n.charAt(0)?-0:r}:e},function(t,n,r){var e=r(3).parseInt,i=r(82).trim,o=r(150),u=/^[\-+]?0[xX]/;t.exports=8!==e(o+"08")||22!==e(o+"0x16")?function(t,n){var r=i(String(t),3);return e(r,n>>>0||(u.test(r)?16:10))}:e},function(t,n){t.exports=Object.is||function(t,n){return t===n?0!==t||1/t==1/n:t!=t&&n!=n}},function(t,n,r){var e=r(16),i=r(149),o=r(46);t.exports=function(t,n,r,u){var c=String(o(t)),f=c.length,a=void 0===r?" ":String(r),s=e(n);if(s<=f||""==a)return c;var l=s-f,h=i.call(a,Math.ceil(l/a.length));return h.length>l&&(h=h.slice(0,l)),u?h+c:c+h}},function(t,n,r){n.f=r(7)},function(t,n,r){"use strict";var e=r(164);t.exports=r(118)("Map",function(t){return function(){return t(this,arguments.length>0?arguments[0]:void 0)}},{get:function(t){var n=e.getEntry(this,t);return n&&n.v},set:function(t,n){return e.def(this,0===t?0:t,n)}},e,!0)},function(t,n,r){r(10)&&"g"!=/./g.flags&&r(11).f(RegExp.prototype,"flags",{configurable:!0,get:r(120)})},function(t,n,r){"use strict";var e=r(164);t.exports=r(118)("Set",function(t){return function(){return t(this,arguments.length>0?arguments[0]:void 0)}},{add:function(t){return e.def(this,t=0===t?0:t,t)}},e)},function(t,n,r){"use strict";var e,i=r(48)(0),o=r(28),u=r(65),c=r(172),f=r(166),a=r(6),s=u.getWeak,l=Object.isExtensible,h=f.ufstore,v={},p=function(t){return function(){return t(this,arguments.length>0?arguments[0]:void 0)}},d={get:function(t){if(a(t)){var n=s(t);return!0===n?h(this).get(t):n?n[this._i]:void 0}},set:function(t,n){return f.def(this,t,n)}},y=t.exports=r(118)("WeakMap",p,d,f,!0,!0);7!=(new y).set((Object.freeze||Object)(v),7).get(v)&&(e=f.getConstructor(p),c(e.prototype,d),u.NEED=!0,i(["delete","has","get","set"],function(t){var n=y.prototype,r=n[t];o(n,t,function(n,i){if(a(n)&&!l(n)){this._f||(this._f=new e);var o=this._f[t](n,i);return"set"==t?this:o}return r.call(this,n,i)})}))},,,function(t,n){"use strict";function r(){var t=document.querySelector("#page-nav");if(t&&!document.querySelector("#page-nav .extend.prev")&&(t.innerHTML='<a class="extend prev disabled" rel="prev">&laquo; Prev</a>'+t.innerHTML),t&&!document.querySelector("#page-nav .extend.next")&&(t.innerHTML=t.innerHTML+'<a class="extend next disabled" rel="next">Next &raquo;</a>'),yiliaConfig&&yiliaConfig.open_in_new){document.querySelectorAll(".article-entry a:not(.article-more-a)").forEach(function(t){var n=t.getAttribute("target");n&&""!==n||t.setAttribute("target","_blank")})}var n=document.querySelector("#js-aboutme");n&&0!==n.length&&(n.innerHTML=n.innerText)}t.exports={init:r}},function(t,n,r){"use strict";function e(t){return t&&t.__esModule?t:{default:t}}function i(t,n){var r=/\/|index.html/g;return t.replace(r,"")===n.replace(r,"")}function o(){for(var t=document.querySelectorAll(".js-header-menu li a"),n=window.location.pathname,r=0,e=t.length;r<e;r++){var o=t[r];i(n,o.getAttribute("href"))&&(0,h.default)(o,"active")}}function u(t){for(var n=t.offsetLeft,r=t.offsetParent;null!==r;)n+=r.offsetLeft,r=r.offsetParent;return n}function c(t){for(var n=t.offsetTop,r=t.offsetParent;null!==r;)n+=r.offsetTop,r=r.offsetParent;return n}function f(t,n,r,e,i){var o=u(t),f=c(t)-n;if(f-r<=i){var a=t.$newDom;a||(a=t.cloneNode(!0),(0,d.default)(t,a),t.$newDom=a,a.style.position="fixed",a.style.top=(r||f)+"px",a.style.left=o+"px",a.style.zIndex=e||2,a.style.width="100%",a.style.color="#fff"),a.style.visibility="visible",t.style.visibility="hidden"}else{t.style.visibility="visible";var s=t.$newDom;s&&(s.style.visibility="hidden")}}function a(){var t=document.querySelector(".js-overlay"),n=document.querySelector(".js-header-menu");f(t,document.body.scrollTop,-63,2,0),f(n,document.body.scrollTop,1,3,0)}function s(){document.querySelector("#container").addEventListener("scroll",function(t){a()}),window.addEventListener("scroll",function(t){a()}),a()}var l=r(156),h=e(l),v=r(157),p=(e(v),r(381)),d=e(p),y=r(128),g=e(y),b=r(189),m=e(b),x=r(129);(function(){g.default.versions.mobile&&window.screen.width<800&&(o(),s())})(),(0,x.addLoadEvent)(function(){m.default.init()}),t.exports={}},,,,function(t,n,r){(function(t){"use strict";function n(t,n,r){t[n]||Object[e](t,n,{writable:!0,configurable:!0,value:r})}if(r(380),r(390),r(197),t._babelPolyfill)throw new Error("only one instance of babel-polyfill is allowed");t._babelPolyfill=!0;var e="defineProperty";n(String.prototype,"padLeft","".padStart),n(String.prototype,"padRight","".padEnd),"pop,reverse,shift,keys,values,entries,indexOf,every,some,forEach,map,filter,find,findIndex,includes,join,slice,concat,push,splice,unshift,sort,lastIndexOf,reduce,reduceRight,copyWithin,fill".split(",").forEach(function(t){[][t]&&n(Array,t,Function.call.bind([][t]))})}).call(n,function(){return this}())},,,function(t,n,r){r(209),t.exports=r(52).RegExp.escape},,,,function(t,n,r){var e=r(6),i=r(138),o=r(7)("species");t.exports=function(t){var n;return i(t)&&(n=t.constructor,"function"!=typeof n||n!==Array&&!i(n.prototype)||(n=void 0),e(n)&&null===(n=n[o])&&(n=void 0)),void 0===n?Array:n}},function(t,n,r){var e=r(201);t.exports=function(t,n){return new(e(t))(n)}},function(t,n,r){"use strict";var e=r(2),i=r(50),o="number";t.exports=function(t){if("string"!==t&&t!==o&&"default"!==t)throw TypeError("Incorrect hint");return i(e(this),t!=o)}},function(t,n,r){var e=r(72),i=r(125),o=r(116);t.exports=function(t){var n=e(t),r=i.f;if(r)for(var u,c=r(t),f=o.f,a=0;c.length>a;)f.call(t,u=c[a++])&&n.push(u);return n}},function(t,n,r){var e=r(72),i=r(30);t.exports=function(t,n){for(var r,o=i(t),u=e(o),c=u.length,f=0;c>f;)if(o[r=u[f++]]===n)return r}},function(t,n,r){"use strict";var e=r(207),i=r(121),o=r(26);t.exports=function(){for(var t=o(this),n=arguments.length,r=Array(n),u=0,c=e._,f=!1;n>u;)(r[u]=arguments[u++])===c&&(f=!0);return function(){var e,o=this,u=arguments.length,a=0,s=0;if(!f&&!u)return i(t,r,o);if(e=r.slice(),f)for(;n>a;a++)e[a]===c&&(e[a]=arguments[s++]);for(;u>s;)e.push(arguments[s++]);return i(t,e,o)}}},function(t,n,r){t.exports=r(3)},function(t,n){t.exports=function(t,n){var r=n===Object(n)?function(t){return n[t]}:n;return function(n){return String(n).replace(t,r)}}},function(t,n,r){var e=r(1),i=r(208)(/[\\^$*+?.()|[\]{}]/g,"\\$&");e(e.S,"RegExp",{escape:function(t){return i(t)}})},function(t,n,r){var e=r(1);e(e.P,"Array",{copyWithin:r(160)}),r(78)("copyWithin")},function(t,n,r){"use strict";var e=r(1),i=r(48)(4);e(e.P+e.F*!r(47)([].every,!0),"Array",{every:function(t){return i(this,t,arguments[1])}})},function(t,n,r){var e=r(1);e(e.P,"Array",{fill:r(130)}),r(78)("fill")},function(t,n,r){"use strict";var e=r(1),i=r(48)(2);e(e.P+e.F*!r(47)([].filter,!0),"Array",{filter:function(t){return i(this,t,arguments[1])}})},function(t,n,r){"use strict";var e=r(1),i=r(48)(6),o="findIndex",u=!0;o in[]&&Array(1)[o](function(){u=!1}),e(e.P+e.F*u,"Array",{findIndex:function(t){return i(this,t,arguments.length>1?arguments[1]:void 0)}}),r(78)(o)},function(t,n,r){"use strict";var e=r(1),i=r(48)(5),o="find",u=!0;o in[]&&Array(1)[o](function(){u=!1}),e(e.P+e.F*u,"Array",{find:function(t){return i(this,t,arguments.length>1?arguments[1]:void 0)}}),r(78)(o)},function(t,n,r){"use strict";var e=r(1),i=r(48)(0),o=r(47)([].forEach,!0);e(e.P+e.F*!o,"Array",{forEach:function(t){return i(this,t,arguments[1])}})},function(t,n,r){"use strict";var e=r(53),i=r(1),o=r(17),u=r(169),c=r(137),f=r(16),a=r(131),s=r(154);i(i.S+i.F*!r(123)(function(t){Array.from(t)}),"Array",{from:function(t){var n,r,i,l,h=o(t),v="function"==typeof this?this:Array,p=arguments.length,d=p>1?arguments[1]:void 0,y=void 0!==d,g=0,b=s(h);if(y&&(d=e(d,p>2?arguments[2]:void 0,2)),void 0==b||v==Array&&c(b))for(n=f(h.length),r=new v(n);n>g;g++)a(r,g,y?d(h[g],g):h[g]);else for(l=b.call(h),r=new v;!(i=l.next()).done;g++)a(r,g,y?u(l,d,[i.value,g],!0):i.value);return r.length=g,r}})},function(t,n,r){"use strict";var e=r(1),i=r(117)(!1),o=[].indexOf,u=!!o&&1/[1].indexOf(1,-0)<0;e(e.P+e.F*(u||!r(47)(o)),"Array",{indexOf:function(t){return u?o.apply(this,arguments)||0:i(this,t,arguments[1])}})},function(t,n,r){var e=r(1);e(e.S,"Array",{isArray:r(138)})},function(t,n,r){"use strict";var e=r(1),i=r(30),o=[].join;e(e.P+e.F*(r(115)!=Object||!r(47)(o)),"Array",{join:function(t){return o.call(i(this),void 0===t?",":t)}})},function(t,n,r){"use strict";var e=r(1),i=r(30),o=r(67),u=r(16),c=[].lastIndexOf,f=!!c&&1/[1].lastIndexOf(1,-0)<0;e(e.P+e.F*(f||!r(47)(c)),"Array",{lastIndexOf:function(t){if(f)return c.apply(this,arguments)||0;var n=i(this),r=u(n.length),e=r-1;for(arguments.length>1&&(e=Math.min(e,o(arguments[1]))),e<0&&(e=r+e);e>=0;e--)if(e in n&&n[e]===t)return e||0;return-1}})},function(t,n,r){"use strict";var e=r(1),i=r(48)(1);e(e.P+e.F*!r(47)([].map,!0),"Array",{map:function(t){return i(this,t,arguments[1])}})},function(t,n,r){"use strict";var e=r(1),i=r(131);e(e.S+e.F*r(4)(function(){function t(){}return!(Array.of.call(t)instanceof t)}),"Array",{of:function(){for(var t=0,n=arguments.length,r=new("function"==typeof this?this:Array)(n);n>t;)i(r,t,arguments[t++]);return r.length=n,r}})},function(t,n,r){"use strict";var e=r(1),i=r(162);e(e.P+e.F*!r(47)([].reduceRight,!0),"Array",{reduceRight:function(t){return i(this,t,arguments.length,arguments[1],!0)}})},function(t,n,r){"use strict";var e=r(1),i=r(162);e(e.P+e.F*!r(47)([].reduce,!0),"Array",{reduce:function(t){return i(this,t,arguments.length,arguments[1],!1)}})},function(t,n,r){"use strict";var e=r(1),i=r(135),o=r(45),u=r(75),c=r(16),f=[].slice;e(e.P+e.F*r(4)(function(){i&&f.call(i)}),"Array",{slice:function(t,n){var r=c(this.length),e=o(this);if(n=void 0===n?r:n,"Array"==e)return f.call(this,t,n);for(var i=u(t,r),a=u(n,r),s=c(a-i),l=Array(s),h=0;h<s;h++)l[h]="String"==e?this.charAt(i+h):this[i+h];return l}})},function(t,n,r){"use strict";var e=r(1),i=r(48)(3);e(e.P+e.F*!r(47)([].some,!0),"Array",{some:function(t){return i(this,t,arguments[1])}})},function(t,n,r){"use strict";var e=r(1),i=r(26),o=r(17),u=r(4),c=[].sort,f=[1,2,3];e(e.P+e.F*(u(function(){f.sort(void 0)})||!u(function(){f.sort(null)})||!r(47)(c)),"Array",{sort:function(t){return void 0===t?c.call(o(this)):c.call(o(this),i(t))}})},function(t,n,r){r(74)("Array")},function(t,n,r){var e=r(1);e(e.S,"Date",{now:function(){return(new Date).getTime()}})},function(t,n,r){"use strict";var e=r(1),i=r(4),o=Date.prototype.getTime,u=function(t){return t>9?t:"0"+t};e(e.P+e.F*(i(function(){return"0385-07-25T07:06:39.999Z"!=new Date(-5e13-1).toISOString()})||!i(function(){new Date(NaN).toISOString()})),"Date",{toISOString:function(){if(!isFinite(o.call(this)))throw RangeError("Invalid time value");var t=this,n=t.getUTCFullYear(),r=t.getUTCMilliseconds(),e=n<0?"-":n>9999?"+":""
;return e+("00000"+Math.abs(n)).slice(e?-6:-4)+"-"+u(t.getUTCMonth()+1)+"-"+u(t.getUTCDate())+"T"+u(t.getUTCHours())+":"+u(t.getUTCMinutes())+":"+u(t.getUTCSeconds())+"."+(r>99?r:"0"+u(r))+"Z"}})},function(t,n,r){"use strict";var e=r(1),i=r(17),o=r(50);e(e.P+e.F*r(4)(function(){return null!==new Date(NaN).toJSON()||1!==Date.prototype.toJSON.call({toISOString:function(){return 1}})}),"Date",{toJSON:function(t){var n=i(this),r=o(n);return"number"!=typeof r||isFinite(r)?n.toISOString():null}})},function(t,n,r){var e=r(7)("toPrimitive"),i=Date.prototype;e in i||r(27)(i,e,r(203))},function(t,n,r){var e=Date.prototype,i="Invalid Date",o="toString",u=e[o],c=e.getTime;new Date(NaN)+""!=i&&r(28)(e,o,function(){var t=c.call(this);return t===t?u.call(this):i})},function(t,n,r){var e=r(1);e(e.P,"Function",{bind:r(163)})},function(t,n,r){"use strict";var e=r(6),i=r(32),o=r(7)("hasInstance"),u=Function.prototype;o in u||r(11).f(u,o,{value:function(t){if("function"!=typeof this||!e(t))return!1;if(!e(this.prototype))return t instanceof this;for(;t=i(t);)if(this.prototype===t)return!0;return!1}})},function(t,n,r){var e=r(11).f,i=r(66),o=r(24),u=Function.prototype,c="name",f=Object.isExtensible||function(){return!0};c in u||r(10)&&e(u,c,{configurable:!0,get:function(){try{var t=this,n=(""+t).match(/^\s*function ([^ (]*)/)[1];return o(t,c)||!f(t)||e(t,c,i(5,n)),n}catch(t){return""}}})},function(t,n,r){var e=r(1),i=r(171),o=Math.sqrt,u=Math.acosh;e(e.S+e.F*!(u&&710==Math.floor(u(Number.MAX_VALUE))&&u(1/0)==1/0),"Math",{acosh:function(t){return(t=+t)<1?NaN:t>94906265.62425156?Math.log(t)+Math.LN2:i(t-1+o(t-1)*o(t+1))}})},function(t,n,r){function e(t){return isFinite(t=+t)&&0!=t?t<0?-e(-t):Math.log(t+Math.sqrt(t*t+1)):t}var i=r(1),o=Math.asinh;i(i.S+i.F*!(o&&1/o(0)>0),"Math",{asinh:e})},function(t,n,r){var e=r(1),i=Math.atanh;e(e.S+e.F*!(i&&1/i(-0)<0),"Math",{atanh:function(t){return 0==(t=+t)?t:Math.log((1+t)/(1-t))/2}})},function(t,n,r){var e=r(1),i=r(142);e(e.S,"Math",{cbrt:function(t){return i(t=+t)*Math.pow(Math.abs(t),1/3)}})},function(t,n,r){var e=r(1);e(e.S,"Math",{clz32:function(t){return(t>>>=0)?31-Math.floor(Math.log(t+.5)*Math.LOG2E):32}})},function(t,n,r){var e=r(1),i=Math.exp;e(e.S,"Math",{cosh:function(t){return(i(t=+t)+i(-t))/2}})},function(t,n,r){var e=r(1),i=r(141);e(e.S+e.F*(i!=Math.expm1),"Math",{expm1:i})},function(t,n,r){var e=r(1),i=r(142),o=Math.pow,u=o(2,-52),c=o(2,-23),f=o(2,127)*(2-c),a=o(2,-126),s=function(t){return t+1/u-1/u};e(e.S,"Math",{fround:function(t){var n,r,e=Math.abs(t),o=i(t);return e<a?o*s(e/a/c)*a*c:(n=(1+c/u)*e,r=n-(n-e),r>f||r!=r?o*(1/0):o*r)}})},function(t,n,r){var e=r(1),i=Math.abs;e(e.S,"Math",{hypot:function(t,n){for(var r,e,o=0,u=0,c=arguments.length,f=0;u<c;)r=i(arguments[u++]),f<r?(e=f/r,o=o*e*e+1,f=r):r>0?(e=r/f,o+=e*e):o+=r;return f===1/0?1/0:f*Math.sqrt(o)}})},function(t,n,r){var e=r(1),i=Math.imul;e(e.S+e.F*r(4)(function(){return-5!=i(4294967295,5)||2!=i.length}),"Math",{imul:function(t,n){var r=65535,e=+t,i=+n,o=r&e,u=r&i;return 0|o*u+((r&e>>>16)*u+o*(r&i>>>16)<<16>>>0)}})},function(t,n,r){var e=r(1);e(e.S,"Math",{log10:function(t){return Math.log(t)/Math.LN10}})},function(t,n,r){var e=r(1);e(e.S,"Math",{log1p:r(171)})},function(t,n,r){var e=r(1);e(e.S,"Math",{log2:function(t){return Math.log(t)/Math.LN2}})},function(t,n,r){var e=r(1);e(e.S,"Math",{sign:r(142)})},function(t,n,r){var e=r(1),i=r(141),o=Math.exp;e(e.S+e.F*r(4)(function(){return-2e-17!=!Math.sinh(-2e-17)}),"Math",{sinh:function(t){return Math.abs(t=+t)<1?(i(t)-i(-t))/2:(o(t-1)-o(-t-1))*(Math.E/2)}})},function(t,n,r){var e=r(1),i=r(141),o=Math.exp;e(e.S,"Math",{tanh:function(t){var n=i(t=+t),r=i(-t);return n==1/0?1:r==1/0?-1:(n-r)/(o(t)+o(-t))}})},function(t,n,r){var e=r(1);e(e.S,"Math",{trunc:function(t){return(t>0?Math.floor:Math.ceil)(t)}})},function(t,n,r){"use strict";var e=r(3),i=r(24),o=r(45),u=r(136),c=r(50),f=r(4),a=r(71).f,s=r(31).f,l=r(11).f,h=r(82).trim,v="Number",p=e[v],d=p,y=p.prototype,g=o(r(70)(y))==v,b="trim"in String.prototype,m=function(t){var n=c(t,!1);if("string"==typeof n&&n.length>2){n=b?n.trim():h(n,3);var r,e,i,o=n.charCodeAt(0);if(43===o||45===o){if(88===(r=n.charCodeAt(2))||120===r)return NaN}else if(48===o){switch(n.charCodeAt(1)){case 66:case 98:e=2,i=49;break;case 79:case 111:e=8,i=55;break;default:return+n}for(var u,f=n.slice(2),a=0,s=f.length;a<s;a++)if((u=f.charCodeAt(a))<48||u>i)return NaN;return parseInt(f,e)}}return+n};if(!p(" 0o1")||!p("0b1")||p("+0x1")){p=function(t){var n=arguments.length<1?0:t,r=this;return r instanceof p&&(g?f(function(){y.valueOf.call(r)}):o(r)!=v)?u(new d(m(n)),r,p):m(n)};for(var x,w=r(10)?a(d):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,isFinite,isInteger,isNaN,isSafeInteger,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,parseFloat,parseInt,isInteger".split(","),S=0;w.length>S;S++)i(d,x=w[S])&&!i(p,x)&&l(p,x,s(d,x));p.prototype=y,y.constructor=p,r(28)(e,v,p)}},function(t,n,r){var e=r(1);e(e.S,"Number",{EPSILON:Math.pow(2,-52)})},function(t,n,r){var e=r(1),i=r(3).isFinite;e(e.S,"Number",{isFinite:function(t){return"number"==typeof t&&i(t)}})},function(t,n,r){var e=r(1);e(e.S,"Number",{isInteger:r(168)})},function(t,n,r){var e=r(1);e(e.S,"Number",{isNaN:function(t){return t!=t}})},function(t,n,r){var e=r(1),i=r(168),o=Math.abs;e(e.S,"Number",{isSafeInteger:function(t){return i(t)&&o(t)<=9007199254740991}})},function(t,n,r){var e=r(1);e(e.S,"Number",{MAX_SAFE_INTEGER:9007199254740991})},function(t,n,r){var e=r(1);e(e.S,"Number",{MIN_SAFE_INTEGER:-9007199254740991})},function(t,n,r){var e=r(1),i=r(178);e(e.S+e.F*(Number.parseFloat!=i),"Number",{parseFloat:i})},function(t,n,r){var e=r(1),i=r(179);e(e.S+e.F*(Number.parseInt!=i),"Number",{parseInt:i})},function(t,n,r){"use strict";var e=r(1),i=r(67),o=r(159),u=r(149),c=1..toFixed,f=Math.floor,a=[0,0,0,0,0,0],s="Number.toFixed: incorrect invocation!",l="0",h=function(t,n){for(var r=-1,e=n;++r<6;)e+=t*a[r],a[r]=e%1e7,e=f(e/1e7)},v=function(t){for(var n=6,r=0;--n>=0;)r+=a[n],a[n]=f(r/t),r=r%t*1e7},p=function(){for(var t=6,n="";--t>=0;)if(""!==n||0===t||0!==a[t]){var r=String(a[t]);n=""===n?r:n+u.call(l,7-r.length)+r}return n},d=function(t,n,r){return 0===n?r:n%2==1?d(t,n-1,r*t):d(t*t,n/2,r)},y=function(t){for(var n=0,r=t;r>=4096;)n+=12,r/=4096;for(;r>=2;)n+=1,r/=2;return n};e(e.P+e.F*(!!c&&("0.000"!==8e-5.toFixed(3)||"1"!==.9.toFixed(0)||"1.25"!==1.255.toFixed(2)||"1000000000000000128"!==(0xde0b6b3a7640080).toFixed(0))||!r(4)(function(){c.call({})})),"Number",{toFixed:function(t){var n,r,e,c,f=o(this,s),a=i(t),g="",b=l;if(a<0||a>20)throw RangeError(s);if(f!=f)return"NaN";if(f<=-1e21||f>=1e21)return String(f);if(f<0&&(g="-",f=-f),f>1e-21)if(n=y(f*d(2,69,1))-69,r=n<0?f*d(2,-n,1):f/d(2,n,1),r*=4503599627370496,(n=52-n)>0){for(h(0,r),e=a;e>=7;)h(1e7,0),e-=7;for(h(d(10,e,1),0),e=n-1;e>=23;)v(1<<23),e-=23;v(1<<e),h(1,1),v(2),b=p()}else h(0,r),h(1<<-n,0),b=p()+u.call(l,a);return a>0?(c=b.length,b=g+(c<=a?"0."+u.call(l,a-c)+b:b.slice(0,c-a)+"."+b.slice(c-a))):b=g+b,b}})},function(t,n,r){"use strict";var e=r(1),i=r(4),o=r(159),u=1..toPrecision;e(e.P+e.F*(i(function(){return"1"!==u.call(1,void 0)})||!i(function(){u.call({})})),"Number",{toPrecision:function(t){var n=o(this,"Number#toPrecision: incorrect invocation!");return void 0===t?u.call(n):u.call(n,t)}})},function(t,n,r){var e=r(1);e(e.S+e.F,"Object",{assign:r(172)})},function(t,n,r){var e=r(1);e(e.S,"Object",{create:r(70)})},function(t,n,r){var e=r(1);e(e.S+e.F*!r(10),"Object",{defineProperties:r(173)})},function(t,n,r){var e=r(1);e(e.S+e.F*!r(10),"Object",{defineProperty:r(11).f})},function(t,n,r){var e=r(6),i=r(65).onFreeze;r(49)("freeze",function(t){return function(n){return t&&e(n)?t(i(n)):n}})},function(t,n,r){var e=r(30),i=r(31).f;r(49)("getOwnPropertyDescriptor",function(){return function(t,n){return i(e(t),n)}})},function(t,n,r){r(49)("getOwnPropertyNames",function(){return r(174).f})},function(t,n,r){var e=r(17),i=r(32);r(49)("getPrototypeOf",function(){return function(t){return i(e(t))}})},function(t,n,r){var e=r(6);r(49)("isExtensible",function(t){return function(n){return!!e(n)&&(!t||t(n))}})},function(t,n,r){var e=r(6);r(49)("isFrozen",function(t){return function(n){return!e(n)||!!t&&t(n)}})},function(t,n,r){var e=r(6);r(49)("isSealed",function(t){return function(n){return!e(n)||!!t&&t(n)}})},function(t,n,r){var e=r(1);e(e.S,"Object",{is:r(180)})},function(t,n,r){var e=r(17),i=r(72);r(49)("keys",function(){return function(t){return i(e(t))}})},function(t,n,r){var e=r(6),i=r(65).onFreeze;r(49)("preventExtensions",function(t){return function(n){return t&&e(n)?t(i(n)):n}})},function(t,n,r){var e=r(6),i=r(65).onFreeze;r(49)("seal",function(t){return function(n){return t&&e(n)?t(i(n)):n}})},function(t,n,r){var e=r(1);e(e.S,"Object",{setPrototypeOf:r(144).set})},function(t,n,r){"use strict";var e=r(114),i={};i[r(7)("toStringTag")]="z",i+""!="[object z]"&&r(28)(Object.prototype,"toString",function(){return"[object "+e(this)+"]"},!0)},function(t,n,r){var e=r(1),i=r(178);e(e.G+e.F*(parseFloat!=i),{parseFloat:i})},function(t,n,r){var e=r(1),i=r(179);e(e.G+e.F*(parseInt!=i),{parseInt:i})},function(t,n,r){"use strict";var e,i,o,u=r(69),c=r(3),f=r(53),a=r(114),s=r(1),l=r(6),h=r(26),v=r(68),p=r(79),d=r(146),y=r(151).set,g=r(143)(),b="Promise",m=c.TypeError,x=c.process,w=c[b],x=c.process,S="process"==a(x),_=function(){},O=!!function(){try{var t=w.resolve(1),n=(t.constructor={})[r(7)("species")]=function(t){t(_,_)};return(S||"function"==typeof PromiseRejectionEvent)&&t.then(_)instanceof n}catch(t){}}(),E=function(t,n){return t===n||t===w&&n===o},P=function(t){var n;return!(!l(t)||"function"!=typeof(n=t.then))&&n},j=function(t){return E(w,t)?new F(t):new i(t)},F=i=function(t){var n,r;this.promise=new t(function(t,e){if(void 0!==n||void 0!==r)throw m("Bad Promise constructor");n=t,r=e}),this.resolve=h(n),this.reject=h(r)},M=function(t){try{t()}catch(t){return{error:t}}},A=function(t,n){if(!t._n){t._n=!0;var r=t._c;g(function(){for(var e=t._v,i=1==t._s,o=0;r.length>o;)!function(n){var r,o,u=i?n.ok:n.fail,c=n.resolve,f=n.reject,a=n.domain;try{u?(i||(2==t._h&&I(t),t._h=1),!0===u?r=e:(a&&a.enter(),r=u(e),a&&a.exit()),r===n.promise?f(m("Promise-chain cycle")):(o=P(r))?o.call(r,c,f):c(r)):f(e)}catch(t){f(t)}}(r[o++]);t._c=[],t._n=!1,n&&!t._h&&N(t)})}},N=function(t){y.call(c,function(){var n,r,e,i=t._v;if(T(t)&&(n=M(function(){S?x.emit("unhandledRejection",i,t):(r=c.onunhandledrejection)?r({promise:t,reason:i}):(e=c.console)&&e.error&&e.error("Unhandled promise rejection",i)}),t._h=S||T(t)?2:1),t._a=void 0,n)throw n.error})},T=function(t){if(1==t._h)return!1;for(var n,r=t._a||t._c,e=0;r.length>e;)if(n=r[e++],n.fail||!T(n.promise))return!1;return!0},I=function(t){y.call(c,function(){var n;S?x.emit("rejectionHandled",t):(n=c.onrejectionhandled)&&n({promise:t,reason:t._v})})},k=function(t){var n=this;n._d||(n._d=!0,n=n._w||n,n._v=t,n._s=2,n._a||(n._a=n._c.slice()),A(n,!0))},L=function(t){var n,r=this;if(!r._d){r._d=!0,r=r._w||r;try{if(r===t)throw m("Promise can't be resolved itself");(n=P(t))?g(function(){var e={_w:r,_d:!1};try{n.call(t,f(L,e,1),f(k,e,1))}catch(t){k.call(e,t)}}):(r._v=t,r._s=1,A(r,!1))}catch(t){k.call({_w:r,_d:!1},t)}}};O||(w=function(t){v(this,w,b,"_h"),h(t),e.call(this);try{t(f(L,this,1),f(k,this,1))}catch(t){k.call(this,t)}},e=function(t){this._c=[],this._a=void 0,this._s=0,this._d=!1,this._v=void 0,this._h=0,this._n=!1},e.prototype=r(73)(w.prototype,{then:function(t,n){var r=j(d(this,w));return r.ok="function"!=typeof t||t,r.fail="function"==typeof n&&n,r.domain=S?x.domain:void 0,this._c.push(r),this._a&&this._a.push(r),this._s&&A(this,!1),r.promise},catch:function(t){return this.then(void 0,t)}}),F=function(){var t=new e;this.promise=t,this.resolve=f(L,t,1),this.reject=f(k,t,1)}),s(s.G+s.W+s.F*!O,{Promise:w}),r(81)(w,b),r(74)(b),o=r(52)[b],s(s.S+s.F*!O,b,{reject:function(t){var n=j(this);return(0,n.reject)(t),n.promise}}),s(s.S+s.F*(u||!O),b,{resolve:function(t){if(t instanceof w&&E(t.constructor,this))return t;var n=j(this);return(0,n.resolve)(t),n.promise}}),s(s.S+s.F*!(O&&r(123)(function(t){w.all(t).catch(_)})),b,{all:function(t){var n=this,r=j(n),e=r.resolve,i=r.reject,o=M(function(){var r=[],o=0,u=1;p(t,!1,function(t){var c=o++,f=!1;r.push(void 0),u++,n.resolve(t).then(function(t){f||(f=!0,r[c]=t,--u||e(r))},i)}),--u||e(r)});return o&&i(o.error),r.promise},race:function(t){var n=this,r=j(n),e=r.reject,i=M(function(){p(t,!1,function(t){n.resolve(t).then(r.resolve,e)})});return i&&e(i.error),r.promise}})},function(t,n,r){var e=r(1),i=r(26),o=r(2),u=(r(3).Reflect||{}).apply,c=Function.apply;e(e.S+e.F*!r(4)(function(){u(function(){})}),"Reflect",{apply:function(t,n,r){var e=i(t),f=o(r);return u?u(e,n,f):c.call(e,n,f)}})},function(t,n,r){var e=r(1),i=r(70),o=r(26),u=r(2),c=r(6),f=r(4),a=r(163),s=(r(3).Reflect||{}).construct,l=f(function(){function t(){}return!(s(function(){},[],t)instanceof t)}),h=!f(function(){s(function(){})});e(e.S+e.F*(l||h),"Reflect",{construct:function(t,n){o(t),u(n);var r=arguments.length<3?t:o(arguments[2]);if(h&&!l)return s(t,n,r);if(t==r){switch(n.length){case 0:return new t;case 1:return new t(n[0]);case 2:return new t(n[0],n[1]);case 3:return new t(n[0],n[1],n[2]);case 4:return new t(n[0],n[1],n[2],n[3])}var e=[null];return e.push.apply(e,n),new(a.apply(t,e))}var f=r.prototype,v=i(c(f)?f:Object.prototype),p=Function.apply.call(t,v,n);return c(p)?p:v}})},function(t,n,r){var e=r(11),i=r(1),o=r(2),u=r(50);i(i.S+i.F*r(4)(function(){Reflect.defineProperty(e.f({},1,{value:1}),1,{value:2})}),"Reflect",{defineProperty:function(t,n,r){o(t),n=u(n,!0),o(r);try{return e.f(t,n,r),!0}catch(t){return!1}}})},function(t,n,r){var e=r(1),i=r(31).f,o=r(2);e(e.S,"Reflect",{deleteProperty:function(t,n){var r=i(o(t),n);return!(r&&!r.configurable)&&delete t[n]}})},function(t,n,r){"use strict";var e=r(1),i=r(2),o=function(t){this._t=i(t),this._i=0;var n,r=this._k=[];for(n in t)r.push(n)};r(139)(o,"Object",function(){var t,n=this,r=n._k;do{if(n._i>=r.length)return{value:void 0,done:!0}}while(!((t=r[n._i++])in n._t));return{value:t,done:!1}}),e(e.S,"Reflect",{enumerate:function(t){return new o(t)}})},function(t,n,r){var e=r(31),i=r(1),o=r(2);i(i.S,"Reflect",{getOwnPropertyDescriptor:function(t,n){return e.f(o(t),n)}})},function(t,n,r){var e=r(1),i=r(32),o=r(2);e(e.S,"Reflect",{getPrototypeOf:function(t){return i(o(t))}})},function(t,n,r){function e(t,n){var r,c,s=arguments.length<3?t:arguments[2];return a(t)===s?t[n]:(r=i.f(t,n))?u(r,"value")?r.value:void 0!==r.get?r.get.call(s):void 0:f(c=o(t))?e(c,n,s):void 0}var i=r(31),o=r(32),u=r(24),c=r(1),f=r(6),a=r(2);c(c.S,"Reflect",{get:e})},function(t,n,r){var e=r(1);e(e.S,"Reflect",{has:function(t,n){return n in t}})},function(t,n,r){var e=r(1),i=r(2),o=Object.isExtensible;e(e.S,"Reflect",{isExtensible:function(t){return i(t),!o||o(t)}})},function(t,n,r){var e=r(1);e(e.S,"Reflect",{ownKeys:r(177)})},function(t,n,r){var e=r(1),i=r(2),o=Object.preventExtensions;e(e.S,"Reflect",{preventExtensions:function(t){i(t);try{return o&&o(t),!0}catch(t){return!1}}})},function(t,n,r){var e=r(1),i=r(144);i&&e(e.S,"Reflect",{setPrototypeOf:function(t,n){i.check(t,n);try{return i.set(t,n),!0}catch(t){return!1}}})},function(t,n,r){function e(t,n,r){var f,h,v=arguments.length<4?t:arguments[3],p=o.f(s(t),n);if(!p){if(l(h=u(t)))return e(h,n,r,v);p=a(0)}return c(p,"value")?!(!1===p.writable||!l(v)||(f=o.f(v,n)||a(0),f.value=r,i.f(v,n,f),0)):void 0!==p.set&&(p.set.call(v,r),!0)}var i=r(11),o=r(31),u=r(32),c=r(24),f=r(1),a=r(66),s=r(2),l=r(6);f(f.S,"Reflect",{set:e})},function(t,n,r){var e=r(3),i=r(136),o=r(11).f,u=r(71).f,c=r(122),f=r(120),a=e.RegExp,s=a,l=a.prototype,h=/a/g,v=/a/g,p=new a(h)!==h;if(r(10)&&(!p||r(4)(function(){return v[r(7)("match")]=!1,a(h)!=h||a(v)==v||"/a/i"!=a(h,"i")}))){a=function(t,n){var r=this instanceof a,e=c(t),o=void 0===n;return!r&&e&&t.constructor===a&&o?t:i(p?new s(e&&!o?t.source:t,n):s((e=t instanceof a)?t.source:t,e&&o?f.call(t):n),r?this:l,a)};for(var d=u(s),y=0;d.length>y;)!function(t){t in a||o(a,t,{configurable:!0,get:function(){return s[t]},set:function(n){s[t]=n}})}(d[y++]);l.constructor=a,a.prototype=l,r(28)(e,"RegExp",a)}r(74)("RegExp")},function(t,n,r){r(119)("match",1,function(t,n,r){return[function(r){"use strict";var e=t(this),i=void 0==r?void 0:r[n];return void 0!==i?i.call(r,e):new RegExp(r)[n](String(e))},r]})},function(t,n,r){r(119)("replace",2,function(t,n,r){return[function(e,i){"use strict";var o=t(this),u=void 0==e?void 0:e[n];return void 0!==u?u.call(e,o,i):r.call(String(o),e,i)},r]})},function(t,n,r){r(119)("search",1,function(t,n,r){return[function(r){"use strict";var e=t(this),i=void 0==r?void 0:r[n];return void 0!==i?i.call(r,e):new RegExp(r)[n](String(e))},r]})},function(t,n,r){r(119)("split",2,function(t,n,e){"use strict";var i=r(122),o=e,u=[].push,c="split",f="length",a="lastIndex";if("c"=="abbc"[c](/(b)*/)[1]||4!="test"[c](/(?:)/,-1)[f]||2!="ab"[c](/(?:ab)*/)[f]||4!="."[c](/(.?)(.?)/)[f]||"."[c](/()()/)[f]>1||""[c](/.?/)[f]){var s=void 0===/()??/.exec("")[1];e=function(t,n){var r=String(this);if(void 0===t&&0===n)return[];if(!i(t))return o.call(r,t,n);var e,c,l,h,v,p=[],d=(t.ignoreCase?"i":"")+(t.multiline?"m":"")+(t.unicode?"u":"")+(t.sticky?"y":""),y=0,g=void 0===n?4294967295:n>>>0,b=new RegExp(t.source,d+"g");for(s||(e=new RegExp("^"+b.source+"$(?!\\s)",d));(c=b.exec(r))&&!((l=c.index+c[0][f])>y&&(p.push(r.slice(y,c.index)),!s&&c[f]>1&&c[0].replace(e,function(){for(v=1;v<arguments[f]-2;v++)void 0===arguments[v]&&(c[v]=void 0)}),c[f]>1&&c.index<r[f]&&u.apply(p,c.slice(1)),h=c[0][f],y=l,p[f]>=g));)b[a]===c.index&&b[a]++;return y===r[f]?!h&&b.test("")||p.push(""):p.push(r.slice(y)),p[f]>g?p.slice(0,g):p}}else"0"[c](void 0,0)[f]&&(e=function(t,n){return void 0===t&&0===n?[]:o.call(this,t,n)});return[function(r,i){var o=t(this),u=void 0==r?void 0:r[n];return void 0!==u?u.call(r,o,i):e.call(String(o),r,i)},e]})},function(t,n,r){"use strict";r(184);var e=r(2),i=r(120),o=r(10),u="toString",c=/./[u],f=function(t){r(28)(RegExp.prototype,u,t,!0)};r(4)(function(){return"/a/b"!=c.call({source:"a",flags:"b"})})?f(function(){var t=e(this);return"/".concat(t.source,"/","flags"in t?t.flags:!o&&t instanceof RegExp?i.call(t):void 0)}):c.name!=u&&f(function(){return c.call(this)})},function(t,n,r){"use strict";r(29)("anchor",function(t){return function(n){return t(this,"a","name",n)}})},function(t,n,r){"use strict";r(29)("big",function(t){return function(){return t(this,"big","","")}})},function(t,n,r){"use strict";r(29)("blink",function(t){return function(){return t(this,"blink","","")}})},function(t,n,r){"use strict";r(29)("bold",function(t){return function(){return t(this,"b","","")}})},function(t,n,r){"use strict";var e=r(1),i=r(147)(!1);e(e.P,"String",{codePointAt:function(t){return i(this,t)}})},function(t,n,r){"use strict";var e=r(1),i=r(16),o=r(148),u="endsWith",c=""[u];e(e.P+e.F*r(134)(u),"String",{endsWith:function(t){var n=o(this,t,u),r=arguments.length>1?arguments[1]:void 0,e=i(n.length),f=void 0===r?e:Math.min(i(r),e),a=String(t);return c?c.call(n,a,f):n.slice(f-a.length,f)===a}})},function(t,n,r){"use strict";r(29)("fixed",function(t){return function(){return t(this,"tt","","")}})},function(t,n,r){"use strict";r(29)("fontcolor",function(t){return function(n){return t(this,"font","color",n)}})},function(t,n,r){"use strict";r(29)("fontsize",function(t){return function(n){return t(this,"font","size",n)}})},function(t,n,r){var e=r(1),i=r(75),o=String.fromCharCode,u=String.fromCodePoint;e(e.S+e.F*(!!u&&1!=u.length),"String",{fromCodePoint:function(t){for(var n,r=[],e=arguments.length,u=0;e>u;){if(n=+arguments[u++],i(n,1114111)!==n)throw RangeError(n+" is not a valid code point");r.push(n<65536?o(n):o(55296+((n-=65536)>>10),n%1024+56320))}return r.join("")}})},function(t,n,r){"use strict";var e=r(1),i=r(148),o="includes";e(e.P+e.F*r(134)(o),"String",{includes:function(t){return!!~i(this,t,o).indexOf(t,arguments.length>1?arguments[1]:void 0)}})},function(t,n,r){"use strict";r(29)("italics",function(t){return function(){return t(this,"i","","")}})},function(t,n,r){"use strict";var e=r(147)(!0);r(140)(String,"String",function(t){this._t=String(t),this._i=0},function(){var t,n=this._t,r=this._i;return r>=n.length?{value:void 0,done:!0}:(t=e(n,r),this._i+=t.length,{value:t,done:!1})})},function(t,n,r){"use strict";r(29)("link",function(t){return function(n){return t(this,"a","href",n)}})},function(t,n,r){var e=r(1),i=r(30),o=r(16);e(e.S,"String",{raw:function(t){for(var n=i(t.raw),r=o(n.length),e=arguments.length,u=[],c=0;r>c;)u.push(String(n[c++])),c<e&&u.push(String(arguments[c]));return u.join("")}})},function(t,n,r){var e=r(1);e(e.P,"String",{repeat:r(149)})},function(t,n,r){"use strict";r(29)("small",function(t){return function(){return t(this,"small","","")}})},function(t,n,r){"use strict";var e=r(1),i=r(16),o=r(148),u="startsWith",c=""[u];e(e.P+e.F*r(134)(u),"String",{startsWith:function(t){var n=o(this,t,u),r=i(Math.min(arguments.length>1?arguments[1]:void 0,n.length)),e=String(t);return c?c.call(n,e,r):n.slice(r,r+e.length)===e}})},function(t,n,r){"use strict";r(29)("strike",function(t){return function(){return t(this,"strike","","")}})},function(t,n,r){"use strict";r(29)("sub",function(t){return function(){return t(this,"sub","","")}})},function(t,n,r){"use strict";r(29)("sup",function(t){return function(){return t(this,"sup","","")}})},function(t,n,r){"use strict";r(82)("trim",function(t){return function(){return t(this,3)}})},function(t,n,r){"use strict";var e=r(3),i=r(24),o=r(10),u=r(1),c=r(28),f=r(65).KEY,a=r(4),s=r(126),l=r(81),h=r(76),v=r(7),p=r(182),d=r(153),y=r(205),g=r(204),b=r(138),m=r(2),x=r(30),w=r(50),S=r(66),_=r(70),O=r(174),E=r(31),P=r(11),j=r(72),F=E.f,M=P.f,A=O.f,N=e.Symbol,T=e.JSON,I=T&&T.stringify,k="prototype",L=v("_hidden"),R=v("toPrimitive"),C={}.propertyIsEnumerable,D=s("symbol-registry"),U=s("symbols"),W=s("op-symbols"),G=Object[k],B="function"==typeof N,V=e.QObject,z=!V||!V[k]||!V[k].findChild,q=o&&a(function(){return 7!=_(M({},"a",{get:function(){return M(this,"a",{value:7}).a}})).a})?function(t,n,r){var e=F(G,n);e&&delete G[n],M(t,n,r),e&&t!==G&&M(G,n,e)}:M,K=function(t){var n=U[t]=_(N[k]);return n._k=t,n},J=B&&"symbol"==typeof N.iterator?function(t){return"symbol"==typeof t}:function(t){return t instanceof N},Y=function(t,n,r){return t===G&&Y(W,n,r),m(t),n=w(n,!0),m(r),i(U,n)?(r.enumerable?(i(t,L)&&t[L][n]&&(t[L][n]=!1),r=_(r,{enumerable:S(0,!1)})):(i(t,L)||M(t,L,S(1,{})),t[L][n]=!0),q(t,n,r)):M(t,n,r)},H=function(t,n){m(t);for(var r,e=g(n=x(n)),i=0,o=e.length;o>i;)Y(t,r=e[i++],n[r]);return t},$=function(t,n){return void 0===n?_(t):H(_(t),n)},X=function(t){var n=C.call(this,t=w(t,!0));return!(this===G&&i(U,t)&&!i(W,t))&&(!(n||!i(this,t)||!i(U,t)||i(this,L)&&this[L][t])||n)},Q=function(t,n){if(t=x(t),n=w(n,!0),t!==G||!i(U,n)||i(W,n)){var r=F(t,n);return!r||!i(U,n)||i(t,L)&&t[L][n]||(r.enumerable=!0),r}},Z=function(t){for(var n,r=A(x(t)),e=[],o=0;r.length>o;)i(U,n=r[o++])||n==L||n==f||e.push(n);return e},tt=function(t){for(var n,r=t===G,e=A(r?W:x(t)),o=[],u=0;e.length>u;)!i(U,n=e[u++])||r&&!i(G,n)||o.push(U[n]);return o};B||(N=function(){if(this instanceof N)throw TypeError("Symbol is not a constructor!");var t=h(arguments.length>0?arguments[0]:void 0),n=function(r){this===G&&n.call(W,r),i(this,L)&&i(this[L],t)&&(this[L][t]=!1),q(this,t,S(1,r))};return o&&z&&q(G,t,{configurable:!0,set:n}),K(t)},c(N[k],"toString",function(){return this._k}),E.f=Q,P.f=Y,r(71).f=O.f=Z,r(116).f=X,r(125).f=tt,o&&!r(69)&&c(G,"propertyIsEnumerable",X,!0),p.f=function(t){return K(v(t))}),u(u.G+u.W+u.F*!B,{Symbol:N});for(var nt="hasInstance,isConcatSpreadable,iterator,match,replace,search,species,split,toPrimitive,toStringTag,unscopables".split(","),rt=0;nt.length>rt;)v(nt[rt++]);for(var nt=j(v.store),rt=0;nt.length>rt;)d(nt[rt++]);u(u.S+u.F*!B,"Symbol",{for:function(t){return i(D,t+="")?D[t]:D[t]=N(t)},keyFor:function(t){if(J(t))return y(D,t);throw TypeError(t+" is not a symbol!")},useSetter:function(){z=!0},useSimple:function(){z=!1}}),u(u.S+u.F*!B,"Object",{create:$,defineProperty:Y,defineProperties:H,getOwnPropertyDescriptor:Q,getOwnPropertyNames:Z,getOwnPropertySymbols:tt}),T&&u(u.S+u.F*(!B||a(function(){var t=N();return"[null]"!=I([t])||"{}"!=I({a:t})||"{}"!=I(Object(t))})),"JSON",{stringify:function(t){if(void 0!==t&&!J(t)){for(var n,r,e=[t],i=1;arguments.length>i;)e.push(arguments[i++]);return n=e[1],"function"==typeof n&&(r=n),!r&&b(n)||(n=function(t,n){if(r&&(n=r.call(this,t,n)),!J(n))return n}),e[1]=n,I.apply(T,e)}}}),N[k][R]||r(27)(N[k],R,N[k].valueOf),l(N,"Symbol"),l(Math,"Math",!0),l(e.JSON,"JSON",!0)},function(t,n,r){"use strict";var e=r(1),i=r(127),o=r(152),u=r(2),c=r(75),f=r(16),a=r(6),s=r(3).ArrayBuffer,l=r(146),h=o.ArrayBuffer,v=o.DataView,p=i.ABV&&s.isView,d=h.prototype.slice,y=i.VIEW,g="ArrayBuffer";e(e.G+e.W+e.F*(s!==h),{ArrayBuffer:h}),e(e.S+e.F*!i.CONSTR,g,{isView:function(t){return p&&p(t)||a(t)&&y in t}}),e(e.P+e.U+e.F*r(4)(function(){return!new h(2).slice(1,void 0).byteLength}),g,{slice:function(t,n){if(void 0!==d&&void 0===n)return d.call(u(this),t);for(var r=u(this).byteLength,e=c(t,r),i=c(void 0===n?r:n,r),o=new(l(this,h))(f(i-e)),a=new v(this),s=new v(o),p=0;e<i;)s.setUint8(p++,a.getUint8(e++));return o}}),r(74)(g)},function(t,n,r){var e=r(1);e(e.G+e.W+e.F*!r(127).ABV,{DataView:r(152).DataView})},function(t,n,r){r(55)("Float32",4,function(t){return function(n,r,e){return t(this,n,r,e)}})},function(t,n,r){r(55)("Float64",8,function(t){return function(n,r,e){return t(this,n,r,e)}})},function(t,n,r){r(55)("Int16",2,function(t){return function(n,r,e){return t(this,n,r,e)}})},function(t,n,r){r(55)("Int32",4,function(t){return function(n,r,e){return t(this,n,r,e)}})},function(t,n,r){r(55)("Int8",1,function(t){return function(n,r,e){return t(this,n,r,e)}})},function(t,n,r){r(55)("Uint16",2,function(t){return function(n,r,e){return t(this,n,r,e)}})},function(t,n,r){r(55)("Uint32",4,function(t){return function(n,r,e){return t(this,n,r,e)}})},function(t,n,r){r(55)("Uint8",1,function(t){return function(n,r,e){return t(this,n,r,e)}})},function(t,n,r){r(55)("Uint8",1,function(t){return function(n,r,e){return t(this,n,r,e)}},!0)},function(t,n,r){"use strict";var e=r(166);r(118)("WeakSet",function(t){return function(){return t(this,arguments.length>0?arguments[0]:void 0)}},{add:function(t){return e.def(this,t,!0)}},e,!1,!0)},function(t,n,r){"use strict";var e=r(1),i=r(117)(!0);e(e.P,"Array",{includes:function(t){return i(this,t,arguments.length>1?arguments[1]:void 0)}}),r(78)("includes")},function(t,n,r){var e=r(1),i=r(143)(),o=r(3).process,u="process"==r(45)(o);e(e.G,{asap:function(t){var n=u&&o.domain;i(n?n.bind(t):t)}})},function(t,n,r){var e=r(1),i=r(45);e(e.S,"Error",{isError:function(t){return"Error"===i(t)}})},function(t,n,r){var e=r(1);e(e.P+e.R,"Map",{toJSON:r(165)("Map")})},function(t,n,r){var e=r(1);e(e.S,"Math",{iaddh:function(t,n,r,e){var i=t>>>0,o=n>>>0,u=r>>>0;return o+(e>>>0)+((i&u|(i|u)&~(i+u>>>0))>>>31)|0}})},function(t,n,r){var e=r(1);e(e.S,"Math",{imulh:function(t,n){var r=65535,e=+t,i=+n,o=e&r,u=i&r,c=e>>16,f=i>>16,a=(c*u>>>0)+(o*u>>>16);return c*f+(a>>16)+((o*f>>>0)+(a&r)>>16)}})},function(t,n,r){var e=r(1);e(e.S,"Math",{isubh:function(t,n,r,e){var i=t>>>0,o=n>>>0,u=r>>>0;return o-(e>>>0)-((~i&u|~(i^u)&i-u>>>0)>>>31)|0}})},function(t,n,r){var e=r(1);e(e.S,"Math",{umulh:function(t,n){var r=65535,e=+t,i=+n,o=e&r,u=i&r,c=e>>>16,f=i>>>16,a=(c*u>>>0)+(o*u>>>16);return c*f+(a>>>16)+((o*f>>>0)+(a&r)>>>16)}})},function(t,n,r){"use strict";var e=r(1),i=r(17),o=r(26),u=r(11);r(10)&&e(e.P+r(124),"Object",{__defineGetter__:function(t,n){u.f(i(this),t,{get:o(n),enumerable:!0,configurable:!0})}})},function(t,n,r){"use strict";var e=r(1),i=r(17),o=r(26),u=r(11);r(10)&&e(e.P+r(124),"Object",{__defineSetter__:function(t,n){u.f(i(this),t,{set:o(n),enumerable:!0,configurable:!0})}})},function(t,n,r){var e=r(1),i=r(176)(!0);e(e.S,"Object",{entries:function(t){return i(t)}})},function(t,n,r){var e=r(1),i=r(177),o=r(30),u=r(31),c=r(131);e(e.S,"Object",{getOwnPropertyDescriptors:function(t){for(var n,r=o(t),e=u.f,f=i(r),a={},s=0;f.length>s;)c(a,n=f[s++],e(r,n));return a}})},function(t,n,r){"use strict";var e=r(1),i=r(17),o=r(50),u=r(32),c=r(31).f;r(10)&&e(e.P+r(124),"Object",{__lookupGetter__:function(t){var n,r=i(this),e=o(t,!0);do{if(n=c(r,e))return n.get}while(r=u(r))}})},function(t,n,r){"use strict";var e=r(1),i=r(17),o=r(50),u=r(32),c=r(31).f;r(10)&&e(e.P+r(124),"Object",{__lookupSetter__:function(t){var n,r=i(this),e=o(t,!0);do{if(n=c(r,e))return n.set}while(r=u(r))}})},function(t,n,r){var e=r(1),i=r(176)(!1);e(e.S,"Object",{values:function(t){return i(t)}})},function(t,n,r){"use strict";var e=r(1),i=r(3),o=r(52),u=r(143)(),c=r(7)("observable"),f=r(26),a=r(2),s=r(68),l=r(73),h=r(27),v=r(79),p=v.RETURN,d=function(t){return null==t?void 0:f(t)},y=function(t){var n=t._c;n&&(t._c=void 0,n())},g=function(t){return void 0===t._o},b=function(t){g(t)||(t._o=void 0,y(t))},m=function(t,n){a(t),this._c=void 0,this._o=t,t=new x(this);try{var r=n(t),e=r;null!=r&&("function"==typeof r.unsubscribe?r=function(){e.unsubscribe()}:f(r),this._c=r)}catch(n){return void t.error(n)}g(this)&&y(this)};m.prototype=l({},{unsubscribe:function(){b(this)}});var x=function(t){this._s=t};x.prototype=l({},{next:function(t){var n=this._s;if(!g(n)){var r=n._o;try{var e=d(r.next);if(e)return e.call(r,t)}catch(t){try{b(n)}finally{throw t}}}},error:function(t){var n=this._s;if(g(n))throw t;var r=n._o;n._o=void 0;try{var e=d(r.error);if(!e)throw t;t=e.call(r,t)}catch(t){try{y(n)}finally{throw t}}return y(n),t},complete:function(t){var n=this._s;if(!g(n)){var r=n._o;n._o=void 0;try{var e=d(r.complete);t=e?e.call(r,t):void 0}catch(t){try{y(n)}finally{throw t}}return y(n),t}}});var w=function(t){s(this,w,"Observable","_f")._f=f(t)};l(w.prototype,{subscribe:function(t){return new m(t,this._f)},forEach:function(t){var n=this;return new(o.Promise||i.Promise)(function(r,e){f(t);var i=n.subscribe({next:function(n){try{return t(n)}catch(t){e(t),i.unsubscribe()}},error:e,complete:r})})}}),l(w,{from:function(t){var n="function"==typeof this?this:w,r=d(a(t)[c]);if(r){var e=a(r.call(t));return e.constructor===n?e:new n(function(t){return e.subscribe(t)})}return new n(function(n){var r=!1;return u(function(){if(!r){try{if(v(t,!1,function(t){if(n.next(t),r)return p})===p)return}catch(t){if(r)throw t;return void n.error(t)}n.complete()}}),function(){r=!0}})},of:function(){for(var t=0,n=arguments.length,r=Array(n);t<n;)r[t]=arguments[t++];return new("function"==typeof this?this:w)(function(t){var n=!1;return u(function(){if(!n){for(var e=0;e<r.length;++e)if(t.next(r[e]),n)return;t.complete()}}),function(){n=!0}})}}),h(w.prototype,c,function(){return this}),e(e.G,{Observable:w}),r(74)("Observable")},function(t,n,r){var e=r(54),i=r(2),o=e.key,u=e.set;e.exp({defineMetadata:function(t,n,r,e){u(t,n,i(r),o(e))}})},function(t,n,r){var e=r(54),i=r(2),o=e.key,u=e.map,c=e.store;e.exp({deleteMetadata:function(t,n){var r=arguments.length<3?void 0:o(arguments[2]),e=u(i(n),r,!1);if(void 0===e||!e.delete(t))return!1;if(e.size)return!0;var f=c.get(n);return f.delete(r),!!f.size||c.delete(n)}})},function(t,n,r){var e=r(185),i=r(161),o=r(54),u=r(2),c=r(32),f=o.keys,a=o.key,s=function(t,n){var r=f(t,n),o=c(t);if(null===o)return r;var u=s(o,n);return u.length?r.length?i(new e(r.concat(u))):u:r};o.exp({getMetadataKeys:function(t){return s(u(t),arguments.length<2?void 0:a(arguments[1]))}})},function(t,n,r){var e=r(54),i=r(2),o=r(32),u=e.has,c=e.get,f=e.key,a=function(t,n,r){if(u(t,n,r))return c(t,n,r);var e=o(n);return null!==e?a(t,e,r):void 0};e.exp({getMetadata:function(t,n){return a(t,i(n),arguments.length<3?void 0:f(arguments[2]))}})},function(t,n,r){var e=r(54),i=r(2),o=e.keys,u=e.key;e.exp({getOwnMetadataKeys:function(t){return o(i(t),arguments.length<2?void 0:u(arguments[1]))}})},function(t,n,r){var e=r(54),i=r(2),o=e.get,u=e.key;e.exp({getOwnMetadata:function(t,n){
return o(t,i(n),arguments.length<3?void 0:u(arguments[2]))}})},function(t,n,r){var e=r(54),i=r(2),o=r(32),u=e.has,c=e.key,f=function(t,n,r){if(u(t,n,r))return!0;var e=o(n);return null!==e&&f(t,e,r)};e.exp({hasMetadata:function(t,n){return f(t,i(n),arguments.length<3?void 0:c(arguments[2]))}})},function(t,n,r){var e=r(54),i=r(2),o=e.has,u=e.key;e.exp({hasOwnMetadata:function(t,n){return o(t,i(n),arguments.length<3?void 0:u(arguments[2]))}})},function(t,n,r){var e=r(54),i=r(2),o=r(26),u=e.key,c=e.set;e.exp({metadata:function(t,n){return function(r,e){c(t,n,(void 0!==e?i:o)(r),u(e))}}})},function(t,n,r){var e=r(1);e(e.P+e.R,"Set",{toJSON:r(165)("Set")})},function(t,n,r){"use strict";var e=r(1),i=r(147)(!0);e(e.P,"String",{at:function(t){return i(this,t)}})},function(t,n,r){"use strict";var e=r(1),i=r(46),o=r(16),u=r(122),c=r(120),f=RegExp.prototype,a=function(t,n){this._r=t,this._s=n};r(139)(a,"RegExp String",function(){var t=this._r.exec(this._s);return{value:t,done:null===t}}),e(e.P,"String",{matchAll:function(t){if(i(this),!u(t))throw TypeError(t+" is not a regexp!");var n=String(this),r="flags"in f?String(t.flags):c.call(t),e=new RegExp(t.source,~r.indexOf("g")?r:"g"+r);return e.lastIndex=o(t.lastIndex),new a(e,n)}})},function(t,n,r){"use strict";var e=r(1),i=r(181);e(e.P,"String",{padEnd:function(t){return i(this,t,arguments.length>1?arguments[1]:void 0,!1)}})},function(t,n,r){"use strict";var e=r(1),i=r(181);e(e.P,"String",{padStart:function(t){return i(this,t,arguments.length>1?arguments[1]:void 0,!0)}})},function(t,n,r){"use strict";r(82)("trimLeft",function(t){return function(){return t(this,1)}},"trimStart")},function(t,n,r){"use strict";r(82)("trimRight",function(t){return function(){return t(this,2)}},"trimEnd")},function(t,n,r){r(153)("asyncIterator")},function(t,n,r){r(153)("observable")},function(t,n,r){var e=r(1);e(e.S,"System",{global:r(3)})},function(t,n,r){for(var e=r(155),i=r(28),o=r(3),u=r(27),c=r(80),f=r(7),a=f("iterator"),s=f("toStringTag"),l=c.Array,h=["NodeList","DOMTokenList","MediaList","StyleSheetList","CSSRuleList"],v=0;v<5;v++){var p,d=h[v],y=o[d],g=y&&y.prototype;if(g){g[a]||u(g,a,l),g[s]||u(g,s,d),c[d]=l;for(p in e)g[p]||i(g,p,e[p],!0)}}},function(t,n,r){var e=r(1),i=r(151);e(e.G+e.B,{setImmediate:i.set,clearImmediate:i.clear})},function(t,n,r){var e=r(3),i=r(1),o=r(121),u=r(206),c=e.navigator,f=!!c&&/MSIE .\./.test(c.userAgent),a=function(t){return f?function(n,r){return t(o(u,[].slice.call(arguments,2),"function"==typeof n?n:Function(n)),r)}:t};i(i.G+i.B+i.F*f,{setTimeout:a(e.setTimeout),setInterval:a(e.setInterval)})},function(t,n,r){r(329),r(268),r(270),r(269),r(272),r(274),r(279),r(273),r(271),r(281),r(280),r(276),r(277),r(275),r(267),r(278),r(282),r(283),r(235),r(237),r(236),r(285),r(284),r(255),r(265),r(266),r(256),r(257),r(258),r(259),r(260),r(261),r(262),r(263),r(264),r(238),r(239),r(240),r(241),r(242),r(243),r(244),r(245),r(246),r(247),r(248),r(249),r(250),r(251),r(252),r(253),r(254),r(316),r(321),r(328),r(319),r(311),r(312),r(317),r(322),r(324),r(307),r(308),r(309),r(310),r(313),r(314),r(315),r(318),r(320),r(323),r(325),r(326),r(327),r(230),r(232),r(231),r(234),r(233),r(219),r(217),r(223),r(220),r(226),r(228),r(216),r(222),r(213),r(227),r(211),r(225),r(224),r(218),r(221),r(210),r(212),r(215),r(214),r(229),r(155),r(301),r(306),r(184),r(302),r(303),r(304),r(305),r(286),r(183),r(185),r(186),r(341),r(330),r(331),r(336),r(339),r(340),r(334),r(337),r(335),r(338),r(332),r(333),r(287),r(288),r(289),r(290),r(291),r(294),r(292),r(293),r(295),r(296),r(297),r(298),r(300),r(299),r(342),r(368),r(371),r(370),r(372),r(373),r(369),r(374),r(375),r(353),r(356),r(352),r(350),r(351),r(354),r(355),r(345),r(367),r(376),r(344),r(346),r(348),r(347),r(349),r(358),r(359),r(361),r(360),r(363),r(362),r(364),r(365),r(366),r(343),r(357),r(379),r(378),r(377),t.exports=r(52)},function(t,n){function r(t,n){if("string"==typeof n)return t.insertAdjacentHTML("afterend",n);var r=t.nextSibling;return r?t.parentNode.insertBefore(n,r):t.parentNode.appendChild(n)}t.exports=r},,,,,,,,,function(t,n,r){(function(n,r){!function(n){"use strict";function e(t,n,r,e){var i=n&&n.prototype instanceof o?n:o,u=Object.create(i.prototype),c=new p(e||[]);return u._invoke=s(t,r,c),u}function i(t,n,r){try{return{type:"normal",arg:t.call(n,r)}}catch(t){return{type:"throw",arg:t}}}function o(){}function u(){}function c(){}function f(t){["next","throw","return"].forEach(function(n){t[n]=function(t){return this._invoke(n,t)}})}function a(t){function n(r,e,o,u){var c=i(t[r],t,e);if("throw"!==c.type){var f=c.arg,a=f.value;return a&&"object"==typeof a&&m.call(a,"__await")?Promise.resolve(a.__await).then(function(t){n("next",t,o,u)},function(t){n("throw",t,o,u)}):Promise.resolve(a).then(function(t){f.value=t,o(f)},u)}u(c.arg)}function e(t,r){function e(){return new Promise(function(e,i){n(t,r,e,i)})}return o=o?o.then(e,e):e()}"object"==typeof r&&r.domain&&(n=r.domain.bind(n));var o;this._invoke=e}function s(t,n,r){var e=P;return function(o,u){if(e===F)throw new Error("Generator is already running");if(e===M){if("throw"===o)throw u;return y()}for(r.method=o,r.arg=u;;){var c=r.delegate;if(c){var f=l(c,r);if(f){if(f===A)continue;return f}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(e===P)throw e=M,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);e=F;var a=i(t,n,r);if("normal"===a.type){if(e=r.done?M:j,a.arg===A)continue;return{value:a.arg,done:r.done}}"throw"===a.type&&(e=M,r.method="throw",r.arg=a.arg)}}}function l(t,n){var r=t.iterator[n.method];if(r===g){if(n.delegate=null,"throw"===n.method){if(t.iterator.return&&(n.method="return",n.arg=g,l(t,n),"throw"===n.method))return A;n.method="throw",n.arg=new TypeError("The iterator does not provide a 'throw' method")}return A}var e=i(r,t.iterator,n.arg);if("throw"===e.type)return n.method="throw",n.arg=e.arg,n.delegate=null,A;var o=e.arg;return o?o.done?(n[t.resultName]=o.value,n.next=t.nextLoc,"return"!==n.method&&(n.method="next",n.arg=g),n.delegate=null,A):o:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,A)}function h(t){var n={tryLoc:t[0]};1 in t&&(n.catchLoc=t[1]),2 in t&&(n.finallyLoc=t[2],n.afterLoc=t[3]),this.tryEntries.push(n)}function v(t){var n=t.completion||{};n.type="normal",delete n.arg,t.completion=n}function p(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(h,this),this.reset(!0)}function d(t){if(t){var n=t[w];if(n)return n.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var r=-1,e=function n(){for(;++r<t.length;)if(m.call(t,r))return n.value=t[r],n.done=!1,n;return n.value=g,n.done=!0,n};return e.next=e}}return{next:y}}function y(){return{value:g,done:!0}}var g,b=Object.prototype,m=b.hasOwnProperty,x="function"==typeof Symbol?Symbol:{},w=x.iterator||"@@iterator",S=x.asyncIterator||"@@asyncIterator",_=x.toStringTag||"@@toStringTag",O="object"==typeof t,E=n.regeneratorRuntime;if(E)return void(O&&(t.exports=E));E=n.regeneratorRuntime=O?t.exports:{},E.wrap=e;var P="suspendedStart",j="suspendedYield",F="executing",M="completed",A={},N={};N[w]=function(){return this};var T=Object.getPrototypeOf,I=T&&T(T(d([])));I&&I!==b&&m.call(I,w)&&(N=I);var k=c.prototype=o.prototype=Object.create(N);u.prototype=k.constructor=c,c.constructor=u,c[_]=u.displayName="GeneratorFunction",E.isGeneratorFunction=function(t){var n="function"==typeof t&&t.constructor;return!!n&&(n===u||"GeneratorFunction"===(n.displayName||n.name))},E.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,c):(t.__proto__=c,_ in t||(t[_]="GeneratorFunction")),t.prototype=Object.create(k),t},E.awrap=function(t){return{__await:t}},f(a.prototype),a.prototype[S]=function(){return this},E.AsyncIterator=a,E.async=function(t,n,r,i){var o=new a(e(t,n,r,i));return E.isGeneratorFunction(n)?o:o.next().then(function(t){return t.done?t.value:o.next()})},f(k),k[_]="Generator",k.toString=function(){return"[object Generator]"},E.keys=function(t){var n=[];for(var r in t)n.push(r);return n.reverse(),function r(){for(;n.length;){var e=n.pop();if(e in t)return r.value=e,r.done=!1,r}return r.done=!0,r}},E.values=d,p.prototype={constructor:p,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=g,this.done=!1,this.delegate=null,this.method="next",this.arg=g,this.tryEntries.forEach(v),!t)for(var n in this)"t"===n.charAt(0)&&m.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=g)},stop:function(){this.done=!0;var t=this.tryEntries[0],n=t.completion;if("throw"===n.type)throw n.arg;return this.rval},dispatchException:function(t){function n(n,e){return o.type="throw",o.arg=t,r.next=n,e&&(r.method="next",r.arg=g),!!e}if(this.done)throw t;for(var r=this,e=this.tryEntries.length-1;e>=0;--e){var i=this.tryEntries[e],o=i.completion;if("root"===i.tryLoc)return n("end");if(i.tryLoc<=this.prev){var u=m.call(i,"catchLoc"),c=m.call(i,"finallyLoc");if(u&&c){if(this.prev<i.catchLoc)return n(i.catchLoc,!0);if(this.prev<i.finallyLoc)return n(i.finallyLoc)}else if(u){if(this.prev<i.catchLoc)return n(i.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return n(i.finallyLoc)}}}},abrupt:function(t,n){for(var r=this.tryEntries.length-1;r>=0;--r){var e=this.tryEntries[r];if(e.tryLoc<=this.prev&&m.call(e,"finallyLoc")&&this.prev<e.finallyLoc){var i=e;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=n&&n<=i.finallyLoc&&(i=null);var o=i?i.completion:{};return o.type=t,o.arg=n,i?(this.method="next",this.next=i.finallyLoc,A):this.complete(o)},complete:function(t,n){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&n&&(this.next=n),A},finish:function(t){for(var n=this.tryEntries.length-1;n>=0;--n){var r=this.tryEntries[n];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),v(r),A}},catch:function(t){for(var n=this.tryEntries.length-1;n>=0;--n){var r=this.tryEntries[n];if(r.tryLoc===t){var e=r.completion;if("throw"===e.type){var i=e.arg;v(r)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(t,n,r){return this.delegate={iterator:d(t),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=g),A}}}("object"==typeof n?n:"object"==typeof window?window:"object"==typeof self?self:this)}).call(n,function(){return this}(),r(158))}])</script><script src="/./main.b3331d.js"></script><script>!function(){!function(e){var t=document.createElement("script");document.getElementsByTagName("body")[0].appendChild(t),t.setAttribute("src",e)}("/slider.445162.js")}()</script>


    
<div class="tools-col" q-class="show:isShow,hide:isShow|isFalse" q-on="click:stop(e)">
  <div class="tools-nav header-menu">
    
    
      
      
      
    
      
      
      
    
      
      
      
    
    

    <ul style="width: 70%">
    
    
      
      <li style="width: 33.333333333333336%" q-on="click: openSlider(e, 'innerArchive')"><a href="javascript:void(0)" q-class="active:innerArchive">æ‰€æœ‰æ–‡ç« </a></li>
      
        
      
      <li style="width: 33.333333333333336%" q-on="click: openSlider(e, 'friends')"><a href="javascript:void(0)" q-class="active:friends">å‹é“¾</a></li>
      
        
      
      <li style="width: 33.333333333333336%" q-on="click: openSlider(e, 'aboutme')"><a href="javascript:void(0)" q-class="active:aboutme">å…³äºæˆ‘</a></li>
      
        
    </ul>
  </div>
  <div class="tools-wrap">
    
    	<section class="tools-section tools-section-all" q-show="innerArchive">
        <div class="search-wrap">
          <input class="search-ipt" q-model="search" type="text" placeholder="find somethingâ€¦">
          <i class="icon-search icon" q-show="search|isEmptyStr"></i>
          <i class="icon-close icon" q-show="search|isNotEmptyStr" q-on="click:clearChose(e)"></i>
        </div>
        <div class="widget tagcloud search-tag">
          <p class="search-tag-wording">tag:</p>
          <label class="search-switch">
            <input type="checkbox" q-on="click:toggleTag(e)" q-attr="checked:showTags">
          </label>
          <ul class="article-tag-list" q-show="showTags">
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color4">IOS</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color3">éšç¬”</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color4">iOS</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color3">IOSåŸºç¡€çŸ¥è¯†</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color2">ä¸‰æ–¹æ¡†æ¶è§£æ</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color5">å›¾ç‰‡è§†é¢‘</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color5">è§†é¢‘å¿ƒå¾—</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color5">åšå®¢ä¹‹åˆ</a>
              </li>
            
            <div class="clearfix"></div>
          </ul>
        </div>
        <ul class="search-ul">
          <p q-show="jsonFail" style="padding: 20px; font-size: 12px;">
            ç¼ºå¤±æ¨¡å—ã€‚<br/>1ã€è¯·ç¡®ä¿nodeç‰ˆæœ¬å¤§äº6.2<br/>2ã€åœ¨åšå®¢æ ¹ç›®å½•ï¼ˆæ³¨æ„ä¸æ˜¯yiliaæ ¹ç›®å½•ï¼‰æ‰§è¡Œä»¥ä¸‹å‘½ä»¤ï¼š<br/> npm i hexo-generator-json-content --save<br/><br/>
            3ã€åœ¨æ ¹ç›®å½•_config.ymlé‡Œæ·»åŠ é…ç½®ï¼š
<pre style="font-size: 12px;" q-show="jsonFail">
  jsonContent:
    meta: false
    pages: false
    posts:
      title: true
      date: true
      path: true
      text: false
      raw: false
      content: false
      slug: false
      updated: false
      comments: false
      link: false
      permalink: false
      excerpt: false
      categories: false
      tags: true
</pre>
          </p>
          <li class="search-li" q-repeat="items" q-show="isShow">
            <a q-attr="href:path|urlformat" class="search-title"><i class="icon-quo-left icon"></i><span q-text="title"></span></a>
            <p class="search-time">
              <i class="icon-calendar icon"></i>
              <span q-text="date|dateformat"></span>
            </p>
            <p class="search-tag">
              <i class="icon-price-tags icon"></i>
              <span q-repeat="tags" q-on="click:choseTag(e, name)" q-text="name|tagformat"></span>
            </p>
          </li>
        </ul>
    	</section>
    

    
    	<section class="tools-section tools-section-friends" q-show="friends">
  		
        <ul class="search-ul">
          
            <li class="search-li">
              <a href="http://localhost:4000/" target="_blank" class="search-title"><i class="icon-quo-left icon"></i>å‹æƒ…é“¾æ¥1</a>
            </li>
          
            <li class="search-li">
              <a href="http://localhost:4000/" target="_blank" class="search-title"><i class="icon-quo-left icon"></i>å‹æƒ…é“¾æ¥2</a>
            </li>
          
            <li class="search-li">
              <a href="http://localhost:4000/" target="_blank" class="search-title"><i class="icon-quo-left icon"></i>å‹æƒ…é“¾æ¥3</a>
            </li>
          
            <li class="search-li">
              <a href="http://localhost:4000/" target="_blank" class="search-title"><i class="icon-quo-left icon"></i>å‹æƒ…é“¾æ¥4</a>
            </li>
          
            <li class="search-li">
              <a href="http://localhost:4000/" target="_blank" class="search-title"><i class="icon-quo-left icon"></i>å‹æƒ…é“¾æ¥5</a>
            </li>
          
            <li class="search-li">
              <a href="http://localhost:4000/" target="_blank" class="search-title"><i class="icon-quo-left icon"></i>å‹æƒ…é“¾æ¥6</a>
            </li>
          
        </ul>
  		
    	</section>
    

    
    	<section class="tools-section tools-section-me" q-show="aboutme">
  	  	
  	  		<div class="aboutme-wrap" id="js-aboutme">å¾ˆæƒ­æ„§&lt;br&gt;&lt;br&gt;åªåšäº†ä¸€ç‚¹å¾®å°çš„å·¥ä½œ&lt;br&gt;è°¢è°¢å¤§å®¶</div>
  	  	
    	</section>
    
  </div>
  
</div>
    <!-- Root element of PhotoSwipe. Must have class pswp. -->
<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

    <!-- Background of PhotoSwipe. 
         It's a separate element as animating opacity is faster than rgba(). -->
    <div class="pswp__bg"></div>

    <!-- Slides wrapper with overflow:hidden. -->
    <div class="pswp__scroll-wrap">

        <!-- Container that holds slides. 
            PhotoSwipe keeps only 3 of them in the DOM to save memory.
            Don't modify these 3 pswp__item elements, data is added later on. -->
        <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
        </div>

        <!-- Default (PhotoSwipeUI_Default) interface on top of sliding area. Can be changed. -->
        <div class="pswp__ui pswp__ui--hidden">

            <div class="pswp__top-bar">

                <!--  Controls are self-explanatory. Order can be changed. -->

                <div class="pswp__counter"></div>

                <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>

                <button class="pswp__button pswp__button--share" style="display:none" title="Share"></button>

                <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>

                <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>

                <!-- Preloader demo http://codepen.io/dimsemenov/pen/yyBWoR -->
                <!-- element will get class pswp__preloader--active when preloader is running -->
                <div class="pswp__preloader">
                    <div class="pswp__preloader__icn">
                      <div class="pswp__preloader__cut">
                        <div class="pswp__preloader__donut"></div>
                      </div>
                    </div>
                </div>
            </div>

            <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                <div class="pswp__share-tooltip"></div> 
            </div>

            <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
            </button>

            <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
            </button>

            <div class="pswp__caption">
                <div class="pswp__caption__center"></div>
            </div>

        </div>

    </div>

</div>
  </div>
</body>
</html>